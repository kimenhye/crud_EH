(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[1683],{1683:(t,e,i)=>{"use strict";i.r(e),i.d(e,{cellInfo:()=>A,drilldown:()=>R,gridView:()=>F,headerInfo:()=>v,linkedMappingController:()=>T,mappingController:()=>L.v});var o=i(5405),s=i(465),r=i(5130),a=i(209),n=i(6247),l=function(){};l.prototype.notifySettedGridData=function(t,e,i,o,s,a){try{if(this.options.scrollFix&&this.settedData){for(var n=this.getTopRowIndex(),l=0;l<=this.lastIndex;l++){var h=n+l;this.drawRowData(h-this.rowIndex,h)}return}this.dataList.clearFilter(!0),this._oldFilterArrStr||this.notifyClearFilter(!0),this.settedData=!1;i=i;(e=e||!1)||(this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,this.extraData={grid:{},row:[],col:[],cell:[]},i=0,this._removeAllTDCellClass()),this.beforeDataLength=-1,1==this.isDrillDown&&(this.setCellInfo(),1==this.isPaste?this.initPasteDrilldown():this.initDrilldown()),this.initStyleArr(i),0==this.loadFlag&&e?this.loadFlag=!1:this.loadFlag=!0,this.lastTopRowIndex=null;var d={gridData:!0!==a};e&&(d.append=!0,d.keepTop=!0),this.notifyDataChanged(d),this.loadFlag=!0,0==this.getTotalRow()&&this.removeFocusedCell(),this.options.focusOnSetData&&this._setFocusedCell(0,0),this.setScrollYHeight(),this.settedData=!0,this.options.fixedRightColumn>0&&this._handleScrollX(),(!e&&this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0),(!0===s||this.options.instanceBindBySetData)&&this.options.ref&&this._refreshInstance(t,e)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeSettedCellData=function(){try{if(null!=this.editedCell)return void this.editedCell.handleEndEdit()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySettedCellData=function(t,e,i,o){try{var s=this.getColumnIndex(e);t=this._getGroupbyGroupedRowIndex(t);this.notifyCellChanged(t,s,o),this.isDrillDown&&(!s&&this._dataList.options.depthColumn&&(s=this._dataList.getColumnIndex(e)),this.drilldown.options.depthColumn==s&&(this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight()));var a=this.getCellInfo(e),n=t,l=this.getTotalRow();if(a&&a.options.colMerge&&a.options.colMergeEdit&&!this.groupbyStatus.grouped){var h=this.data_td_list[(n-this.rowIndex)*this.oneRowDataLength+s];if(h){var d,u=h.getAttribute("colMerged");if("1"==u&&i!=this.dataList.getCellData(n-1,s))if(h.setAttribute("colMerged","0"),this.drawCellData(n-this.rowIndex,n,s),n<l-1)(d=this.data_td_list[(n-this.rowIndex+1)*this.oneRowDataLength+s])&&(i==this.dataList.getCellData(n+1,s)?d.setAttribute("colMerged","1"):d.setAttribute("colMerged","0"),this.drawCellData(n-this.rowIndex+1,n+1,s));if("0"==u)if(n>=1&&i==this.dataList.getCellData(n-1,s)&&(h.setAttribute("colMerged","1"),this.drawCellData(n-this.rowIndex,n,s)),n<l-1)(d=this.data_td_list[(n-this.rowIndex+1)*this.oneRowDataLength+s])&&(i==this.dataList.getCellData(n+1,s)?d.setAttribute("colMerged","1"):d.setAttribute("colMerged","0"),this.drawCellData(n-this.rowIndex+1,n+1,s))}}this.moveDirection=null}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeInsertedRow=function(t){try{!this.isDrillDown&&t>this.getDataLength()&&(t=this.getDataLength());var e=!1,i=[];if(this.isDrillDown){for(var o=this.drilldown.getParentRowIndex(t);o>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(o))||(e=!0,i.push(o)),o=this.drilldown.getParentRowIndex(o);if(e)for(var s=i.length-1;s>=0;s--)if(!this.drilldown.isOpen(i[s])){var a=this.drilldown.getDisplayRowIndex(i[s]);this._toggle(a)}}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterInsertedRow=function(t,e){try{this.settedData=!1
;for(var i=this.dataList.getRealRowIndex(t),o=this.getTotalCol(),s=[i*o,0],a=0;a<o;a++)s.push(null);if(this.resetExpressionFunc(),[].splice.apply(this.cellStyleArr,s),[].splice.apply(this.cellClassArr,s),[].splice.apply(this.cellReadOnlyArr,s),[].splice.apply(this.cellDisabledArr,s),this.extraData.row.splice(t,0,null),this.extraData.cell.splice(t,0,null),1==this.options.setCellInputTypeCustom&&!this.validTypeGetter){var n=this.getColumnCount();for(a=0;a<n;a++){var l=this.getCellInfo(a);"custom"==l.options.inputType&&(l.cellManagerHashByRowIndex.splice(i,0,null),l.cellManagerIDByRowIndex.splice(i,0,null))}}if(this.isDrillDown&&this.drilldown.statusArr.splice(i,0,!0),this._mergeNotifyRowChanged("insertRow",t),!0!==e&&(this.notifyRowInserted(t),this.notifyStatusChanged({rowIndex:[t]})),this.options.ref&&1!=this.insertRowByInstance&&!0!==e&&this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){var h;h=1==this.repeatNodeTagNameFilter&&1==this.repeatNodeTagName.length?this.filteredRepeatNodeTagName[0]:this.repeatNodeTagName[0];var d,u=WebSquare.xml.parse("<"+h+"></"+h+">").documentElement,p=u,c=h;this.repeatNodeTagName.length>1&&(c=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(a=1;a<this.repeatNodeTagName.length;a++)p=WebSquare.xml.createNode(p,this.repeatNodeTagName[a],!1);d=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(u,c):u;for(a=0;a<this.repeatNodeChildTagName.length;a++)WebSquare.xml.createNode(d,this.repeatNodeChildTagName[a],!1);t>=this.maxRowLength?WebSquare.ModelUtil.setInstanceNode(u,this.options.ref,null,"append",!1,this.scope_id):WebSquare.ModelUtil.setInstanceNode(u,this.options.ref+"/"+h+"["+(t+1)+"]",null,"insertBeforeSibling",!1,this.scope_id)}return this.settedData=!0,this.loadFlag=null==this.loadFlag||this.loadFlag,this._refreshColumnClass(),t}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeRemovedRow=function(t){try{if(this.options.ref&&1!=this.removeRowByInstance){var e=this.getRealRowIndex(t)+1;WebSquare.ModelUtil.removeInstanceNode(this.options.ref+"/"+this.repeatNodeTagName[0]+"["+e+"]",!1,this.scope_id)}if(this.isDrillDown&&this._dataList.options.depthColumn){for(var i=!1,o=[],s=this.drilldown.getParentRowIndex(t);s>-1;)this.drilldown.isOpen(this.drilldown.getDisplayRowIndex(s))||(i=!0,o.push(s)),s=this.drilldown.getParentRowIndex(s);if(i)for(var a=o.length-1;a>=0;a--)if(!this.drilldown.isOpen(o[a])){var n=this.drilldown.getDisplayRowIndex(o[a]);this._toggle(n)}t=this.drilldown.getDisplayRowIndex(t)}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeKeepFilter=function(){try{var t=this._dataList.getFilterList();if(t.length<=0||isNaN(t.length))return;this._oldFilterArrStr=JSON.stringify(t,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})),this.customFilterStatusObj&&(this._oldStatusObj=JSON.stringify(this.customFilterStatusObj)),this.customFilterList&&this.customFilterList.customFilterListFilterInfo?this._oldFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})):this.groupbyStatus.grouped&&this.groupbyStatus.filter&&(this._oldFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})))}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterKeepFilter=function(){try{if(!this._oldFilterArrStr)return;this._refreshCustomFilterHistory(this._oldFilterArrStr,this._oldFilterInfo,this._oldStatusObj),this._oldFilterArrStr=null,this._oldFilterInfo=null,this._oldStatusObj=null}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterRemovedRow=function(t,e,i,o){try{this.removed=!0,this.isDrillDown&&this.drilldown.statusArr.splice(i,1);var s=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)?i:t
;this.cellStyleArr.splice(this.oneRowDataLength*s,this.oneRowDataLength),this.cellClassArr.splice(this.oneRowDataLength*s,this.oneRowDataLength),this.cellReadOnlyArr.splice(this.oneRowDataLength*s,this.oneRowDataLength),this.cellDisabledArr.splice(this.oneRowDataLength*s,this.oneRowDataLength);for(var n=this.getColumnCount(),l=0;l<n;l++){var h=this.getCellInfo(l);if("custom"==h.options.inputType&&1==this.options.setCellInputTypeCustom&&!this.validTypeGetter){if(this.options.senseReader||h.options.embeddedInput){var d=h.cellManagerHashByRowIndex[i];if(d&&d.options.embeddedInput){var u=h.cellManagerIDByRowIndex[i],p=this.id+"_"+u,c=this.dom[p],g=null;null!=c&&(g=WebSquare.idCache[c.uuid]),g&&"function"==typeof g.remove&&g.remove(),delete this.dom[p]}}h.cellManagerHashByRowIndex.splice(i,1),h.cellManagerIDByRowIndex.splice(i,1)}}if(this.itemValueObj)for(var f in this.itemValueObj){var m=o.split(",")[this._dataList.bodyIdColIndexMap[f]];for(var y in this.itemValueObj[f])-1!=y.indexOf("auto")&&this.itemValueObj[f][y]===m&&(this.itemValueObj[f][y]="")}if(!0!==e){var b=this.checkScrollEnd,w=this.scrollEvent;if(this.checkScrollEnd=!1,this.scrollEvent=!1,this._getFocusedRowIndex()==this.getDataLength()){var v=this._getFocusedRowIndex(),I=this.getFocusedColumnIndex();this.removeRowFocus(this.getDataLength()),this._setFocusedCell(v-1,I)}this.resetExpressionFunc(),this._mergeNotifyRowChanged("removeRow",t),this.notifyRowChanged(t),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.notifyStatusChanged({rowindex:[t]}),a.D.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[b,w]})}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRemovedRows=function(t,e){try{if(!0!==e){var i=this.checkScrollEnd,o=this.scrollEvent;this.checkScrollEnd=!1,this.scrollEvent=!1,this.resetExpressionFunc(),this.notifyRowChanged(),a.D.setTimeout((function(t,e){this.checkScrollEnd=t,this.scrollEvent=e}),{key:this.id+"_notifyAfterRemovedRow",caller:this,delay:150,args:[i,o]})}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRemovedAll=function(t){try{this.removed=!0;var e=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this.loadFlag=!0,this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this.cellReadOnlyArr=[],this.cellDisabledArr=[],this.extraData={grid:{},row:[],col:[],cell:[]},this._removeAllTDCellClass(),this.resetExpressionFunc();for(var i=this.getTotalCol(),o=0;o<i;o++){var s=this.getCellInfo(o);if(s&&s.options&&"expression"==s.options.inputType)for(var a=this.drawedRowLength,n=0;n<a;n++)s.options.expressionFunc&&s.options.expressionFunc[n]&&(s.options.expressionFunc[n]={});else if("custom"==s.options.inputType)if(1!=this.options.setCellInputTypeCustom||this.validTypeGetter)s.options.typeGetter&&(s.cellManagerHashByID={},s.cellManagerHashByRowIndex={},s.cellManagerIDByRowIndex={});else{if(this.options.senseReader||s.options.embeddedInput)for(var l=0;l<s.cellManagerIDByRowIndex.length;l++){var h=s.cellManagerHashByRowIndex[l];if(h&&h.options.embeddedInput){var d=s.cellManagerIDByRowIndex[l],u=this.id+"_"+d,p=this.dom[u],c=null;null!=p&&(c=WebSquare.idCache[p.uuid]),c&&"function"==typeof c.remove&&c.remove(),delete this.dom[u],s.cellManagerIDByRowIndex[l]=null,s.cellManagerHashByRowIndex[l]=null}}s.cellManagerHashByRowIndex=[],s.cellManagerIDByRowIndex=[]}}this.removeFocusedCell();for(o=0;o<this.dataRowList.length;o++){var g=this.dataRowList[o];g.style.display="none",this.__addClass(g,"w2grid_hidedRow"),this.__hasClass(g,"w2grid_lastRow")&&this.__removeClass(g,"w2grid_lastRow")}this.lastDisplayedRow=-1,this.subtotalHidden(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1,
this.maxRowLength=0,this.displayNoResultMessage(),this.drawFooter(),this.drawHeader(),this._setCheckboxHead(),0==this.getDataLength()&&(this.removeFocusedCell(),"all"===this.options.visibleRowNum&&this.setSize(null,this.defaultDataLayerHeight)),this.setScrollYHeight(),this.options.ref&&1!=this.removeRowByInstance&&WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],gridNoRefresh:!0,scopeId:this.scope_id}),this.options.groupbyFilterBox&&!1!==t&&this.clearFilterHistory(),1==this.isDrillDown&&this.initDrilldown(),this.itemValueObj={}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRemovedRange=function(t){try{this.removed=!0,this.notifyRowChanged(t)}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyCreatedRowStatus=function(t){try{this.rowStyleArr=this.rowStyleArr.slice(0,t).concat([null]).concat(this.rowStyleArr.slice(t)),this.rowReadOnlyArr=this.rowReadOnlyArr.slice(0,t).concat([null]).concat(this.rowReadOnlyArr.slice(t)),this.rowDisabledArr=this.rowDisabledArr.slice(0,t).concat([null]).concat(this.rowDisabledArr.slice(t)),this.rowStyleFixedArr=this.rowStyleFixedArr.slice(0,t).concat([null]).concat(this.rowStyleFixedArr.slice(t)),this.rowStyleDataArr=this.rowStyleDataArr.slice(0,t).concat([null]).concat(this.rowStyleDataArr.slice(t))}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyRemovedRowStatus=function(t){try{this.rowStyleArr.splice(t,1),this.rowReadOnlyArr.splice(t,1),this.rowDisabledArr.splice(t,1),this.rowStyleFixedArr.splice(t,1),this.rowStyleDataArr.splice(t,1)}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyDeleteRow=function(t){try{this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var e=0;e<this.getColCnt();e++){var i=this.getColumnID(e),o=this.expressionAssArr[i];if(null!=o)for(var s=0;s<o.length;s++){var a=this.getColumnIndex(o[s]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyUndeleteRow=function(t){try{this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.hasFooter&&this.options.excludeDeletedRows&&this.drawFooter(),this.hasSubtotal&&this.options.excludeDeletedRows&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex));for(var e=0;e<this.getColCnt();e++){var i=this.getColumnID(e),o=this.expressionAssArr[i];if(null!=o)for(var s=0;s<o.length;s++){var a=this.getColumnIndex(o[s]);this.drawCellData(t-this.rowIndex,t,a)}}}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyReformed=function(){try{if(this.options.rowStatusVisible)for(var t=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,e=0;e<=t;e++)this._drawRowStatus(e,this.rowIndex+e)}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyModifyAllStatus=function(t){try{for(var e=0;e<this.getDataLength();e++)this._drawRowStatus(e-this.rowIndex,e);this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:"all"})}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyModifyRangeStatus=function(t,e,i){try{var o=this.getDataLength();if(0<=t&&e<=o)for(var s=t;s<=e;s++)this._drawRowStatus(s-this.rowIndex,s);this.displayNoResultMessage(),this.notifyStatusChanged({startIndex:t,endIndex:e})}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyModifyRowStatus=function(t,e){try{t>-1&&t<this.getDataLength()&&(this._drawRowStatus(t-this.rowIndex,t),this.displayNoResultMessage(),this.notifyStatusChanged({rowIndex:[t]}))}catch(t){r.w.printStackTrace(t)}},l.prototype.notifyModifyMatchedStatus=function(t,e,i){try{for(var o=[],s=this.getDataLength(),a=0;a<s;a++){var n=this.getColumnID(t),l=this.dataList.getRealRowIndex(a);if(this.dataList._getCellData(l,n)+""==e+"")i!=this.dataList._setRowStatus(l,i)&&o.push(a),this._drawRowStatus(a-this.rowIndex,a),this.displayNoResultMessage()}
this.notifyStatusChanged({rowIndex:o})}catch(t){r.w.printStackTrace(t)}},l.prototype.notifySetColumnDefaultValue=function(t,e){try{this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySettedData=function(t){try{this.groupbyStatus.grouped&&this.clearGroupby(),this.loadCheck=[],t||this.options.focusOnSetData||this.removeFocusedCell()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySetRowXML=function(t,e){e?this.notifyRowChanged(t):this.notifyRowInserted(t)},l.prototype.notifyRowMoveUp=function(t){try{var e=this.extraData.row[t-1];this.extraData.row[t-1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t-1],this.extraData.cell[t-1]=this.extraData.cell[t],this.extraData.cell[t]=e,this._getFocusedRowIndex()==t&&this._setFocusedCell(t-1,this.getFocusedColumnIndex()),this.notifyRowChanged(t-1)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRowMoveDown=function(t){try{var e=this.extraData.row[t+1];this.extraData.row[t+1]=this.extraData.row[t],this.extraData.row[t]=e,e=this.extraData.cell[t+1],this.extraData.cell[t+1]=this.extraData.cell[t],this.extraData.cell[t]=e,this._getFocusedRowIndex()==t&&this._setFocusedCell(t+1,this.getFocusedColumnIndex()),this.notifyRowChanged(t)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRowModified=function(t){try{this.changeCount++,this.drawRowData(t-this.rowIndex,t),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyStatusChanged=function(t){try{var e,i,o=!1;"object"==typeof t.rowIndex?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getDataLength()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var s=e;s<i;s++){var a;if(a=o?t.rowIndex[s]:s,null!=this.rowStatusColIDArr)for(var n=0;n<this.rowStatusColIDArr.length;n++){var l=this.getColumnIndex(this.rowStatusColIDArr[n]);this.drawCellData(a-this.rowIndex,a,l)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySaveFocusedCell=function(){try{this.focusedCellInfo.beforeFocusedCell=!(0==this.focusedCell.length),this.focusedCellInfo.beforeFocusedCell&&(this.focusedCellInfo.beforeFocusedCellRealRowIndex=this.dataList.getRealRowIndex(this.focusedCell[0].focusedRowIndex),this.focusedCellInfo.beforeFocusedCellRealColumnIndex=this.focusedCell[0].focusedColIndex)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySetFocusedCell=function(t){try{var e=this.options.filterFocusMode,i=this.focusedCellInfo.beforeFocusedCellRealRowIndex;if("outfocus"!==e&&"infocus"!==e){if(this.focusedCellInfo.beforeFocusedCell)for(var o=0;o<this.getDataLength();o++)if(this.dataList.getRealRowIndex(o)==i){this._setFocusedCell(o,this.focusedCellInfo.beforeFocusedCellRealColumnIndex,!1,{isSort:t});break}}else"outfocus"==e&&this.outFocusedCell();this.focusedCellInfo={}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySettedFilter=function(t){try{var e=t&&t.isSort,i=t&&t.fiteredColID;if(this.notifySetFocusedCell({isSort:e}),e&&this.syncWithSortStatus(),this.groupbyStatus.grouped)for(var o in this.customFilterStatusObj)if(this.customFilterStatusObj[o]){this.rowNumArr=[];for(var s=0;s<this.getDataLength();s++)this.rowNumArr.push(s);break}1==this.isDrillDown&&this._linkedDataList&&(this.setCellInfo(),this.initDrilldown());var a=!t||!1!==t.keepTop,n=[];if(this.hiddenRowObj.init){for(var l in this.hiddenRowObj.row)!0===this.hiddenRowObj.row[l]&&n.push(l);this.clearRowVisible({noDraw:!0})}if(this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:a}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),
e&&!this.groupbyStatus.grouped&&this.drawHeaderSortImages(),i&&!e&&this.options.useFilterList){var h=this.bodyToHeaderRelation[i];if(h){var d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}}for(s=0;s<n.length;s++)this.setRowVisible(n[s])}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifySettedFilterByUser=function(t){try{if(this.options.useFilterListSync){var e=t.colID,i=JSON.parse(t.oldFilteredRowIndexArr),o=JSON.parse(t.newFilteredRowIndexArr);if(this.groupbyStatus.grouped);else if(this.options.useFilterList){this.customFilterList||this.createCustomFilterList(null,!0),this.customFilterList.filterHistory.column[0]!==e&&(this.customFilterList.filterHistory.column.unshift(e),this.customFilterList.filterHistory.filteredRowIndexArr.unshift(i));var s=this.dataList.getColData(e,o),a=this.getUniqueValueOfArray(s),n=this.changeItemValue("label",e,a);this.customFilterList.customFilterListFilterInfo||(this.customFilterList.customFilterListFilterInfo={}),this.customFilterList.customFilterListFilterInfo[e]=[];for(var l=0;l<n.length;l++){var h=n[l],d=this;"string"==typeof h&&(h=h.replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return d.replacechar(t)}))),this.customFilterList.customFilterListFilterInfo[e].push(h)}}}}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeClearSort=function(){try{this.notifySaveFocusedCell(),this.clearHeaderSort()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyClearSortFilter=function(){try{var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex();this.syncWithSortStatus(),this.rowNumArr=null,this.removeFocusedCell(),this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),"infocus"==this.options.filterFocusMode&&this._setFocusedCell(t,e)}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeSettedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterSettedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeRemovedColumnFilter=function(){try{this.lastTopRowIndex=null,this.scrollEvent=!1,this.rowIndex=0}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterRemovedColumnFilter=function(){try{var t=this.getElementById(this.id+"_scrollY_div"),e=t.scrollTop;this.bScrollTop=-1,this.scrollEvent=!0,t.scrollTop=e,this.options.groupbyFilterBox&&this.refreshGroupbyFilterBox()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRemovedFilter=function(t){try{!0===t&&this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null,this.setScrollYHeight()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyClearFilter=function(t){try{for(var e in this.clearHeaderSort(),this.rowNumArr=null,this._mergeNotifyFilter(),t||(this.adjustDraw_keepTop=!0,this.notifyDataChanged({keepTop:!0}),this.adjustDraw_keepTop=null),0==this.getDataLength()&&this.removeFocusedCell(),this.lastTopRowIndex=null,this.setScrollYHeight(),this.headerInfoHash){var i=this.getElementById(this.id+"_"+e+"_filter");i&&WebSquare.style.removeClass(i,"w2grid_customFilter_filter")}this.itemValueObj={},this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterList.customFilterListFilterInfo={}),this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]})}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyMultisort=function(){try{
this.syncWithSortStatus(),this.drawHeaderSortImages()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyBeforeInitDataList=function(){try{this.removeAllFinish=!0}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyAfterInitDataList=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj(),1==this.isDrillDown&&this.initDrilldown(),this.removeAllFinish=!1,this.initColumns()}catch(t){r.w.printStackTrace(t,null,this)}},l.prototype.notifyRefresh=function(t){try{!this.startedDisplayNone&&this.rowIndex>=0&&(t&&this.setDataTable(),this._mergeRefresh(),this.drawData(this.rowIndex,0),t&&this.setScrollYHeight(),this.displayNoResultMessage())}catch(t){r.w.printStackTrace(t,null,this)}};var h,d=i(6146),u=i(6342),p=function(){};p.prototype.toHTML=function(){try{var t=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/mainZIndex/@value")||"10",e=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/xScrollZIndex/@value")||"20",i=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/yScrollZIndex/@value")||"15";if(this.uncompleted)return;var o=[],a="scroll"===this.options.overflowY,n=(this.options.drawType,"hidden"),l=(this.options.drawType,""),h="native"===this.options.drawType?"visibility:hidden;":"",d=this.options.title?" title='"+this.options.title.wq_replaceAll("'","&#39;")+"'":"",u="none"==this.options.focusMode||"linear"==this.options.focusFlow?"":" tabIndex='0'",p=this.options.scrollFocus?" tabIndex='0'":"",c=""==this.options.style?"style='overflow:"+n+";'":"style='"+this.options.style+";overflow:"+n+";'",g=this.options.readOnly?" w2grid_readonly_outer":"",f=function(t){return this._useRole()?" role='"+t+"' ":""};if(o.push("<div id='"+this.id+"' class='w2grid "+this.options.className+g+"' "+c+f.call(this,"application")+d+u+">"),this.options.senseReader&&this.options.useStartEndDiv&&o.push("<div id='"+this.id+"_gridstart_div' style='height:0px; font-size:0; line-height:0px;' tabindex='0'>그리드 시작</div>"),this.options.groupbyZone&&this.options.groupbyFilterBox&&"top"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='top:0px;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete" />'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+f.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),this.options.groupbyZone){var m="<div id='"+this.id+"_groupbyZone_div' class='w2grid_groupbyZone' style='width:0px; height:0px;'>",y="";this.options.groupbyZoneSearch&&(y="<div id='"+this.id+"_groupbyZone_search' class='w2grid_groupbyZone_search'></div>"),o.push(m+y+"</div>")}return o.push("<div id='"+this.id+"_main_div' class='w2grid_main' style='z-index:"+t+";overflow:"+n+";position:absolute;left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; top:0px; bottom:"+this.scrollLayerWidthSize+"px;float:left;'>"),o.push(this.mainDataGridLayout()),o.push("</div>"),this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"==this.options.groupbyFilterBoxLocation&&(o.push("<div id='"+this.id+"_groupbyFilterBox_div' class='w2grid_groupbyFilterBox' style='left:0px; right:"+(a?this.scrollLayerWidthSize:"0")+"px; bottom:0px;float:left;'>"),o.push("<div id='"+this.id+"_groupbyFilterBox_main' class='w2grid_groupbyFilterBox_main' >"),
o.push("<div id='"+this.id+"_groupbyFilterBox_buttons' class='w2grid_groupbyFilterBox_buttons' >"),o.push('<input id="'+this.id+'_groupbyFilterBox_delete" type="button" value="X" class="w2grid_groupbyFilterBox_delete"/>'),o.push('<input id="'+this.id+'_groupbyFilterBox_apply" type="checkbox" class="w2grid_groupbyFilterBox_apply" />'),o.push("</div>"),o.push('<div id="'+this.id+'_groupbyFilterBox_select"'+f.call(this,"combobox")+'aria-labelledby="'+this.id+'_groupbyFilterBox_itemTable" aria-autocomplete="none" class="" tabindex="0">'),o.push("</div>"),o.push("</div>"),o.push("</div>")),o.push("<div id='"+this.id+"_scrollX_div' class='w2grid_scrollX' style='z-index:"+e+";overflow-x:hidden;overflow-y:hidden;position:absolute; height:0px; left:0px; right:"+(a?this.scrollWidthSize:"0")+"px; bottom:0px;"+l+"'>"),o.push(this.getScrollX()),o.push("</div>"),o.push("<div id='"+this.id+"_scrollY_div' class='w2grid_scrollY' style='z-index:"+i+";position:absolute; overflow-x:hidden;overflow-y:scroll;width:"+(a||"native"===this.options.drawType?this.scrollLayerWidthSize:"0")+"px; height: 100%;right:0px;"+h+p+"'>"),o.push(this.getScrollY()),o.push("</div>"),o.push("<div id='"+this.id+"_iScrollX' class='w2grid_iScrollX' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_iScrollY' class='w2grid_iScrollY' style='visibility:hidden;'></div>"),o.push("<div id='"+this.id+"_resize_line' class='w2grid_resize_line' style='display:none;position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px;'></div>"),o.push("<div id='"+this.id+"_noresult' style='display:none;position:absolute;"+this.options.noResultMessageStyle+"' class='"+this.options.noResultMessageClass+"'>"+this.options.noResultMessage+"</div>"),(this.options.senseReader&&this.options.useStartEndDiv||1==this.options.moveKeyEditModeAll)&&o.push("<div id='"+this.id+"_gridend_div' style='height:0px; font-size:0; line-height:0px;' tabindex='0'>그리드 끝</div>"),o.push("</div>"),o.join("")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getScrollY=function(){try{return"<div id='"+this.id+"_size_y' style='height:0px; position:absolute; top:0px; left:0px; width:18px;'></div>"}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getScrollX=function(){try{for(var t=this.getFixedColumnLastIndex(),e=0,i=0;i<t;i++)this.hiddenList[i]||(e+=this.colWidthList[i]);var o=this.getFixedRightColumnLastIndex(),s=0;for(i=this.colWidthList.length-1;i>=o;i--)this.hiddenList[i]||(s+=this.colWidthList[i]);var a=this.options.scrollFocus?" tabIndex='0'":" tabIndex='-1'",n=[],l=this.options.fixedColumnScrollHidden?"hidden":"scroll";return n.push("<table id='"+this.id+"_scrollX_table' style='height:18px;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:100%'>"),n.push("<tr>"),n.push("<td id='"+this.id+"_scrollX_left' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+e+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:"+l+";overflow-y:hidden'></div>"),n.push("</td>"),n.push("<td style='border:0px solid orange;padding:0px 0px 0px 0px;height:18px;'>"),n.push("<div id='"+this.id+"_scrollX_right' style='height:18px;border:0px solid blue; overflow-x:scroll;overflow-y:hidden;padding:0px 0px 0px 0px;padding-top:-5px;'"+a+">"),n.push("<div id='"+this.id+"_scroll_size' style='height:1px;width:"+parseInt(this.gridWidth-e-s)+"px'></div>"),n.push("</div>"),n.push("</td>"),n.push("<td id='"+this.id+"_scrollX_fixedRight' style='border:0px solid red;padding:0px 0px 0px 0px;height:"+this.scrollLayerWidthSize+"px;width:"+s+"px;vertical-align:bottom;'>"),n.push("<div style='height:"+this.scrollLayerWidthSize+"px;overflow-x:scroll;overflow-y:hidden'></div>"),n.push("</td>"),n.push("</tr>"),n.push("</table>"),n.join("")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.mainDataGridLayout=function(){try{this.setTableStruct();var t=[];return t.push(this.getBodyTable()),
t.push(this.getFooterTable()),this.setInitialCSS(),t.join("")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setColArr=function(){try{this.colGroupArr=[],this.setColWidth(),this.gridWidth=0;var t,e,i=-1;if(this.options.rowStatusVisible){var o=40;this.options.rowStatusWidth.length>0&&(this.options.rowStatusWidth.indexOf("*")>-1?(o=this.options.rowStatusWidth,i++):this.options.rowStatusWidth-0>-1&&(o=this.options.rowStatusWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(this.options.rowNumVisible){o=40;this.options.rowNumWidth.length>0&&(this.options.rowNumWidth.indexOf("*")>-1?(o=this.options.rowNumWidth,i++):this.options.rowNumWidth-0>-1&&(o=this.options.rowNumWidth-0)),this.colWidthList.unshift(o),this.hiddenList.unshift(!1),this.hiddenAdaptiveList.unshift(!1)}if(i>-1){this.autofitColumn=!0;for(var s=0;s<2;s++)this.colWidthList[s]&&"string"==typeof this.colWidthList[s]&&this.colWidthList[s].indexOf("*")>-1&&(this.autofitColumnIndexArr.push(s),this.autofitColumnWidthArr[s]=this.colWidthList[s])}if(this.isIE6or7){t=[],e=this.colIndexes.bodyColInfo.colSpanArr;var a=this.colIndexes.bodyColInfo.colIndexArr.length;for(s=0;s<a;s++)if(e[s])for(var n=0;n<e[s];n++)t[n]=!0}this.colGroupArr.push("<colgroup>");for(s=0;s<this.colWidthList.length;s++){null==this.colWidthList[s]&&(this.colWidthList[s]=70);var l=isNaN(this.colWidthList[s])?0:this.colWidthList[s];this.hiddenList[s]?l=0:(this.gridWidth+=l,this.isIE6or7&&(s<this.defaultColCnt||!t[s])&&(l--,s==this.defaultColCnt&&l--)),this.colGroupArr.push("<col id='colGroupID_"+s+"' style='width:"+l+"px;white-space:nowrap' />")}this.colGroupArr.push("</colgroup>")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setCss=function(){try{if(this.options.headerTableClass=this.struct.head.attr.class||"gridHeaderTableDefault",this.options.headerTrClass=this.struct.head.attr.rowClass||"gridHeaderTRDefault",this.options.headerTdClass=this.struct.head.attr.columnClass||"gridHeaderTDDefault",this.options.bodyTableClass=this.struct.body.attr.class||"gridBodyTableDefault",this.options.bodyTrClass=this.struct.body.attr.rowClass||"gridBodyTRDefault",this.options.bodyTdClass=this.struct.body.attr.columnClass||"gridBodyDefault",a.D.isIEAllVersion()?this.options.gridNativeClass="gridNativeIE":this.options.gridNativeClass="gridNative",this.hasFooter&&(this.options.footerTableClass=this.struct.foot.attr.class||"gridFooterTableDefault",this.options.footerTrClass=this.struct.foot.attr.rowClass||"gridFooterTRDefault",this.options.footerTdClass=this.struct.foot.attr.columnClass||"gridFooterTDDefault"),this.hasSubtotal){this.options.subtotalTrClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.rowClass||"gridSubtotalTRDefault",this.options.subtotalTdClass=this.struct.subtotalArr[this.struct.subtotalArr.length-1].attr.columnClass||"gridSubtotalDefault";for(var t=0;t<this.struct.subtotalArr.length;t++)if(this.struct.subtotalArr[t].attr.subtotalClass){this.subtotalClassList=[];break}if(this.subtotalClassList)for(t=0;t<this.struct.subtotalArr.length;t++){var e=this.struct.subtotalArr[t].attr.subtotalClass||"gridSubtotalDefault";this.subtotalClassList.push(e)}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setInitialCSS=function(){try{this.options.oddEvenColorDisplay&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" .evenTd","background-color:"+this.options.evenRowBackgroundColor),WebSquare.cssStyleSheet.addRule("#"+this.id+" .oddTd","background-color:"+this.options.oddRowBackgroundColor)),this.rowStyleIndex=0,this.cellStyleIndex=0,this.readOnlyTdStyle="",this.readOnlyTdImg="",this.disabledTdStyle="",this.rowOverStyle="",""!=this.options.readOnlyBackgroundColor&&(this.readOnlyTdStyle="background-color:"+this.options.readOnlyBackgroundColor),
""==this.options.readOnlyBackgroundImg&&""==this.options.readOnlyBackgroundImgCSS||(this.options.readOnlyBackgroundImgCSS?this.readOnlyTdImg=this.options.readOnlyBackgroundImgCSS:this.readOnlyTdImg="background:url("+this.options.readOnlyBackgroundImg+") no-repeat center center; background-size: cover"),""!=this.options.disabledBackgroundColor&&(this.disabledTdStyle="background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(this.disabledTdStyle=""!=this.disabledTdStyle?this.disabledTdStyle+";":"",this.disabledTdStyle+="color:"+this.options.disabledFontColor),""!=this.options.rowNumBackgroundColor&&WebSquare.cssStyleSheet.addRule("#"+this.id+" ."+this.options.bodyTdClass+"_rowNumber","background-color:"+this.options.rowNumBackgroundColor),this.options.rowMouseOver&&(this.rowOverStyle="background-color:"+this.options.rowMouseOverColor),-1!=this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultHeaderCellHeight+"px"),-1!=this.options.defaultCellHeight&&(WebSquare.cssStyleSheet.addRule("#"+this.id+" td."+this.options.bodyTdClass,"height:"+this.options.defaultCellHeight+"px"),-1==this.options.defaultHeaderCellHeight&&WebSquare.cssStyleSheet.addRule("#"+this.id+" th."+this.options.headerTdClass,"height:"+this.options.defaultCellHeight+"px"))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getGridClassName=function(t,e){try{return null==t||""==t?e:t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.grid2TableXml=function(t){try{var e=WebSquare.Elem.api.getElementsByTagName(this.element,t,s.v._XML_NAMESPACE.W2);return e.length>0?this.oneGrid2TableXml(e[0]):null}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.xml2JSON=function(t){try{var e={attr:{},rowArr:[],rowAttrArr:[]};e.attr=WebSquare.Parser.parseAttribute(t);for(var i=WebSquare.Elem.api.getElementsByTagName(t,"row",s.v._XML_NAMESPACE.W2),o=0;o<i.length;o++){e.rowAttrArr[o]=WebSquare.Parser.parseAttribute(i[o]);for(var a=WebSquare.Elem.api.getElementsByTagName(i[o],"column",s.v._XML_NAMESPACE.W2),n=[],l=0;l<a.length;l++){var h=WebSquare.Parser.parseAttribute(a[l]);h["@xml"]=a[l],n.push(h)}e.rowArr.push(n)}return e}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.oneGrid2TableXml=function(t){try{var e=WebSquare.xml.serialize(t),i=e.indexOf("w2:header")>=0?"th":"td";return e=(e=(e=(e=(e=e.wq_replaceAll("w2:header",this.options.fixPrint?"tbody":"thead")).wq_replaceAll("w2:gBody","tbody")).wq_replaceAll("w2:footer","tbody")).wq_replaceAll("w2:row","tr")).wq_replaceAll("w2:column",i),WebSquare.xml.parse(e)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setColWidth=function(){try{var t=this.getColCnt();this.colWidthList=[],this.autoFitColWidthList=null,this.hiddenList=[],this.hiddenAdaptiveList=[];for(var e=0;e<t;e++)this.colWidthList[e]=null,this.hiddenList[e]=!1,this.hiddenAdaptiveList[e]=!1;this.initializeTableInfo()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getColCnt=function(){try{for(var t=0,e=this.htmlInfo?this.htmlInfo.head.rowArr[0]:this.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.initializeTableInfo=function(){try{var t=this,e=function(e){if(null==e)return null;for(var i=[],o=[],s=[],r=[],a=[],n=e.rowArr,l=[],h=0;h<n.length;h++){for(var d=[],u=0;u<t.colWidthList.length;u++)d.push(!1);l.push(d)}var p=0;t.options.rowNumVisible&&(i.push(0),s.push(0),r.push(n.length),a.push([p++])),t.options.rowStatusVisible&&(i.push(!0===t.options.rowNumVisible?1:0),s.push(0),r.push(n.length),a.push([p++]));for(h=0;h<n.length;h++){var c=n[h],g=0;for(u=0;u<c.length;u++){for(var f=c[u],m=parseInt(f.colSpan||1),y=parseInt(f.rowSpan||1);void 0!==l[h][g]&&l[h][g];)g++;f.colIndex=g+t.defaultColCnt,i.push(g+t.defaultColCnt),s.push(h),r.push(y);var b=f.width||"";if(m>1){if("string"==typeof b&&b.indexOf("*")>-1){
t.autofitColumn=!0;for(var w=0;w<m;w++){var v=g+w;t.colWidthList[v]=b,t.autofitColumnWidthArr[v+t.defaultColCnt]=b,t.autofitColumnIndexArr.push(v+t.defaultColCnt)}}o[i.length-1]=m}if(1==m&&null==t.colWidthList[g])if("string"==typeof b&&b.indexOf("*")>-1){t.autofitColumn=!0;v=g;t.colWidthList[v]=b,t.autofitColumnIndexArr.push(v+t.defaultColCnt),t.autofitColumnWidthArr[v+t.defaultColCnt]=b}else t.colWidthList[g]=parseInt(b||0);for(var I=0;I<m;I++){a[g+t.defaultColCnt+I]||(a[g+t.defaultColCnt+I]=[]),a[g+t.defaultColCnt+I].push(p),l[h][g+I]=!0,"true"==f.hidden&&(t.hiddenList[g+I]=!0);for(var C=1;C<y;C++)l[h+C][g+I]=!0}p++,delete f.hidden}}return{colIndexArr:i,colSpanArr:o,trIndexArr:s,rowSpanArr:r,colIndexMatch:a}};if(this.colIndexes={headerColInfo:e(this.struct.head),bodyColInfo:e(this.struct.body),footerColInfo:e(this.struct.foot)},this.hasSubtotal){this.colIndexes.subtotalColInfo=[];for(var i=0;i<this.struct.subtotalArr.length;i++){var o=e(this.struct.subtotalArr[i]);this.colIndexes.subtotalColInfo.push(o),this.colIndexes.subtotalColInfo[this.struct.subtotalArr[i].attr.targetColumnID]=o}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getFooterTable=function(){try{if(!this.hasFooter)return"";this.hasFooter=!0;var t="";this.options.footerSummary?t=this.options.footerSummary?" summary='"+this.options.footerSummary.wq_replaceAll("'","&#39;")+"'":"":this.options.captionTitle&&this.options.footerSummaryAuto&&(t=" summary='"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"'");var e="";if(e="<table id='"+this.id+"_foot_table' class='"+this.options.footerTableClass+"' style='position:absolute; bottom:0px; table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px;'"+t+">",e+=this.getColGroup(this.id+"_col_footer"),this.options.footerCaption?e+="<caption>"+this.options.footerCaption+"</caption>":this.options.captionTitle&&this.options.footerCaptionAuto&&(e+="<caption>"+this.options.captionTitle+WebSquare.language.getMessage("Grid_footer_caption")+"</caption>"),a.D.isSafari()||a.D.isChrome())e+="<thead><tr></tr></thead>";else if(a.D.isIE()){for(var i="",o=0;o<this.getColCnt();o++)i+="<td></td>";e+="<thead style='visibility:collapse;'><tr>"+i+"</tr></thead>"}return e+=this.getTableHtml(this.htmlInfo.foot,"tbody","td",this.options.footerTdClass),e=(e=(e+="</table>").wq_replaceAll("width=","or_wd=")).wq_replaceAll("disabled=","dis=")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getBodyTable=function(){try{var t="width:"+this.gridWidth+"px;'";this.isIE6or7&&(t="");var e="";this.options.summary&&(e=" summary = '"+(this.element.getAttribute("summary")||"").wq_replaceAll("'","&#39;")+"' ");var i="",o=this._useRole()?" role='grid' ":"",s="native"===this.options.drawType?"auto":"hidden",a="native"===this.options.drawType?" "+this.options.gridNativeClass:"",n="native"===this.options.drawType?"":" border-collapse:collapse";if(i="<div id='"+this.id+"_dataLayer' class='w2grid_dataLayer' style='position:absolute; width:100%; top:0px;bottom:0px;overflow-x:hidden;overflow-y:"+s+";'>",i+=this.getGridHeaderFillerTable(this.headerXml,this.options.headerTdClass,this.options.headerTrClass,this.id+"_head_table",this.options.headerTableClass),i+="<table id='"+this.id+"_body_table' class='"+this.options.headerTableClass+a+"' style='position:absolute;left:0px;top:0px;table-layout:fixed;"+n+"; border-spacing:0px;"+t+e+o+">",i+=this.getColGroup(this.id+"_col_body"),this.captionXml){var l=WebSquare.xml.parse("<caption/>"),h=null,d=WebSquare.Parser.parseAttribute(this.captionXml);for(var u in d){if("id"==u){var p=d[u];p&&l.documentElement.setAttribute("id",this.id+"_"+p)}else l.documentElement.setAttribute(u,d[u]);"value"==u&&(h=d[u])}if(h)l.documentElement.appendChild(l.createTextNode(h));else for(var c=this.captionXml.getChildNodes(),g=0;g<c.length;g++)if(3===c[g].getNodeType()){var f=l.createTextNode(c[g].getNodeValue());l.documentElement.appendChild(f)}
i+=WebSquare.xml.noNameSpaceSerialize(l)}if(this.isWebKit){if(!this.captionXml){var m="transparent",y="0";try{for(g=0;g<document.styleSheets.length;g++){var b=document.styleSheets[g];try{b.cssRules}catch(t){continue}for(var w=0;b.cssRules&&w<b.cssRules.length;w++){var v=b.cssRules[w];if(v.selectorText=="."+this.options.headerTableClass){m=v.style["border-top-color"],y=parseInt(v.style["border-top-width"])/2,g=document.styleSheets.length;break}}}}catch(t){}i+="<caption style='height:"+y+"px;background-color:"+m+";'></caption>"}i+="<thead><tr></tr></thead>"}i+=this.getTableHtml(this.htmlInfo.head,"thead","th",this.options.headerTdClass);a="";return"native"===this.options.drawType&&(a=" class='"+this.options.gridNativeClass+"'"),i+="<tbody id='"+this.id+"_body_tbody'"+a+"></tbody>",i+="</table>",i=(i+="</div>").wq_replaceAll("width=","or_wd=")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getTableInfo=function(t,e,i){try{var s=o.x.extend({},t.attr),a=[],n=t.rowAttrArr||[{}],l=t.rowArr;s.id=this.id+"_"+e+"_tbody",s.style="";for(var h=0;h<l.length;h++){this._useRole()&&(n[h].role="row"),a.push([]);for(var d=0;d<l[h].length;d++){var u=o.x.extend({},l[h][d]);if(this._useRole()&&(u.role="gridcell"),u.class=e+" "+e+"_data",this.isIE6or7){var p=parseInt(u.colSpan||"1"),c=parseInt(u.colIndex);if(p>1){for(var g=1;g<p;g++)0!=this.hgap[i+"_"+c]&&(this.hgap[i+"_"+(c+g)]=!0);this.hgap[i+"_"+c]=!0}else this.hgap[i+"_"+c]=!1}var f=u.textAlign,m=u.style?u.style+";":"";m=m+"text-align:"+(f||"center"),u.style=m,a[h].push(u)}}return{attr:s,rowArr:a,rowAttrArr:n}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getBodyHtmlInfo=function(){try{var t=this.options.bodyTdClass,e=this.options.bodyTrClass,i=this.getTableInfo(this.struct.body,t,e),o=i.attr,a=i.rowArr,n=i.rowAttrArr;this.oneRowLength=a.length,this.oneRowDataLength=0,this.tdIdList=[],this.bodyIdColIndexMap={},this.colMoveIndexMap={};for(var l=0,h={},d=0;d<a.length;d++){n[d].trIndex=d,this.oneRowDataLength+=a[d].length;for(var p=0;p<a[d].length;p++){var c=a[d][p],g=c.style.split(";");if(g.length>0)for(var f=0;f<g.length;f++)if(g[f].indexOf(":")>-1){try{var m=g[f].split(":")[0].wq_trim(),y=g[f].split(":")[1].wq_trim();this.options.useDefaultStyle?this.setDefaultStyle(l,m,y):"text-align"!==m||c.textAlign?this.setColumnStyle(l,m,y):this._setInitStyle(l,m,y)}catch(t){}if(!this.options.applyAllColumnStyle)break}var b=this.options.adaptiveStyle||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/adaptiveStyle/@value");if("none"==this.options.adaptiveStyle&&(b=""),b=c.adaptiveStyle||b,"none"==c.adaptiveStyle&&(b=""),b){var w=b.split(";");if(w.length>0)for(var v=0;v<w.length;v++)if(w[v].indexOf(":")>-1)try{var I=w[v].split(":")[0].wq_trim(),C=w[v].split(":")[1].wq_trim();this.setAdaptiveColumnStyle(l,I,C)}catch(t){}}"textarea"==c.inputType&&"all"==c.displayType&&(c.style+=";word-break:break-all;white-space:normal;");var x=c.id;if(null==c.col_id?(c.col_id=x,c.id=this.id+"_"+x,c["@xml"]=c["@xml"].cloneNode(!0),c["@xml"].setAttribute("col_id",x),c["@xml"].setAttribute("id",this.id+"_"+x)):x=c.col_id,this._setCellInfo(x,c["@xml"]),this.bodyIdColIndexMap[x]=l,0==d&&(this.colMoveIndexMap[x]=l),h[x]){var _=WebSquare.language.getMessage("E_comp_duplicated_Msg",x)||"id["+x+"] 가 중복사용되었습니다. 소스코드를 확인하세요.";$l(_)}else h[x]=x;this.tdIdList.push(x),""===x&&u.k.printLog("warning : The "+this.id+" column name for column index "+l+" is missing."),l++}}return{attr:o,rowArr:a,rowAttrArr:n}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getHeaderHtmlInfo=function(){try{var t=this.options.headerTdClass,e=this.options.headerTrClass,i=this.getTableInfo(this.struct.head,t,e),o=i.attr,s=i.rowArr,a=i.rowAttrArr,n=[];this.thIdList=[],this.colMoveHeaderIndexMap={},o.id=this.id+"_head_table",o.class=this.options.headerTableClass;var l=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.head.attr.style);l&&2==l.length&&(this.headerHeight=parseInt(l[1])),
o.style=this.options.hideHeader?"display:none":"",this.headCellInfoHash={};for(var h=0;h<s.length;h++){n.push([]);for(var d=0;d<s[h].length;d++){var u=s[h][d],p=null,c=u.inputType,g=u.dataType,f=u.value;if(void 0!==f&&null!=f||void 0!==(f=u.defaultValue)&&null!=f||(f=""),"checkbox"==c)p="<input type='checkbox' style='border:0px solid blue;background-color:transprent;' />";else if("select"==c){var m="";if(this.options.chooseOption){if(m=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(b=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(m=b)}else if(this.options.allOption){m=WebSquare.language.getMessage("Grid_all")||"-전체-"}else if("json"!==u["@xml"]._elementType){var y=(WebSquare.xml.serialize(u["@xml"]).match(/label\s*>[^<]+<\//)||"").toString();""!==y&&(m=y.slice(y.toString().indexOf(">")+1,-2))}p="<div style='width:100%;height:20px;top:0px;left:0px;position:relative;background-color:#ffffff' class='w2selectbox "+this.options.headerTdClass+" "+this.options.headerTdClass+"_data'><span style='display:none'></span><table class='w2selectbox_table_main'><tr class='w2selectbox_row w2selectbox_row_main'><td class='w2selectbox_col_label'><div class='w2selectbox_label'>"+m+"</div></td><td class='w2selectbox_col_button'></td></tr></table></div>"}else if("text"==c&&"own"==g)p="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";else{var b;if(this.options.useLocale&&u.localeRef)(b=this.getLocaleValue(u.localeRef))&&(f=b);p="<nobr style='padding-top:0px; padding-left:4px;padding-right:4px' >"+(f=null!=f?f:"")+"</nobr>"}n[h].push(p),this.thIdList.push(u.id),this.headCellInfoHash[u.id]=u["@xml"],this._setHeaderInfo(u.id,u["@xml"]),null==u.col_id&&(u.col_id=u.id)}}return{attr:o,rowArr:s,rowAttrArr:a,headerTdHtml:n}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getFooterHtmlInfo=function(){try{var t=this.options.footerTdClass,e=this.options.footerTrClass,i=this.getTableInfo(this.struct.foot,t,e),o=i.attr,s=i.rowArr,a=i.rowAttrArr,n=/(?:^|;)\s*height\s*:\s*(\d*)px\s*(?:$|;)/i.exec(this.struct.foot.attr.style);return n&&2==n.length&&(this.footerHeight=parseInt(n[1])),{attr:o,rowArr:s,rowAttrArr:a}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getSubtotalHtmlInfo=function(t){try{var e=this.options.subtotalTdClass;this.subtotalClassList&&(e=t.attr.subtotalClass||"gridSubtotalDefault");for(var i=this.options.subtotalTrClass,o=this.getTableInfo(t,e,i),s=o.attr,a=o.rowArr,n=o.rowAttrArr,l=0;l<a.length;l++){n[l].trIndex=l,n[l].targetColumnID=s.targetColumnID;for(var h=0;h<a[l].length;h++)a[l][h].class=a[l][h].class+" "+this.id+"_subtotal__column"+h,delete a[l][h].hidden}return{attr:s,rowArr:a,rowAttrArr:n}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getTableHtml=function(t,e,i,s){try{var a=t.attr,n=t.rowArr,l=t.rowAttrArr,h=[],d="";if("native"===this.options.drawType){var u={};o.x.extend(u,a),u.class?u.class+=" "+this.options.gridNativeClass:u.class=this.options.gridNativeClass,d=this.getAttributesString(u)}else d=this.getAttributesString(a);h.push("<"+e+d+">");var p="",c="";n.length>=2&&(p=!1===this.options.rowNumRowSpan?" rowSpan='1'":" rowSpan='"+n.length+"'",c=!1===this.options.rowStatusRowSpan?" rowSpan='1'":" rowSpan='"+n.length+"'");var g="";"native"===this.options.drawType&&t===this.htmlInfo.head&&(g=" "+this.options.gridNativeClass);for(var f=0;f<n.length;f++){if(t==this.htmlInfo.head?h.push("<tr"+this.getAttributesString(l[f])+" class='gridHeaderStyle_"+f+g+"'>"):t==this.htmlInfo.foot?h.push("<tr"+this.getAttributesString(l[f])+" class='gridFooterStyle_"+f+"'>"):h.push("<tr"+this.getAttributesString(l[f])+">"),0==this.options.rowNumRowSpan&&this.options.rowNumVisible)if(f===n.length-1){var m="";t==this.htmlInfo.head&&(m=this.options.rowNumHeaderValue),h.push("<"+i+p+" class='"+s+" "+s+"_rowNumber' value='"+m+"' colIndex='0' id='_headerRowNumber'></"+i+">")
}else h.push("<"+i+p+" class='"+s+" "+s+"_rowNumber' value='' colIndex='0' id='_headerRowNumber'></"+i+">");else if(0===f){m="";t==this.htmlInfo.head&&(m=this.options.rowNumHeaderValue),this.options.rowNumVisible&&h.push("<"+i+p+" class='"+s+" "+s+"_rowNumber' value='"+m+"' colIndex='0' id='_headerRowNumber'></"+i+">")}if(!1===this.options.rowStatusRowSpan){if(f===n.length-1){var y="";t==this.htmlInfo.head&&(y=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&h.push("<"+i+c+" class='"+s+" "+s+"_rowStatus' value='"+y+"' colIndex='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else if(this.options.rowStatusVisible)if(this.options.rowStatusColSpan&&0==f){var b=1;n[f][0].colSpan?b+=Number(n[f][0].colSpan):b++;var w=" colSpan='"+b+"'",v=n[f][0].value;h.push("<"+i+c+w+" class='"+s+" "+s+"_rowStatus' value='"+v+"' colIndex='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else h.push("<"+i+c+" class='"+s+" "+s+"_rowStatus' value='' colIndex='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}else if(0==f){y="";t==this.htmlInfo.head&&(y=this.options.rowStatusHeaderValue),this.options.rowStatusVisible&&h.push("<"+i+c+" class='"+s+" "+s+"_rowStatus' value='"+y+"' colIndex='"+(this.options.rowNumVisible?1:0)+"' id='_headerRowStatus'></"+i+">")}for(var I=0;I<n[f].length;I++){if(s!==this.options.subtotalTdClass&&s!==this.options.footerTdClass||null==n[f][I].columnClass)if(this.subtotalClassList&&n[f][I].columnClass){for(var C=0;C<this.subtotalClassList.length;C++)if(this.subtotalClassList[C]&&s===this.subtotalClassList[C]){x=n[f][I].class;n[f][I].class=n[f][I].columnClass+" "+n[f][I].class,h.push("<"+i+this.getAttributesString(n[f][I])+">"),n[f][I].class=x;break}}else h.push("<"+i+this.getAttributesString(n[f][I])+">");else{var x=n[f][I].class;n[f][I].class=n[f][I].columnClass+" "+n[f][I].class,h.push("<"+i+this.getAttributesString(n[f][I])+">"),n[f][I].class=x}t.headerTdHtml&&t.headerTdHtml[f][I]&&h.push(t.headerTdHtml[f][I]),h.push("</"+i+">")}h.push("</tr>")}return h.push("</"+e+">"),h.join("")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getGridHeaderFillerTable=function(t,e,i,o,s){try{if(!this.options.headFiller)return"";var a=[],n="";return this.options.hideHeader&&(n="display:none"),a.push("<table class='"+this.options.headerTableClass+"' style='z-index:-1;position:absolute;table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:"+this.gridWidth+"px; '>"),a.push("<tbody id='"+this.id+"_"+e+"_tbody_tmp' style='"+n+"' class='"+s+"'>"),a.push("<tr class='"+i+"'>"),a.push("<td style='' id='"+this.id+"_header_bg_td' class='"+e+" "+e+"_rowNumber'>&nbsp;</td>"),a.push("</tr>"),a.push("</tbody>"),a.push("</table>"),a.join("")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getColGroup=function(t){try{return this.colGroupArr.join("").wq_replaceAll("colGroupID",t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.initializeLayoutEvents=function(){try{this.event.addListener2(this.getElementById(this.id+"_scrollX_right"),"onscroll",this.handleScrollX,this),this.event.addListener2(this.getElementById(this.id+"_scrollY_div"),"onscroll",this.handleScrollY,this),this.event.addListener2(this.render,"onmousewheel",this.handleWheel,this),this.options.groupbyZone&&(this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onclick",this.handleGroupbyZoneClick,this),this.event.addListener2(this.getElementById(this.id+"_groupbyZone_div"),"onmousedown",this.handleChangeGroupDepth,this)),this.options.resize&&!a.D.isMobile()&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousemove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endColumnResize)),
this.options.rowResize&&(this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousemove",this.event.bindAsEventListener(this,this.handleRowResize)),this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onmousedown",this.event.bindAsEventListener(this,this.doRowResize)),this.event.addListener(document.documentElement,"onmouseup",this.event.bindAsEventListener(this,this.endRowResize))),a.D.isIE()&&s.v.browserVersion()<=8&&this.event.addListener(this.render,"onmousemove",this.event.bindAsEventListener(this,(function(t){(this.resizeStarted||this.options.rowResize&&this.rowResizeStarted||null!=this.columnMoveTarget)&&d.B.preventDefault(t)})))),this.options.resize&&a.D.isMobile()&&(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchmove",this.event.bindAsEventListener(this,this.handleColumnResize)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"ontouchstart",this.event.bindAsEventListener(this,this.doColumnResize)),this.event.addListener(document.documentElement,"ontouchend",this.event.bindAsEventListener(this,this.endColumnResize)))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleScrollX=function(t){try{var e=d.B.getTarget(t);e&&(this._scrollXPrev||(this._scrollXPrev={}),this._scrollXPrev.scrollLeft===e.scrollLeft&&this._scrollXPrev.scrollTop===e.scrollTop&&this._scrollXPrev.scrollWidth===e.scrollWidth&&this._scrollXPrev.scrollHeight===e.scrollHeight&&(this.scrollXPreventEndEdit=!0),this._scrollXPrev.scrollLeft=e.scrollLeft,this._scrollXPrev.scrollTop=e.scrollTop,this._scrollXPrev.scrollWidth=e.scrollWidth,this._scrollXPrev.scrollHeight=e.scrollHeight),s.v.clearTimer(this.id+"_completiveDrawData",!0),s.v.clearTimer(this.id+"_applyStyleOptions",!0),null==this.editedCell||this.scrollXPreventEndEdit||this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t]),this._handleScrollX(),this.scrollXPreventEndEdit&&this.editedCell&&this.editedCell.setPosition&&this.editedCell.setPosition(),this.scrollXPreventEndEdit=!1,d.B.fireEvent(this,"onscrollx",t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._handleScrollX=function(){try{this.body_table||(this.head_table=this.getElementById(this.id+"_head_table"),this.body_table=this.getElementById(this.id+"_body_table"),this.hasFooter&&(this.foot_table=this.getElementById(this.id+"_foot_table")),this.scrollX_right=this.getElementById(this.id+"_scrollX_right")),void 0!==this.colGroup&&null!=this.colGroup||(this.colGroup={},this.colGroup.bodyColList=this.body_table.getElementsByTagName("col"),this.hasFooter?this.colGroup.footerColList=this.foot_table.getElementsByTagName("col"):this.colGroup.footerColList=null);var t=0;if(this.options.scrollByColumn){var e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;e>1?t=1+Math.round(e):e<1&&(t=1+Math.round(1/e))}var i=this.getFixedColumnLastIndex(),o=this.scrollX_right.scrollLeft,s=this.gridWidth-o-t-this.fixedWidth-1-this.fixedWidthRight,n=s;s=s>0?s:0;var l=this.options.fixedRightColumn>0;if(!l){if(this.head_table.style.width=s+"px",this.isWebKit){for(var h=[],d=this.defaultColCnt;d<this.hiddenList.length;d++)1==this.hiddenList[d]&&h.push(d-this.defaultColCnt);(A=s-this.colGroup.bodyColList.length-h.length-1)<0&&(A=0),this.body_table.style.width=A+"px",this.hasFooter&&(this.foot_table.style.width=A+"px")}else this.body_table.style.width=s+"px",this.hasFooter&&(this.foot_table.style.width=s+"px");this.hasFooter&&(this.foot_table.style.width=s+"px")}var u=[],p=[],c=0,g=-1,f=0;if(l||this.options.scrollByColumn||a.D.isIE(8)){var m=parseInt(document.getElementById(this.id+"_scrollY_div").style.width,10)-1;if(c=(f=this.resizeObj&&this.resizeObj.clientWidth?this.resizeObj.clientWidth:this.render.clientWidth)-1-this.fixedWidth-this.fixedWidthRight,a.D.isChrome()&&(c+=1),-1!=m&&(c-=m),l){this.options.scrollByColumn=!1;var y=f-1-m;y<this.gridWidth&&(this.head_table.style.width=f-1-m+"px",this.body_table.style.width=f-1-m+"px",
this.hasFooter&&(this.foot_table.style.width=f-1-m+"px"))}}var b=this.getFixedRightColumnLastIndex(),w=l,v=-1;for(d=this.colWidthList.length-1;d>=b;d--)this.hiddenList[d]||(this.colGroup.bodyColList[d].style.width=this.colWidthList[d]+"px");for(d=b-1;d>=0;d--){var I=0,C=parseInt(this.colWidthList[d],10)||0;if(this.hiddenList[d]&&(C=0),l&&w)if(s>c+C)s-=C,C=0;else{var x=C;y<this.gridWidth&&(C-=s-c),s-=x,w=!1,v=d}else s>C?s-=C:(s>0&&n<=c&&(g=d,this.options.scrollByColumn&&(I=s)),C=s,s=0),d<i&&!this.hiddenList[d]&&(C=parseInt(this.colWidthList[d],10)||0);var _=0,S=0;if(this.isIE6or7&&0!=C&&(1==this.hgap[this.options.headerTrClass+"_"+d]?0:1,_=1==this.hgap[this.options.bodyTrClass+"_"+d]?0:1,this.hasFooter&&(S=1==this.hgap[this.options.footerTrClass+"_"+d]?0:1)),a.D.isIE(8)&&0==this.defaultColCnt&&0==d&&0==C&&(C=1,g>=0&&(u[g]=u[g]-1,this.colGroup.bodyColList[g].style.width=u[g]+"px",this.hasFooter&&(p[g]=p[g]-1,this.colGroup.footerColList[g].style.width=p[g]+"px"))),this.options.scrollByColumn){var D=this.colWidthList[d];1==C&&a.D.isIE(8)&&0==this.defaultColCnt&&0==d&&(D=1),0==C&&(D=0),I>0&&(D=I),v===d&&(D=0),(0==D||1==D||D==this.colWidthList[d]||I>0||v===d)&&(this.colGroup.bodyColList[d].style.width=D-_+"px",u[d]=D-_,this.hasFooter&&(this.colGroup.footerColList[d].style.width=D-S+"px",p[d]=D-S))}else this.hiddenList[d]&&(C=0),this.colGroup.bodyColList[d].style.width=C-_+"px",u[d]=C-_,this.hasFooter&&(this.colGroup.footerColList[d].style.width=C-S+"px",p[d]=C-S)}m=this.getElementById(this.id+"_scrollY_div").offsetWidth;if(this.isWebKit&&-1==this.options.className.indexOf("w2gridViewItemTable")&&0===m&&"allColumn"===this.options.autoFit&&!this.options.autoFitMinWidth){var R=this.render.getBoundingClientRect().width,L=!0;this.head_table.getBoundingClientRect().width<=0&&(L=!1);for(d=b-1;d>=0;d--){var T=R-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width),k=1;if(!(T>=0))break;if(!this.hiddenList[d]){if(T<2)break;var A=parseInt(this.colGroup.bodyColList[d].style.width);this.colGroup.bodyColList[d].style.width=A+k+"px",u[d]=A+k,(T=R-(L?this.head_table.getBoundingClientRect().width:this.body_table.getBoundingClientRect().width))<1&&(k=-1,this.colGroup.bodyColList[d].style.width=A+k+"px",u[d]=A+k),this.hasFooter&&(this.colGroup.footerColList[d].style.width=A+k+"px",p[d]=A+k)}}}this.setColIndexInfo(u,p),this._setGridBorder(),(this.groupbyZoneStatus.groupbyZoneRender||this.options.useFilterList)&&(this.resizeGroupbyZone(),this.resizeGridList())}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.redrawTable=function(){try{if(this.isWebKit)if("native"===this.options.drawType){var t=this.colGroup.bodyColList[0],e=t.offsetWidth,i=t.id;t.style.width=e+1+"px",a.D.setTimeout((function(){document.getElementById(i).style.width=e+"px"}),{key:this.id+"_redrawTable",delay:20})}else{null==this._redrawTable_transform&&(this._redrawTable_transform=this.body_table.style.webkitTransform),this.body_table.style.webkitTransform="rotateZ(0deg)";var o=this.uuid;a.D.setTimeout((function(){var t=WebSquare.idCache[o];t.body_table.style.webkitTransform=t._redrawTable_transform,delete t._redrawTable_transform}),{key:this.id+"_redrawTable",delay:20})}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setColIndexInfo=function(t,e){try{if(void 0===this.colGroup||null==this.colGroup){this.colGroup={},this.colGroup.bodyColList=this.getElementById(this.id+"_body_table").getElementsByTagName("col");var i=this.getElementById(this.id+"_foot_table");this.colGroup.footerColList=i?i.getElementsByTagName("col"):null}this.colIndexInfo={};var o=this.getVisibleColRange(this.colGroup.bodyColList,t),s=this.getVisibleTds(this.colIndexes.bodyColInfo,o);if(this.colIndexInfo.body={colInfo:this.colIndexes.bodyColInfo,visibleTds:s.visibleTds,invisibleTds:s.invisibleTds,visibilityArr:s.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.isIE6or7){var a=this.getVisibleTds(this.colIndexes.headerColInfo,o)
;if(this.colIndexInfo.header={colInfo:this.colIndexes.headerColInfo,visibleTds:a.visibleTds,invisibleTds:a.invisibleTds,visibilityArr:a.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex},this.hasFooter){var n=this.getVisibleColRange(this.colGroup.footerColList,e),l=this.getVisibleTds(this.colIndexes.footerColInfo,n);this.colIndexInfo.footer={colInfo:this.colIndexes.footerColInfo,visibleTds:l.visibleTds,invisibleTds:l.invisibleTds,visibilityArr:l.visibilityArr,firstCoveredColIndex:n.firstCoveredColIndex}}if(this.hasSubtotal)for(var h in this.colIndexInfo.subtotal={},this.subtotalRowHash){var d=this.getVisibleTds(this.colIndexes.subtotalColInfo[h],o);this.colIndexInfo.subtotal[h]={colInfo:this.colIndexes.subtotalColInfo[h],visibleTds:d.visibleTds,invisibleTds:d.invisibleTds,visibilityArr:d.visibilityArr,firstCoveredColIndex:o.firstCoveredColIndex}}}this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideInvisibleTds=(h=!0,function(){try{if(h){if(h=!1,this.groupbyStatus.grouped){this.options.lazyDrawHiddenColumn=!1;var t=WebSquare.language.getMessage("Grid_warning6",this.id)||this.id+" groupby가 활성화되어서 lazyDrawHiddenColumn 속성이 비활성화 되었습니다.";return void $l(t)}for(var e=this.defaultColCnt;e<this.colIndexes.bodyColInfo.rowSpanArr.length;e++)if(this.colIndexes.bodyColInfo.rowSpanArr[e]>=2){this.options.lazyDrawHiddenColumn=!1;var i=WebSquare.language.getMessage("Grid_warning7",this.id)||this.id+" : rowSpan이 있기 때문에 lazyDrawHiddenColumn 속성이 비활성화 되었습니다.";return void $l(i)}}var o=this.colIndexInfo.body.visibilityArr,s=[];for(e=0;e<this.drawedRowLength;e++)if("none"!=this.dataRowList[e].style.display)for(var a=0,n=0,l=this.defaultColCnt;l<o.length;l++){this.colIndexes.bodyColInfo.trIndexArr[l]>a&&(n=0,a++);var d=this._getColumnMoveIndex(l-this.defaultColCnt),u=this.data_td_list[d+e*this.oneRowDataLength],p=this.colIndexes.bodyColInfo.colSpanArr[l]||1;o[l]?(this.initVisibilityArr[l]||(this.drawCellData(e,e+this.rowIndex,d),this.applyCellStyleOptions(e+this.rowIndex,d),s[l]=!0),u.style.display="",p+n>1?(u.setAttribute("colSpan",p+n),u.setAttribute("data-lazydrawtd","true")):(u.removeAttribute("colSpan"),u.removeAttribute("data-lazydrawtd")),n=0):(u.style.display="none",n+=p)}for(e=0;e<s.length;e++)s[e]&&(this.initVisibilityArr[e]=!0)}catch(t){r.w.printStackTrace(t,null,this)}}),p.prototype.getVisibleColRange=function(t,e){try{for(var i=this.render.clientWidth,o=[],s=0,a=-1,n=-1,l=e?e.length:t.length,h=0;h<l;h++){var d=e?e[h]:parseInt(t[h].style.width);if((s+=d)>i){a>=0?(d<3?o.push([a,h]):o.push([a,h+1]),n=h+1,a=-1):(o.push([h,h+1]),n=h+1);break}d<3?-1!=a&&(o.push([a,h]),a=-1):-1==a&&(a=h)}return-1!=a&&a<h&&o.push([a,h]),o.firstCoveredColIndex=-1!==n?n:l,-1==n&&(n=l),o}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getVisibleTds=function(t,e){try{for(var i=[],o=[],s=[],a=0;a<t.colIndexArr.length;a++){for(var n=t.colIndexArr[a],l=t.colSpanArr[a]||1,h=0;h<e.length;h++)if(e[h][0]<=n&&n<e[h][1]||e[h][0]<=n+l-1&&n+l-1<e[h][1]||n<=e[h][0]&&e[h][0]<n+l||n<=e[h][1]-1&&e[h][1]-1<n+l){i[i.length]=a,s[s.length]=!0;break}h==e.length&&(o[o.length]=a,s[s.length]=!1)}return{visibleTds:i,invisibleTds:o,visibilityArr:s}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setGridBorder=function(){try{if(a.D.isIE(8)){if(0==this.defaultColCnt){var t=this.colGroup.bodyColList[0].style.width,e="1px"==t||"0px"==t?"0px":"";if(!this.leftMostTds){this.leftMostTds=[];for(var i=this.getElementById(this.id+"_head_table").getElementsByTagName("th"),o=this.hasFooter?this.getElementById(this.id+"_foot_table").getElementsByTagName("td"):[],s=0;s<i.length;s++)0==i[s].getAttribute("colIndex")&&this.leftMostTds.push(i[s]);for(s=0;s<o.length;s++)0==o[s].getAttribute("colIndex")&&this.leftMostTds.push(o[s])}for(s=0;s<this.leftMostTds.length;s++)this.leftMostTds[s].style.borderLeftWidth=e,this.leftMostTds[s].style.borderRightWidth=e;if(this.all_data_td_list.length>0){if(!this.leftMostIndexArr){
this.leftMostIndexArr=[];for(s=0;s<this.oneRowDataLength;s++)0==this.all_data_td_list[s].getAttribute("colIndex")&&this.leftMostIndexArr.push(s)}for(s=0;s<this.leftMostIndexArr.length;s++)for(var n=0;n<this.drawedRowLength;n++){(l=this.all_data_td_list[this.leftMostIndexArr[s]+n*this.oneRowDataLength]).style.borderLeftWidth=e,l.style.borderRightWidth=e}}if(this.hasSubtotal&&this.drawedSubtotal)for(s=0;s<this.drawedSubtotal.length;s++)for(n=0;n<this.drawedSubtotal[s].length;n++){var l;0==(l=this.drawedSubtotal[s][n].cells[0]).cellIndex&&(l.style.borderLeftWidth=e,l.style.borderRightWidth=e)}}if(!this._setGridBorderNoRefresh){var h=(u=this.getElementById(this.id+"_dataLayer")).style.display,d=document.activeElement;u.style.display="none",u.offsetHeight,u.style.display=h,document.activeElement!=d&&this.hasClass(d,this.options.bodyTdClass)&&d.focus()}}if(this.isIE6or7&&(this.colIndexInfo||this.setColIndexInfo(),this.colGroup&&(this._setBorderFolding(this.all_data_td_list,this.colIndexInfo.body,this.drawedRowLength),this.headerTds||(this.headerTds=this.getElementById(this.id+"_head_table").getElementsByTagName("th")),this._setBorderFolding(this.headerTds,this.colIndexInfo.header)),this.hasFooter&&(this.footerTds||(this.footerTds=this.getElementById(this.id+"_foot_table").getElementsByTagName("td")),this._setBorderFolding(this.footerTds,this.colIndexInfo.footer)),this.hasSubtotal&&this._setSubtotalBorder(),!this._setGridBorderNoRefresh)){var u,p=(u=this.getElementById(this.id+"_dataLayer")).style.filter;d=document.activeElement;u.style.filter="alpha(opacity=99)",u.style.filter=p,document.activeElement!=d&&this.hasClass(d,this.options.bodyTdClass)&&d.focus()}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setBorderFolding=function(t,e,i){try{if(this.groupbyStatus.grouped)return;if(!t||0==i)return;i=i||1;for(var o=e.firstCoveredColIndex,s=this.oneRowDataLength+this.defaultColCnt,a=0,n=e.visibilityArr.length;a<n;a++){var l=e.colInfo.colIndexArr[a],h=e.visibilityArr[a],d="0px"===t[a].style.borderWidth;if(i>1&&(d=d||"0px"===t[a+s].style.borderWidth),l<o&&!h&&!d)for(var u=0;u<i;u++)t[a+u*s].style.borderWidth="0px";else if((l>=o||h)&&d)for(u=0;u<i;u++)t[a+u*s].style.borderWidth="",t[a+u*s].style.borderStyle=""}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setSubtotalBorder=function(){try{if(!this.drawedSubtotal)return;for(var t={},e=0;e<this.drawedSubtotal.length;e++){var i=this.drawedSubtotal[e];if(!t[i.targetID]){t[i.targetID]=!0;for(var o=this.colIndexInfo.subtotal[i.targetID],s=o.firstCoveredColIndex,a=0,n=0;n<i.length;n++)for(var l=i[n],h=0;h<l.cells.length;h++,a++){var d=o.colInfo.colIndexArr[a],u=o.visibilityArr[a],p="0px"===l.cells[h].style.borderWidth;if(d<s&&!u&&!p)for(var c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="0px");else if((d>=s||u)&&p)for(c=e;c<this.drawedSubtotal.length;c++)this.drawedSubtotal[c].targetID==i.targetID&&(this.drawedSubtotal[c][n].cells[h].style.borderWidth="")}}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleWheel=function(t){try{if(this.options.groupbyZone||this.options.useFilterList)for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone_scrollView")||e.match("w2grid_customFilter_scrollView"))return void d.B.stopPropagation(t);var i=d.B.getMouseWheelDelta(t),o=t.wheelDeltaY,s=t.wheelDeltaX,n=Math.floor(this.options.wheelRows*Math.abs(i));if("wheelDeltaX"in t&&Math.abs(s)>Math.abs(o))return this.getElementById(this.id+"_scrollX_right").scrollLeft-=s,void d.B.stopEvent(t);var l=this.getElementById(this.id+"_scrollY_div");if(this.scrollEvent=!0,i>0){if(0==l.scrollTop)return void(this.options.wheelStop&&d.B.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)-n)}else if(i<0){var h=this.getElementById(this.id+"_scrollY_div")
;if(this.rowIndex<0||0==h.clientHeight||h.scrollTop==h.scrollHeight-h.clientHeight)return void(this.options.wheelStop&&d.B.stopEvent(t));l.scrollTop=this.oneRowScrollHeight*(this._getScrollRowIndex(this.rowIndex)+n)}a.D.isMobile()&&this.moveYScroll(0),d.B.stopEvent(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleColumnResize=function(t){try{if(2==t.button)return;var e,i,o,s,n;if("drag"!==this.resizeStatus){for(var l=this.event.getTargetIterator(t,this.render),h=null;l.next();){var u=l.getElement();if("TH"!=u.tagName&&"TD"!=u.tagName||(h=u),"NOBR"==u.tagName){h=null;break}}if(null!=h){e=d.B.getMouseX(t),i=WebSquare.style.getAbsoluteLeft(h),o=parseInt(h.getAttribute("colSpan")||1,10),s=parseInt(h.getAttribute("colIndex"),0),n=i*(null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1);var p=s,c=h.getAttribute("header_id");"_headerRowNumber"!=c&&"_headerRowStatus"!=c&&(p=this._getRealColIndex("head",c)+this.defaultColCnt),p=this._getMouseColumnIndex({colIndex:s,offsetX:e,offsetLeft:n,colSpan:o}),"col-resize"===this.resizeStatus&&!1===this.isColumnResizable(p)&&(this.resizeStatus="init")}}switch(this.resizeStatus){case"init":this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="";break;case"col-resize":this.getElementById(this.id+"_head_table").style.cursor="col-resize",this.getElementById(this.id+"_head_table").cursor="col-resize";break;case"drag":return this.resizeStatus="drag",this.handleResizeLine(t),void(a.D.isMobile()&&d.B.stopEvent(t))}if(null!=this.columnMoveTarget)return;if(null==h)return void(this.resizeStatus="init");if(e-n<(f=.3*this.colWidthList[s]>10?10:parseInt(.3*this.colWidthList[s],10))&&0!=s){if("init"===this.resizeStatus||"col-resize"===this.resizeStatus)return void(this.isColumnResizable(s)&&(this.resizeStatus="col-resize"))}else this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus;if("_headerRowNumber"!=c&&"_headerRowStatus"!=c)for(var g=0;g<o;g++){if(1==this.options.columnMove){h.getAttribute("header_id");s=this._getRealColIndex("head",c)+this.defaultColCnt}var f,m=this.colWidthList[(s+g)%(this.columnOrder.length+this.defaultColCnt)];if((n+=m)-(f=.3*m>10?10:parseInt(.3*m,10))<e&&e<n+f)return void("init"!==this.resizeStatus&&"col-resize"!==this.resizeStatus||this.isColumnResizable(s)&&(this.resizeStatus="col-resize"));this.resizeStatus="drag"!==this.resizeStatus?"init":this.resizeStatus}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.doColumnResize=function(t){try{if(2==t.button)return;if(a.D.isMobile()&&this.handleColumnResize(t),!this.options.columnMove&&!this.options.groupbyZone&&"init"==this.resizeStatus||"drag"==this.resizeStatus)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_colIndex=null,this.resize_colId=null;e.next();)e.match(this.options.headerTdClass)&&(i=e.getElement());if(null==i)return;this.startResizeX=d.B.getScreenX(t);var o=i.getAttribute("header_id");if("col-resize"==this.resizeStatus){d.B.preventDefault(t),this.resizeStarted=!0,this.resizeStatus="drag";var s=d.B.getMouseX(t),n=WebSquare.style.getAbsoluteLeft(i),l=parseInt(i.getAttribute("colSpan")||1,10),h=this._getRealColIndex("head",o)+this.defaultColCnt;"_headerRowNumber"!=o&&"_headerRowStatus"!=o||(h=parseInt(i.getAttribute("colindex"),10));var u=n;this.resizeColIndex=this._getMouseColumnIndex({colIndex:h,offsetX:s,offsetLeft:u,colSpan:l})}else if(this.options.columnMove&&(0===this.getHeaderRowIndex(o)||this.options.allColumnMove)){this.resizeStatus="drag";var p=null,c=this.htmlInfo.head.rowArr[0],g=!0;if(0!=parseInt(this.options.stopColumnMoveRow,10))for(var f=0;f<c.length;f++)if(c[f].id==o){g=!1;break}if(this.options.allColumnMove)for(f=1;f<this.htmlInfo.head.rowArr.length;f++)if(parseInt(this.options.stopColumnMoveRow,10)!=f)for(var m=0;m<this.htmlInfo.head.rowArr[f].length;m++)if(this.htmlInfo.head.rowArr[f][m].id==o){g=!1,p=o,o=this.htmlInfo.head.rowArr[0][m].id;break}if(g)return
;this.resizeStauts="init","_headerRowNumber"!=o&&"_headerRowStatus"!=o&&(null!=p&&(this.realColumnMoveTarget=this.getHeaderIndex(p)),this.columnMoveTarget=this.getHeaderIndex(o),this.columnMoveTargetId=o,this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.D.emptySelection())}else if(this.options.groupbyZone&&(this.resizeStatus="drag","_headerRowNumber"!=o&&"_headerRowStatus"!=o)){if(this.groupbyZoneStatus.clickedHeaderInfo={},this.groupbyZoneStatus.clickedHeaderInfo.index=this._getRealHeaderColIndex(o),this.groupbyZoneStatus.clickedHeaderInfo.value=i.getAttribute("value"),this.groupbyZoneStatus.clickedHeaderInfo.headerID=o,null!=this.groupbyStatus.sortIndexArr&&null!=this.groupbyStatus.sortOrderArr){this.resizeStatus="init";var y=!1,b={};b.render=i,b.parentRender=this.render.getElementsByTagName("div")[0],b.headerID=i.getAttribute("header_id"),b.headerIndex=this.getHeaderIndex(b.headerID);for(f=0;f<this.groupbyStatus.sortIndexArr.length;f++)if(b.headerIndex==this.groupbyStatus.sortIndexArr[f]){y=!0;break}y?this.groupbyFilterList?this.toggleGroupbyFilterList(b):this.createGroupbyFilterList(b):(this.hideGroupbyFilterList(),this.showGroupbyHeaderGhost(t,o))}else this.showGroupbyHeaderGhost(t,o);this.getElementById(this.id+"_head_table").style.cursor="pointer",this.addClass("w2noselect"),a.D.emptySelection()}this.handleResizeLine(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.endColumnResize=function(t){try{if(2==t.button)return;if("drag"!==this.resizeStatus&&(this.resizeStatus="init"),this.options.columnMove&&null!=this.columnMoveTarget){var e=this.event.getTargetIterator(t,this.render),i=null;if(this.event.isMe(t,this.render))for(;e.next();)e.match(this.options.headerTdClass)&&(e.match(this.options.headerTdClass+"_rowNumber")||e.match(this.options.headerTdClass+"_rowStatus")||(i=e.getElement()),e.stop());var o=this.resize_colId;null!=i&&(o=i.getAttribute("header_id")||this.resize_colId),this.moveColumnByHeaderId(this.columnMoveTargetId,o),this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo){for(e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2grid_groupbyZone")){e.getElement(),null==this.groupbyStatus.sortIndexArr&&(this.groupbyStatus.sortIndexArr=[]),null==this.groupbyStatus.sortOrderArr&&(this.groupbyStatus.sortOrderArr=[]);for(var s=0;s<this.groupbyStatus.sortIndexArr.length;s++)if(this.groupbyZoneStatus.clickedHeaderInfo.index==this.groupbyStatus.sortIndexArr[s])return this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<=this.groupbyStatus.sortIndexArr.length)return u.k.printLog("groupby max column count has been exceeded.["+this.id+"]"),this.groupbyZoneStatus.clickedHeaderInfo=null,void(this.resizeStarted=!1);this.groupbyStatus.sortIndexArr.push(this.groupbyZoneStatus.clickedHeaderInfo.index),this.groupbyStatus.sortOrderArr.push(1);var n={};if(n.sortIndex=this.groupbyStatus.sortIndexArr,n.sortOrder=this.groupbyStatus.sortOrderArr,null!=this.groupbyStatus.filter&&(n.filter=this.groupbyStatus.filter),!1===d.B.fireEvent(this,"ongroupby",n)){var l=this.getColCnt()+this.defaultColCnt;n.rowNumHeader={colSpan:l,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' 건 ] ' ",align:"left"},n.footerVisible=!1,n.rowNumFooter={colSpan:l},this.groupby(n)}this.groupbyFilterList&&this.hideGroupbyFilterList();break}this.groupbyZoneStatus.clickedHeaderInfo=null,this.resizeStatus="init",this.handleResizeLine(t),a.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}else if("drag"===this.resizeStatus){this.endResizeX=d.B.getScreenX(t)
;for(var h=this.resizeColIndex;1==this.hiddenList[h]&&!(--h<0););if(h>=0&&this.isColumnResizable(h)){var p=this.colWidthList[h],c=p+this.endResizeX-this.startResizeX,g=this.cellInfoHash[this.getColumnID(this.columnOrder[h-this.defaultColCnt])];c=g&&c<g.options.minWidth?g.options.minWidth:c,this.setColumnWidth(h,c,!0),0!=Math.abs(p-c)&&d.B.fireEvent(this,"onaftercolumnresize",h-this.defaultColCnt,p,c)}this.resizeStatus="init",this.resizeStarted=!1,this.columnMoveTarget=null,this.realColumnMoveTarget=null,this.handleResizeLine(t),a.D.emptySelection(),!1===this.options.noSelect&&!1===this.options.preventCopy&&this.removeClass("w2noselect")}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");if(this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.options.columnMove&&null!=this.columnMoveTarget){for(var i=this.event.getTargetIterator(t,this.render),o=null;i.next();)i.match(this.options.headerTdClass)&&(o=i.getElement());if(null!=o){this.columnBlock||this.createBlockedHeaderInfo();var s=this.columnMoveTargetId,n=this.getHeaderColIndex(s);n=this.columnBlock.hash[n-this.defaultColCnt],s=this.getHeaderColID(n+this.defaultColCnt);var l=o.getAttribute("header_id"),h=this.getHeaderColIndex(l);h=this.columnBlock.hash[h-this.defaultColCnt],l=this.getHeaderColID(h+this.defaultColCnt);var u=this.getHeaderIndex(s),p=this.getHeaderIndex(l);if(u<p)for(var c=this.columnBlock.info[h],g=c.length-1;g>=0;g--){var f=this.getHeaderColID(c[g]+this.defaultColCnt,{firstRow:!0});if(f){l=f,p=this.getHeaderIndex(l);break}}var m=this._getRealColIndex("head",l),y=this.htmlInfo.head.rowArr[0],b=!0;for(g=0;g<y.length;g++)if(y[g].id==l){b=!1;break}if(this.options.allColumnMove)for(g=1;g<this.htmlInfo.head.rowArr.length;g++)for(var w=0;w<this.htmlInfo.head.rowArr[g].length;w++)if(this.htmlInfo.head.rowArr[g][w].id==l){b=!1,l=this.htmlInfo.head.rowArr[0][w].id,p=this.getHeaderIndex(l),m=this.colMoveHeaderIndexMap[l];break}if(b)return;if("_headerRowNumber"==l||"_headerRowStatus"==l||u==p)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else{if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>u+this.defaultColCnt||this.getFixedColumnLastIndex()>p+this.defaultColCnt))return e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",void(!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor=""));this.resize_colIndex=p,this.resize_colId=l;var v=null;for(g=0;g<this.htmlInfo.body.rowArr.length;g++){for(w=0;w<this.htmlInfo.body.rowArr[g].length;w++)if(this.htmlInfo.body.rowArr[g][w]["@col"]==m){v=this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[g][w].col_id];break}if(null!==v)break}var I=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),C=WebSquare.style.getAbsoluteTop(this.render),x=WebSquare.style.getAbsoluteLeft(this.render),_=I[p+this.defaultColCnt],S=_.offsetLeft,D=_.offsetWidth,R=S+(u<p?D:0);null!=this.realColumnMoveTarget?this.resize_ghost.innerHTML=I[this.realColumnMoveTarget+this.defaultColCnt].innerHTML:this.resize_ghost.innerHTML=I[this.columnMoveTarget+this.defaultColCnt].innerHTML,this.resize_ghost.style.display="block",this.resize_ghost.style.top=C+I[this.columnMoveTarget].offsetHeight+5+"px",this.resize_ghost.style.left=x+R+5+"px",
this.resize_ghost.firstChild&&this.resize_ghost.firstChild.tagName&&"NOBR"!==this.resize_ghost.firstChild.tagName.toUpperCase()?this.resize_ghost.style.width=D+"px":this.resize_ghost.style.width="auto",this.resize_arrow.style.display="block",this.resize_arrow.style.top=C-this.resize_arrow.offsetHeight+"px",this.resize_arrow.style.left=x+R-parseInt(this.resize_arrow.offsetWidth/2,10)+1+"px",e.style.display="block",e.style.zIndex=9999,e.style.border="1px solid #3a3f44",e.style.top=0,e.style.left=R+"px",e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px"),a.D.emptySelection()}}}else if(null!=this.groupbyZoneStatus.clickedHeaderInfo)e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none";else if("drag"==this.resizeStatus&&this.resizeStarted&&this.isColumnResizable(this.resizeColIndex)){e.style.cssText="position:absolute;top:10px; bottom:0px;border:0px dashed #222222; border-left-width:1px; cursor:col-resize;",e.style.display="block",e.style.zIndex=100,e.style.top=0,e.style.height=this.render.offsetHeight+"px",this.getElementById(this.id+"foot_table")&&(e.style.height=this.render.offsetHeight-this.getElementById(this.id+"_foot_table").offsetHeight-this.getElementById(this.id+"_scrollX_div").offsetHeight+"px");var L=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1;e.style.left=(d.B.getMouseX(t)-WebSquare.style.getAbsoluteLeft(this.render)*L)/L+"px",this.resize_ghost.style.display="none"}else e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none",!1===this.isColumnResizable(this.resizeColIndex)&&(this.getElementById(this.id+"_head_table").style.cursor="",this.getElementById(this.id+"_head_table").cursor="")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return void(this.rowResizeTarget&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""));if(this.handleRowResizeLine(t),null!=this.rowMoveTarget)return;for(var e=this.event.getTargetIterator(t,this.render),i=null;e.next();){var o=e.getElement();if("TD"==o.tagName&&(i=o),"TH"==o.tagName){i=null;break}}if(null==i)return;i.style.cursor="",i.cursor="";var s=d.B.getMouseY(t),a=WebSquare.style.getAbsoluteTop(i),n=parseInt(i.getAttribute("tdIndex"),0),l=parseInt(n/this.realRowDataLength)+this.rowIndex;if(s-a<10&&0!=l)return i.style.cursor="row-resize",i.cursor="row-resize",this.rowResizeTarget&&this.rowResizeTarget!=i&&(this.rowResizeTarget.style.cursor="",this.rowResizeTarget.cursor=""),void(this.rowResizeTarget=i)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.doRowResize=function(t){try{if("started"==WebSquare.dragdrop.gDragManager.status)return;var e=this.event.getTargetIterator(t,this.render),i=null;for(this.resize_rowIndex=null;e.next();)e.match(this.options.bodyTdClass)&&(i=e.getElement());if(null==i)return;if(this.startResizeY=d.B.getScreenY(t),"row-resize"==i.cursor){d.B.preventDefault(t),this.rowResizeStarted=!0,this.rowResizeTarget=i;var o=parseInt(i.getAttribute("tdIndex"),0),s=parseInt(o/this.realRowDataLength)+this.rowIndex;this.resizeRowIndex=s-1}this.handleRowResizeLine(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.endRowResize=function(t){try{if(this.rowResizeStarted){this.endResizeY=d.B.getScreenY(t);var e=this.resizeRowIndex||0;if(e>=0){var i=this.rowResizeTarget.offsetHeight+this.endResizeY-this.startResizeY;i=i<20?20:i,this.rowStyleArr[e]="rowResizeStyle_"+e,this.rowStyleValueObj[this.rowStyleArr[e]]||(this.rowStyleValueObj[this.rowStyleArr[e]]={}),this.rowStyleValueObj[this.rowStyleArr[e]].style="height:"+i+"px;",this.applyRowStyleOptions(e),this.drawData(this.rowIndex,e+1,"async")}if(this.rowResizeStarted=!1,this.rowResized=!0,
this.rowMoveTarget=null,this.handleRowResizeLine(t),window.getSelection)window.getSelection().removeAllRanges();else if(document.selection)try{document.selection.empty()}catch(t){}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleRowResizeLine=function(t){try{var e=this.getElementById(this.id+"_resize_line");this.resize_ghost||(this.resize_ghost=document.createElement("div"),this.resize_ghost.className="w2grid_columnMove_ghost",this.resize_ghost.style.display="none",document.body.appendChild(this.resize_ghost),this.resize_arrow=document.createElement("div"),this.resize_arrow.className="w2grid_columnMove_arrow",this.resize_arrow.style.display="none",document.body.appendChild(this.resize_arrow)),this.rowResizeStarted?(e.style.cssText="position:absolute;left:10px;right:0px;border:0px dashed #222222; border-top-width:1px;",e.style.display="block",e.style.zIndex=100,e.style.top=d.B.getMouseY(t)-WebSquare.style.getAbsoluteTop(this.render)+"px",e.style.width=this.render.offsetWidth+"px",e.style.left=0,this.resize_ghost.style.display="none"):(e.style.display="none",this.resize_ghost.style.display="none",this.resize_arrow.style.display="none")}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setColumnWidth=function(t,e){try{if(this.autoFitColWidthList=null,this.hiddenList[t])this.colWidthList[t]=e;else{var i=isNaN(this.colWidthList[t])?0:this.colWidthList[t];this.colWidthList[t]=e,this.gridWidth+=e-i,this.arrangeOverflowXScroll(),this.setOverflowX(),this.handleScrollX();var o=t-this.defaultColCnt;if(o>=0){var s=this.getCellInfo(o);if("textarea"==s.options.inputType)this.drawColumnData(o);else if(("text"==s.options.inputType||"secret"==s.options.inputType||"calendar"==s.options.inputType)&&s.options.embeddedInput){for(var a=0,n=0;n<=o;n++)if((a+=(s=this.getCellInfo(n)).options.colSpan-0)-1==o){o=n;break}this.embeddedWidthObj[o]&&(this.embeddedWidthObj[o].isChanged=!0),this.drawColumnData(o)}}this.handlerResize_drawInitializer()}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setColumnVisible=function(t,e){try{e=a.D.getBoolean(e);for(var i=this.getCellInfo(t),o=this._getRealColIndex("body",i.options.col_id)+this.defaultColCnt,n=0;n<i.options.colSpan;n++)this.hiddenList[o+n]=!e;this.gridWidth=0;for(n=0;n<this.colWidthList.length;n++)this.hiddenList[n]||(this.gridWidth+=this.colWidthList[n]);if(0===this.render.offsetHeight&&0===this.render.offsetWidth&&(this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex})),""!=this.options.hiddenClass||""!=i.options.hiddenClass){this.drawData(this.rowIndex,0);var l=this.getColumnID(t),h=this.options.hiddenClass;""!=i.options.hiddenClass&&(h=i.options.hiddenClass);var d=null!=this.bodyToHeaderRelation[l]?this.getHeaderLayer(this.bodyToHeaderRelation[l]):null;e?null!=d&&this.hasClass(d,h)&&this.removeClass(d,h):null==d||this.hasClass(d,h)||this.addClass(d,h)}if(this.options.lazyDrawHiddenColumn&&e&&this.initVisibilityArr&&!this.initVisibilityArr[o]){var u=this.colIndexInfo.body.colInfo.colIndexArr;for(n=0;n<u.length;n++)if(u[n]==o)for(var p=0;p<=this.lastIndex;p++)this.drawCellData(p,p+this.rowIndex,n-this.defaultColCnt),this.applyCellStyleOptions(p+this.rowIndex,n-this.defaultColCnt);this.initVisibilityArr[o]=!0}"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&this.setAdaptiveColumnVisible(o,e),s.v.setTimer((function(){try{this.arrangeOverflowXScroll(),this.options.groupbyZone&&this.options.groupbyFilterBox?this.handlerResize_drawInitializer():this.setOverflowX(),this.handleScrollX(),(this.options.autoFit||this.autofitColumn)&&this._setAutoFit()}catch(t){r.w.printStackTrace(t,null,this)}}),{key:this.id+"_setColumnVisible",caller:this})}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setRowVisible=function(t,e,i){try{
if((t=parseInt(t,10))<0||t>=this.getTotalRow()||isNaN(t))return void u.k.printLog(this.id+" setRowVisible error : invalid rowIndex "+t);var o=a.D.getBoolean(e);if(this.hiddenRowObj.row[t]===!o||null==this.hiddenRowObj.row[t]&&!0===o)return;this.hiddenRowObj.row[t]=!o,this.hiddenRowObj.init=!0;var s=this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)});if(!1===o?(this.hiddenRowObj.length++,"all"===this.options.visibleRowNum||s||this.hiddenRowObj.extraRow<this.hiddenRowObj.length&&this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.length-1)):(delete this.hiddenRowObj.row[t],this.hiddenRowObj.length--),s)return;a.D.setTimeout((function(){this.lastTopRowIndex=null,this.initHeightCompleted=!1;var t=this.getDataLength();if(t-this.hiddenRowObj.length<=this.lastIndex+1&&0!==this.rowIndex)return this.bScrollY=0,this.setScrollTop(0),void this.drawData(0);var e=t-this._getVisibleLastIndex(this.lastIndex+1);if(e<this.rowIndex){var i=this.getLastFocusedCell();return this.removeFocusedCell(),this.rowIndex=e,e<this.bScrollTop&&(this.bScrollTop=e),this.setScrollYHeight({restRowCnt:this._getScrollRowIndex(e),skipScrollEnd:!0}),this.drawData(e),void(i.focusedRowIndex>-1&&null!=i.focusedColIndex&&!0===this.getRowVisible(i.focusedRowIndex)&&this.setFocusedCell(i.focusedRowIndex,i.focusedColIndex))}this._applyRowVisible({applyStyle:!0,refreshColumn:!0}),this.setScrollYHeight(),this.dynamicMergeHTML()}),{key:this.id+"_setRowVisible",caller:this,delay:100})}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.clearRowVisible=function(t){try{var e=this.hiddenRowObj.extraRow;if(this.hiddenRowObj.init&&(this.lastTopRowIndex=null),this.hiddenRowObj={length:0,extraRow:e,row:{},init:!1},this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),t&&!0===t.noDraw)return;0!==this.rowIndex?(this.bScrollY=0,this.setScrollTop(0),this.drawData(0),this.setScrollYHeight()):(this.setScrollYHeight(),this.dynamicMergeHTML(),this.applyStyleOptions(this.lastIndex))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&!0!==this.hiddenRowObj.row[t]}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getRowVisible=function(t){try{return!(null==t||t<0||t>this.getTotalRow())&&(!(this.hiddenRowObj.length>0)||this.getRowVisible(this.dataList.getRealRowIndex(t)))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getHiddenRowCount=function(t){try{var e=this.hiddenRowObj.length;if(this.isDrillDown&&isNaN(t)&&(t=0),this.hiddenRowObj.length>0&&(t||this.isDrillDown)){e=0;for(var i=this.getDataLength(),o=t;o<i;o++)this._getRowVisible(o)||e++}return e}catch(t){return r.w.printStackTrace(t,null,this),0}},p.prototype._getVisibleRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;var e=this.getDataLength();if(t>=e)return e;for(var i=t,o=0;i>=0&&o<e;)this._getRowVisible(o)&&i--,i>=0&&o++;return o}catch(e){return r.w.printStackTrace(e,null,this),t}},p.prototype._getVisibleTrRowIndex=function(t,e){try{if(this._getHiddenRowCount()<=0)return t;for(var i=this.getDataLength(),o=0,s=this.drawedRowLength+this.hiddenRowObj.extraRow-1,a=t,n=e;a>=0&&n<i&&s>o;n++)this._getRowVisible(n)&&a--,a>=0&&o++;return o}catch(e){return r.w.printStackTrace(e,null,this),t}},p.prototype._getScrollRowIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;if(t<=0)return 0;for(var e=0,i=this._getScrollMaxRowIndex(),o=t-1;o>=0&&i>e;o--)this._getRowVisible(o)&&e++;return e}catch(e){return r.w.printStackTrace(e,null,this),t}},p.prototype._getScrollMaxRowIndex=function(){try{var t=parseInt(document.getElementById(this.id+"_size_y").style.height,10)-document.getElementById(this.id+"_scrollY_div").offsetHeight;return Math.floor((t+this._getEpsilon())/this.oneRowScrollHeight)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getEpsilon=function(){try{var t=Math.min(2,Math.round(this.oneRowScrollHeight/10)),e=null!=WebSquare.BootLoader.fullViewRatio?WebSquare.BootLoader.fullViewRatio:1
;return e<1&&(t=Math.min(Math.round(t/e),Math.round(this.oneRowScrollHeight/2.4))),t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getVisibleLastIndex=function(t){try{if(this._getHiddenRowCount()<=0)return t;for(var e=t,i=this.getDataLength(),o=0,s=i-1;s>=0&&e>0;s--)this._getRowVisible(s)&&e--,o++;return o}catch(e){return r.w.printStackTrace(e,null,this),t}},p.prototype._getTrIndex=function(t){try{var e=t;return this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>t||this.options.lastFixedRow>0&&t>this.lastIndex-this.options.lastFixedRow||(e-=this.rowIndex)),e}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getTdElem=function(t,e){try{for(var i=0,o=this.rowIndex;o<t&&this.hiddenRowObj.length>0;o++)this._getRowVisible(o)||i++;var s=this._getTrIndex(t);if(s<0||s-i>=this.drawedRowLength)return;return this.data_td_list[s*this.oneRowDataLength+e]}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._addHiddenRow=function(t){try{var e=[];0==this.drawedRowLength&&this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(-1)));for(var i=[],o=0;o<this.oneRowLength;o++){var s=this.tempTr.rows[o].cloneNode(!0);i[o]=s,e.push(s)}this.addBodyRow(t,i),this.hasSubtotal&&(e=e.concat(this.createSubtotalRows(t)));var a=this.getElementById(this.id+"_body_table"),n=this.getElementById(this.id+"_body_tbody");0==this.drawedRowLength?a.style.borderWidth="0px":a.style.borderWidth="";for(o=0;o<e.length;o++)n.appendChild(e[o]);this._setRowDisplay(t,"none"),this.hiddenRowObj.extraRow++}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._applyRowVisible=function(t){try{if(void 0!==t&&null!=t||(t={}),this.delayedDraw({rowIndex:Math.max(this.rowIndex,0)}))return;var e=0,i=!0,o=this.getDataLength()+this._getLastSubtotalCount(),s=this.lastIndex;s=""===this.options.visibleRowNum?Math.min(this.drawedRowLength,o-this.rowIndex)-1:"all"===this.options.visibleRowNum?this.drawedRowLength:Math.min(parseInt(this.options.visibleRowNum,10),o)-1;var a=o-this._getVisibleLastIndex(s+1),n=this.rowIndex;this.subtotalHidden();for(var l=!1,h={skipSubtotal:!0,refreshColumn:t.refreshColumn},d=0,u=s,p=0;p<=s;p++){var c=p+this.rowIndex;if(!0===t.drawRow&&(this.options.fixedRow>0&&this.options.fixedRow>p?(c=p,this.fastDrawRowData(p,c,h)):this.options.lastFixedRow>0&&p>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(p,c,h)),this._getRowVisible(p+this.rowIndex)?(this._setRowDisplay(p,""),i=!1,l=!0):(this._setRowDisplay(p,"none"),e++,i&&n<a&&n++),this.hasSubtotal&&l)this.options.initFixedHeightByRowNum>-1&&(m={maxCount:s-p+e}),(y=this.drawSubtotalRow(p+1,c,m))>0&&(l=!1,this.options.initFixedHeightByRowNum>-1&&(p>=(s-=y)&&(e-=p-s),d+=y));u=p}var g=this.hiddenRowObj.extraRow+d,f=0;for(p=0;p<g&&s>=0;p++){var m,y,b=p+u+1;c=b+this.rowIndex;if(this._getRowVisible(c)&&e>0&&c<o?(this._setRowDisplay(b,""),this.fastDrawRowData(b,c,h),e--,i=!1,l=!0):(this._setRowDisplay(b,"none"),i&&n<a&&n++,e<=0&&(l=n>=a),!0===t.drawRow&&this.fastDrawRowData(b,c,h)),this.hasSubtotal&&b+this.rowIndex<o&&l)this.options.initFixedHeightByRowNum>-1&&(m={maxCount:e}),(y=this.drawSubtotalRow(b+1,c,m))>0&&(l=!1,this.options.initFixedHeightByRowNum>-1&&(f+=y,e-=y))}n!==this.rowIndex&&!0!==t.noDraw?this.drawData(n):""===this.options.visibleRowNum?(!0===t.applyStyle&&this.applyStyleOptions(s),this.cutGridBottom()):this.lastIndex=s-f}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setCellVisible=function(t,e,i){try{if(!0!==i&&!1!==i)return;e=this.getColumnIndex(e);var o,s=!0===this.hiddenCellObj[t+"_"+e],n=!1;if(!0===i&&s?(this.hiddenCellObj[t+"_"+e]=!1,o=!0,this.hiddenCellObj.length--):!1!==i||s||(this.hiddenCellObj[t+"_"+e]=!0,o=!0,this.hiddenCellObj.length++,this.hiddenCellObj.init||(n=!0),this.hiddenCellObj.init=!0),!0===o){var l=this._getTdElem(t,e);null!=l&&(l.style.display=!0===i?"":"none")}n&&(""!==this.options.visibleRowNum&&"native"!==this.options.drawType&&(this.options.visibleRowNum=""),this.setDataTable()),
"native"!==this.options.drawType&&a.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:100})}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setCellVisibleRefresh=function(){try{if("native"===this.options.drawType)return;this.lastTopRowIndex=null;var t=this.rowIndex,e=Math.max(this.getDataLength()-this.drawedRowLength,0);this.rowIndex=e,this.subtotalHidden();var i=this.completiveDrawData(0,{extraRowByCellHidden:!0});if(this.lastTopRowIndex=e+i,0===e&&0===i){0!==(o=this.getElementById(this.id+"_size_y")).offsetHeight&&(o.style.height="0px",this.handlerResize_drawInitializer())}else{var o=this.getElementById(this.id+"_size_y"),s=this.getElementById(this.id+"_scrollY_div"),a=o.offsetHeight;if(a<1e6&&(a=parseInt(o.style.height,10)),o.style.height=s.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",t=Math.min(t,this.lastTopRowIndex),this.hasSubtotal&&this.struct.subtotalArr&&this.struct.subtotalArr.length>0)this.lastTopRowIndex+=this.struct.subtotalArr.length,this.drawData(t);else{var n=this.oneRowScrollHeight*t;t!==this.rowIndex?this.drawData(t):s.scrollTop!==n&&(this.bScrollY=n,s.scrollTop=n),this.handlerResize_drawInitializer()}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getCellVisible=function(t,e){try{e=this.getColumnIndex(e);return!0!==this.hiddenCellObj[t+"_"+e]}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.clearCellVisible=function(){try{for(var t in this.hiddenCellObj)if(!0===this.hiddenCellObj[t]){var e=t.split("_"),i=Number(e[0]),o=Number(e[1]),s=this._getTdElem(i,o);null!=s&&(s.style.display="")}this.hiddenCellObj={length:0,init:!1},this.cutGridBottom(this.lastIndex)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._moveCellVisible=function(t,e,i){try{if(!(this.hiddenCellObj.length>0))return;void 0!==i&&null!=i||(i={});var s=[];t.sort((function(t,e){return t-e}));for(var a={},n=0;n<t.length;n++)a[t[n]]=!0;var l=this.getRowCount();for(n=0;n<l;n++)!0===i.remove&&!0===a[n]||s.push(n);!0===i.insert&&(s=s.slice(0,e).concat(t).concat(s.slice(e)));var h={};for(n=0;n<s.length;n++)s[n]!==n&&(h[s[n]]=n);var d=o.x.extend({},this.hiddenCellObj),u=this.getColumnCount();for(var p in h){var c=Number(p),g=h[c];if(c!==g)for(var f=0;f<u;f++)this.setCellVisible(g,f,!d[c+"_"+f])}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._refreshRowVisible=function(t){try{this._applyRowVisible(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setScrollLeft=function(t){t=parseInt(t,10);try{this.getElementById(this.id+"_scrollX_right").scrollLeft=t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setScrollTop=function(t){t=parseInt(t,10);try{this.scrollEvent=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getScrollLeft=function(){try{return this.getElementById(this.id+"_scrollX_right").scrollLeft}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getScrollTop=function(){try{return this.getElementById(this.id+"_scrollY_div").scrollTop}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setGridStyle=function(t){try{if(!t)return;if("string"==typeof t){t=t.match(/"\s*N\s*"\s*:\s*"\s*w2:gridView\s*"/)?JSON.parse(t):WebSquare.xml.parse(t)}t instanceof WebSquare.Elem&&(t=t._element),!0===WebSquare.convertPageXML&&s.v.isXML(t)&&(t=WebSquare.xmljs.xml2json(t).E[0]),!0===s.v.isXML(t)&&9==t.nodeType&&(t=t.documentElement);var e=this.getParent();e&&e.parentControl&&"wframe"==e.parentControl.options.pluginName&&(e=e.parentControl);var i,o=this.scope_obj,a=this.parentFrame;this.options.groupbyFilterBox&&this.options.customFilterBox&&this.groupbyFilterBox_history.length>0&&(i=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo),this.remove(),this.__removed_object__=!0;var n=WebSquare.controlFactory.create(null,null,t,o,a);n.options&&isNaN(n.options.fixedRightColumn)&&(n.options.fixedRightColumn=0),n.writeTo(e),
n.activate(),n.onComplete(),n.options.groupbyFilterBox&&n.options.customFilterBox&&(n.refreshGroupbyFilterBox(),n.applyFilterHistory(),i?(n.customFilterList.customFilterListFilterInfo=JSON.parse(i,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})),n.groupbyFilterBox_history[n.groupbyFilterBox_select.getSelectedIndex()].customFilterListFilterInfo=i):n.customFilterList&&(n.customFilterList.customFilterListFilterInfo={}));var l=n.options._sortStatus;if(l){for(var h=JSON.parse(l),d=[],u=[],p=[],c=0;c<h.length;c++){var g=h[c];d.push(g.colID),u.push(g.sortOrder),p.push(g.dataType)}n.dataList.setFilter({type:"sort",sortIndex:d.join(" "),sortOrder:u.join(" "),dataType:p.join(" "),focuseMode:n.options.filterFocusMode,ignoreEmptyStringOnSort:n.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:n.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:n.options.setEmptyStringSortableOnSort}),n.drawHeaderSortImages()}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getGridStyle=function(){try{return"json"===this.element._elementType?WebSquare.jsonUtil.serialize(this.element._element):WebSquare.xml.serialize(this.element._element)}catch(t){r.w.printStackTrace(t)}},p.prototype.getCurrentGridStyle=function(){try{var t=this.element.cloneNode(!0);t.setAttribute("columnOrder",this.getColumnOrder()),t.setAttribute("fixedColumn",this.options.fixedColumn),t.setAttribute("fixedRow",this.options.fixedRow),t.setAttribute("fixedRightColumn",this.options.fixedRightColumn);for(var e=t.getChildNodes(),i=0;i<e.length;i++){if("w2:header"==e[i].getTagName())for(var o=e[i].getChildNodes(),s={},n=0,l=this.htmlInfo.head.rowAttrArr.length,h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){for(var d=o[h].getChildNodes(),u=[],p=0;p<d.length;p++)"w2:column"==d[p].getTagName()&&u.push(d[p]);for(var c=0,g=0,f={},m=0;m<u.length;m++){for(;null!=s[i]&&null!=s[i][m+c+g];)g+=s[i][m+c+g];f[m+c-0+g]=m;var y=parseInt(u[m].getAttribute("colSpan"),10)||1,b=parseInt(u[m].getAttribute("rowSpan"),10)||1;if(b>1)for(var w=n;w<n+b-1;w++)null==s[w+1]&&(s[w+1]={}),null==s[w+1][m-0+c+g]?s[w+1][m-0+c+g]=y:s[w+1][m-0+c+g]+=y;y>1&&(c+=y-1)}if(n===l-1){var v=0,I=0;for(m=0;m<u.length;m++){for(;null!=s[n]&&null!=s[n][this.columnOrder[m+I+v]];)I+=s[n][this.columnOrder[m+I+v]];var C=f[[this.columnOrder[m-0+v+I]]];null==C&&(C=0);var x=u[C];(y=parseInt(x.getAttribute("colSpan"),10))>1&&(v+=y-1),x.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v+I]),this.hiddenList[m+this.defaultColCnt+v+I]?x.setAttribute("hidden","true"):x.setAttribute("hidden","false")}}n++}if("w2:gBody"==e[i].getTagName())for(o=e[i].getChildNodes(),h=0;h<o.length;h++)if("w2:row"===o[h].getTagName()){var _=o[h].getChildNodes(),S=[];for(p=0;p<_.length;p++)"w2:column"==_[p].getTagName()&&S.push(_[p]);for(c=0,f={},m=0;m<S.length;m++){f[m+c]=m,(y=parseInt(S[m].getAttribute("colSpan"),10))>1&&(c+=y-1)}for(v=0,m=0;m<S.length;m++){x=S[f[[this.columnOrder[m+v]]]];(y=parseInt(x.getAttribute("colSpan"),10))>1&&(v+=y-1),x.setAttribute("width",this.colWidthList[m+this.defaultColCnt+v]),a.D.isChrome()?x.setAttribute("hidden",this.hiddenList[m+this.defaultColCnt+v]):this.hiddenList[m+this.defaultColCnt+v]?x.setAttribute("hidden","true"):x.setAttribute("hidden","false");var D=x.getAttribute("col_id");D&&(x.setAttribute("id",D),x.removeAttribute("col_id"))}}}var R=this.getSortableStatus();return R&&R.length>0&&t.setAttribute("_sortStatus",JSON.stringify(R)),t.serialize()}catch(t){r.w.printStackTrace(t)}},p.prototype.setTableStruct=function(){try{if(this.headerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"header",s.v._XML_NAMESPACE.W2)[0],this.bodyXml=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",s.v._XML_NAMESPACE.W2)[0],this.struct={head:this.xml2JSON(this.headerXml),
body:this.xml2JSON(this.bodyXml)},this.updateStruct(this.struct.head.rowArr),this.updateStruct(this.struct.body.rowArr),this.changeRowID(this.struct.head.rowAttrArr),this.changeRowID(this.struct.body.rowAttrArr),this.footerXml=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0],this.footerXml&&(this.hasFooter=!0,this.struct.foot=this.xml2JSON(this.footerXml),this.updateStruct(this.struct.foot.rowArr)),this.subtotalXmlArr=WebSquare.Elem.api.getElementsByTagName(this.element,"subTotal",s.v._XML_NAMESPACE.W2),this.subtotalXmlArr.length>0){this.options.showLastRow=!1,this.hasSubtotal=!0,this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0,this.struct.subtotalArr=[];for(var t=0;t<this.subtotalXmlArr.length;t++){var e=this.xml2JSON(this.subtotalXmlArr[t]);this.struct.subtotalArr.push(e),this.struct.subtotalArr[e.attr.id]=e,this.updateStruct(e.rowArr)}}if(this.setCss(),this.setColArr(),this.htmlInfo={head:this.getHeaderHtmlInfo(),body:this.getBodyHtmlInfo()},this.footerXml&&(this.htmlInfo.foot=this.getFooterHtmlInfo()),this.subtotalXmlArr.length>0){this.htmlInfo.subtotalArr=[],this.subtotalStrList={};for(t=0;t<this.struct.subtotalArr.length;t++){e=this.getSubtotalHtmlInfo(this.struct.subtotalArr[t]);this.htmlInfo.subtotalArr.push(e),this.htmlInfo.subtotalArr[e.attr.id]=e,this.subtotalStrList[e.attr.targetColumnID]=e}}this.captionXml=WebSquare.Elem.api.getElementsByTagName(this.element,"caption",s.v._XML_NAMESPACE.W2)[0];var i=this.getColCnt();this.columnOrder=[];for(t=0;t<i;t++)this.columnOrder.push(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.updateStruct=function(t){try{for(var e=0,i=[],o=this.getColCnt(),s=0;s<t.length;s++){for(var a=[],n=0;n<o;n++)a.push(null);i.push(a)}for(s=0;s<t.length;s++)for(n=0;n<t[s].length;n++){var l;for(l=0;l<i[s].length&&null!==i[s][l];l++);var h=t[s][n];h["@col"]=l;for(var d=h.colSpan||h.colspan||1,u=h.rowSpan||h.rowspan||1,p=0;p<u;p++)for(var c=0;c<d;c++)i[s+p][l+c]=e;e++}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.changeRowID=function(t){try{for(var e=0;e<t.length;e++){var i=t[e];null!=i.id&&(i["data-tr-id"]=i.id,delete i.id)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getRealColIndex=function(t,e){try{for(var i=0;i<this.htmlInfo[t].rowArr.length;i++)for(var o=0;o<this.htmlInfo[t].rowArr[i].length;o++)if(this.htmlInfo[t].rowArr[i][o].col_id==e)return this.htmlInfo[t].rowArr[i][o]["@col"];return null}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getRealHeaderColIndex=function(t){try{return this.getColumnIndex(this.headerToBodyRelation[t])}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getDataColIndex=function(t){try{return this._dataList.getColumnIndex(this.getColumnID(t))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._moveColumn=function(t,e,i,o,s,a){try{e=e||"td";for(var n=[],l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&n.push(t[i].childNodes[l]);var h=n[o];h.parentNode.removeChild(h);var d=[];for(l=0;l<t[i].childNodes.length;l++)t[i].childNodes[l].nodeName.toLowerCase()==e&&d.push(t[i].childNodes[l]);if(a<d.length){var u=d[a];u.parentNode.insertBefore(h,u)}else t[s].appendChild(h)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.moveBodyColumn=function(t,e,i,o){try{var s=this.htmlInfo.body.rowArr[t].splice(e,1);this.htmlInfo.body.rowArr[i].splice(o,0,s[0]),this.updateStruct(this.htmlInfo.body.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_body_tbody"),n=0;this.hasSubtotal&&this.drawedSubtotal&&this.drawedSubtotal.length>0&&(n=this.drawedSubtotal[0].length);for(var l=0;l<this.drawedRowLength;l++){for(var h=[],d=0;d<this.oneRowLength;d++)h.push(a.rows[l*(this.oneRowLength+n)+d+n]);this._moveColumn(h,"td",t,e,i,o);for(d=0;d<n;d++)if(0===t&&0===i){var u=d>0?this.defaultColCnt:0;this._moveColumn([a.rows[l*(this.oneRowLength+n)+d]],"td",0,e-u,0,o-u)}}}catch(t){r.w.printStackTrace(t,null,this)}},
p.prototype.moveHeadColumn=function(t,e,i,o){try{var s=this.htmlInfo.head.rowArr[t].splice(e,1);this.htmlInfo.head.rowArr[i].splice(o,0,s[0]),this.updateStruct(this.htmlInfo.head.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=this.getElementById(this.id+"_head_table");this._moveColumn(a.rows,"th",t,e,i,o)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._moveFooterColumn=function(t,e,i,o){try{var s=this.htmlInfo.foot.rowArr[t].splice(e,1);this.htmlInfo.foot.rowArr[i].splice(o,0,s[0]),this.updateStruct(this.htmlInfo.foot.rowArr),e+=0==t?this.defaultColCnt:0,o+=0==i?this.defaultColCnt:0;var a=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumn(a.rows,"td",t,e,i,o)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.moveFooterColumn=function(t,e){try{var i,o,s=parseInt(t,10),a=[];"string"==typeof t&&isNaN(s)?(o="id",i=t):(o="@col",i=this.colIndexes.footerColInfo.colIndexArr[s+this.defaultColCnt]-this.defaultColCnt);for(var n=0;n<this.htmlInfo.foot.rowArr.length;n++)for(var l=0;l<this.htmlInfo.foot.rowArr[n].length;l++)this.htmlInfo.foot.rowArr[n][l][o]==i&&a.push({row:n,col:l});var h,d,u=parseInt(e,10);"string"==typeof e&&isNaN(u)?(d="id",h=e):(d="@col",h=this.colIndexes.footerColInfo.colIndexArr[u+this.defaultColCnt]-this.defaultColCnt);for(n=0;n<a.length;n++){var p=null;for(l=0;l<this.htmlInfo.foot.rowArr[a[n].row].length;l++)if(this.htmlInfo.foot.rowArr[a[n].row][l][d]==h){p=l;break}null!==p?this._moveFooterColumn(a[n].row,a[n].col,a[n].row,p):this._moveFooterColumn(a[n].row,a[n].col,a[n].row,u)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.moveColumnByHeaderId=function(t,e){try{if(!t||!e||t===e)return!1;var i=this.getHeaderColIndex(t),o=this.getHeaderColIndex(e);if(isNaN(i)||isNaN(o))return!1;var s=this.columnBlock.hash[i-this.defaultColCnt],a=this.columnBlock.hash[o-this.defaultColCnt];if(s===a)return!1;var n=this.getFixedColumnLastIndex();if(this.options.fixedColumnNoMove&&(n>s||n>a))return!1;for(var l=-1,h=-1,u=0;u<this.columnOrder.length;u++){var p=this.columnOrder[u];if(p===s&&(l=u),p===a&&(h=u),l>-1&&h>-1)break}var c=this.headerToBodyRelation[t],g=this.headerToBodyRelation[e];if(!1===d.B.fireEvent(this,"onbeforecolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}))return!1;this.columnBlock||this.createBlockedHeaderInfo();var f=this.getColumnOrder(),m=-1,y=-1;for(u=0;u<f.length;u++){var b=f[u];if(b===s?m=u:b===a&&(y=u),-1!==m&&-1!==y)break}var w=this.columnBlock.info[s],v=this.columnBlock.info[a],I=f.slice(0);I.splice(m,w.length);var C=y+(m<y?v.length-w.length:0),x=I.slice(0,C).concat(w).concat(I.slice(C)),_=this.setColumnOrder(x);return d.B.fireEvent(this,"onaftercolumnmove",{startColumnID:c,startColumnIndex:l,endColumnID:g,endColumnIndex:h}),_}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.moveColumn=function(t,e){try{if(t==e)return;if(this.options.fixedColumnNoMove&&(this.getFixedColumnLastIndex()>t+this.defaultColCnt||this.getFixedColumnLastIndex()>e+this.defaultColCnt))return;var i=this.getHeaderID(t),o=this._getRealColIndex("head",i)+this.defaultColCnt,s=this.headerToBodyRelation[i];if(!s||this.colMoveBolockedHeaderObj[i])return;var a=this.colMoveIndexMap[s],n=this._getRealColIndex("body",s)+this.defaultColCnt,l=this.getHeaderID(e),h=this.headerToBodyRelation[l];if(!h||this.colMoveBolockedHeaderObj[l])return;var u=this._getRealColIndex("head",l)+this.defaultColCnt,p=this.colMoveIndexMap[h],c=this.colIndexes.bodyColInfo.colIndexArr[p+this.defaultColCnt];if(!1===d.B.fireEvent(this,"onbeforecolumnmove",{startColumnID:s,startColumnIndex:a,endColumnID:h,endColumnIndex:p}))return!1;for(var g=[],f=n-this.defaultColCnt,m=0;m<this.htmlInfo.body.rowArr.length;m++)for(var y=0;y<this.htmlInfo.body.rowArr[m].length;y++)this.htmlInfo.body.rowArr[m][y]["@col"]==f&&g.push({row:m,col:y});var b=c-this.defaultColCnt;for(m=0;m<g.length;m++){var w=null
;for(y=0;y<this.htmlInfo.body.rowArr[g[m].row].length;y++)if(this.htmlInfo.body.rowArr[g[m].row][y]["@col"]==b){w=y;break}null!==w?this.moveBodyColumn(g[m].row,g[m].col,g[m].row,w):this.moveBodyColumn(g[m].row,g[m].col,g[m].row,p)}g=[];var v=o-this.defaultColCnt;for(m=0;m<this.htmlInfo.head.rowArr.length;m++)for(y=0;y<this.htmlInfo.head.rowArr[m].length;y++)this.htmlInfo.head.rowArr[m][y]["@col"]==v&&g.push({row:m,col:y});var I=u-this.defaultColCnt;for(m=0;m<g.length;m++){for(w=null,y=0;y<this.htmlInfo.head.rowArr[g[m].row].length;y++)if(this.htmlInfo.head.rowArr[g[m].row][y]["@col"]==I){w=y;break}null!==w?this.moveHeadColumn(g[m].row,g[m].col,g[m].row,w):this.moveHeadColumn(g[m].row,g[m].col,g[m].row,e)}this.hasFooter&&this.options.columnMoveWithFooter&&this.moveFooterColumn(t,e);var C=function(t,e,i){var o=t.splice(e,1);t.splice(i,0,o[0])};if(null!=this.initVisibilityArr)for(m=0;m<this.htmlInfo.body.rowArr.length;m++)C(this.initVisibilityArr,n+m*this.getColCnt(),c+m*this.getColCnt());for(var x in C(this.columnOrder,n-this.defaultColCnt,c-this.defaultColCnt),C(this.colIndexInfo.body.colInfo.colIndexMatch,n,c),C(this.colWidthList,n,c),C(this.hiddenList,o,u),this.colMoveIndexMap)this.colMoveIndexMap[x]==a?this.colMoveIndexMap[x]=p:a<p?a<this.colMoveIndexMap[x]&&this.colMoveIndexMap[x]<=p&&(this.colMoveIndexMap[x]-=1):a>p&&a>this.colMoveIndexMap[x]&&this.colMoveIndexMap[x]>=p&&(this.colMoveIndexMap[x]+=1);for(var x in this.colMoveHeaderIndexMap)this.colMoveHeaderIndexMap[x]==a?this.colMoveHeaderIndexMap[x]=p:a<p?a<this.colMoveHeaderIndexMap[x]&&this.colMoveHeaderIndexMap[x]<=p&&(this.colMoveHeaderIndexMap[x]-=1):a>p&&a>this.colMoveHeaderIndexMap[x]&&this.colMoveHeaderIndexMap[x]>=p&&(this.colMoveHeaderIndexMap[x]+=1);this.arrangeOverflowXScroll(),this._handleScrollX(),d.B.fireEvent(this,"onaftercolumnmove",{startColumnID:s,startColumnIndex:a,endColumnID:h,endColumnIndex:p})}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.resetMoveColumn=function(){try{for(var t=this.getColCnt(),e=[],i=0;i<t;i++)e.push(i);this.setColumnOrder(e)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setColumnOrder=function(t){try{if(!a.D.isEmptyObject(this.cellMergeInfo))return void u.k.printLog("warning : setColumnOrder refused due to mergeCells. ["+this.id+"]");var e=this.getColCnt(),i=[];"string"==typeof t&&(t=t.split(","));for(var o=0;o<t.length;o++){if(null!=this.bodyIdColIndexMap[t[o]]&&(t[o]=this.bodyIdColIndexMap[t[o]]),t[o]=Number(t[o]),"number"!=typeof t[o])return void $l(this.id+".setColumnOrder : wrong column order array.");i[t[o]]=!0}if(e>t.length){for(o=0;o<t.length;o++)t[o]=this.colIndexes.headerColInfo.colIndexArr[t[o]+this.defaultColCnt]-this.defaultColCnt;for(o=0;o<t.length;o++){var s=this.getCellInfo(t[o]).options.colSpan;if(s>1)for(var n=1;n<s;n++)t.splice(o+n,0,t[o]+n)}for(o=0;o<t.length;o++)i[t[o]]=!0}for(o=t.length-1;o>=0;o--)for(n=o-1;n>=0;n--)t[o]===t[n]&&t.splice(o,1);for(o=0;o<e;o++)i[o]||t.push(o);if(e!=t.length)return $l(this.id+".setColumnOrder : wrong column order array."),!1;var l=[];for(o=0;o<t.length;o++)for(n=0;n<this.columnOrder.length;n++)if(this.columnOrder[n]==t[o]){l[o]=n;break}if(!0===this.checkRefreshAdaptive()&&this.removeAdaptive(),this.columnOrder=l.slice(0),this.drawedRowLength<=0&&this.drawDataTable(),this._moveColumnByOrder(this.id+"_body_tbody",this.htmlInfo.body.rowArr),this._moveColumnByOrder(this.id+"_head_table",this.htmlInfo.head.rowArr),this.hasFooter&&this.options.columnMoveWithFooter){var h=document.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0];this._moveColumnByOrder(h.getAttribute("id"),this.htmlInfo.foot.rowArr)}if(null!=this.initVisibilityArr){var d=[];for(o=0;o<this.initVisibilityArr.length-this.defaultColCnt;o++){var p=Math.floor(o/this.columnOrder.length),c=o%this.columnOrder.length,g=p*this.columnOrder.length+this.columnOrder[c]+this.defaultColCnt;d.push(this.initVisibilityArr[g])}
for(o=0;o<d.length;o++)this.initVisibilityArr[o+this.defaultColCnt]=d[o]}this._swapItem(this.colIndexInfo.body.colInfo.colIndexMatch,this.columnOrder,this.defaultColCnt),this._swapItem(this.colWidthList,this.columnOrder,this.defaultColCnt),this.initialColWidthList=this.colWidthList.slice(),this._swapItem(this.hiddenList,this.columnOrder,this.defaultColCnt),"allColumn"===this.options.autoFit&&this._swapItem(this.autoFitColWidthList,this.columnOrder,this.defaultColCnt);for(o=0;o<this.tdIdList.length;o++)for(n=0;n<t.length;n++)if(o==t[n]){this.colMoveIndexMap[this.tdIdList[o]]=n,this.colMoveHeaderIndexMap[this.thIdList[o]]=n;break}return this.columnOrder=t.slice(0),this.arrangeOverflowXScroll(),this._handleScrollX(),!0===this.checkRefreshAdaptive()&&this.addAdaptive(),!0}catch(t){return r.w.printStackTrace(t,null,this),!1}},p.prototype._moveColumnByOrder=function(t,e){try{var i=document.getElementById(t),o=[],s={},n=e.length;(isNaN(n)||n<=0)&&(n=1);for(var l=0;l<n;l++){if(!(C=i.rows[l]))break;var h=0;0===l&&(h=this.defaultColCnt);for(var d={},u=0,p=0,c=h;c<C.childNodes.length;c++){for(;null!=s[l]&&null!=s[l][c+u+p];)p+=s[l][c+u+p];d[c+u-h+p]=c;var g=parseInt(C.childNodes[c].getAttribute("colSpan"),10)||1;this.options.lazyDrawHiddenColumn&&"true"==C.childNodes[c].getAttribute("data-lazydrawtd")&&(g=1);var f=parseInt(C.childNodes[c].getAttribute("rowSpan"),10)||1;if(f>1)for(var m=l;m<l+f-1;m++)null==s[m+1]&&(s[m+1]={}),null==s[m+1][c-h+u+p]?s[m+1][c-h+u+p]=g:s[m+1][c-h+u+p]+=g;g>1&&(u+=g-1)}var y=0,b=0;o[l]=[];for(c=h;c<C.childNodes.length;c++){for(;null!=s[l]&&null!=s[l][this.columnOrder[c+b+y]];)b+=s[l][this.columnOrder[c+b+y]];var w=d[[this.columnOrder[c-h+y+b]]];null==w&&(w=0),o[l].push(w-h);var v=C.childNodes[w];g=parseInt(v.getAttribute("colSpan"),10);this.options.lazyDrawHiddenColumn&&"true"==v.getAttribute("data-lazydrawtd")&&(g=1),g>1&&(y+=g-1)}}for(l=0;l<i.rows.length;l++){h=0;var I=l%n;0===I&&(h=this.defaultColCnt);var C=i.rows[l];a.D.isIEAllVersion()&&"11"==a.D.browserVersion()&&l>=(this.lastIndex+1)*this.oneRowLength&&(C.style.backgroundColor="");var x=[];for(c=0;c<o[I].length;c++)x.push(C.childNodes[o[I][c]+h]);for(c=0;c<x.length;c++)C.appendChild(x[c])}for(l=0;l<n;l++)this._swapItem(e[l],o[l],0);this.updateStruct(e)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._swapItem=function(t,e,i){try{for(var o=[],s=null==i?0:i,a=0;a<e.length;a++)o.push(t[e[a]+s]);for(a=0;a<o.length;a++)t[a+s]=o[a]}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getColumnOrder=function(t){try{if(t){for(var e=[],i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.defaultColCnt;o<i.length;o++){if(0==i[o].length)return void $l(this.id+".getColumnOrder : use getColumnOrder(false). cannot express column order by name.");for(var s=this.tdIdList[i[o][0]-this.defaultColCnt],a=!1,n=0;n<e.length;n++)if(e[n]===s){a=!0;break}a||e.push(s)}return e}return this.columnOrder.slice(0)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getDisplayColumnIndex=function(t){try{for(var e=parseInt(t,10),i=0;i<this.columnOrder.length;i++)if(e===this.columnOrder[i])return i;return t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getColumnMoveIndex=function(t){try{if(t<0||isNaN(t))return t;for(var e=this.colIndexInfo.body.colInfo.colIndexArr[t+this.defaultColCnt],i=this.colIndexInfo.body.colInfo.trIndexArr[t+this.defaultColCnt],o=this.colIndexInfo.body.colInfo.colIndexMatch[e],s=0;s<o.length;s++){var a=o[s];if(a>=t+this.defaultColCnt)break;var n=this.colIndexInfo.body.colInfo.rowSpanArr[a];n>1&&(i=i-n+1)}return o[i]-this.defaultColCnt}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleGroupbyZoneClick=function(t){try{for(var e=this.event.getTargetIterator(t,this.render);e.next()&&(!this.options.groupbyZoneSearch||!e.match("w2grid_groupbyZone_search"));){if(e.match("w2grid_groupbyZone_column")){var i=e.getElement(),o={};o.render=i,o.parentRender=this.render.getElementsByTagName("div")[0],o.headerID=i.getAttribute("header_id"),
o.headerIndex=this._getColumnMoveIndex(this.getHeaderIndex(o.headerID)),o.dataIndex=this._getDataColIndex(this._getRealHeaderColIndex(o.headerID)),this.toggleGroupbyFilterList(o),d.B.stopEvent(t);break}if(e.match("w2grid_groupbyZone_column_closeButtonImg")){i=e.getElement();this.hideGroupbyFilterList(),this.ungroupColumn(i.getAttribute("col_id"));break}if(e.match("w2grid_groupbyZone")){this.hideGroupbyFilterList(),d.B.stopEvent(t);break}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.toggleGroupbyFilterList=function(t){try{var e=t.render.tagName,i=t.headerIndex;"number"==typeof this.groupbyZoneStatus.beforeOpenedColIndex?(this.groupbyFilterList.saveState(this.groupbyZoneStatus.beforeOpenedColIndex.toString()),i==this.groupbyZoneStatus.beforeOpenedColIndex&&e==this.groupbyZoneStatus.beforeOpenedColTagName?"block"==this.groupbyFilterList.render.style.display?this.hideGroupbyFilterList():this.showGroupbyFilterList(t,!0):this.showGroupbyFilterList(t,!0,!0)):this.createGroupbyFilterList(t)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.applyFilterListFormat=function(t,e){try{if(this.options.displayValueOnUseFilterList)for(var i=0;i<t.length;i++)null!=t[i].id3&&(this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(i,"id2",t[i].id3):this.customFilterList.setCellDataNM(i,"id2",t[i].id3));else if(this.options.useFilterListFormat){var o=this.headerToBodyRelation[e],s=this.getCellInfo(o),a=0,n=this.headerInfoHash[e];if(n&&n.options.hideCustomFilter&&(a=1),s.options.displayFormat||s.options.displayFormatter||s.options.ioFormat)for(i=2-a;i<t.length;i++){var l=s.formatter.format(t[i].id2);this.groupbyStatus.grouped?this.groupbyFilterList.setCellDataNM(i,"id2",l):this.customFilterList.setCellDataNM(i,"id2",l)}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.createGroupbyFilterList=function(t){try{var e=t.render,i=t.parentRender,o=t.headerIndex,s=t.headerID;if(!this.groupbyFilterList){this.groupbyStatus.filter={};"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >","        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>","        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>","    </w2:listRow>","</w2:list>";var n=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_groupbyZone_list' virtualized='true' labelCheck='true'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_groupbyZone_list_listRow' check_id='id1' >        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_groupbyZone_list_listColumn_checkbox'/>        <w2:listColumn id='id2' check_id='id1' inputType='text' style='' class='w2grid_groupbyZone_list_listColumn_text'/>    </w2:listRow></w2:list>",!0).documentElement;this.groupbyFilterList=new WebSquare.uiplugin.list(this.id+"_groupbyZone_list","",n),this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]};var l=this;this.groupbyFilterList._handleClickEvent=this.groupbyFilterList.handleClickEvent,this.groupbyFilterList.handleClickEvent=function(t){try{this._handleClickEvent(t),d.B.stopPropagation(t);var e=d.B.getTarget(t),i=e;if((e.className.match("w2grid_groupbyZone_list_listColumn_checkbox")||e.className.match("w2grid_groupbyZone_list_listColumn_text"))&&(i=e.parentElement),!i.className.match("w2grid_groupbyZone_list_listRow"))return
;var o=i.children[0],s=l.getHeaderID(this.headerIndex),a=l.getColumnID(this.headerIndex),n=i.getAttribute("unique_id"),h=this.getAllData(),u=o.checked,p=!1,c=!1,g=!1;if(h[0].customerFilter&&h[0].unique_id==n){if(u)return l.hideGroupbyFilterList(),l.firstOpenCustomFilter[s]?(l._dataList.filterManager.headerID=s,l._dataList.filterManager.targetColID=a,void l.setCustomFilterExpression()):(l.firstOpenCustomFilter[s]||(l.firstOpenCustomFilter[s]=!0),void l.showCustomFilter(s));for(var f in l.customFilterStatusObj[s]=!1,l.dataList.removeColumnFilter(a),l.customFilterStatusObj)if(l.customFilterStatusObj[f])return;p=!0,c=!0,g=!0;for(var m=1;m<h.length;m++)h[m].id1=!0}else if(h[1].gridCheckedAll&&h[1].unique_id==n){c=!0,u&&(g=!0);for(m=2;m<h.length;m++)h[m].id1=u}if(!p&&!g&&h.length-2>0){l.groupbyStatus.filter[a]=[];for(m=2;m<h.length;m++)h[m].id1&&l.groupbyStatus.filter[a].push(h[m].id2);l.groupbyStatus.filter[a]=l.changeItemValue("value",a,l.groupbyStatus.filter[a]);var y=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(m=0;m<l.groupbyStatus.filter[a].length;m++){var b=l.groupbyStatus.filter[a][m];"string"==typeof b&&(l.groupbyStatus.filter[a][m]=b.replace(y,(function(t){return l.replacechar(t)})))}}if(c){if(g&&this.filterHistory.column[0]===a)this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),delete l.groupbyStatus.filter[a];else if(!g&&this.filterHistory.column[0]!==a&&h.length-2>0){for(m=1;m<this.filterHistory.column.length;m++)if(this.filterHistory.column[m]===a){l.dataList.removeColumnFilter(a,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(a),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else{var w=h.length-2;if(w>l.groupbyStatus.filter[a].length){if(h[1].id1=!1,this.filterHistory.column[0]!==a){for(var m=1;m<this.filterHistory.column.length;m++)if(this.filterHistory.column[m]===a){l.dataList.removeColumnFilter(a,{noRefresh:!0,noRefreshAfter:!0});break}this.filterHistory.column.unshift(a),this.filterHistory.filteredRowIndexArr.unshift(l._dataList.filteredRowIndexArr.slice(0))}}else l.groupbyStatus.filter[a].length==w&&(h[1].id1=!0,delete l.groupbyStatus.filter[a],this.filterHistory.column[0]===a&&(this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()))}this.setFirstRowIndex(this.firstListIndex,!0);var v={};if(v.sortIndex=l.groupbyStatus.sortIndexArr,v.sortOrder=l.groupbyStatus.sortOrderArr,null!=l.groupbyStatus.filter&&(v.filter=l.groupbyStatus.filter,l.groupbyStatus.filter[a]&&2*l.groupbyStatus.filter[a].length>h.length)){var I=[],C="*";for(m=2;m<h.length;m++)if(!h[m].id1){if(h[m].id2===l.filterEmptyStr){C="+";continue}I.push(h[m].id2)}var x=l.getCellInfo(a);(x.itemsetObj||x.itemArr)&&(I=l.changeItemValue("value",a,I));var _="^\\n*(?:(?!^";for(y=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,m=0;m<I.length;m++){var S=I[m];"string"==typeof S&&(S=S.replace(y,(function(t){return l.replacechar(t)}))),_+=S+="$)(?!^"}_+="$).)"+C+"\\n*$",v.filterRegExp={},v.filterRegExp[a]=new RegExp(_,"gi")}if(v.noRefreshAfter=!0,!1===d.B.fireEvent(l,"ongroupby",v)){var D=l.getColCnt()+l.defaultColCnt;v.rowNumHeader={colSpan:D,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' 건 ] ' ",align:"left"},v.footerVisible=!1,v.rowNumFooter={colSpan:D},l.groupby(v)}l.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){r.w.printStackTrace(t,null,this)}},this.groupbyFilterList.writeTo(this),this.groupbyFilterList.activate()}if(!0===t.noDraw)return;var h=e.clientWidth,u=WebSquare.style.getRelativeTop(e,i)+e.offsetHeight,p=WebSquare.style.getRelativeLeft(e,i);this.groupbyFilterList.setPosition(p,u),this.groupbyFilterList.render.style.width=h+"px";var c=this.render.offsetHeight-u;this.groupbyFilterList.options.visibleRowNum=Math.floor(c/21);var g=this.getGroupbyDepthInfo(t);if(this.groupbyFilterList.setJSON(g),this.applyFilterListFormat(g,s),this.groupbyFilterList.currentHeaderID=s,this.groupbyFilterList.headerIndex=o,
WebSquare.style.show(this.groupbyFilterList.render),a.D.getBoolean(this.headerInfoHash[s].options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList)){var f=this.groupbyFilterList.getMaxItemWidth();f>h&&(this.groupbyFilterList.render.style.width=f+"px")}this.groupbyFilterList.focus(),this.groupbyZoneStatus.beforeOpenedColIndex=o,this.groupbyZoneStatus.beforeOpenedColTagName=e.tagName}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showGroupbyFilterList=function(t,e,i){try{var o=t.render,s=t.parentRender,n=t.headerIndex,l=t.headerID;if(this.groupbyFilterList.currentHeaderID=t.headerID,this.groupbyFilterList.headerIndex=n,this.groupbyZoneStatus.beforeOpenedColIndex=n,this.groupbyZoneStatus.beforeOpenedColTagName=o.tagName,WebSquare.style.show(this.groupbyFilterList.render),this.groupbyFilterList.focus(),e){var h,d=WebSquare.style.getRelativeTop(o,s)+o.offsetHeight,u=WebSquare.style.getRelativeLeft(o,s),p=this.render.offsetHeight-d;this.groupbyFilterList.options.visibleRowNum=Math.floor(p/21);var c=this.getGroupbyDepthInfo(t);this.groupbyFilterList.setJSON(c),!0===i&&this.groupbyFilterList.loadState(n),a.D.getBoolean(this.headerInfoHash[l].options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList)?(h=this.groupbyFilterList.getMaxItemWidth(),o.clientWidth>h&&(h=o.clientWidth)):h=o.clientWidth,this.groupbyFilterList.setPosition(u,d),this.groupbyFilterList.render.style.width=h+"px",this.applyFilterListFormat(c,l)}else if(!0===i){this.groupbyFilterList.loadState(n);c=this.getGroupbyDepthInfo(t);this.applyFilterListFormat(c,l)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideGroupbyFilterList=function(){try{this.groupbyFilterList&&(WebSquare.style.hide(this.groupbyFilterList.render),this.groupbyFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.groupbyFilterList.isChanged=!1))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getGroupbyDepthInfo=function(t){try{var e,i=t.headerIndex,o=this.getColumnID(i),s=t.headerID;e=this.groupbyFilterList.filterHistory.column[0]===o?this.groupbyFilterList.filterHistory.filteredRowIndexArr[0]:this._dataList.filteredRowIndexArr;var a=this.dataList.getColData(o,e),n=this.getCellInfo(o),l=this.getUniqueValueOfArray(a),h=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];h.push("");var d,u,p=this.changeItemValue("label",o,l.slice(0)),c=this.customFilterStatusObj[s]||!1,g=WebSquare.language.getMessage("Grid_Customized_Filter")||"사용자필터",f=WebSquare.language.getMessage("Grid_checked_all")||"전체선택",m=[];m.push({id1:c,id2:g,customerFilter:!0}),m.push({id1:!c,id2:f,gridCheckedAll:!0}),!c&&this.groupbyStatus.filter&&o in this.groupbyStatus.filter&&(u=(d=this.groupbyStatus.filter[o]).slice(0));for(var y=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,b=this,w=0;w<p.length;w++){var v={};if(u){var I=!1,C=n.itemArr?n.itemHash[p[w]]:p[w];"string"==typeof C&&(C=C.replace(y,(function(t){return b.replacechar(t)})));for(var x=u.length-1;x>-1;x--){if(C==u[x]){I=!0,u.splice(x,1);break}if("string"==typeof u[x]){for(var _=!1,S=0;S<h.length;S++)if(h[S]==u[x]){_=!0;break}if(_&&(p[w]==this.options.useFilterEmptyMsg||p[w]==this.filterEmptyStr)){I=!0;break}}}v.id1=I}else v.id1=!c;v.id2=p[w],this.options.displayValueOnUseFilterList&&(v.id3=l[w]),m.push(v)}if(d){var D=!0,R=m;for(w=2;w<R.length;w++)if(!R[w].id1){D=!1;break}m[1].id1=!!D}return this._dataList.getDataLength()||(m[1].id1=!1),m}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(this.groupbyZoneStatus.groupbyZoneRender.offsetHeight>0)return;if(WebSquare.style.show(this.groupbyZoneStatus.groupbyZoneRender),this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px",this.isIE6)try{
this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){}this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideGroupbyZone=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.groupbyZoneStatus.groupbyZoneRender){if(0==this.groupbyZoneStatus.groupbyZoneRender.offsetHeight)return;if(this.dom[this.id+"_main_div"].style.top="0px",this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight+this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){}WebSquare.style.hide(this.groupbyZoneStatus.groupbyZoneRender),this.setDataTable(),this.drawData(this.rowIndex,0)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showGroupbyZoneMessage=function(){try{if((this.options.groupbyZone||this.clearGrouping)&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.show(t)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideGroupbyZoneMessage=function(){try{if(this.options.groupbyZone&&this.options.groupbyZoneMessage){var t=this.groupbyZoneStatus.groupbyZoneMessageRender;t&&WebSquare.style.hide(t)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.syncWithGroupbyZone=function(){try{if(this.groupbyStatus.grouped&&this.options.groupbyZone){this.clearGroupbyZone();for(var t=this.groupbyStatus.sortIndexArr,e=0;e<t.length;e++){var i=t[e],o=this.getHeaderID(this._getDisplayColumnIndex(i)),s=this.getColumnID(i),a=document.createElement("div");a.setAttribute("header_id",o),a.className="w2grid_groupbyZone_column";var n=document.createElement("div");n.className="w2grid_groupbyZone_column_closeButtonDiv";var l=document.createElement("div");l.className="w2grid_groupbyZone_column_closeButtonImg",l.setAttribute("col_id",s);var h=document.createElement("div");h.className="w2grid_groupbyZone_column_labelDiv";var d=document.createElement("span"),u="textContent"in d?"textContent":"innerText";d[u]=this.getHeaderValue(o).replace(/<(\/)?br(\\s)*(\/)?>/gi," "),d.setAttribute("title",d[u]),h.appendChild(d),n.appendChild(l),a.appendChild(h),a.appendChild(n),this.groupbyZoneStatus.groupbyZoneRender.appendChild(a),d.className="w2grid_groupbyZone_column_value"}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.clearGroupbyZone=function(){try{if((this.groupbyStatus.grouped||this.clearGrouping)&&this.options.groupbyZone){for(var t=this.groupbyZoneStatus.groupbyZoneRender,e=t.childNodes,i=[],o=0;o<e.length;o++)null!=e[o].className.match("w2grid_groupbyZone_column")&&i.push(e[o]);for(o=0;o<i.length;o++)t.removeChild(i[o])}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.handleChangeGroupDepth=function(t){try{for(var e=this.event.getTargetIterator(t);e.next();)if(e.match("w2grid_groupbyZone_column")){this.addClass("w2noselect"),a.D.emptySelection();var i=e.getElement().getAttribute("header_id"),o=this.getHeaderIndex(i),s=this.getHeaderValue(i),n=this;return void WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_column_drag",contents:s,delay:15,applyMousePosition:!0,onDrop:function(t,e,i,s,r,a,l){var h,d=null;for(this.isMobile?(d=new WebSquare.targetIterator(document.elementFromPoint(l.changedTouches[0].clientX,l.changedTouches[0].clientY)),l.preventDefault()):d=n.event.getTargetIterator(l);d.next();){if(d.match("w2grid_groupbyZone_column")){h=n.getHeaderIndex(d.getElement().getAttribute("header_id"));break}if(d.match("w2grid_groupbyZone")){var u=n.groupbyStatus.sortIndexArr;h=u[u.length-1];break}if(d.match(null,null,"body"))return}o!=h&&(!1===n.options.noSelect&&!1===n.options.preventCopy&&n.removeClass("w2noselect"),n.hideGroupbyFilterList(),n.changeGroupDepth(o,h))}})}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.createContextMenu=function(t,e){try{if("object"==typeof e&&!0===e.hideSystemMenu)return
;"<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>","    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>","        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>","    </w2:listRow>","</w2:list>";var i=WebSquare.xml.parse("<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='' class='w2grid_contextMenu'>    <w2:listRow tagName='div' style='height: 20px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_contextMenu_row'>        <w2:listColumn id='col1' inputType='text' style='' class='w2grid_contextMenu_column'/>    </w2:listRow></w2:list>",!0).documentElement;this.contextMenu=new WebSquare.uiplugin.list(this.id+"_contextMenu_list","",i),this.contextMenu.writeTo(WebSquare.getBody()),this.contextMenu.activate();var o=this;this.contextMenu.event.addListener(this.contextMenu.render,"onclick",(function(t){try{d.B.stopPropagation(t);for(var e,i,s=o.event.getTargetIterator(t,this.render),a=o.contextMenu;s.next();){if(s.match("w2grid_contextMenu_column")){e=s.getElement().parentNode;break}if(s.match("w2grid_contextMenu_row")){e=s.getElement();break}if(s.match("w2grid_contextMenu"))break}for(var n=0;n<a.getLength();n++)if(e==a.render.childNodes[n]){i=n;break}o.callSelectedAPI(a.getRowData(n).col1,a.info),o.hideContextMenu();var l=o.contextMenu.getAllData()[i],h={row:a.info.rowIndex,col:a.info.colIndex,focusedCell:a.info.focusedCell,userMenuId:l.userMenuId,isSystemMenu:l.isSystemMenu,systemMenu:l.systemMenu};a.info=null,d.B.fireEvent(o,"oncontextclick",h.row,h.col,h.userMenuId,h.isSystemMenu,h.systemMenu,h.focusedCell)}catch(t){r.w.printStackTrace(t,null,this)}}));var s=this.getContextMenuData(t);if(e&&e.hideSystemMenu&&"object"==typeof e.hideSystemMenu&&e.hideSystemMenu.indexOf)for(var a=0;a<s.length;a++){var n=s[a].systemMenu;e.hideSystemMenu.indexOf(n)>-1&&(s.splice(a,1),a--)}if(e&&e.appendMenu&&"object"==typeof e.appendMenu&&e.appendMenu.length)for(a=0;a<e.appendMenu.length;a++){var l=e.appendMenu[a];l.col1=l.label,l.isSystemMenu=!1,s.push(l)}if(s.length>0){this.showContextMenu(t,s);for(a=0;a<s.length;a++){var h=s[a];h.className&&(this.contextMenu.render.children[a].className=this.contextMenu.render.children[a].className+" "+h.className)}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getContextMenuData=function(t){try{var e=[],i=!0;if(this.groupbyStatus.grouped)for(var o=WebSquare.language.getMessage("Grid_ungroup")||"선택 컬럼 그룹 해제",s=0;s<this.groupbyStatus.sortIndexArr.length;s++)if(t.focusedCell&&t.focusedCell.length>1){for(var a=0;a<t.focusedCell.length;a++)if(this.groupbyStatus.sortIndexArr[s]==t.focusedCell[a].focusedColIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(!i)break}else if(this.groupbyStatus.sortIndexArr[s]==t.colIndex){e.push({col1:o,isSystemMenu:!0,systemMenu:"Ungroup"}),i=!1;break}if(i){var n=WebSquare.language.getMessage("Grid_group")||"선택 컬럼 그룹";e.push({col1:n,isSystemMenu:!0,systemMenu:"Group"})}var l=WebSquare.language.getMessage("Grid_column_hide")||"선택 컬럼 숨기기";if(e.push({col1:l,isSystemMenu:!0,systemMenu:"ColumnHide"}),0==this.options.fixedColumn||this.options.fixedColumn-1<t.colIndex){var h=WebSquare.language.getMessage("Grid_column_fix")||"선택 컬럼 틀고정";e.push({col1:h,isSystemMenu:!0,systemMenu:"ColumnFix"})}if(this.options.fixedColumn>0){var d=WebSquare.language.getMessage("Grid_column_unfix")||"전체 컬럼 틀고정 취소";e.push({col1:d,isSystemMenu:!0,systemMenu:"ColumnUnfixAll"})}var u=WebSquare.language.getMessage("Grid_column_adjustWidth")||"선택 컬럼 크기 자동 맞추기",p=WebSquare.language.getMessage("Grid_column_showAll")||"전체 컬럼 숨기기 해제";e.push({col1:u,isSystemMenu:!0,systemMenu:"ColumnAdjustWidth"});for(s=0;s<this.hiddenList.length;s++)if(this.hiddenList[s]){e.push({col1:p,isSystemMenu:!0,systemMenu:"ColumnShowAll"});break}
var c=WebSquare.language.getMessage("Grid_column_adjustAuto")||"전체 컬럼 크기 자동 맞추기";e.push({col1:c,isSystemMenu:!0,systemMenu:"ColumnAdjustAuto"});var g=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"컬럼 크기 자동 맞추기 해제";if(e.push({col1:g,isSystemMenu:!0,systemMenu:"ColumnAdjustAutoNone"}),this.groupbyStatus.grouped){var f=WebSquare.language.getMessage("Grid_fold_all")||"전체 그룹 접기",m=WebSquare.language.getMessage("Grid_unfold_all")||"전체 그룹 펼치기",y=WebSquare.language.getMessage("Grid_ungroup_all")||"전체 그룹 해제";e.push({col1:f,isSystemMenu:!0,systemMenu:"FoldAll"}),e.push({col1:m,isSystemMenu:!0,systemMenu:"UnfoldAll"}),e.push({col1:y,isSystemMenu:!0,systemMenu:"UngroupAll"})}return e}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showContextMenu=function(t,e){try{e||(e=this.getContextMenuData(t),this.contextMenu.setPosition(0,0));var i=e.length*(this.options.contextMenuRowHeight+1);this.contextMenu.show(),this.contextMenu.setSize(null,i),this.contextMenu.setJSON(e);var o=d.B.getMouseX(t.event),s=d.B.getMouseY(t.event),a=document.body.scrollTop;a<document.documentElement.scrollTop&&(a=document.documentElement.scrollTop);var n=(s-a)*WebSquare.style.getScale(),l=document.documentElement.clientHeight-n,h=Math.max(l,n),u=WebSquare.style.getSize(this.contextMenu.render,"outerheight");(h<u&&e.length>0||l<u&&n>u)&&(s-=u),document.documentElement.clientWidth<o+this.contextMenu.render.offsetWidth&&(o-=this.contextMenu.render.offsetWidth)<0&&(o=WebSquare.style.getAbsoluteLeft(this.render)),this.contextMenu.setPosition(o,s),this.contextMenu.info=t}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideContextMenu=function(){try{this.contextMenu&&this.contextMenu.hide()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.callSelectedAPI=function(t,e){try{var i=WebSquare.language.getMessage("Grid_column_hide")||"선택 컬럼 숨기기",s=WebSquare.language.getMessage("Grid_column_showAll")||"전체 컬럼 숨기기 해제",a=WebSquare.language.getMessage("Grid_column_fix")||"선택 컬럼 틀고정",n=WebSquare.language.getMessage("Grid_column_unfix")||"전체 컬럼 틀고정 취소",l=WebSquare.language.getMessage("Grid_column_adjustWidth")||"선택 컬럼 크기 자동 맞추기",h=WebSquare.language.getMessage("Grid_column_adjustAuto")||"전체 컬럼 크기 자동 맞추기",u=WebSquare.language.getMessage("Grid_column_adjustAuto_none")||"컬럼 크기 자동 맞추기  해제",p=WebSquare.language.getMessage("Grid_fold_all")||"전체 그룹 접기",c=WebSquare.language.getMessage("Grid_unfold_all")||"전체 그룹 펼치기",g=WebSquare.language.getMessage("Grid_ungroup_all")||"전체 그룹 해제",f=WebSquare.language.getMessage("Grid_ungroup")||"선택 컬럼 그룹 해제",m=WebSquare.language.getMessage("Grid_group")||"선택 컬럼 그룹",y=e.focusedCell||[],b=[];if(y.length>0){for(var w=0;w<e.focusedCell.length;w++)b.push(e.focusedCell[w].colIndex);b.sort((function(t,e){return t-e}));for(w=0;w<b.length-1;)b[w]===b[w+1]?b.splice(w,1):w++}switch(t){case i:if(-1===e.colIndex)break;if(b.length>1)for(w=0;w<b.length;w++)this.setColumnVisible(b[w],!1),this.groupbyStatus.grouped&&this.ungroupColumn(b[w]);else this.setColumnVisible(e.colIndex,!1),this.groupbyStatus.grouped&&this.ungroupColumn(e.colIndex);break;case s:for(w=0;w<this.hiddenList.length;w++)this.hiddenList[w]&&this.setColumnVisible(this.columnOrder[w-this.defaultColCnt],!0);break;case a:if(-1===e.colIndex)break;if(b.length>1)for(w=0;w<b.length;w++)this.setFixedColumn(parseInt(b[w],10)+1);else this.setFixedColumn(parseInt(e.colIndex,10)+1);break;case n:if(-1===e.colIndex)break;this.setFixedColumn(0);break;case l:if(-1===e.colIndex)break;if(!this.autofitColumn){var v={type:"selectedColumn",colIndex:e.colIndex};this.setAutoFit(v)}break;case h:v={type:"allColumn"};this.setAutoFit(v);break;case u:this.clearAutoFit();break;case p:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.foldAll();break;case c:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.unfoldAll();break;case g:if(-1===e.colIndex)break;this.groupbyStatus.grouped&&this.clearGroupby();break;case f:if(-1===e.colIndex)break
;if(b.length>1)for(w=0;w<b.length;w++)this.ungroupColumn(b[w]);else this.ungroupColumn(e.colIndex);break;case m:if(-1===e.colIndex)break;if(this.groupbyStatus.grouped){if((v={}).sortIndex=this.groupbyStatus.sortIndexArr,v.sortOrder=this.groupbyStatus.sortOrderArr,b.length>1)for(w=0;w<b.length;w++)v.sortIndex.push(b[w]),v.sortOrder.push(1);else v.sortIndex.push(e.colIndex),v.sortOrder.push(1);!1===d.B.fireEvent(this,"ongroupby",v)&&((v=o.x.extend({},this.groupbyDisplayOptions)).sortIndex=this.groupbyStatus.sortIndexArr,v.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(v,!0))}else{v={};if(b.length>1){v.sortIndex=b,v.sortOrder=[];for(w=0;w<b.length;w++)v.sortOrder.push(1)}else v.sortIndex=[e.colIndex],v.sortOrder=[1];if(!1===d.B.fireEvent(this,"ongroupby",v)){var I=this.getColCnt()+this.defaultColCnt;v.rowNumHeader={colSpan:I,inputType:"expression",expression:" toggle() + depthStr() + ' [ ' + count() + ' 건 ] ' ",align:"left"},v.rowNumFooter={colSpan:I},this.groupby(v,!0)}}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.createCustomFilterList=function(t,e){try{var i;!0!==e&&(i=this.headerToBodyRelation[t]);var o=this.options.filterListRowHeight+1,s=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum,n=this.getElementById(this.id+"_head_table");this._dataLayerHeight=this.dataLayerHeight?this.dataLayerHeight:this.getElementById(this.id+"_body_table").parentNode.offsetHeight,this._dataLayerHeight=this._dataLayerHeight-n.offsetHeight;var l=0;this.options.useFilterSearch?(l=Math.min(parseInt(this._dataLayerHeight/o),s),this.customFilterScrollViewRenderHeight=l*o):this.customFilterScrollViewRenderHeight=s*o;"<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'>","</w2:scrollView>";var h=WebSquare.xml.parse("<w2:scrollView xmlns:w2=\"http://www.inswave.com/websquare\" style='position:absolute; z-index:11;' class='w2grid_customFilter_scrollView'></w2:scrollView>",!0).documentElement;WebSquare.xml.setAttribute(h,"bounce",!1),WebSquare.xml.setAttribute(h,"horizontalScroll",!1),WebSquare.xml.setAttribute(h,"paging",!1),WebSquare.xml.setAttribute(h,"scrollType","auto"),WebSquare.xml.setAttribute(h,"showHorizontalScroll",!1),WebSquare.xml.setAttribute(h,"showVerticalScroll",!1),WebSquare.xml.setAttribute(h,"verticalScroll",!1),this.customFilterScrollView=new WebSquare.uiplugin.scrollView(this.id+"_customFilter_scrollView","",h);var u="";if(this.options.useFilterSearch)u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list' placeholder='"+(WebSquare.language.getMessage("Grid_filter_search")||"검색")+"' virtualized='true' visibleRowNum='"+(l-1)+"' useSearch='true' wheelRows='1' _listRowHeight='"+o+"'>";else u+="<w2:list xmlns:w2=\"http://www.inswave.com/websquare\" tagName='div' style='position:absolute; z-index:11; padding:0px; display:block;' class='w2grid_customFilter_list'>";u+="    <w2:listRow tagName='div' style='height: "+this.options.filterListRowHeight+"px; display:block; border-top: 0px; border-left:0px; border-right:0px;' class='w2grid_customFilter_list_listRow'>",u+="        <w2:listColumn id='id1' inputType='checkbox' style='' class='w2grid_customFilter_list_listColumn_checkbox'/>",u+="        <w2:listColumn id='id2' inputType='text' style='' class='w2grid_customFilter_list_listColumn_text'/>",u+="    </w2:listRow>",u+="</w2:list>";var p=WebSquare.xml.parse(u,!0).documentElement;this.customFilterList=new WebSquare.uiplugin.list(this.id+"_customFilter_list","",p),this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]},this.customFilterScrollView.addControl(this.customFilterList),this.customFilterScrollView.writeTo(this),this.customFilterScrollView.activate();var c=this
;if(this.customFilterScrollView.event.addListener(this.customFilterScrollView.render,"onclick",this.customFilterScrollView.event.bindAsEventListener(this.customFilterList,(function(t){try{d.B.stopPropagation(t);var e=d.B.getTarget(t);if(e.className.match("w2list_input"))return;var i,o=e.parentNode,s=0;if(this.options.virtualized?(i=this.getElementById(this.id+"_items_main").childNodes,s=this.firstListIndex):i=this.render.childNodes,e.className.match("w2grid_customFilter_list_listRow")){e=(o=e).firstChild;for(var a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+s,"id1",!e.checked);break}}if(e.className.match("w2grid_customFilter_list_listColumn_text")&&(i[0]!=o||this.options.virtualized&&s>0)){e=o.firstChild;for(a=0;a<this.getLength();a++)if(o==i[a]){this.setCellData(a+s,"id1",!e.checked);break}}var n=this.currentHeaderID,l=c.headerToBodyRelation[n],h=c._dataList.getColumnIndex(l),u=c.headerInfoHash[n],p=0;if(u&&u.options.hideCustomFilter&&(p=1),1!==p&&o==i[0]&&0===s){if(e.className.match("w2grid_customFilter_list_listColumn_checkbox")){if(e.checked){if(c.firstOpenCustomFilter[n]){c.headerID=n,c.targetColID=l,c.options.useFilterSearch&&c.setAutoCompleteItem(l,n),c.setCustomFilterExpression();for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!1);if(c.options.useFilterSearch){var g=c.getCustomFilterListJSON({colID:l,headerID:n});c._setFilterListHeight(n,g.length)}return}return c.hideCustomFilterList(),c.firstOpenCustomFilter[n]||(c.firstOpenCustomFilter[n]=!0),void c._showCustomFilter(n)}if(c.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],c.dataList.removeColumnFilter(l),c.options.useFilterSearch){(g=c.getCustomFilterListJSON({colID:l,headerID:n}))[0].id1=!1;for(a=1-p;a<g.length;a++)g[a].id1=!0}for(a=1;a<this.getLength();a++)this.setCellData(a,"id1",!0);c.options.useFilterSearch&&(this.setJSON(g),c._setFilterListHeight(n,g.length))}else if(e.className.match("w2grid_customFilter_list_listColumn_text"))return void c._showCustomFilter(n)}else if(1!==p&&this.setCellData(0,"id1",!1),c.customFilterStatusObj[n]=!1,delete this.customFilterListFilterInfo[l],o==i[1-p-s]){var f=e.checked;if(e.className.match("w2grid_customFilter_list_listColumn_text"))f=!i[1-p].firstChild.checked;for(a=1-p;a<this.getLength();a++)this.setCellData(a,"id1",f)}var m=[],y=[],b=[],w=this.getLength();for(a=2-p;a<w;a++)this.getCellData(a,"id1")?y.push(a):b.push(a);var v=y.length>b.length,I=(c._dataList.getFilterList(),this.getLength()-2+p),C=v?b:y,x="*";for(a=0;a<C.length;a++){var _=this.getCellData(C[a],"id2");v&&_===c.filterEmptyStr?x="+":m.push(_)}m=c.changeItemValue("value",l,m);var S=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(a=0;a<m.length;a++){var D=m[a];"string"==typeof D&&(m[a]=D.replace(S,(function(t){return c.replacechar(t)})))}var R="";0==y.length?R+="/^[a-z0-9_-]{3,16}$/":R+=v?"^\\n*(?:(?!^"+m.join("$)(?!^")+"$).)"+x+"\\n*$":"^"+m.join("$|^")+"$";var L,T=c.getCellInfo(l),k="";if(T&&(k=c.getColumnOption(T.options.col_id,"dataType")),L="number"==k?new RegExp(R):new RegExp(R,"gi"),d.B.fireEvent(c._dataList,"onbeforecolumnfilterchange"),y.length<I&&(WebSquare.DataCollection.stopBroadCast=!0),c.dataList.removeColumnFilter(l,{noRefreshAfter:!0}),this.filterHistory.column[0]!==l&&(this.filterHistory.column.unshift(l),this.filterHistory.filteredRowIndexArr.unshift(c._dataList.filteredRowIndexArr.slice(0))),y.length<I){if(WebSquare.DataCollection.stopBroadCast=!1,v){this.customFilterListFilterInfo[l]=[];for(a=0;a<y.length;a++)this.customFilterListFilterInfo[l].push(this.getCellData(y[a],"id2"));(T.itemsetObj||T.itemArr)&&(this.customFilterListFilterInfo[l]=c.changeItemValue("value",l,this.customFilterListFilterInfo[l]));for(a=0;a<this.customFilterListFilterInfo[l].length;a++){var A=this.customFilterListFilterInfo[l][a];A===c.filterEmptyStr?this.customFilterListFilterInfo[l][a]="":"string"==typeof A&&(A=A.replace(S,(function(t){return c.replacechar(t)})),this.customFilterListFilterInfo[l][a]=A)}
}else this.customFilterListFilterInfo[l]=m;c.dataList.setColumnFilter({type:"regExp",colIndex:h,key:L,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[l];var F=c.getElementById(c.id+"_"+n+"_filter");1!==p&&this.getCellData(0,"id1")||WebSquare.style.removeClass(F,"w2grid_customFilter_filter");var E=!0,M=(I=this.getLength()-2+p,this.getAllData());for(a=2-p;a<M.length;a++)if(!M[a].id1){E=!1;break}E?(this.setCellData(1-p,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift()):(this.setCellData(1-p,"id1",!1),WebSquare.style.addClass(F,"w2grid_customFilter_filter")),d.B.fireEvent(c._dataList,"onaftercolumnfilterchange"),c.options.groupbyFilterBox&&(this.isChanged=!0)}catch(t){r.w.printStackTrace(t,null,this)}}))),this.options.useFilterSearch&&(this.customFilterList.find=function(){this.search="contain";var t=this.dom.input.value,e=[],i=this.currentHeaderID,o=c.headerToBodyRelation[i],s=c._dataList.getColumnIndex(o),r=c.headerInfoHash[i],a=0;r&&r.options.hideCustomFilter&&(a=1);for(var n=0;n<2-a;n++)e.push({id1:n-a==1,id2:m[n].id2});if(""!=t){c.itemValueObj={},c.customFilterStatusObj[i]=!1,c.firstOpenCustomFilter[i]=!1;var l=e.length;c.dataList.removeColumnFilter(o),delete this.customFilterListFilterInfo[o];for(O=c.getCustomFilterListJSON({colID:o,headerID:i}),n=2-a;n<O.length;n++){var h=!1,u=O[n].id2+"";"contain"==this.search?h=this.myhelper.containWith(u,t):"start"==this.search?h=this.myhelper.startWith(u,t):"none"==this.search&&(h=u==t),h&&e.push({id1:!0,id2:O[n].id2})}l===e.length&&e.splice(1-a,1),this.setJSON(e),c._setFilterListHeight(i,O.length,e.length);var p=[],g=[],f=[],y=this.getLength();for(n=2-a;n<y;n++)this.getCellData(n,"id1")?g.push(n):f.push(n);if(0!=g.length||0!=f.length){var b=g.length>f.length;0===f.length&&(b=!1);var w=b?f:g,v="*";for(n=0;n<w.length;n++){var I=this.getCellData(w[n],"id2");b&&I===c.filterEmptyStr?v="+":p.push(I)}p=c.changeItemValue("value",o,p);var C=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g;for(n=0;n<p.length;n++){var x=p[n];"string"==typeof x&&(p[n]=x.replace(C,(function(t){return c.replacechar(t)})))}var _="";0==g.length?_+="/^[a-z0-9_-]{3,16}$/":_+=b?"^\\n*(?:(?!^"+p.join("$)(?!^")+"$).)"+v+"\\n*$":"^"+p.join("$|^")+"$";var S,D=c.getCellInfo(o),R="";D&&(R=c.getColumnOption(D.options.col_id,"dataType")),S="number"==R?new RegExp(_):new RegExp(_,"gi"),d.B.fireEvent(c._dataList,"onbeforecolumnfilterchange");var L=this.getLength()-2+a;if(g.length<L&&(WebSquare.DataCollection.stopBroadCast=!0),c.dataList.removeColumnFilter(o,{noRefreshAfter:!0}),this.filterHistory.column[0]!==o&&(this.filterHistory.column.unshift(o),this.filterHistory.filteredRowIndexArr.unshift(c._dataList.filteredRowIndexArr.slice(0))),g.length<=L){if(WebSquare.DataCollection.stopBroadCast=!1,b){this.customFilterListFilterInfo[o]=[];for(n=0;n<g.length;n++)this.customFilterListFilterInfo[o].push(this.getCellData(g[n],"id2"));(D.itemsetObj||D.itemArr)&&(this.customFilterListFilterInfo[o]=c.changeItemValue("value",o,this.customFilterListFilterInfo[o]));for(n=0;n<this.customFilterListFilterInfo[o].length;n++){var T=this.customFilterListFilterInfo[o][n];T===c.filterEmptyStr?this.customFilterListFilterInfo[o][n]="":"string"==typeof T&&(T=T.replace(C,(function(t){return c.replacechar(t)})),this.customFilterListFilterInfo[o][n]=T)}}else this.customFilterListFilterInfo[o]=p;c.dataList.setColumnFilter({type:"regExp",colIndex:s,key:S,condition:"and",columnfilterchangeFire:!1,noRefreshAfter:!0})}else delete this.customFilterListFilterInfo[o];M=c.getElementById(c.id+"_"+i+"_filter");1!==a&&this.getCellData(0,"id1")||WebSquare.style.removeClass(M,"w2grid_customFilter_filter");var k=!0,A=(L=this.getLength()-2+a,this.getAllData());for(n=2-a;n<A.length;n++)if(!A[n].id1){k=!1;break}k?(this.setCellData(1-a,"id1",!0),this.filterHistory.column.shift(),this.filterHistory.filteredRowIndexArr.shift(),
this.listRowObjArr.length!==m.length&&WebSquare.style.addClass(M,"w2grid_customFilter_filter")):(this.setCellData(1-a,"id1",!1),WebSquare.style.addClass(M,"w2grid_customFilter_filter")),d.B.fireEvent(c._dataList,"onaftercolumnfilterchange"),c.options.groupbyFilterBox&&(this.isChanged=!0)}}else{for(var F=c._dataList.getFilterList(),E=!1,n=0;n<F.length;n++)if(F[n]&&F[n].colIndex===s&&"func"!==F[n].type){E=!0;break}if(this.listRowObjArr.length!==m.length&&E){c.itemValueObj={},c.customFilterStatusObj[i]=!1,delete this.customFilterListFilterInfo[o],c.firstOpenCustomFilter[i]=!1,c.dataList.removeColumnFilter(o);var M=c.getElementById(c.id+"_"+i+"_filter");1!==a&&this.getCellData(0,"id1")||WebSquare.style.removeClass(M,"w2grid_customFilter_filter");for(var O=c.getCustomFilterListJSON({colID:o,headerID:i}),n=2-a;n<O.length;n++)e.push({id1:!0,id2:O[n].id2});this.setJSON(e),c._setFilterListHeight(i,e.length)}}},this.customFilterList._inputKeyDown=this.customFilterList.inputKeyDown,this.customFilterList.inputKeyDown=function(t,e){var i=this;this.mytime=setTimeout((function(t){i.find()}),100,t)}),!0===e)return;var g,f,m=this.getCustomFilterListJSON({colID:i,headerID:t}),y=this.getElementById(this.id+"_"+t),b=(this.options.useFilterSearch?m.length+1:m.length)*o-1,w=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),v=WebSquare.style.getRelativeTop(y,this.render)+y.offsetHeight+1,I=WebSquare.style.getRelativeLeft(y,this.render),C=Math.min(this.customFilterScrollViewRenderHeight,b,this._dataLayerHeight-w);if(this.options.useFilterSearch&&(b=C),a.D.getBoolean(this.headerInfoHash[t].options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList)){this.customFilterList.setJSON(m),this.applyFilterListFormat(m,t),g=this.customFilterList.getMaxItemWidth(),y.clientWidth>g&&(g=y.clientWidth),f=g,this.options.useFilterSearch||C>=b||(f+=this.getElementById(this.id+"_size_y").clientWidth);var x=this.getElementById(this.id+"_customFilter_scrollView_container");WebSquare.style.setStyle(x,"overflow-x","hidden")}else{var _=parseInt(this.headerInfoHash[t].options.filterListWidth);f=g=_>0?_:this.options.filterListWidth>0?this.options.filterListWidth:y.clientWidth,this.options.useFilterSearch||C>=b||(g-=this.getElementById(this.id+"_size_y").clientWidth),this.customFilterList.setJSON(m),this.applyFilterListFormat(m,t)}if(this.customFilterScrollView.setPosition(I,v-1),this.customFilterScrollView.setSize(f,C),this.customFilterList.setSize(g,b),this.options.useFilterSearch){this.removeFocusedCell(),this.customFilterList.oldSearchedData="";var S=this.customFilterList.getElementById(this.customFilterList.id+"_input"),D=WebSquare.style.getSize(S,"innerwidth")-WebSquare.style.getSize(S,"width");this.customFilterList.dom.input.style.width=g-parseInt(this.customFilterList.getElementById(this.customFilterList.id+"_scroll_main").style.width)-D+"px",this.customFilterList.dom.input.focus()}this.customFilterList.currentHeaderID=t,this.customFilterList.customFilterListFilterInfo={},this.customFilterList.customFilterListAction=!1,this.customFilterList.customUserFilterListAction=!1,WebSquare.style.show(this.customFilterScrollView.render)}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._setFilterListHeight=function(t,e,i){try{var o,s,n=this.getElementById(this.id+"_"+t),l=this.options.filterListRowHeight+1,h=i||e,d=(this.options.useFilterSearch?h+1:h)*l-1,u=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),p=Math.min(this.customFilterScrollViewRenderHeight,d,this._dataLayerHeight-u);if(this.options.useFilterSearch&&(d=p),a.D.getBoolean(this.headerInfoHash[t].options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList)){o=this.customFilterList.getMaxItemWidth(),n.clientWidth>o&&(o=n.clientWidth),s=o,
this.options.useFilterSearch||this.customFilterScrollViewRenderHeight>=d||(s+=this.getElementById(this.id+"_size_y").clientWidth);var c=this.getElementById(this.id+"_customFilter_scrollView_container");WebSquare.style.setStyle(c,"overflow-x","hidden")}else{var g=parseInt(this.headerInfoHash[t].options.filterListWidth);s=o=g>0?g:this.options.filterListWidth>0?this.options.filterListWidth:n.clientWidth,this.options.useFilterSearch||p>d||(o-=this.getElementById(this.id+"_size_y").clientWidth)}if(this.customFilterScrollView.setSize(s,p),this.customFilterList.setSize(o,d),this.options.useFilterSearch){var f=this.customFilterList.getElementById(this.customFilterList.id+"_input"),m=WebSquare.style.getSize(f,"innerwidth")-WebSquare.style.getSize(f,"width");this.customFilterList.dom.input.style.width=o-parseInt(this.customFilterList.getElementById(this.customFilterList.id+"_scroll_main").style.width)-m+"px"}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.toggleCustomFilterList=function(t){try{this.customFilterScrollView&&this.customFilterList&&("none"==this.customFilterScrollView.render.style.display||this.customFilterList.currentHeaderID!=t?this.moveCustomFilterList(t):this.hideCustomFilterList())}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showCustomFilterList=function(t,e){try{if(this.customFilterScrollView&&this.customFilterList){if(e){var i,o;WebSquare.style.show(this.customFilterScrollView.render);var s=this.getElementById(this.id+"_"+t.headerID),n=this.options.filterListRowHeight+1,l=(this.options.useFilterSearch?t.dataLength+1:t.dataLength)*n-1,h=WebSquare.style.getSize(this.customFilterScrollView.render,"outerHeight")-WebSquare.style.getSize(this.customFilterScrollView.render,"height"),d=this.options.filterListVisibleRowNum||this.options.customFilterListVisibleRowNum;if(this.options.useFilterSearch){var u=Math.min(parseInt(this._dataLayerHeight/n),d);this.customFilterScrollViewRenderHeight=u*n}else this.customFilterScrollViewRenderHeight=d*n;var p=WebSquare.style.getRelativeTop(s,this.render)+s.offsetHeight+1,c=WebSquare.style.getRelativeLeft(s,this.render),g=this.getElementById(this.id+"_head_table"),f=this.dataLayerHeight-g.offsetHeight,m=Math.min(this.customFilterScrollViewRenderHeight,l,f-h);if(this.options.useFilterSearch&&(l=m),a.D.getBoolean(this.headerInfoHash[t.headerID].options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList)){i=this.customFilterList.getMaxItemWidth(),s.clientWidth>i&&(i=s.clientWidth),o=i,this.options.useFilterSearch||this.customFilterScrollViewRenderHeight>=l||(o+=this.getElementById(this.id+"_size_y").clientWidth);var y=this.getElementById(this.id+"_customFilter_scrollView_container");WebSquare.style.setStyle(y,"overflow-x","hidden")}else{var b=parseInt(this.headerInfoHash[t.headerID].options.filterListWidth);o=i=b>0?b:this.options.filterListWidth>0?this.options.filterListWidth:s.clientWidth,this.options.useFilterSearch||m>=l||(i-=this.getElementById(this.id+"_size_y").clientWidth)}this.customFilterScrollView.setPosition(c,p-1),this.customFilterScrollView.setSize(o,m),this.customFilterList.setSize(i,l)}if(this.customFilterList.currentHeaderID=t.headerID,this.options.useFilterSearch){this.removeFocusedCell(),this.customFilterList.dom.input.value="",this.customFilterList.oldSearchedData="";var w=this.customFilterList.getElementById(this.customFilterList.id+"_input"),v=WebSquare.style.getSize(w,"innerwidth")-WebSquare.style.getSize(w,"width");this.customFilterList.dom.input.style.width=i-parseInt(this.customFilterList.getElementById(this.customFilterList.id+"_scroll_main").style.width)-v+"px",this.customFilterList.dom.input.focus()}WebSquare.style.show(this.customFilterScrollView.render)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.moveCustomFilterList=function(t){try{if(this.customFilterScrollView&&this.customFilterList){var e=this.headerToBodyRelation[t],i=this.getCustomFilterListJSON({colID:e,headerID:t});this.customFilterList.setJSON(i),
this.applyFilterListFormat(i,t),this.customFilterList.currentHeaderID=t,this.showCustomFilterList({headerID:t,dataLength:i.length},!0)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.hideCustomFilterList=function(){try{this.customFilterScrollView&&this.customFilterList&&(WebSquare.style.hide(this.customFilterScrollView.render),this.customFilterList.isChanged&&this.options.groupbyFilterBox&&(this.refreshGroupbyFilterBox(),this.customFilterList.isChanged=!1))}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.getCustomFilterListJSON=function(t){try{var e;if(this.customFilterList.filterHistory.column[0]!==t.colID||this.options.showAllFilterList)if(this.options.useFilterSearch){var i=this._dataList.getFilterList();if(i.length>0){var o=!1;1==i.length&&this.getColumnID(i[0].colIndex)===t.colID&&(o=!0)}e=o?this._dataList.filterManager.allRowIndexArr:this._dataList.filteredRowIndexArr}else this.options.showAllFilterList?(this.customFilterList.customFilterListFilterInfo,e=this._dataList.filterManager.firstFiltering?this._dataList.filteredRowIndexArr:this._dataList.filterManager.allRowIndexArr):e=this._dataList.filteredRowIndexArr;else e=this.customFilterList.filterHistory.filteredRowIndexArr[0];var s=this.dataList.getColData(t.colID,e),a=this.getCellInfo(t.colID),n=this.getUniqueValueOfArray(s),l=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];l.push("");var h,d,u=this.changeItemValue("label",t.colID,n.slice(0)),p=this.customFilterStatusObj[t.headerID]||!1,c=WebSquare.language.getMessage("Grid_Customized_Filter")||"사용자필터",g=WebSquare.language.getMessage("Grid_checked_all")||"전체선택",f=[{id1:p,id2:c},{id1:!p,id2:g}];!p&&this.customFilterList.customFilterListFilterInfo&&t.colID in this.customFilterList.customFilterListFilterInfo&&(d=(h=this.customFilterList.customFilterListFilterInfo[t.colID]).slice(0));for(var m=/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,y=this,b=0;b<u.length;b++){var w={};if(d){var v=!1,I=a.itemArr?a.itemHash[u[b]]:u[b];"string"==typeof I&&(I=I.replace(m,(function(t){return y.replacechar(t)})));for(var C=d.length-1;C>-1;C--){if(I==d[C]){v=!0,d.splice(C,1);break}if("string"==typeof d[C]){for(var x=!1,_=0;_<l.length;_++)if(l[_]==d[C]){x=!0;break}if(x&&(u[b]==this.options.useFilterEmptyMsg||u[b]==this.filterEmptyStr)){v=!0;break}}}w.id1=v}else w.id1=!p;w.id2=u[b],this.options.displayValueOnUseFilterList&&(w.id3=n[b]),f.push(w)}var S=0,D=this.headerInfoHash[t.headerID];if(D&&D.options.hideCustomFilter&&(f.shift(),S=1),h){var R=!0,L=f;for(b=2-S;b<L.length;b++)if(!L[b].id1){R=!1;break}f[1-S].id1=!!R}return this._dataList.getDataLength()||(f[1-S].id1=!1),f}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.changeItemValue=function(t,e,i){try{var o=[],s=!1,a=this.getCellInfo(e);if(a.itemHash={},a.itemsetObj&&""!=a.itemsetObj.nodeset&&a.itemsetObj.nodeset.wq_replaceAll(" ","").indexOf("data:")>=0&&(!a.itemArr||a.itemArr.length<1)){a.itemArr=[];var n=a.itemsetObj.nodeset.replace("data:",""),l=this.modelControl.getDataComp(n);if(l&&WebSquare.idCache[l.uuid])switch(l.initializeType){case"linkedDataList":for(var h=[],d={},u=l.getAllNoFilteredData(),p=0;p<l._dataList.getDataLength();p++){var c=u[p*l.cellIdList.length+l.bodyIdColIndexMap[a.itemsetObj.label]],g=u[p*l.cellIdList.length+l.bodyIdColIndexMap[a.itemsetObj.value]];d[c]!=g&&(d[c]=g,h.push({label:c,value:g}))}a.itemArr=h;break;case"dataList":for(h=[],d={},p=0;p<l.getDataLength();p++){c=l.getCellData(p,a.itemsetObj.label),g=l.getCellData(p,a.itemsetObj.value);d[c]!=g&&(d[c]=g,h.push({label:c,value:g}))}a.itemArr=h;break;case"dataMap":for(h=[],d={},p=0;p<l.getCount();p++){c=l.get(a.itemsetObj.label),g=l.get(a.itemsetObj.value);d[c]!=g&&(d[c]=g,h.push({label:c,value:g}))}a.itemArr=h}}if(a.itemArr){var f="label"==t?"value":"label",m=a.itemArr.slice(0);for(p=0;p<i.length;p++)for(var y=m.length-1;y>-1;y--){var b=m[y];if(b[f]==i[p]){o.push(b[t]),m.splice(y,1),"label"==t&&(a.itemHash[b[t]]=b[f]);break}if("label"==t){
if(!i[p]||this.useFilterEmptyValueInfo[i[p]]){s||(s=!0,o.push(this.filterEmptyStr));break}}else if("value"==t&&i[p]==this.filterEmptyStr){for(var w in this.useFilterEmptyValueInfo)o.push(w);break}}}else for(p=0;p<i.length;p++){if("label"==t){if(!i[p]&&0!==i[p]||this.useFilterEmptyValueInfo[i[p]]){s||(s=!0,o.push(this.filterEmptyStr));continue}}else if("value"==t&&i[p]==this.filterEmptyStr){for(var w in this.useFilterEmptyValueInfo)o.push(w);continue}o.push(i[p]),a.itemHash[i[p]]=i[p]}return o}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.resizeGridList=function(){try{var t,e;if(this.groupbyFilterList)return;if(!this.customFilterList)return;t=this.customFilterList,e=this.customFilterScrollView;var i=document.getElementById(this.id+"_"+t.currentHeaderID);if(i){var o=i.clientWidth,s=e.render.clientHeight,n=WebSquare.style.getRelativeTop(i,this.render)+i.offsetHeight+1,l=WebSquare.style.getRelativeLeft(i,this.render);(a.D.getBoolean(this.getHeaderInfo(t.currentHeaderID).options.autoFitFilterList)||a.D.getBoolean(this.options.autoFitFilterList))&&(this.customFilterList?s<t.render.clientHeight?(o=Math.max(o,this.customFilterList.getMaxItemWidth()),o+=this.getElementById(this.id+"_size_y").clientWidth):o=Math.max(o,this.customFilterList.getMaxItemWidth()):this.groupbyFilterList&&(o=Math.max(o,this.groupbyFilterList.getMaxItemWidth()))),e.setPosition(l,n),t.setSize(o,null),e.setSize(o,s)}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.showGroupbyHeaderGhost=function(t,e){try{var i=this.getHeaderValue(e);WebSquare.dragdrop.gDragManager.activate(t,null,{id:this.id+"_drag",className:"w2grid_groupbyZone_header_drag",contents:i,delay:15,applyMousePosition:!0,onDrop:function(t,e,i,o,s,r,a){}})}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setAdaptiveColumnVisible=function(t,e){try{if(this.hiddenAdaptiveList[t]==!e||t>=this.hiddenAdaptiveList.length)return;var i=this;function r(t){var e=i.getColumnID(t),o=null!=i.bodyToHeaderRelation[e]?i.getHeaderLayer(i.bodyToHeaderRelation[e]):null;return null!=o?o:r(t-1)}var o=r(t),s=document.getElementsByClassName(this.id+"_columnstyle_"+(t-this.defaultColCnt)+"_"),a=this.getColumnStyleValue(t-this.defaultColCnt,"height");if(null==this.oldOptions.headerColBorder&&null!=o&&(this.oldOptions.headerColBorder=WebSquare.style.getStyle(o,"border-top")),null==this.oldOptions.headerPaddingTop&&null!=o&&(this.oldOptions.headerPaddingTop=WebSquare.style.getStyle(o,"padding-top")),null==this.oldOptions.headerPaddingBottom&&null!=o&&(this.oldOptions.headerPaddingBottom=WebSquare.style.getStyle(o,"padding-bottom")),s.length>0&&""!=this.oldOptions.bodyColBorder&&(this.oldOptions.bodyColBorder=WebSquare.style.getStyle(s[0],"border-top")),this.hasSubtotal)for(var n=0,l=0,h=this.drawedSubtotal[0][0].childNodes,d=0;d<h.length&&((w=parseInt(h[d].getAttribute("colSpan")))||(w=1),!(l<=t&&t<l+w));d++)l+=w,n++;if(this.hasFooter){var u=0,p=0,c=this.htmlInfo.foot.rowArr;for(d=0;d<c.length;d++)for(var g=c[d],f=0;f<g.length;f++){var m=g[f];if((w=parseInt(m.colSpan))||(w=1),p<=t-this.defaultColCnt&&t-this.defaultColCnt<p+w)break;p+=w,u++}}if(e){o.style.height=a,o.style.removeProperty("padding"),o.style.borderTop=this.oldOptions.headerColBorder;for(d=0;d<s.length;d++)s[d].style.height=a,s[d].style.removeProperty("padding"),s[d].style.borderTop=this.oldOptions.bodyColBorder;if(this.setAdaptiveColumnStyle(t,"height",a),this.setAdaptiveColumnStyle(t,"padding",""),this.setAdaptiveColumnStyle(t,"border-top",this.oldOptions.bodyColBorder),this.hasFooter)for(d=0;d<c.length;d++){m=c[d][u];var y=parseInt(this.getFooterStyle(m.id,"height"))+parseInt(o.offsetHeight);!(w=parseInt(m.colSpan))||parseInt(this.getFooterStyle(m.id,"height"))<=0?(this.setFooterStyle(m.id,"height",o.style.height),this.setFooterStyle(m.id,"padding",o.style.padding),this.setFooterStyle(m.id,"borderTop",o.style.borderTop)):this.setFooterStyle(m.id,"height",y+"px")}
if(this.hasSubtotal)for(d=0;d<this.drawedSubtotal.length;d++)for(f=0;f<this.drawedSubtotal[d].length;f++){var b=this.drawedSubtotal[d][f].childNodes;y=parseInt(b[n].style.height)+parseInt(o.offsetHeight);!(w=parseInt(b[n].getAttribute("colSpan")))||parseInt(b[n].style.height)<=0?(b[n].style.height=o.style.height,b[n].style.padding=o.style.padding,b[n].style.borderTop=o.style.borderTop):b[n].style.height=y+"px"}}else{if(this.hasFooter)for(d=0;d<c.length;d++){m=c[d][u],y=parseInt(this.getFooterStyle(m.id,"height"))-parseInt(o.offsetHeight);!(w=parseInt(m.colSpan))||y<=0?(this.setFooterStyle(m.id,"height","0px"),this.setFooterStyle(m.id,"padding","0px"),this.setFooterStyle(m.id,"borderTop","0px")):this.setFooterStyle(m.id,"height",y+"px")}if(this.hasSubtotal)for(d=0;d<this.drawedSubtotal.length;d++)for(f=0;f<this.drawedSubtotal[d].length;f++){var w;b=this.drawedSubtotal[d][f].childNodes,y=parseInt(b[n].style.height)-parseInt(o.offsetHeight);!(w=parseInt(b[n].getAttribute("colSpan")))||y<=0?(b[n].style.height="0px",b[n].style.padding="0px",b[n].style.borderTop="0px"):b[n].style.height=y+"px"}var v=parseInt(o.colSpan,10),I=!1;if(v>1)for(var C=this.headerToBodyRelation[o.getAttribute("header_id")],x=this.getColumnIndex(C),_=x;_<x+v;_++)this.hiddenList[_]||(I=!0);(v<2||!I)&&(o.style.height="0px",o.style.padding="0px",o.style.borderTop="0px");for(d=0;d<s.length;d++)s[d].style.height="0px",s[d].style.padding="0px",s[d].style.borderTop="0px";this.setAdaptiveColumnStyle(t,"height","0px"),this.setAdaptiveColumnStyle(t,"padding","0px"),this.setAdaptiveColumnStyle(t,"border-top","0px")}parseInt(o.colSpan,10)>1&&this.setAdaptiveGridHeaderHeight(),this.hiddenAdaptiveList[t]=!e}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.applyFilterHistory=function(){try{if(this.getElementById(this.id+"_groupbyFilterBox_apply").checked=this.groupbyFilterBox_history.length>0,!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var t=this.groupbyFilterBox_select.getSelectedIndex(),e=this.groupbyFilterBox_history[t];if(e.groupbyOptions)this.groupby(JSON.parse(e.groupbyOptions,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:e}catch(t){return e}}))),this.customFilterList&&(this.customFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={};else{for(var i in this.groupbyStatus.grouped&&this.clearGroupby(),this._dataList.clearFilter(e.filterOption.length>0),this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],this.headerInfoHash){var o=this.getElementById(this.id+"_"+i+"_filter");o&&WebSquare.style.removeClass(o,"w2grid_customFilter_filter")}this.refreshCustomFilterHistory(t),this._dataList.broadcast({gridView:["clearHeaderSort"]}),this._dataList.broadcast({gridView:["notifyMultisort"]})}}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._refreshCustomFilterHistory=function(t,e,i){try{for(var o=t?JSON.parse(t,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):[],s="",a="",n=0;n<o.length;n++){var l=o[n];l.noRefresh=n<o.length-1,l.keepTop=!1,l.internal=!0;var h="";for(var d in l.bodyIdColIndexMap)l.bodyIdColIndexMap[d]===l.colIndex&&(h=d);"sort"!==l.type&&(s=',"'+h+'"'+s,a=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+a),this._dataList.setFilter(l);var u=this.bodyToHeaderRelation[this._dataList.cellIdList[l.colIndex]],p=this.getElementById(this.id+"_"+u+"_filter");p&&WebSquare.style.addClass(p,"w2grid_customFilter_filter")}s=s.slice(1)+"],",a=a.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var c='{"column":['+s+'"filteredRowIndexArr":['+a;this.customFilterList.filterHistory=JSON.parse(c),
this.customFilterList.customFilterListFilterInfo=e?JSON.parse(e,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):{},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),this.customFilterStatusObj=i?JSON.parse(i):{},this.groupbyStatus.grouped||this.drawHeaderSortImages()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.refreshCustomFilterHistory=function(t){try{for(var e=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()],i="",o="",s=0;s<e.filterOption.length;s++){var a=e.filterOption[s];a.noRefresh=s<e.filterOption.length-1,a.keepTop=!1,a.internal=!0;var n="";for(var l in a.bodyIdColIndexMap)a.bodyIdColIndexMap[l]===a.colIndex&&(n=l);"sort"!==a.type&&(i=',"'+n+'"'+i,o=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+o),this._dataList.setFilter(a);var h=this.bodyToHeaderRelation[this._dataList.cellIdList[a.colIndex]],d=this.getElementById(this.id+"_"+h+"_filter");d&&WebSquare.style.addClass(d,"w2grid_customFilter_filter")}i=i.slice(1)+"],",o=o.slice(1)+"]}",this.customFilterList||this.createCustomFilterList(null,!0);var u='{"column":['+i+'"filteredRowIndexArr":['+o;this.customFilterList.filterHistory=JSON.parse(u),e.customFilterListFilterInfo?this.customFilterList.customFilterListFilterInfo=JSON.parse(e.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}})):this.customFilterList.customFilterListFilterInfo={},this.groupbyFilterList&&(this.groupbyFilterList.filterHistory={column:[],filteredRowIndexArr:[]}),e.customFilterStatusObj?this.customFilterStatusObj=JSON.parse(e.customFilterStatusObj):this.customFilterStatusObj={}}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.clearFilterHistory=function(){try{this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!1,this.groupbyFilterBox_history=[],this.groupbyFilterBox_select.removeAll(),this.groupbyStatus.grouped?this.clearGroupby():this._dataList.clearFilter()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.refreshGroupbyFilterBox=function(){try{var t=this._dataList.getFilterList(),e="",i=!(!this.options.customFilterBox||!this.groupbyStatus.groupbyOptions),o=i?"[Groupby] ":"";if(!this.options.customFilterBox&&!this.groupbyStatus.groupbyOptions)return;e+=o,e+="(";for(var s,n=null,l="",h=!0,d=o,u=!1,p=this.options.groupbyFilterBoxLabelSize,c=0;c<t.length;c++){var g="regExp"===(S=t[c]).type,f="func"===S.type&&S.param;if(g||f){h||(e+=" "+S.condition+" ",d+=S.condition),e+="(";var m=this._dataList.cellIdList[S.colIndex],y=this.getHeaderValue(this.bodyToHeaderRelation[m])||m;if(g){var b=this.dataList.getColData(m,this._dataList.filteredRowIndexArr);if((L=this.getUniqueValueOfArray(b)).length<=0){if(a.D.isNullReg(S.key)){n=m,l=y;break}continue}for(var w=0,v=0;v<L.length;v++){var I=L[v];this.useFilterEmptyValueInfo[I]&&(I=this.filterEmptyStr),w>0&&(w<p&&(e+=" OR "),d+="OR"),w<p&&(e+=y+" = "+I),d+=m+"="+I,w++}w>p&&(e+=" OR ... ("+(w-p)+" omitted)")}else if(f)for(v=0;v<S.param.length;v++){null!=(A=S.param[v]).radio&&(e+=1===A.radio?" OR ":" AND ",d+=1===A.radio?" OR ":" AND ");var C="string"==typeof A.auto?A.auto.replace(/[\\](?![\\])/g,""):A.auto;e+=y+" "+this.selectboxItemSet[A.select-1]+" "+C,d+=m+" "+this.selectboxItemSet[A.select-1]+" "+A.auto}e+=")",h=!1}}if(e+=")",n&&(e=o+"("+l+" = NULL)",d=o+n+"_NULL_"),"()"!==e&&e!==o+"()"||(e=o+"ALL",d=o+"_ALL_",u=!0),!u&&this.options.groupbyFilterBoxFormatter){var x=a.D.getGlobalFunction(this.options.groupbyFilterBoxFormatter,this.scope_id);if("function"==typeof x){var _=[];if(d===o+n+"_NULL_")_.push({header:l,filter:[]
});else for(c=0;c<t.length;c++){var S;g="regExp"===(S=t[c]).type,f="func"===S.type&&S.param;if(g||f){m=this._dataList.cellIdList[S.colIndex];var D=this.getHeaderValue(this.bodyToHeaderRelation[m])||m;if(g){var R={header:D,filter:[]},L=(b=this.dataList.getColData(m,this._dataList.filteredRowIndexArr),this.getUniqueValueOfArray(b)),T=[];for(v=0;v<L.length;v++){I=L[v];this.useFilterEmptyValueInfo[I]&&(I=this.filterEmptyStr),T.push(I)}var k=this.getCellInfo(m);R.filter.push({operator:"in",values:T,labels:k.itemsetObj||k.itemArr?this.changeItemValue("label",m,L.slice(0)):T}),_.push(R)}else if(f){for(R={header:D,filter:[]},v=0;v<S.param.length;v++){var A=S.param[v],F={};null!=A.radio&&(F.gate=1===A.radio?"or":"and"),F.operator=this.selectboxItemSet[A.select-1];C="string"==typeof A.auto?A.auto.replace(/[\\](?![\\])/g,""):A.auto;F.values=C;k=this.getCellInfo(m);F.labels=k.itemsetObj||k.itemArr?this.changeItemValue("label",m,[C])[0]:C,R.filter.push(F)}S.param.length>0&&_.push(R)}}}var E=x.call(this,_,i);null!=E&&!1!==E&&(e=E)}}if(!u&&!1===this.groupbyFilterBox_select.setValueNM(d))this.groupbyFilterBox_select.addItem(d,e),this.groupbyFilterBox_select.setValueNM(d),d===o+"_ALL_"?s={filterOption:[],customFilterStatusObj:"{}"}:(s={filterOption:t,customFilterStatusObj:JSON.stringify(this.customFilterStatusObj)},this.groupbyStatus.grouped&&this.groupbyStatus.filter?s.customFilterListFilterInfo=JSON.stringify(this.groupbyStatus.filter,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})):this.customFilterList&&this.customFilterList.customFilterListFilterInfo&&(s.customFilterListFilterInfo=JSON.stringify(this.customFilterList.customFilterListFilterInfo,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})))),this.groupbyStatus.groupbyOptions&&(s.groupbyOptions=this.groupbyStatus.groupbyOptions),this.groupbyFilterBox_history.push(s);this.getElementById(this.id+"_groupbyFilterBox_apply").checked=!u}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype._getMouseColumnIndex=function(t){try{var e=t.colIndex,i=t.offsetX,o=t.offsetLeft,s=t.colSpan;if(i-o<(n=.3*this.colWidthList[e]>10?10:parseInt(.3*this.colWidthList[e],10))&&0!=e)e--;else for(var a=0;a<s;a++){var n,l=this.colWidthList[(e+a)%this.columnOrder.length];if((o+=l)-(n=.3*l>10?10:parseInt(.3*l,10))<i&&i<o+n){e+=a;break}}return e}catch(t){return r.w.printStackTrace(t,null,this),e}},p.prototype._useRole=function(){try{return!a.D.isMobile()}catch(t){r.w.printStackTrace(t,null,this)}},p.prototype.setAdaptive=function(){try{var t=this.options.adaptive,e=parseInt(this.options.adaptiveThreshold)||480;for(var i in this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}"crosstab"==t&&(a.D.isIE()&&parseInt(s.v.browserVersion(),10)<10||(parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=e?this.addAdaptive():this.removeAdaptive()))}catch(t){r.w.printStackTrace(t)}},p.prototype.addAdaptive=function(){try{var t,e=this.options.adaptive;for(var i in"crosstab"==e&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}if(!this.hasClass(t)){this.oldOptions.visibleRowNum=this.options.visibleRowNum,this.options.visibleRowNum="all",this.adjustDraw(this.lastIndex),this.addClass(t),this.setAdaptiveGridBodyHeight(),this.setAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(var o=this.defaultColCnt;o<this.hiddenList.length;o++)1==this.hiddenList[o]&&this.setAdaptiveColumnVisible(o,!1)
;this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}if(this.options.adaptiveSlideHeader){var s=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody");this.slideHeadObj||(this.slideHeadObj={},this.slideHeadObj.render=s,this.slideHeadObj.headTableWidth=s.offsetWidth,this.slideHeadObj.hidden=!1),"absolute"!=this.slideHeadObj.render.style.position?n.scrollWidth>n.clientWidth+this.slideHeadObj.headTableWidth&&(this.slideHeadObj.render.style.position="absolute",this.options.adaptiveSlideHeaderOnScroll||($(this.slideHeadObj.render.firstChild).animate({width:"hide"}),this.slideHeadObj.hidden=!0)):n.scrollWidth==n.clientWidth&&(a.D.clearTimeout(this.id+"_adaptiveSlideHeader"),this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1)}}catch(t){r.w.printStackTrace(t)}},p.prototype.removeAdaptive=function(){try{var t;if("crosstab"==this.options.adaptive&&(t=this.hasFooter?"w2grid_adaptive_crosstab w2grid_adaptive_crosstab_footer":"w2grid_adaptive_crosstab"),this.options.adaptiveSlideHeader&&this.slideHeadObj&&(this.slideHeadObj.render.style.position="",this.slideHeadObj.render.firstChild.style.display="",this.slideHeadObj.hidden=!1),this.hasClass(t)){this.options.visibleRowNum=this.oldOptions.visibleRowNum;for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);if(this.removeClass(t),this.removeAdaptiveGridBodyHeight(),this.removeAdaptiveGridHeaderHeight(),this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),""!=this.options.visibleRowNum){this.focusedCell=[],this.initializeDrawController(),this.dataRowList=[],this.drawedRowLength=0,this.lastDisplayedRow=-1;for(var i=this.getElementById(this.id+"_body_tbody");i.firstChild;)i.removeChild(i.firstChild);if(this.options.senseReader){for(e=0;e<this.adaptiveEmbeddedInputIdList.length;e++)delete this.dom[this.adaptiveEmbeddedInputIdList[e]];this.adaptiveEmbeddedInputIdList=[]}this.drawDataTable(0)}this.event.removeEvent(this.id+"_body_tbody","onscroll")}}catch(t){r.w.printStackTrace(t)}},p.prototype.doAdaptive=function(){try{if(""!=this.options.adaptive)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="9999999",this.setAdaptive(),this.adaptiveDoneBy="doAdaptive"}catch(t){r.w.printStackTrace(t)}},p.prototype.undoAdaptive=function(){try{if("doAdaptive"!=this.adaptiveDoneBy)return;this.options.adaptive="crosstab",this.options.adaptiveThreshold="1",this.setAdaptive(),this.options.adaptive="",this.options.adaptiveThreshold="",this.adaptiveDoneBy=""}catch(t){r.w.printStackTrace(t)}},p.prototype.checkRefreshAdaptive=function(){try{var t=!1;if(!(a.D.isIE()&&parseInt(s.v.browserVersion(),10)<10)){var e=WebSquare.BootLoader.fullViewed||!1,i=a.D.fullViewed||!1;if(!e&&!i&&this.checkAdaptiveGridType()&&(""!=this.options.adaptive||0!=Object.keys(this.hideThresholdObj).length)){var o=this.options.adaptive,n=parseInt(this.options.adaptiveThreshold)||480;"crosstab"==o&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=n&&(t=!0)}}return t}catch(t){r.w.printStackTrace(t)}},p.prototype.refreshAdaptive=function(t){try{if(!0===this.checkRefreshAdaptive())if(t&&!0===t.simple){for(var e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);for(var i in this.hasSubtotal&&this.removeAdaptiveGridSubtotalHeight(),this.hideThresholdObj){parseInt(this.hideThresholdObj[i])>=parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)?this.setColumnVisible(i,!1):this.setColumnVisible(i,!0)}this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!1)}else this.removeAdaptive(),this.addAdaptive()
}catch(t){r.w.printStackTrace(t)}};var c=function(){};c.prototype.setTableLayout=function(){try{this.initializeHead(),this.initializeFooter(),this.setDataLayerPosition(),this.arrangeOverflowXScroll(),this.handlerResize_drawInitializer(),this.setTrRowTable(),this.setTrSubtotalRowTable(),this.initialColWidthList=this.colWidthList.slice(),this.initialGridWidth=this.gridWidth,this._setAutoFit(),this.realRowDataLength=this.oneRowDataLength+this.defaultColCnt,this.associateHeaderBody(),this.options.columnMove&&this.createBlockedHeaderInfo(),this.lastDisplayedRow=-1;for(var t=0;t<this.oneRowDataLength;t++){var e=this.cellInfoHash2[this.tdIdList[t]],i=new WebSquare.uiplugin.cellInfo(e,this);"textarea"==i.options.inputType&&(this.isExistTextarea=!0),i.options.colMerge&&(this.isColMerge=!0,a.D.getBoolean(this.options.colMergeAnd)&&(this.isColMergeAnd=!0),i.options.upperColumn&&(this.upperToLowerColumnRelation[i.options.upperColumn]||(this.upperToLowerColumnRelation[i.options.upperColumn]=[]),this.upperToLowerColumnRelation[i.options.upperColumn].push(i.options.id))),null!=i.options.maxLength&&""!==i.options.maxLength&&(i.options.maxlength=i.options.maxLength),this.cellInfoHash[i.id]=i,this.cellIdList.push(i.id);var o=i.options.hideThreshold;void 0!==o&&(this.hideThresholdObj[i.id]=o)}this.drawFooter(),this.drawHeader();for(var s=0;s<this.thIdList.length;s++){var n=this.headerInfoHash2[this.thIdList[s]];if(n){var l=new WebSquare.uiplugin.headerInfo(n,this);this.headerInfoHash[l.id]=l,this.colMoveHeaderIndexMap[l.id]=s}}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setDataLayerPosition=function(){try{var t=this.getElementById(this.id+"_dataLayer");if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table").offsetHeight;e=0==e?this.footerHeight:e,t.style.bottom=e+"px"}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.arrangeOverflowXScroll=function(t){try{this.fixedWidth=0;for(var e=this.getFixedColumnLastIndex(),i=0;i<e;i++)this.hiddenList[i]||(this.fixedWidth+=this.colWidthList[i]);this.fixedWidth=parseInt(this.fixedWidth,10)||0,this.fixedWidthRight=0;var o=this.getFixedRightColumnLastIndex(),s=this.colWidthList.length;for(i=s-1;i>=o;i--)this.hiddenList[i]||(this.fixedWidthRight+=this.colWidthList[i]);if(this.fixedWidthRight=parseInt(this.fixedWidthRight,10)||0,e>this.defaultColCnt||o<s)for(var a=this.getColumnCount(),n=this.data_td_list.length/a,l=0;l<n+1;l++){var h;if(e>this.defaultColCnt)(h=this.data_td_list[l*a+(e-this.defaultColCnt)])&&this.addClass(h,"w2grid_fixedColumn");if(o<s)(h=this.data_td_list[l*a+(o-this.defaultColCnt)])&&this.addClass(h,"w2grid_fixedRightColumn")}if(!0!==t){var d=this.getElementById(this.id+"_scrollX_div"),u=this.getElementById(this.id+"_scrollX_table"),p=0===d.offsetWidth?0:d.offsetWidth-u.offsetWidth,c=this.getElementById(this.id+"_scrollX_left"),g=this.getElementById(this.id+"_scroll_size"),f=this.getElementById(this.id+"_scrollX_fixedRight");c.style.width=this.fixedWidth+"px",g.style.width=this.gridWidth-this.fixedWidth-this.fixedWidthRight-p+"px",f.style.width=this.fixedWidthRight+"px"}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.handlerResize_drawInitializer=function(){try{if(0==this.render.offsetWidth||0==this.render.offsetHeight)return;if(this.setOverflowY(),this.setOverflowX(),this.setIE6Fix(),this.options.headFiller){var t=this.getElementById(this.id+"_header_bg_td"),e=this.getElementById(this.id+"_dataLayer").offsetWidth-1,i=this.getElementById(this.id+"_head_table").offsetHeight,o=e,s=i;for(t.style.width=e+"px";t.offsetWidth!=o;)t.offsetWidth>o?e--:e++,t.style.width=e+"px";for(t.style.height=i+"px";t.offsetHeight!=s;)t.offsetHeight>s?i--:i++,t.style.height=i+"px"}if(this.options.groupbyZone){var a=this.getElementById(this.id+"_main_div"),n=this.groupbyZoneStatus.groupbyZoneRender?this.groupbyZoneStatus.groupbyZoneRender.offsetHeight:0;if(this.isIE6or7&&(a.style.height=a.offsetHeight-n),this.options.groupbyFilterBox){
var l=this.getElementById(this.id+"_groupbyFilterBox_div"),h=this.getElementById(this.id+"_groupbyFilterBox_buttons");if(this.isIE6or7){a.style.height=a.offsetHeight-(this.scrollLayerWidthSize+l.offsetHeight)-3+"px",h.style.left=-h.offsetWidth;var d=this.scrollLayerWidthSize+l.offsetHeight+n,u=Math.ceil(d/this.oneRowScrollHeight),p=this.getElementById(this.id+"_scrollY_div");this.lastIndex>-1&&this.lastIndex>u&&p.offsetHeight<p.scrollHeight&&this.cutGridBottom(this.lastIndex-u)}else"bottom"===this.options.groupbyFilterBoxLocation&&(a.style.bottom=this.scrollLayerWidthSize+l.offsetHeight+"px",a.style.height="")}else this.isIE6or7&&this.cutGridBottom(this.lastIndex-Math.ceil(n/this.oneRowScrollHeight))}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setIE6Fix=function(){try{var t=this.options.fixPrint&&(a.D.isIE(9)||a.D.isIE(10)||s.v.browserCheck.ieAllVersion&&"11"==document.documentMode||a.D.isFF());if(this.isIE6or7||a.D.isOpera()||t){var e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_scrollY_div"),o=this.getElementById(this.id+"_main_div"),n=this.render.offsetHeight-e.offsetHeight,l=this.render.offsetWidth-i.offsetWidth+2;n=n<0?0:n,l=l<0?0:l,o.style.height=n+"px",o.style.width=l+"px";var h,d=0;if(this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d),""!==this.options.visibleRowNum){var u=this.getElementById(this.id+"_body_table");h=!this.defaultDataLayerHeight||u.offsetHeight>this.defaultDataLayerHeight?u.offsetHeight+d:this.defaultDataLayerHeight+d}else h=n-d-1;h=h<0?0:h;var p=this.getElementById(this.id+"_dataLayer");p.style.height=h+"px",this.dataLayerHeight=h;var c=this.getElementById(this.id+"_scrollX_right");c.style.width=c.parentNode.offsetWidth+"px",t&&(o.style.position="relative",o.style.bottom="",o.style.right="",p.style.position="relative",p.style.bottom="")}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype._setOverflowXNative=function(t){if("native"===this.options.drawType){var e=document.getElementById(this.id+"_scrollX_div"),i=document.getElementById(this.id+"_dataLayer");if(!1===t||this.options.fixedColumn<=0&&this.options.fixedRightColumn<=0)return e.style.visibility="hidden",void(i.style.overflowX="auto");!0===t&&(e.style.visibility="visible",i.style.overflowX="hidden")}},c.prototype.setOverflowX=function(t){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowX=t):e=!1,t=this.isMobile?"hidden":this.options.overflowX){case"auto":this.setOverflowXAuto();break;case"hidden":this.setOverflowXHidden();break;default:this.setOverflowXScroll()}this.isMobile&&this.setIScrollX(),e&&this.setIE6Fix()},c.prototype.setOverflowXAuto=function(){var t=this.getElementById(this.id+"_scrollX_div"),e=this.getElementById(this.id+"_scrollX_left"),i=this.getElementById(this.id+"_scrollX_right"),o=e.offsetWidth;if(this.options.fixedRightColumn){var s=this.getElementById(this.id+"_scrollX_fixedRight");s&&(o+=s.offsetWidth)}i.firstChild.offsetWidth>t.offsetWidth-o?this.setOverflowXScroll():this.setOverflowXHidden()},c.prototype.setOverflowXScroll=function(){try{var t=(l=this.getElementById(this.id+"_scrollX_div")).style.height;if(l.style.height=this.scrollLayerWidthSize+"px",this.options.scrollFocus){var e=this.getElementById(this.id+"_scrollX_right"),i=this.getElementById(this.id+"_scrollX_left");e.setAttribute("aria-hidden","true"),e.firstChild.offsetWidth>l.offsetWidth-i.offsetWidth?e.setAttribute("tabIndex","0"):e.setAttribute("tabIndex","-1")}var o=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"===t&&!o&&"native"!==this.options.drawType)if(""!==this.options.visibleRowNum){var s=parseInt(this.render.style.height,10);this.setSize(null,s+this.scrollWidthSize)}else{this.dataLayerHeight-=this.scrollWidthSize;var a=this.dataRowList[(this.lastIndex+1)*this.oneRowLength-1]
;a&&a.offsetTop+a.offsetHeight>this.dataLayerHeight&&(this._setRowDisplay(this.lastIndex,"none"),this.lastIndex=this.lastIndex-1,this.maxRowLength=this.maxRowLength-1,this.lastDisplayedRow=this.lastIndex,this.lastTopRowIndex=null,this.setScrollYHeight({noDraw:!0}),this.setOverflowYAuto())}if(!this.isIE6or7){var n=this.getElementById(this.id+"_main_div"),l=this.getElementById(this.id+"_scrollX_div"),h=parseInt(l.style.height,10);if(n.style.bottom=h+"px",this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation){var d=this.getElementById(this.id+"_groupbyFilterBox_div");n.style.bottom=this.scrollLayerWidthSize+d.offsetHeight+"px"}}if(o)(d=this.getElementById(this.id+"_groupbyFilterBox_div")).style.bottom=this.scrollLayerWidthSize+"px"}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setOverflowXHidden=function(){try{var t=this.getElementById(this.id+"_scrollX_div"),e=t.style.height;if(t.style.height="0px",this.options.scrollFocus){var i=this.getElementById(this.id+"_scrollX_right"),o=this.getElementById(this.id+"_scrollX_left");i.setAttribute("aria-hidden","true"),i.firstChild.offsetWidth>t.offsetWidth-o.offsetWidth?i.setAttribute("tabIndex","0"):i.setAttribute("tabIndex","-1")}"0px"!=e&&this.handleScrollX();var s=this.options.groupbyZone&&this.options.groupbyFilterBox&&"bottom"===this.options.groupbyFilterBoxLocation;if(-1!==this.rowIndex&&"0px"!==e&&!s&&"native"!==this.options.drawType)if(""!==this.options.visibleRowNum){var a=parseInt(this.render.style.height,10);this.setSize(null,a-this.scrollWidthSize)}else{this.dataLayerHeight+=this.scrollWidthSize,this.maxRowLength=this.maxRowLength+1;var n=this.getDataLength();this.maxRowLength>=n&&(this.getElementById(this.id+"_size_y").style.height="0px"),this.setOverflowYAuto(),this.drawData(this.rowIndex,this.lastIndex);for(var l=0;l<this.tdIdList.length;l++){var h=this.cellInfoHash[this.tdIdList[l]];if(h.dataComp){var d=this.modelControl.getDataComp(h.dataComp);"linkedDataList"===d.initializeType&&d.syncWithParent()}}this.lastTopRowIndex=null}var u=this.getElementById(this.id+"_main_div");if(this.isIE6||(u.style.bottom="0px"),s)this.getElementById(this.id+"_groupbyFilterBox_div").style.bottom="0px"}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setOverflowY=function(t){if("native"!==this.options.drawType){var e=!0;switch(void 0!==t?("hidden"!=t&&"auto"!=t&&"scroll"!=t&&(t="auto"),this.options.overflowY=t):e=!1,t=this.isMobile?"hidden":this.options.overflowY){case"auto":this.setOverflowYAuto();break;case"hidden":this.setOverflowYHidden();break;default:this.setOverflowYScroll()}this.isMobile&&this.setIScrollY(),e&&this.setIE6Fix()}},c.prototype.setOverflowYAuto=function(){if("native"!==this.options.drawType){var t=this.getElementById(this.id+"_scrollY_div");t.offsetHeight<t.scrollHeight?this.setOverflowYScroll():this.setOverflowYHidden()}},c.prototype.setOverflowYScroll=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=this.getElementById(this.id+"_scrollX_div"),i=this.getElementById(this.id+"_main_div"),o=parseInt(t.style.width,10);if(t.style.width=this.scrollLayerWidthSize+"px",t.style.overflowY="scroll",this.isIE6){var s=this.render.offsetWidth-this.scrollWidthSize;e.style.width=(s>0?s:0)+"px",t.style.height=this.render.offsetHeight+"px"}else i.style.right=this.scrollWidthSize-1+"px",e.style.right=this.scrollWidthSize+"px";this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);0==o&&this._setAutoFit(),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1"))},c.prototype.setOverflowYHidden=function(){var t=this.getElementById(this.id+"_scrollY_div"),e=parseInt(t.style.width,10);t.style.width="0px",t.style.overflowY="hidden";var i=this.getElementById(this.id+"_main_div");this.isIE6||(i.style.right="0px",
this.getElementById(this.id+"_scrollX_div").style.right="0px");this.options.groupbyZone&&this.options.groupbyFilterBox&&(this.getElementById(this.id+"_groupbyFilterBox_div").style.right=i.style.right);0!=e&&this._setAutoFit(),this.options.scrollFocus&&(t.setAttribute("aria-hidden","true"),t.offsetHeight<t.scrollHeight?t.setAttribute("tabIndex","0"):t.setAttribute("tabIndex","-1"))},c.prototype.setTrRowTable=function(){try{this.tempDiv=document.createElement("div"),this.tempDiv.style.width="0px",this.tempDiv.style.height="0px",this.tempDiv.style.overflow="hidden",this.tempDiv.innerHTML="<table id='tempTable' style='table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.htmlInfo.body,"tbody","td",this.options.bodyTdClass)+"</table>",this.tempTr=this.tempDiv.getElementsByTagName("table")[0];var t=this.tempTr.getElementsByTagName("td");this.aria_labelledby=[];for(var e=0;e<t.length;e++)this.options.autoScope&&0==e&&t[e].setAttribute("scope","row"),this.aria_labelledby[e]=t[e].getAttribute("aria-labelledby"),t[e].innerHTML="";this.tempDiv.id=this.id,this.tempDiv.className=this.options.className+" w2grid",this.render.parentNode.appendChild(this.tempDiv);var i,o=this.tempDiv.getElementsByTagName("tbody")[0],s=o.getElementsByTagName("tr")[0];0==(i=s?s.offsetHeight:o.offsetHeight)?(i=-1!=this.options.defaultCellHeight?this.options.defaultCellHeight:20,this._visibleRowNumFixResetFlag=!0):this._visibleRowNumFixResetFlag=!1,this.oneRowHeight=i+(a.D.isIE(6)||a.D.isIE(7)?1:0),this.options.scrollRowHeight&&(this.oneRowScrollHeight=this.oneRowHeight),this.render.parentNode.removeChild(this.tempDiv)}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setTrSubtotalRowTable=function(){try{for(var t in this.subtotalTableList={},this.subtotalStrList){var e=document.createElement("div");e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",this.subtotalClassList&&this.subtotalStrList[t].attr?e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.subtotalStrList[t].attr.subtotalClass)+"</table>":e.innerHTML="<table id='tempTable' style='width:100%;table-layout:fixed; border-collapse:collapse; border-spacing:0px;'>"+this.getTableHtml(this.subtotalStrList[t],"tbody","td",this.options.subtotalTdClass)+"</table>";for(var i=e.getElementsByTagName("table")[0],o=i.getElementsByTagName("td"),s=0;s<o.length;s++){var a=o[s],n=a.getAttribute("width");n&&(a.removeAttribute("width"),a.setAttribute("or_wd",n))}this.subtotalTableList[t]=i}}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype._setAutoFit=function(t){if(0!=this.render.offsetWidth&&0!=this.render.offsetHeight){this.autofitDone=!0;var e=(t=t||{}).type?t.type:this.options.autoFit;"none"!==e&&e||(e="clear");var i=t.exceptCol,o=t.exceptWidth||0,s=this.options.autoFitFixYScroll?this.scrollLayerWidthSize:parseInt(this.getElementById(this.id+"_scrollY_div").style.width,10),r=this.render.clientWidth;a.D.isIEAllVersion()&&(r=this.render.clientWidth||parseInt(this.render.style.width,10)||parseInt(WebSquare.style.getComputedStyle(this.render,"width"),10)),this.autofit_clientWidth=r;for(var n=0,l=this.colWidthList.length-1;l>=0;l--)if(0==this.hiddenList[l]){n=l;break}if("selectedColumn"==e&&!this.autofitColumn){if(this.gridWidth>=r)return;this.autofitColumn=!0;var h=this.defaultColCnt+t.colIndex;this.gridWidth-=this.colWidthList[h],this.autofitColumnIndexArr.push(h),this.colWidthList[h]="*",this.autofitColumnWidthArr[h]="*"}if(this.autofitColumn){var d=r,u=this.autofitColumnIndexArr.slice();s>0&&(d-=s);for(l=u.length-1;l>=0;l--){var p=u[l];1!=this.hiddenList[p]&&p!==i||u.splice(l,1)}var c=0,g=[];for(l=0;l<this.colWidthList.length;l++)if(1!=this.hiddenList[l])if(l===i)this._setColumnWidth(l,o),d-=o;else if(l<this.autofitColumnWidthArr.length&&this.autofitColumnWidthArr[l]){
var f=this.autofitColumnWidthArr[l].substring(0,this.autofitColumnWidthArr[l].indexOf("*"));f.length>0?g.push(parseInt(f,10)):0==f.length&&g.push(1)}else d-=this.colWidthList[l];var m=function(t){if(!t.length)return 0;for(var e,i=t.length-1,o=t[i];i;)for(var s=t[--i];e=s%o;s=o,o=e);return o}(g);for(l=0;l<g.length;l++)g[l]=g[l]/m,c+=g[l];var y=Math.floor(d/c),b=d-y*c;for(l=0;l<u.length;l++){var w=this.options.autoFitMinWidth||0,v=y*g[l];g[l]=Math.max(v,w)}if(b>0)if(1==u.length)g=[d];else{var I=g.slice();for(l=b;l>0;l--){for(var C={},x=0;x<g.length;x++)if(1!=this.hiddenList[u[x]]){var _=Math.abs((I[x]-(g[x]+1))*(this.gridWidth/I[x]));(null==C.distortion||C.distortion>_)&&(C.distortion=_,C.index=x)}g[C.index]++}}for(var S=0;S<g.length;S++)this._setColumnWidth(u[S],g[S])}if("lastColumn"==e){this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth,this.orgLastWidth=this.colWidthList[n],this.orgLastVisibleCol=n),"number"==typeof i&&i!=n&&(this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o));var D=r-s-this.gridWidth+this.colWidthList[n];D>this.orgLastWidth?this._setColumnWidth(n,D):this._setColumnWidth(n,this.orgLastWidth)}else if("allColumn"==e){if(!this.autofitColumn){var R=this.autoFitColWidthList||this.colWidthList,L=r-s,T={};if(this.options.keepDefaultColumnWidth)for(l=0;l<this.defaultColCnt;l++)T[l]=!0;for(l=this.defaultColCnt;l<R.length;l++)!1===this.isColumnResizable(l)&&(this.hiddenList[l]||(T[l]=!0));w=parseInt(t.minWidth?t.minWidth:this.options.autoFitMinWidth,10);for(var k in!isNaN(w)&&w>L&&(L=w),L-=o,T)L-=this.colWidthList[k];var A=0;for(l=0;l<R.length;l++)A+=this.hiddenList[l]||l===i||T[l]?0:R[l];var F=0,E=A?L/A:0,M=[];if(E){for(l=0;l<R.length;l++)if(l==i)this.colWidthList[l]=o;else if(T[l]);else{M[l]=E*R[l];var O=Math.round(M[l]);this.colWidthList[l]=O,F+=this.hiddenList[l]?0:O}var N=L-F,B=N>0?1:-1;for(l=0;l<N*B;l++){var G={};for(x=0;x<R.length;x++)if(!this.hiddenList[x]&&x!=i&&!T[x]){_=Math.abs(M[x]-(this.colWidthList[x]+B))*(F/this.colWidthList[x]);(null==G.value||G.value>_)&&(G.value=_,G.index=x)}this.colWidthList[G.index]+=B,F+=B}if(this.hiddenList[0]&&a.D.isIE(8))for(l=0;l<this.colWidthList.length;l++)if(!this.hiddenList[l]){this.colWidthList[l]=this.colWidthList[l]-2;break}}for(var k in this.autoFitColWidthList||(this.autoFitColWidthList=this.colWidthList.slice(0)),this.gridWidth=F+o,T)this.gridWidth+=this.colWidthList[k];this.arrangeOverflowXScroll();var H="";this.options.autoFitMinWidth||(H="hidden"),this.setOverflowX(H),this.scrollXPreventEndEdit=!0,this.handleScrollX(),this.scrollXPreventEndEdit=!1,this.handlerResize_drawInitializer()}for(l=0;l<this.oneRowDataLength;l++){var W=this.getCellInfo(l);"text"!=W.options.inputType&&"secret"!=W.options.inputType&&"calendar"!=W.options.inputType||!W.options.embeddedInput||!this.options.autoResizeEmbeddedInput&&"calendar"!=W.options.inputType||this.hiddenList[l]||(this.embeddedWidthObj[l]&&(this.embeddedWidthObj[l].isChanged=!0),this.drawColumnData(l))}}else"clear"==e&&"number"==typeof i&&(this.autoFitGridWidth||(this.autoFitGridWidth=this.gridWidth),this.autoFitGridWidth+=o-this.colWidthList[i],this._setColumnWidth(i,o))}},c.prototype.setAutoFit=function(t){try{t&&(this.options.autoFit=t.type),this._setAutoFit(t)}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.clearAutoFit=function(t){try{this.options.autoFit="",-1===this.initialColWidthList.indexOf("*")&&(this.autoFitColWidthList=null,this.gridWidth=this.initialGridWidth,this.colWidthList=this.initialColWidthList.slice(),this.arrangeOverflowXScroll(),this.setOverflowX("auto"),this.handleScrollX())}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.autoFitFunc=function(){this.autofit_clientWidth===this.render.clientWidth?s.v.clearTimer(this.id+"_autofit"):s.v.setTimer(this._setAutoFit,{key:this.id+"_autofit",caller:this,delay:100})},c.prototype.setIScrollX=function(){try{var t=this.getElementById(this.id+"_iScrollX");if(!t)return;var e=this.getElementById(this.id+"_scrollX_right")
;if(e.offsetWidth>=e.firstChild.offsetWidth)return void(t.style.visibility="hidden");var i=this.getElementById(this.id+"_dataLayer"),o=parseInt(this.getElementById(this.id+"_scrollX_left").style.width,10),s=e.firstChild.offsetWidth-e.offsetWidth,a=parseInt(e.offsetWidth*e.offsetWidth/e.firstChild.offsetWidth,10);t.style.width=(a<30?30:a)+"px",t.style.left=o+e.scrollLeft/s*(i.offsetWidth-o-t.offsetWidth)+"px",t.style.visibility=""}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.setIScrollY=function(){try{var t=this.getElementById(this.id+"_iScrollY");if(!t)return;var e=this.getDataLength(),i=this.rowIndex,o=this.getElementById(this.id+"_size_y").parentNode.offsetHeight;if(0==o&&(o=parseInt(this.getStyleValue("height"))),-1==i||0==i&&i+this.lastIndex+1==e){var s=!this.hasSubtotal;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==e-1)"none"!=a[a.length-1].style.display&&(s=!0)}if(s)return void(t.style.visibility="hidden")}var n=this.getElementById(this.id+"_scrollY_div"),l=n.firstChild.offsetHeight,h=this.getElementById(this.id+"_dataLayer"),d=l-h.offsetHeight,u=parseInt(h.offsetHeight*h.offsetHeight/l,10);t.style.height=(u<30?30:u)+"px",t.style.top=n.scrollTop/d*(h.offsetHeight-t.offsetHeight)+"px",t.style.visibility=""}catch(t){r.w.printStackTrace(t,null,this)}},c.prototype.createBlockedHeaderInfo=function(){try{this.columnBlock={info:{},hash:{}};for(var t=[],e=this.getColCnt(),i=0;i<e;i++)t.push(1);for(var o in this.struct){var s;if("subtotalArr"===o)s=this.struct[o][0].rowArr;else{if(!this.struct[o]||!this.struct[o].rowArr)continue;s=this.struct[o].rowArr}for(var a=0;a<s.length;a++)for(var n=0,l=0;l<s[a].length;l++){var h=parseInt(s[a][l].colSpan,10)||1;for(i=1;i<h;i++)t[n+i]=0;n+=h}}var d=0;for(i=0;i<t.length;i++){var u=t[i];1===u?(this.columnBlock.info[i]=[i],this.columnBlock.hash[i]=i,d=i):0===u&&(this.columnBlock.info[d].push(i),this.columnBlock.hash[i]=d)}}catch(t){r.w.printStackTrace(t,null,this)}};var g=function(){};g.prototype.initializeEvent=function(){try{if(this.otherClickEvent(),this.checkResize(),this.event.addListener(this.render,"ondblclick",this.event.bindAsEventListener(this,this.handleDblClickEvent)),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),a.D.isIEAllVersion()){if(a.D.isIEAllVersion()){if(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||d.B.preventDefault(t)}))),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,(function(t){this.options.preventCopy||this.editedCell||"native"===this.options.copyType||d.B.preventDefault(t)}))),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,(function(t){this.options.preventPaste&&!this.editedCell&&"native"!==this.options.copyType&&d.B.preventDefault(t)}))),!0===this.options.noSelect)document.getElementById(this.id+"_main_div").onselectstart=function(t){if(a.D.isIEAllVersion()&&t&&t.srcElement){var e=t.srcElement;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName)return!0}return!1};else!0===this.options.preventCopy&&(this.render.onselectstart=function(){return!1})}}else s.v.browserCheck.safari?(this.event.addListener(WebSquare.getBody().render,"onbeforecopy",this.event.bindAsEventListener(this,this.handleBeforeCopyEvent)),this.event.addListener(WebSquare.getBody().render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(WebSquare.getBody().render,"onbeforecut",this.event.bindAsEventListener(this,this.handleBeforeCutEvent)),this.event.addListener(WebSquare.getBody().render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),
this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent))):s.v.browserCheck.chrome||(this.event.addListener(this.render,"oncopy",this.event.bindAsEventListener(this,this.handleCopyEvent)),this.event.addListener(this.render,"oncut",this.event.bindAsEventListener(this,this.handleCutEvent)),this.event.addListener(this.render,"onpaste",this.event.bindAsEventListener(this,this.handlePasteEvent)));this.isMobile||(this.event.addListener(this.getElementById(this.id+"_head_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollX_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onmouseover",this.event.bindAsEventListener(this,this.gridDataLayerOut)),this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)),this.hasFooter&&this.event.addListener(this.getElementById(this.id+"_foot_table"),"onmouseover",this.event.bindAsEventListener(this,this.gridOver)));var t=this.isHammerEnabled();if(this.event.addListener(this.getElementById(this.id+"_dataLayer"),"oncontextmenu",this.event.bindAsEventListener(this,this.clickRightButtonCell)),t||this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.gridOut)),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeyDownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyUpEvent)),a.D.isOpera()&&this.event.addListener(this.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||d.B.preventDefault(t)})),this.options.dataDragDrop||this.options.dataDragDropSelf)if(1==this.isMobile){if(t){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0;else this.options.dataDragDrop||this.options.dataDragDropSelf||!this.options.dataDragSelect||this.isMobile||this.event.addListener(this.getElementById(this.id+"_dataLayer"),"onmousedown",this.event.bindAsEventListener(this,this.handleDragSelectEvent));if(s.v.setTimer((function(){this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(t){var e=WebSquare.getBody().getLayerListener();if(e.layers[this.id]){for(var i=e.layers[this.id].component,o={};i.parentControl;)for(var s in i=i.parentControl,e.useOtherComponentId)e.useOtherComponentId[s]==i.id&&(o[s]=!0);WebSquare.getBody().getLayerListener().hideAll(o)}this.parentControl&&this.parentControl.options&&("gridItemTable"==this.parentControl.options.pluginName||"gridViewItemTable"==this.parentControl.options.pluginName)||d.B.stopPropagation(t)})))}),{key:this.id+"initializeEvent",caller:this,delay:100}),this.isMobile?(this.iScroll={},this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,this.handleTouchStart)),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"ontouchend",this.event.bindAsEventListener(this,this.handleTouchEnd))):window.navigator.msPointerEnabled&&-1!=window.navigator.userAgent.toLowerCase().indexOf("touch")?(this.iScroll={},this.render.style.touchAction="none",this.event.addListener(this.render,"onMSPointerDown",this.event.bindAsEventListener(this,this.handleTouchStart)),
this.event.addListener(this.render,"onMSPointerMove",this.event.bindAsEventListener(this,this.handleTouchMove)),this.event.addListener(this.render,"onMSPointerUp",this.event.bindAsEventListener(this,this.handleTouchEnd))):this.options.senseReader?(this.options.useStartEndDiv&&(this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onfocus",this.event.bindAsEventListener(this,this.handleStartDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridstart_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleStartDivKeyDown)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onfocus",this.event.bindAsEventListener(this,this.handleEndDivFocus)),this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeyup",this.event.bindAsEventListener(this,this.handleEndDivKeyUp))),this.options.scrollFocus?this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)):this.options.useStartEndDiv&&this.event.addListener(this.getElementById(this.id+"_gridend_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleEndDivKeyDown))):this.options.scrollFocus&&this.event.addListener(this.getElementById(this.id+"_scrollY_div"),"onkeydown",this.event.bindAsEventListener(this,this.handleScrollDivKeyDown)),t&&!this._bindPressEvent)try{e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.render),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){if(!o._bindPressEvent){for(var e=d.B.getTarget(t),i=-1;e&&"BODY"!=e.tagName;){if("TD"==e.tagName&&o.hasClass(e,o.options.bodyTdClass)){i=o.getElemRowIndex(e);break}e=e.parentNode}o.removeFocusedCell(),o._dataList.setRowPosition(i),o.handleDblClickEvent(t),d.B.fireEvent(o,"ondblclick",t)}})))}))}catch(t){r.w.printStackTrace(t,null,this)}if("native"===this.options.drawType){var o=document.getElementById(this.id+"_dataLayer");i=this.uuid;o&&(o.onscroll=function(){var t=WebSquare.idCache[i];t._endEdit();var e=document.getElementById(t.id+"_dataLayer"),o=e.scrollTop,s=e.offsetHeight;if(a.D.isIEAllVersion())for(var r=document.getElementById(t.id+"_head_table").getElementsByTagName("th"),n=o+"px",l=0;l<r.length;l++){var h=r[l];"relative"!=h.style.position&&(h.style.position="relative"),h.style.top=n}s+o>=e.scrollHeight&&d.B.fireEvent(t,"onscrollend")})}this.initializeLayoutEvents(),n.s.addCheckResize(this.uuid,"checkResize")}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.handleStartDivFocus=function(t){(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[],"true"!==this.options.keepScrollForSenseReader)&&(this.addGridScroll(0-this.rowIndex),0!=this.getElementById(this.id+"_scrollY_div").scrollTop&&this.addGridScroll(0-this.rowIndex))},g.prototype.handleEndDivFocus=function(t){this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0,this.applyFocusedCellOut(),this.focusedCell=[]},g.prototype.handleScrollDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){for(var e=this.getRowCount()-1,i=this.getRightMostFocusableColIndex(e);e>=0&&null==i;)e-=1,i=this.getRightMostFocusableColIndex(e);if(null!==i){var o=this.getCellInfo(i);if("radio"===o.options.inputType){var s=0,r=this.getCheckedIndex(o.colID)[0];r>0&&(s=r),this._setFocusedCell(s,i,!1,{tabDirection:"left"}),d.B.stopEvent(t)}}}else switch(t.keyCode){case 38:case 40:case 9:d.B.stopPropagation(t)}},g.prototype.handleStartDivKeyDown=function(t){if(!t.shiftKey&&9==t.keyCode){for(var e=0,i=this.getRowCount()-1,o=this.getLeftMostFocusableColIndex(e);e<i&&null==o;)e+=1,o=this.getRightMostFocusableColIndex(e);var s=this.getCellInfo(o);if("radio"===s.options.inputType){var r=0,a=this.getCheckedIndex(s.colID)[0];a>0&&(r=a),
this._setFocusedCell(r,o,!1),d.B.stopEvent(t)}}},g.prototype.handleEndDivKeyDown=function(t){if(t.shiftKey&&9==t.keyCode){var e=this.getElementById(this.id+"_size_y").parentNode.offsetHeight,i=parseInt(this.getElementById(this.id+"_size_y").style.height,10);if(0==i)return;var o=i-e,s=this.getElementById(this.id+"_scrollY_div").scrollTop,r=this._getEpsilon();if(s<o&&(s=Math.min(Math.round(s)+r,o)),o!=s){for(var a=0,n=0;n<this.getRowCount();n++)a+=this.getHasSubtotalCount(n);this.addGridScroll(this.getRowCount()-this.rowIndex-this.lastIndex-1+a)}for(var l=this.getRowCount()-1,h=this.getRightMostFocusableColIndex(l);l>=0&&null==h;)l-=1,h=this.getRightMostFocusableColIndex(l);null!=h&&(this._setFocusedCell(l,h,!1,{tabDirection:"left"}),d.B.stopEvent(t))}},g.prototype.handleEndDivKeyUp=function(t){38==t.keyCode&&"all"!=this.options.visibleRowNum&&(this.getElementById(this.id+"_scrollY_div").scrollTop=0)},g.prototype.handleTdFocus=function(t){var e,i=d.B.getTarget(t),o=this.getLastFocusedCell();if("TD"==i.tagName&&o.focusedTd!=i&&!this.focusedByApi){var s,r,a,n,l,h,u=parseInt(i.getAttribute("tdIndex")),p=parseInt(u/this.realRowDataLength)+this.rowIndex,c=i.getAttribute("col_id");if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&(e=null!=this.editedCell)){var g=this.getCellInfo(this.editedCell.colID);s=g.editRowIndex,r=this._dataList.getColumnIndex(g.id),a=this.getColumnIndex(g.id),n=this.getRealRowIndex(s),l=this._dataList.dataArr[n*this._dataList.getColumnCount()+r],h=g.comp&&g.comp.selectedIndex}if(this._setFocusedCell(p,c),e){var f=this._dataList.dataArr[n*this._dataList.getColumnCount()+r];if(0===l&&(l="0"),0===f&&(f="0"),l!=f){var m={oldValue:l,newValue:f,rowIndex:s,colIndex:a};isNaN(h)||(m.oldSelectedIndex=h,m.newSelectedIndex=g&&g.comp&&g.comp.selectedIndex),d.B.fireEvent(this,"onviewchange",m)}}}this.focusedByApi=!1},g.prototype.handleDragSelectEvent=function(t){if(!this._bindDrag)for(var e=this.body_table.offsetHeight,i=this.event.getTargetIterator(t);i.next();)if(i.match(this.options.bodyTdClass,null,"td")){var o=this,s=i.getElement();return void WebSquare.dragdrop.gDragManager.activate(t,this.render,{id:this.id+"_dragSelect",delay:15,handleStart:function(t){a.D.isIEAllVersion()&&(a.D.emptySelection(),d.B.preventDefault(t));var e,i,r,n,l,h,u=null!=o.editedCell;if(u&&(e=o.editedCell.editRowIndex,i=o._dataList.getColumnIndex(o.editedCell.id),r=o.getColumnIndex(o.editedCell.id),n=o._grid.getRealRowIndex(e),l=o._dataList.dataArr[n*o._dataList.getColumnCount()+i]),o.__setFocusedCell(t,s,{editMode:!1}),u&&l!=(h=o._dataList.dataArr[n*o._dataList.getColumnCount()+i])){var p={oldValue:l,newValue:h,rowIndex:e,colIndex:r};d.B.fireEvent(o,"onviewchange",p)}},handleUpdate:function(t,i,s,r,a){for(var n=null,l=null,h=o.event.getTargetIterator(a);h.next();){if(h.match("w2grid")){n=h.getElement().id;break}h.match(o.options.bodyTdClass,null,"td")&&(l=h.getElement())}var u=o.focusedCell[0];o.options.dataDragSelectAutoScroll&&u.focusedColIndex>-1&&o.dragSelectAutoScroll(d.B.getMouseY(a),e,d.B.getMouseX(a)),null!=n&&null!=l&&o.id==n&&u.focusedColIndex>-1&&(l.className.indexOf("_rowNum")>=0||l.className.indexOf("_rowStatus")>=0||o.__setFocusedCell({shiftKey:!0},l,{editMode:!1}))},handleFinish:function(){o.dragSelectAutoScrollFinish()}})}},g.prototype.handleDragEvent=function(t){if((!this.options.rowResize||!this.rowResizeStarted)&&(!this.isDrillDown||this.drillDownDragDrop)&&!this.editedCell&&(0!=this.options.dataDragDrop||0!=this.options.dataDragDropSelf))for(var e=this.event.getTargetIterator(t);e.next();)if(e.match(null,null,"td")){var i=e.getElement(),o=[],r=i.getAttribute("tdIndex");if(null==r)return;var n=this.rowIndex+parseInt(parseInt(r)/(this.oneRowDataLength+this.defaultColCnt));""==this.options.dragDisplayColumn?o.push(i.getAttribute("col_id")):o=this.options.dragDisplayColumn.split(",");for(var l=[],h=0;h<o.length;h++){var u
;u=null==o[h]||null==o[h]?(n+1).toString():this._getCellDisplayData(n,o[h].wq_trim()),l.push(u)}if(l=l.join(","),this.isMobile){for(var p=d.B.getTarget(t);p&&"TD"!=p.tagName&&"TH"!=p.tagName&&"DIV"!=p.tagName;)p=p.parentNode;this.__setFocusedCell(t,p)}var c=this,g={id:this.id+"_drag",component:c,className:"w2grid_drag",contents:l,delay:15,applyMousePosition:!0,showNoData:!0,handleStart:function(t){d.B.fireEvent(c,"ondatadragstart",n)},onDragover:function(t,e,i,o,s,r,l){if(t&&e){var h=null;for(h=c.isMobile?new WebSquare.targetIterator(document.elementFromPoint(l.changedTouches[0].clientX,l.changedTouches[0].clientY)):c.event.getTargetIterator(l);h.next();)if(h.match("w2grid")||h.match("w2grid_tooltip")){if(h.match("w2grid_tooltip"))h.getElement().style.display="none",h=new WebSquare.targetIterator(document.elementFromPoint(d.B.getClientX(l),d.B.getClientY(l)));var u=a.D.getComponentById(h.getElement().id);c.id!=u.id&&d.B.fireEvent(u,"ondatadragover",c.id,n),h.stop()}}},onDrop:function(t,e,i,o,r,l,h){var u,p=null,g=null,f=null,m=null,y={},b=null,w=null;for(m=c.isMobile?new WebSquare.targetIterator(document.elementFromPoint(h.changedTouches[0].clientX,h.changedTouches[0].clientY)):c.event.getTargetIterator(h);m.next();){if(m.match(null,null,"body"))return;if(m.match("w2grid")){p=m.getElement().id;break}if(m.match("w2grid_tooltip"))m.getElement().style.display="none",m=new WebSquare.targetIterator(document.elementFromPoint(d.B.getClientX(h),d.B.getClientY(h)));if(null==f&&m.match(null,null,"td")){var v=m.getElement();f=parseInt(v.getAttribute("tdIndex"),10),"number"!=typeof(u=parseInt(v.getAttribute("colindex"),10))&&(u=void 0)}if(m.match("w2treeview")||m.match("w2treeview_virtual")||m.match("w2input")||m.match("w2textarea")){b=m.getElement().id;break}(m.match("w2treeview_node")||m.match("treeview_virtual_node"))&&(w=m.getElement().getAttribute("index"))}if((!c.options.dataDragDropSelf||c.id===p)&&(!c.options.dataDragDropOther||c.id!=p)&&(null!=p&&(g=(p=a.D.getComponentById(p)).getDataLength(),null!=f&&(g=p.rowIndex+parseInt(f/(p.oneRowDataLength+p.defaultColCnt)))),null!=b&&(b=a.D.getComponentById(b)),p||b)){var I,C;if(c.focusedCell.length>1&&p&&""==p.options.dragEndFunction&&""==c.options.dragStartFunction){N=[],O=[];for(var x=0;x<c.focusedCell.length;x++){var _=c.focusedCell[x].focusedRowIndex;O.push(_)}O.sort((function(t,e){return t-e}));for(x=0;x<O.length;x++)for(var S=c.dataList.getRowArray(O[x]).data,D=0;D<S.length;D++)N.push(S[D])}else I=c.dataList.getRowArray(n).data;var R=t.getAttribute("col_id"),L=c.getColumnIndex(R);if(""!=c.options.dragStartFunction){var T=a.D.getGlobalFunction(c.options.dragStartFunction,c.scope_id);if("function"==typeof T)if(c.drillDownDragDrop){var k,A;c.getRowCount()<=g?(k=void 0,A=void 0):(k=c.getRealRowIndex(g),A=c.dataList.getRowData(g));var F=[G=c.getRealRowIndex(n)].concat(c.drilldown.getRecursiveRowIndex(G)),E=[];for(x=0;x<F.length;x++)E=E.concat(c.dataList.getRowData(c.getDisplayRowIndex(F[x])));if(!T.call(c,{parentRowIndex:k,parentRowData:A,beforeRemoveData:E,beforeRemoveRowIndex:F}))return}else{var M={fromColumnId:R,fromColumnIndex:L};null==C&&(C=c.dataList.getRowXML(n)),C=T.call(c,n,C,M)}}else if(p&&c.id!==p.id&&c.drillDownDragDrop){var O=[G=c.getRealRowIndex(n)].concat(c.drilldown.getRecursiveRowIndex(G)),N=[];for(x=0;x<O.length;x++)N=N.concat(c.dataList.getRowData(c.getDisplayRowIndex(O[x])))}if(p&&""!=p.options.dragEndFunction){var B=a.D.getGlobalFunction(p.options.dragEndFunction,p.scope_id);if("function"==typeof B)if(c.drillDownDragDrop){if(c.id==p.id){if(c.isDrillDown&&g!=n){var G=c.getRealRowIndex(n);if(c.getRowCount()<=g)c.drilldown.bodyDrop=!0,q=(j=c.getRealRowIndex(g-1))+c.drilldown.getRecursiveRowCount(j);else q=c.getRealRowIndex(g)+1;var H=[G].concat(c.drilldown.getRecursiveRowIndex(G)),W=c.drilldown.moveNode(G,q),V=[W.insertedRowIndex].concat(c.drilldown.getRecursiveRowIndex(W.insertedRowIndex));y={removedData:W.detachedData,removedRowIndex:H,insertedData:W.insertedData,
insertedRowIndex:V,fromRowIndex:G,toRowIndex:V[0]},B.call(c,q,c.dataList.getRowXML(n),y)}}else if(p.drillDownDragDrop&&p.isDrillDown){G=c.getRealRowIndex(n);if(p.getRowCount()<=g)p.drilldown.bodyDrop=!0,q=(j=p.getRealRowIndex(g-1))+p.drilldown.getRecursiveRowCount(j);else q=p.getRealRowIndex(g);for(F=[G].concat(c.drilldown.getRecursiveRowIndex(G)),E=[],x=0;x<F.length;x++)E=E.concat(c.dataList.getRowData(c.getDisplayRowIndex(F[x])));C=c.dataList.getRowXML(n),y={removedData:F,removedRowIndex:H,fromRowIndex:G,toRowIndex:q},B.call(c,q,C,y)&&c._dataList.removeRow(G)}}else{M={fromColumnId:R,fromColumnIndex:L,toColumnId:"number"==typeof u?p.getColumnID(u):void 0,toColumnIndex:u};!0!==s.v.isXML(C)&&(C=c.dataList.getRowXML(n)),B.call(c,g,C,M)&&c.dataList.removeRow(n)}}else if(p){if(c.isDrillDown)if(c.id==p.id&&g!=n){if(c.drillDownDragDrop){G=c.getRealRowIndex(n);if(c.getRowCount()<=g)c.drilldown.bodyDrop=!0,q=(j=c.getRealRowIndex(g-1))+c.drilldown.getRecursiveRowCount(j);else q=c.getRealRowIndex(g)+1;return void c.drilldown.moveNode(G,q)}}else if(p.drillDownDragDrop&&p.isDrillDown){var q,j;G=c.getRealRowIndex(n);if(p.getRowCount()<=g)p.drilldown.bodyDrop=!0,q=(j=p.getRealRowIndex(g-1))+p.drilldown.getRecursiveRowCount(j);else q=p.getRealRowIndex(g)+1;for(E=[],x=(F=[G].concat(c.drilldown.getRecursiveRowIndex(G))).length-1;x>=0;x--)E=E.concat(c.dataList.getRowData(c.getDisplayRowIndex(F[x])));return p.drilldown.appendNode(q,E),void c.dataList.removeRow(G)}var z=p._dataList.getBroadcast();if(p._dataList.setBroadcast(!1),N&&O){var P=-1;if(c.id==p.id)for(x=0;x<O.length;x++)O[x]<g&&P++;P=Math.max(0,P);var X=p.dataList.getRealRowIndex(g),U={};if(c.options.dataDragDropStatus)for(var Z=0;Z<O.length;Z++)U[Z]=c.dataList.getRowStatus(O[Z]);c.dataList.removeRows(O),void 0===X&&(X=g,P=0);var K=X-P;c.id==p.id&&(K=Math.min(K,c.getRowCount())),p._dataList.insertData(K,N);var Y=0;if(c.options.dataDragDropStatus){for(var $ in U){var J=K+Y,Q=c._dataList.options.depthColumn?J:c._dataList.getRealRowIndex(J);c._dataList._setRowStatus(Q,U[$]),Y++}c.setFocusedMultiCell(K,0,K+Y-1,0)}c.id===p.id?c._moveCellVisible(O,K,{remove:!0,insert:!0}):(c._moveCellVisible(O,K,{remove:!0}),p._moveCellVisible(O,K,{insert:!0}))}else{var tt=c.dataList.getRowStatus(n);if(c.dataList.removeRow(n),!0===s.v.isXML(C)?p.dataList.setRowXML(g,C):p.dataList.setRowData(g,I),c.options.dataDragDropStatus){Q=c._dataList.options.depthColumn?g:c._dataList.getRealRowIndex(g);c._dataList._setRowStatus(Q,tt),c.setFocusedCell(Q,0)}c.id===p.id?c._moveCellVisible([n],g,{remove:!0,insert:!0}):(c._moveCellVisible(O,K,{remove:!0}),p._moveCellVisible(O,K,{insert:!0}))}!1!==z&&p._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0}]}),c.id!=p.id?(c.removeFocusedCell(),d.B.fireEvent(p,"ondatadrop",{fromId:c.id,fromRowIndex:n,toRowIndex:g})):d.B.fireEvent(p,"ondatadropself",{id:c.id,fromRowIndex:n,toRowIndex:g}),t.blur()}else if(b){var et;null!=w&&(et=b.tree.findNodeByIndex(w),w=parseInt(w,10)),d.B.fireEvent(b,"ondropfromgrid",{dataListId:c._dataList.id,fromRowIndex:n,value:this.contents,dropNode:et,toRowIndex:w}),c.removeFocusedCell(),t.blur()}}}};return this.isMobile&&(g.passive=!1,g.showGhostOnActivate=!0,g.ghostRightTop=!0,g.delay=0),void WebSquare.dragdrop.gDragManager.activate(t,i,g)}},g.prototype.dragSelectAutoScroll=function(t,e,i){try{this._dragSelectAutoScrollStartTime=new Date,a.D.setInterval((function(t,e,i){this._dragSelectAutoScroll(t,e,i)}),{key:this.id+"_dragSelectAutoScroll",caller:this,delay:this.options.dataDragSelectAutoScrollPeriod,args:[t,e,i]})}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype._dragSelectAutoScroll=function(t,e,i){try{var o=0,s=this.getRowCount(),a=null==this.lastTopRowIndex?s-this.lastIndex:this.lastTopRowIndex,n=WebSquare.style.getAbsoluteTop(this.render),l=n+e,h=1;if(t>l?o=t-l:n>t&&(o=n-t,h=-1),0!==o){
var d=new Date-this._dragSelectAutoScrollStartTime,u=Math.floor(d/this.options.dataDragSelectAutoScrollLevel),p=Math.pow(2,u),c=Math.ceil(o*this.options.dataDragSelectAutoScrollDPI/100)*p*h,g=Math.max(Math.min(this.rowIndex+c,a-1),0);this.rowIndex!==g&&(this.scrollEvent=!1,this.checkScrollEnd=!0,this.rowIndex=g,this.fastDrawData(0,{scroll:!0}),this._dragSelectAutoScrollFlag=!0,document.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g))}for(var f=0,m=WebSquare.style.getAbsoluteLeft(this.render),y=m+this.render.offsetWidth,b=0;b<this.defaultColCnt;b++)m+=this.colWidthList[b];h=1;if(i>y?f=i-y:m>i&&(f=m-i,h=-1),0!==f){var w=this.focusedCell[0],v=this.getLastFocusedCell().focusedTd,I=parseInt(v.getAttribute("tdIndex")),C=parseInt(I/this.realRowDataLength),x=w.focusedRowIndex,_=w.focusedColIndex,S=C+this.rowIndex,D=I%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);D=h<0?Math.max(0,D-1):Math.min(this.oneRowDataLength-1,D+1),this._applyFocusedMultiCell(x,_,S,D),h<0?this.fixScrollLeftDirection():this.fixScrollRightDirection()}}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.dragSelectAutoScrollFinish=function(){try{if(a.D.clearInterval(this.id+"_dragSelectAutoScroll"),!0!==this._dragSelectAutoScrollFlag)return;this._dragSelectAutoScrollFlag=!1,this._dragSelectAutoScrollStartTime=0,s.v.setTimer((function(){var t=this.focusedCell[0],e=this.getLastFocusedCell().focusedTd,i=parseInt(e.getAttribute("tdIndex")),o=parseInt(i/this.realRowDataLength),s=t.focusedRowIndex,r=t.focusedColIndex,a=o+this.rowIndex,n=i%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),l=null==this.lastTopRowIndex?this.getRowCount()-this.lastIndex:this.lastTopRowIndex,h=s<=a?1:-1,d=Math.max(Math.min(this.rowIndex+h,l),0);this.drawData(d,0),this._applyFocusedMultiCell(s,r,a,n)}),{key:this.id+"__dragSelectAutoScroll_drawData",caller:this,delay:this.options.dataDragSelectAutoScrollDelay})}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.otherClickEvent=function(){try{this.isMobile?(this.event.addListener(document.documentElement,"ontouchstart",this.event.bindAsEventListener(this,this.handleClickEventDocument)),this.options.tooltipDisplay&&this.hideTooltip()):WebSquare.getBody().getLayerListener().addListener({component:this,event:{},otherClick:this.handleClickEventDocument,frameClick:this.handleClickEventFrame})}catch(t){}},g.prototype.handleClickEventFrame=function(t){try{this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,!0]),this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),this.hideContextMenu(),this.groupbyFilterList&&this.hideGroupbyFilterList(),this.options.focusAutoRemove&&this.removeFocusedCell()}catch(t){r.w.printStackTrace(t)}},g.prototype.handleClickEventDocument=function(t){this.lastEvent=t,this.isHammerEnabled()&&this.hideTooltip(),this.event.isMe(t,this.render)||this.isMine(t)?this.handleClickEventDocumentAfter(t):(this.editedCell?this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,!1,{otherClick:!0}],{beforeFunc:function(t,e){t.handleClickEventDocumentAfter(e);var i=WebSquare.getBody();i.layerListener.handleMouseDownEventDocument.call(i,e),i=null},beforeFuncArgs:[this,t]}):this.handleClickEventDocumentAfter(t),this.options.tooltipDisplay&&this.isMobile&&(this.hideTooltip(),t.srcElement.id==this.id+"_tooltip"&&d.B.stopEvent(t)))},g.prototype.handleClickEventDocumentAfter=function(t){if(this.contextMenu){var e=d.B.getTarget(t);e&&e.className.match("contextMenu")||this.hideContextMenu()}if(this.groupbyFilterList||this.customFilterScrollView){var i=this.event.getTargetIterator(t,this.render),o=!0
;if(this.customFilterScrollView&&this.customFilterScrollView.render&&"none"==this.customFilterScrollView.render.style.display)o=!1;else for(;i.next();)if(i.match("gridHeaderTDDefault")||i.match("w2grid_groupbyZone_scrollView")||i.match("w2grid_groupbyZone_column")||i.match("w2grid_customFilter_scrollView")||i.match("w2grid_customFilter_column")){o=!1;break}o&&this.hideCustomFilterList()}if(this.options.groupbyZone&&this.options.groupbyFilterBox)for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_filterBox_select_tbody")||i.match("w2grid_filterBox_itemTable")){o=!1;break}if(this.groupbyFilterList){for(i=this.event.getTargetIterator(t,this.render),o=!0;i.next();)if(i.match("w2grid_groupbyZone_list")||i.match("w2grid_groupbyZone_column")||i.match("gridHeaderTDDefault")){o=!1;break}o&&this.hideGroupbyFilterList()}this.options.focusAutoRemove&&this.removeFocusedCell()},g.prototype.isMine=function(t){try{for(var e=d.B.getTarget(t);null!=e;){if(e.id&&e.id.indexOf&&e.id.indexOf("G_"+this.id+"__")>=0)return!0;e=e.parentNode}return!1}catch(t){r.w.printStackTrace(t)}},g.prototype.handleResize=function(){try{var t=this.render.offsetWidth,e=this.render.offsetHeight;if(t>0&&e>0)if(this.delayedDrawObj)this.resizeObj={width:t,height:e,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.setRedrawStatus("draw");else{var i=t-this.resizeObj.width,o=e-this.resizeObj.height,n=!1,l=this.hiddenCellObj.length>0;if(o>0){if(this.options.adaptive){var h=parseInt(this.options.adaptiveThreshold)||480;if(!(a.D.isIE()&&parseInt(s.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=h)return}n=!0;var d=this.getDataLength(),u=this.drawedRowLength;this.lastTopRowIndex=null,this.setDataTable(),this.setScrollYHeight();var p=this._getVisibleLastIndex(this.lastIndex+1);if(d<=0);else if(this.rowIndex+p-1+this.drawedRowLength-u<d){var c=d-this.drawedRowLength+1,g=this.rowIndex;this.rowIndex+1>c&&c>=-1&&(g=c>=0?c:0),l?(this.rowIndex=g,this._setCellVisibleRefresh()):this.drawData(g)}else{var f;if((g=d-this.drawedRowLength>0?d-this.drawedRowLength:0)==this.rowIndex)f=p-1;else this.scrollEvent=!1,this.checkScrollEnd=!0,this.getElementById(this.id+"_scrollY_div").scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g);l?(this.rowIndex=g,this._setCellVisibleRefresh()):this.drawData(g,f)}}else if(o<0&&"all"!=this.options.visibleRowNum){n=!0;var m=this.getElementById(this.id+"_body_table");this.dataLayerHeight=m.parentNode.offsetHeight;var y=Number(this.options.visibleRowNum),b=this.getVisibleRowNum();l?this._setCellVisibleRefresh():(!isNaN(y)&&y>0&&y>=b||(this.lastTopRowIndex=null,this.cutGridBottom(this.lastIndex)),this.setScrollYHeight())}0!=i&&(n=!0,this.resizeObj.clientWidth=this.render.clientWidth,this.setScrollYHeight(),this.options.autoFit||this.setOverflowX(),this._handleScrollX(),this.options.autoFit&&this.autoFitFunc(),l&&this._setCellVisibleRefresh()),n&&this.groupbyZoneStatus.groupbyZoneRender&&this.resizeGroupbyZone()}else this.setRedrawStatus("stop");this.groupbyZoneStatus.groupbyZoneRender&&!this.adjustGroupbyZone&&(this.adjustGroupbyZone=!0,this.resizeGroupbyZone()),this.resizeObj={width:t,height:e,scrollLeft:this.resizeObj.scrollLeft,scrollTop:this.resizeObj.scrollTop,clientWidth:this.resizeObj.clientWidth},this.resizeObj.width>0&&this.resizeObj.height>0&&(this.resizeObj.scrollLeft=this.getElementById(this.id+"_scrollX_right").scrollLeft,this.resizeObj.scrollTop=this.getElementById(this.id+"_scrollY_div").scrollTop)}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.resizeGroupbyZone=function(){if(this.groupbyZoneStatus.groupbyZoneRender){var t=this.resizeObj.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder,e=this.dom[this.id+"_scrollY_div"].offsetWidth;0!=e&&(t-=e),t+="px",this.groupbyZoneStatus.groupbyZoneRender.style.width!=t&&(this.groupbyZoneStatus.groupbyZoneRender.style.width=t)}},
g.prototype.checkPercent=function(){var t=WebSquare.WebSquareparser.getAttribute(this.element,"style");if(t.indexOf("%")>0)for(var e=t.split(";"),i=0;i<t.length;i++)if(e[i].indexOf("%")&&e[i].indexOf("height")||e[i].indexOf("%")&&e[i].indexOf("width")){this.checkResize();break}},g.prototype.checkResize=function(){try{if(this.render){var t=!0;if(WebSquare.getBody().modalStack&&WebSquare.getBody().modalStack.length>0&&this.getDisabled()){for(var e=this.parentControl;e&&(!e.options||!("floatingLayer"==e.options.pluginName||"wframe"===e.options.pluginName&&e._isWframePopup));)e=e.parentControl;null==e&&(t=!1)}t&&!this.startedDisplayNone&&this.handleResize(),this.startedDisplayNone&&this.render.offsetWidth>0&&this.render.offsetHeight>0&&this.delayedAction()}}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.handleDblClickEvent=function(t){for(var e=this.event.getTargetIterator(t,this.render);e.next();){if(e.match(this.options.bodyTdClass)||WebSquare.idToUUID[e.getElement().getAttribute("id")]){this.bodyDblClick(t,e.getElement());break}if(e.match(this.options.headerTdClass)){this.headerDdlClick(t,e.getElement());break}if(this.hasFooter&&e.match(this.options.footerTdClass)){this.footerDblClick(t,e.getElement());break}if(this.hasSubtotal){if(this.subtotalClassList){for(var i=!1,o=0;o<this.subtotalClassList.length;o++)if(this.subtotalClassList[o].length>0&&e.match(this.subtotalClassList[o])){this.subtotalDblClick(t,e.getElement()),i=!0;break}if(i)break}else if(e.match(this.options.subtotalTdClass)){this.subtotalDblClick(t,e.getElement());break}}else e.match("w2grid_customFilter_sortable_open")&&(d.B.stopEvent(t),e.stop())}},g.prototype.handleClickEvent=function(t){if(this.lastEvent=t,d.B.fireEvent(this,"onclick",t),!(this.isMobile&&this.iScroll&&this.iScroll.moveDirection&&this.iScroll.moveDistance>10)){var e,i,o,s,r,a,n,l=this.event.getTargetIterator(t,this.render),h=null!=this.editedCell;h&&(e=this.editedCell.editRowIndex,i=this._dataList.getColumnIndex(this.editedCell.id),n=this.getCellInfo(this.editedCell.id),o=this.getColumnIndex(this.editedCell.id),s=this._grid.getRealRowIndex(e),r=this._dataList.dataArr[s*this._dataList.getColumnCount()+i],a=n.comp&&n.comp.selectedIndex);for(var u=function(t,e){var i=!1;if(e.subtotalClassList)for(var o=0;o<e.subtotalClassList.length;o++)if(e.subtotalClassList[o].length>0&&t.match(e.subtotalClassList[o])){i=!0;break}return i};l.next();){if(l.match(this.options.bodyTdClass)){this.bodyClick(t,l.getElement());break}if(l.match(this.options.headerTdClass)){this.headerClick(t,l.getElement()),h&&null==this.editedCell&&(e=this.getDisplayRowIndex(s));break}if(this.hasFooter&&l.match(this.options.footerTdClass)){this.footerClick(t,l.getElement());break}if(this.hasSubtotal&&(l.match(this.options.subtotalTdClass)||u(l,this))){this.subtotalClick(t,l.getElement());break}if(this.isMine(t));else{if(l.match(this.options.headerTableClass))break;if(l.getElement().getAttribute("id")==this.id+"_dataLayer"){null!=this.editedCell&&this.editedCell.handleEndEdit(),d.B.fireEvent(this,"onblankclick",t);break}}}if(h){var p=this._dataList.dataArr[s*this._dataList.getColumnCount()+i];if(0===r&&(r="0"),0===p&&(p="0"),r!=p){var c={oldValue:r,newValue:p,rowIndex:e,colIndex:o};isNaN(a)||(c.oldSelectedIndex=a,c.newSelectedIndex=n&&n.comp&&n.comp.selectedIndex),d.B.fireEvent(this,"onviewchange",c)}}}},g.prototype.gridDataLayerOut=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},g.prototype.gridHeaderOver=function(t){this.overElem&&(this.options.rowMouseOver&&this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null)},g.prototype.gridOver=function(t){for(var e=d.B.getTarget(t);e&&("TD"!=e.tagName||null==e.getAttribute("colIndex")||!(this.hasClass(e,this.options.bodyTdClass)||this.hasClass(e,this.options.subtotalTdClass)||this.hasClass(e,this.options.footerTdClass)));){
if("TD"==e.tagName&&null!=e.getAttribute("colIndex")&&this.subtotalClassList){for(var i=!1,o=0;o<this.subtotalClassList.length;o++)if(this.subtotalClassList[o].length>0&&this.hasClass(e,this.subtotalClassList[o])){i=!0;break}if(i)break}if(this.options.tooltipHeader&&"TH"==e.tagName&&null!=e.getAttribute("colIndex"))break;if("DIV"==e.tagName&&e.getAttribute("id")==this.id+"_dataLayer")break;if("TABLE"==e.tagName&&e.getAttribute("id")==this.id+"_foot_table")break;if("TH"==e.tagName&&this.hasClass(e,this.options.headerTdClass))break;e=e.parentNode}if(e.id==this.id+"_dataLayer")this.overElem&&(this.removeRowOverStyle(this.overElem.parentNode),this.bodyOut(t,this.overElem),this.overElem=null);else if(e.id==this.id+"_foot_table")this.overElem&&(this.bodyOut(t,this.overElem),this.overElem=null);else if(e&&"TD"==e.tagName){if(this.overElem!=e&&-1==e.className.indexOf(this.options.headerTdClass)){this.bodyOut(t,this.overElem),(this.options.tooltipDisplay||this.options.rowStatusTooltipDisplay)&&this.bodyOver(t,e),this.options.rowMouseOver&&(this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.hasClass(e,"w2grid_groupby")||this.addRowOverStyle(e.parentNode)),this.overElem=e;var s={};e.getAttribute("col_id")&&(s.rowIndex=this._getGroupbyDisplayRowIndex(this.getElemRowIndex(e)),s.colIndex=this.getColumnIndex(e.getAttribute("col_id"))),d.B.fireEvent(this,"onbodymouseover",s)}}else e&&"TH"==e.tagName&&this.overElem!=e&&(this.bodyOut(t,this.overElem),(this.options.tooltipHeader||this.options.headerTooltipDisplay)&&this.headerOver(t,e),this.options.rowMouseOver&&this.overElem&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),this.overElem=e)},g.prototype.gridOver1=function(t){var e=d.B.getTarget(t);"NOBR"==e.tagName&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem&&this.removeRowOverStyle(this.overElem.parentNode),this.addRowOverStyle(e.parentNode)),this.overElem=e)},g.prototype.gridOver2=function(t){var e=d.B.getTarget(t);"NOBR"==e.tagName&&(e=e.parentNode),void 0!==e.tagName&&"TD"==e.tagName&&(this.options.rowMouseOver&&(this.overElem,this.addRowOverStyle(e.parentNode)),this.overElem=e)},g.prototype.handlePasteEvent=function(t){try{var e=this.options.preventPasteColumn,i=e?e.split(","):[];if(this.options.preventPaste&&!this.editedCell||d.B.getTarget(t)&&d.B.getTarget(t).getAttribute("class")&&d.B.getTarget(t).getAttribute("class").indexOf("w2grid_head_input")>-1)return;if(!1===d.B.fireEvent(this,"oncustompaste",t))return;var o,n=(a.D.isIEAllVersion()?window.clipboardData:t.clipboardData).getData("Text");if("\r\n"==n.slice(-2)?n=n.slice(0,n.length-2):"\n"==n.slice(-1)&&(n=n.slice(0,n.length-1)),this.options.customPasteFormatter)if("string"==typeof this.options.customPasteFormatter){var l=a.D.getGlobalFunction(this.options.customPasteFormatter.wq_trim(),this.scope_id);if("function"==typeof l){var h=l.call(this,n);n=h||n}}else $l("customPasteFormatter의 type은 string이어야 합니다.");if(o="native"===this.options.copyType?[[n]]:Papa.parse(n,{delimiter:"\t"}).data,a.D.isIEAllVersion("6 7")&&'"'===n.slice(0,1)&&'"'===n.slice(-1)&&-1==n.slice(1,-1).indexOf("\t")&&(o=[[n.slice(1,n.length-1)]]),!o||null==o||"undefined"==o)return;if(this.focusedCell.length>0){for(var u,p=this.getColumnOrder(),c=this.htmlInfo.body.rowAttrArr.length,g=this.getDataLength()*c,f=0,m=p.length,y=0,b=null,w=0,v=0;v<this.focusedCell.length;v++){var I=this.focusedCell[v],C=I.focusedRowIndex,x=I.focusedColIndex,_=this.getLocationRowCol(C,x);C=_.rowIndex,x=_.colIndex,w+=_.rowSize*_.colSize-1,g>C&&(g=C),f<C+_.rowSize-1&&(f=C+_.rowSize-1),m>x&&(m=x),y<x+_.colSize-1&&(y=x+_.colSize-1),g==C&&m==x&&(b=I)}var S=0;for(v=this.defaultColCnt+m;v<this.defaultColCnt+y;v++)1==this.hiddenList[v]&&(S+=1);if(this.focusedCell.length>1&&this.focusedCell.length+w!=(f-g+1)*(y-m-S+1))return;var D=!1;if(w>0&&(D=!0),u={focusedRange:{minRow:g,maxRow:f,minCol:m,maxCol:y},startCell:b},
b.focusedRowIndex>=0&&b.focusedColIndex>=0){var R=b.focusedTd;if(R){var L=R.getAttribute("col_id");if(null==L||""==L.wq_trim())return;if("1"==R.getAttribute("colMerged"))return}else{var T=this.getCellInfo(b.focusedColIndex);if(T&&(T.options.colMerge||T.options.colMergeAnd))return}var k=g,A=m,F=this.getOriginalRowCol(g,m),E=(x=F.colIndex,C=F.rowIndex,this.getTotalRow()),M=(this.getTotalCol(),E*c),O=p.length;if(this.options.checkBlankRowOnPaste)for(v=o.length-1;v>-1;v--){for(var N=!0,B=0;B<o[0].length;B++)if(""!=o[v][B].wq_trim()){N=!1;break}N&&o.splice(v,1)}if(!1===d.B.fireEvent(this,"onbeforepaste",{rowIndex:this._getGroupbyDisplayRowIndex(C),colIndex:x,data:o.slice(0)}))return;this.isPaste=!0;var G,H=this,W=function(t){for(var e=H.defaultColCnt+t;e<H.hiddenList.length;e++)if(0==H.hiddenList[e])return e-H.defaultColCnt},V=this.uuid,q=!1,j=function(t){var e=WebSquare.idCache[V],s=e.options.checkReadOnlyOnPasteEnable,r=s?s.split(","):[];if(k+o.length>M&&!a.D.getBoolean(H.options.preventAddRowOnPaste)&&"focus"!==H.options.pasteOption){var n=Math.ceil((k+o.length-M)/c),l=Array(H._dataList.getTotalCol()*n);if(""!=H.depthColumn)for(var h=H._dataList.getCellInfo(H.depthColumn).options.defaultValue,u=0;u<n;u++)l[u*H._dataList.getTotalCol()+H._dataList.getColumnIndex(H.depthColumn)]=h;if(H.options.setDefaultValueOnPaste){var p=H._dataList.getTotalCol();for(u=0;u<p;u++)for(var b=H._dataList.getCellInfo(u).options.defaultValue,w=0;w<n;w++)l[w*p+H._dataList.getColumnIndex(u)]=b}if(H.options.checkReadOnlyOnPaste){var v=!0,I=!1;for(u=0;u<o.length;u++){var C=A,x=k+u;for(w=0;w<o[0].length&&!(null==C||C>=O);w++){var _=(T=H.getOriginalRowCol(x,C)).colIndex,S=T.rowIndex;I=!1;for(var R=0;R<r.length;R++)if(r[R]==e.getColumnID(_)){I=!0;break}if(!H.___getEditReadOnly(S,_)||H.___getEditReadOnly(S,_)&&I){v=!1;break}C=W(C+1)}}if(v)return}if(H.options.checkDisabledOnPaste){var L=!0;for(u=0;u<o.length;u++)for(C=A,x=k+u,w=0;w<o[0].length&&!(null==C||C>=O);w++){var T;_=(T=H.getOriginalRowCol(x,C)).colIndex,S=T.rowIndex;if(!H._getEditDisabled(S,_)){L=!1;break}C=W(C+1)}if(L)return}if(l.length>0){q=!0,H._dataList.setData(l,!0);u=0;for(var F=n,N=new Array(n);u<F;u++)N[u]="C";G=N.length,H._dataList.rowStatusArr=H._dataList.rowStatusArr.slice(0,E).concat(N)}}var B=function(s,n,l){for(var h=function(t,e,i){var o=H.data_td_list[e+(t-H.rowIndex)*H.oneRowDataLength];if(t<H.rowIndex&&(o=null),!(H.groupbyStatus.grouped&&o&&H.hasClass(o,"w2grid_groupby"))){var s=H.getCellInfo(e),r=H._getRealColIndex("body",s.options.col_id)+H.defaultColCnt;if(!s.options.blockSelect&&!H.hiddenList[r]){var a={focusedTd:o,focusedRowIndex:t,focusedColIndex:e};H.options.groupbyDisplayRowIndex&&(a.groupbyDisplayRowIndex=H._getGroupbyDisplayRowIndex(t)),i?H.focusedCell.push(a):H.focusedCell.unshift(a),null!=o&&H.applyFocusedCellIn(o,i)}}},u=s,p=0;p<o.length;p++){for(var g=n,f=0;f<o[p].length&&!(null==g||g>=O);f++){var m=H.getOriginalRowCol(u,g),y=m.colIndex,b=m.rowIndex;if(m.noLeftTop)m.leftCell&&(g=W(g+m.colSize));else{h(b,y,!0);for(var w=!1,v=0;v<r.length;v++)if(r[v]==e.getColumnID(y)){w=!0;break}if(H.options.checkReadOnlyOnPaste&&H.___getEditReadOnly(b,y)&&!w)g=W(g+m.colSize);else if(H.options.checkDisabledOnPaste&&H._getEditDisabled(b,y))g=W(g+m.colSize);else{var I=!1;for(v=0;v<i.length;v++)if(i[v]==e.getColumnID(y)){g=W(g+m.colSize),I=!0;break}if(!I&&!(a.D.getBoolean(H.options.preventAddRowOnPaste)&&H.dataList.getRowCount()*c-1<b||"focus"===H.options.pasteOption&&(g>t.focusedRange.maxCol||g<t.focusedRange.minCol||u>t.focusedRange.maxRow||u<t.focusedRange.minRow))){var C=y,x=H.tdIdList[C],_=H._dataList.getColumnIndex(x),S=H._dataList.dataArr[H.getRealRowIndex(b)*H._dataList.getColumnCount()+_],D=o[p][f],R=H.getCellInfo(C),L=!(!H.isDrillDown||!H._dataList.options.depthColumn)?H.getRealRowIndex(b):b;if("number"!=R.options.dataType&&"float"!=R.options.dataType||(D=D.wq_trim()),
(R.options.selectedDataOnPaste||H.options.selectByLabel)&&("autoComplete"===R.options.inputType||"select"===R.options.inputType)){var T,k=R.getItemArray(),A=R.dataComp;if(R.existGridViewItemsetNode||"gridViewItemset"===R.options.itemTableType){var F=R.itemsetObj.nodeset;F.indexOf("data:")>=0&&(A=F.slice("data:".length))}if(A&&(T=R.mainGrid.modelControl.getDataComp(A)),T&&(!k||0==k.length||1==k.length&&(!0===R.options.chooseOption||!0===R.option.allOption)||2==k.length&&!0===R.options.chooseOption&&!0===R.option.allOption)){var E=T.bodyIdColIndexMap[R.itemsetObj.label],M=T.bodyIdColIndexMap[R.itemsetObj.value],N=T.cellIdList.length,B=T.filteredRowIndexArr.length;if(k=[],T&&"linkedDataList"===T.initializeType&&null!=T.conditionInfo&&T.conditionInfo.filterInfo.useRef)for(var V=0;V<T._dataList.getDataLength();V++){(j={}).label=T._dataList.dataArr[V*N+E],j.value=T._dataList.dataArr[V*N+M],k[V]=j}else for(v=0;v<B;v++){var j={};"linkedDataList"!=T.initializeType&&T.dataArr?(j.label=T.dataArr[T.filteredRowIndexArr[v]*N+E],j.value=T.dataArr[T.filteredRowIndexArr[v]*N+M]):(j.label=T._dataList.dataArr[T.filteredRowIndexArr[v]*N+E],j.value=T._dataList.dataArr[T.filteredRowIndexArr[v]*N+M]),k[v]=j}}var z=!1;if(R.options.selectedDataOnPaste)if(0===k.length)z=!0;else for(var P=0;P<k.length;P++){var X=k[P];switch(R.options.selectedDataOnPaste){case"true":case"both":X.value!==D&&X.label!==D||(z=!0);break;case"value":X.value===D&&(z=!0);break;case"label":X.label===D&&(z=!0);break;default:z=!0}if(z)break}if(!z&&R.options.selectedDataOnPaste){o.length<=G+p&&0===f&&q&&H._drawRowStatus(L-H.rowIndex,L),g=W(g+m.colSize);continue}if(H.options.selectByLabel)for(P=0;P<k.length;P++){if((X=k[P]).label===D){D=X.value;break}}}var U=R.comp&&R.comp.selectedIndex;if("true"===H.options.unformatOnPaste||"true"===R.options.unformatOnPaste){if("calendar"==R.options.inputType&&"date"==R.options.dataType){var Z=0;"yearMonthDate"==R.options.calendarValueType?Z=8:"yearMonth"==R.options.calendarValueType?Z=6:"yearMonthDateHour"==R.options.calendarValueType?Z=10:"yearMonthDateTime"==R.options.calendarValueType?Z=12:"yearMonthDateTimeSec"==R.options.calendarValueType?Z=14:"year"==R.options.calendarValueType&&(Z=4);var K=new WebSquare.validator.validateInvoker;K.addCommand(new WebSquare.validator.allowCharCommand("0-9")),K.addCommand(new WebSquare.validator.maxLengthCommand(Z)),D=K.validateString(D)}var Y=D,$=R.formatter.masking,J=R.formatter.type;D=Y=void 0===J||null==J||"number"!=J&&"float"!=J?void 0!==J&&null!=J&&"date"==J?WebSquare.text.unformatDate2($,Y):void 0!==J&&null!=J&&"time"==J?WebSquare.text.unformatTime($,Y):WebSquare.text.unformatText($,Y):WebSquare.text.unformatCurrency($,Y)}if(R.options.maxLength)if("float"==R.options.dataType){D=new WebSquare.validator.maxFloatLengthCommand(R.options.maxLength,R.options.decimalDelimiter,R.options.delimiter).executeValidateString(D)}else{B=parseInt(R.options.maxLength);isNaN(B)||(D=D.slice(0,B))}if(R.options.allowChar){var Q=R.options.allowChar;if(void 0!==Q&&null!=Q&&""!=Q){var tt=new RegExp("["+Q+"]"),et=!0;for(v=0;v<D.length;v++){if(null==D.charAt(v).match(tt)){et=!1;break}}!1===et&&(D="")}}if(R.options.ignoreChar)D=new WebSquare.validator.ignoreCharCommand(R.options.ignoreChar).executeValidateString(D);if((""!==R.options.escape?R.options.escape:H.options.escape)+""=="true"&&(D=WebSquare.xml.decode(D)),"radio"===R.options.inputType&&R.options.trueValue===D)for(var it=H.getCheckedIndex(C),ot=0;ot<it.length;ot++)H._dataList.setCellData(it[ot],_,R.options.falseValue);if("text"===R.options.inputType||"textImage"===R.options.inputType){var st=a.D.getGlobalFunction(R.options.customModelFormatter,H.scope_id);"function"==typeof st?(H.useCustomModelFormatter=!0,D=st.call(H,D,D,R.editRowIndex,R.getColumnIndex(x))):H.useCustomModelFormatter=!1}if(H._dataList.setCellData(L,_,D),!D&&q&&o.length<=G+p&&H._drawRowStatus(L-H.rowIndex,L),S!=D){var rt={oldValue:S,newValue:D,rowIndex:b,colIndex:C};isNaN(U)||(rt.oldSelectedIndex=U,
rt.newSelectedIndex=R.comp&&R.comp.selectedIndex),d.B.fireEvent(H,"onviewchange",rt)}g=W(g+m.colSize)}}}}u+=1}},j=g,z=m;if(o.length>0&&!D)for(u=1;u<o.length;u++)if(o[u].length!==o[0].length){D=!0;break}if(H.applyFocusedCellOut(),H.focusedCell=[],D)B(g,m);else if(f-g+1>=o.length&&y-m+1>=o[0].length)for(;j<=f-o.length+1;){for(z=m;z<=y-o[0].length+1;){j+o.length>f-o.length+1&&z+o[0].length>y-o[0].length+1&&!1,B(j,z),z+=o[0].length}j+=o.length}else if(f-g+1>=o.length)for(;j<=f-o.length+1;){j+o.length>f-o.length+1&&!1,B(j,z),j+=o.length}else if(y-m+1>=o[0].length)for(;z<=y-o[0].length+1;){z+o[0].length>y-o[0].length+1&&!1,B(j,z),z+=o[0].length}else B(g,m)};if("true"===this.options.showMessageOnPaste){var z=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/pasteMessage/@value");WebSquare.layer.pasteMessageLoaded=!1,WebSquare.layer.showProcessMessage(z,{type:"pasteMsg",scope:this.scope_id||""});var P=function(){WebSquare.layer.pasteMessageLoaded?(a.D.clearTimeout(H.id+"_pasteMessageLoaded"),j(),WebSquare.layer.hideProcessMessage({type:"pasteMsg",scope:this.scope_id||""}),d.B.fireEvent(H,"onafterpaste")):a.D.setTimeout(P,{delay:500,key:H.id+"_pasteMessageLoaded"})};P()}else j(u),d.B.fireEvent(this,"onafterpaste")}}this.isPaste=!1,d.B.preventDefault(t)}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.handleBeforeCopyEvent=function(t){d.B.preventDefault(t)},g.prototype.handleBeforeCutEvent=function(t){d.B.preventDefault(t)},g.prototype.handleCopyEvent=function(t){try{if(!1===d.B.fireEvent(this,"oncustomcopy",t))return;var e=this.options.preventCopyColumn,i=e?e.split(","):[];if(this.options.preventCopy||"native"===this.options.copyType)return;if(s.v.browserCheck.safari){for(var o=document.activeElement,n=!1;null!=o;)o.id&&o.id==this.id&&(n=!0),o=o.parentNode;if(!n)return}var l=a.D.isIEAllVersion()?window.clipboardData:t.clipboardData,h=this.options.copyAmount;if(h||(h="cell"),"cell"==h&&this.focusedCell.length>0){for(var u=[],p=this.getColumnOrder(),c=this.htmlInfo.body.rowAttrArr.length,g=this.getDataLength()*c,f=0,m=p.length,y=0,b=0,w=0;w<this.focusedCell.length;w++){var v=this.focusedCell[w],I=v.focusedRowIndex,C=v.focusedColIndex,x=this.getLocationRowCol(I,C);I=x.rowIndex,C=x.colIndex,b+=x.colSize*x.rowSize-1,g>I&&(g=I),f<I+x.rowSize-1&&(f=I+x.rowSize-1),m>C&&(m=C),y<C+x.colSize-1&&(y=C+x.colSize-1)}"row"==this.options.focusMode&&1==this.options.rowCopy&&(m=0,y=p.length-1);var _=0;for(w=this.defaultColCnt+m;w<y+this.defaultColCnt;w++)1==this.hiddenList[w]&&(_+=1);if(this.focusedCell.length+b==(f-g+1)*(y-m-_+1)||"row"==this.options.focusMode&&1==this.options.rowCopy&&this.focusedCell.length==f-g+1)if(this.isDrillDown){var S=function(t){var e=t[t.length-1];T=T<e?e:T;for(var i=0;i<t.length;i++){var o=this.drilldown.getChildrenRowArr(t[i]);o.length>0&&S.call(this,o)}},D=this._dataList.getRealRowIndex(f),R=this.drilldown.getChildrenRowArr(D),L=this._dataList.getRealRowIndex(g),T=D;this.drilldown.isOpen(f)||S.call(this,R);for(w=L;w<=T;w++){for(var k=[],A=m;A<=y;A++){var F=(W=this.getOriginalRowCol(w,A)).colIndex,E=W.rowIndex;if((!W.noLeftTop||W.leftCell)&&1!=this.hiddenList[A+this.defaultColCnt]){for(var M=this.getCellInfo(F),O=!1,N=0;N<i.length;N++)if(i[N]==M.colID){O=!0;break}if(!O){var B=""!==M.options.escape?M.options.escape:this.options.escape,G=this.drilldown.statusArr;if("display"==M.options.copyOption)q=!1===G[w]?this._getDisplayData(E,this.getColumnID(F)):this._getDisplayData(this.getRealRowIndex(E),this.getColumnID(F));else{var H=this.getColumnID(F);q=this.dataList.getColData(H)[E]}W.noLeftTop&&(q=""),B+""=="true"&&(q=WebSquare.xml._encode(q+"")),(q||this.focusedCell.length>1)&&k.push(q)}}}u.push(k)}}else for(w=g;w<=f;w++){for(k=[],A=m;A<=y;A++){var W;F=(W=this.getOriginalRowCol(w,A)).colIndex,E=W.rowIndex;if((!W.noLeftTop||W.leftCell)&&1!=this.hiddenList[A+this.defaultColCnt]){for(M=this.getCellInfo(F),O=!1,N=0;N<i.length;N++)if(i[N]==M.colID){O=!0;break}if(!O){
B=""!==M.options.escape?M.options.escape:this.options.escape;q="display"==M.options.copyOption?this._getDisplayData(this.getRealRowIndex(E),this.getColumnID(F)):this.dataList.getCellData(E,this.getColumnID(F)),W.noLeftTop&&(q=""),B+""=="true"&&(q=WebSquare.xml._encode(q+"")),(q||this.focusedCell.length>1)&&k.push(q)}}}u.push(k)}else{var V=this.focusedCell[this.focusedCell.length-1];if(null!=V){var q;for(B=""!==(M=this.getCellInfo(V.focusedColIndex)).options.escape?M.options.escape:this.options.escape,w=0;w<i.length;w++)if(i[w]==M.colID)return;q="display"==M.options.copyOption?this._getDisplayData(this.getRealRowIndex(V.focusedRowIndex),this.getColumnID(V.focusedColIndex)):this.dataList._getCellData(V.focusedRowIndex,this.getColumnID(V.focusedColIndex)),B+""=="true"&&(q=WebSquare.xml._encode(q+"")),u.push([q])}}var j=Papa.unparse(u,{delimiter:"\t"});l.setData("Text",j)}d.B.preventDefault(t)}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.handleCutEvent=function(t,e){try{if(!e)if(!1===d.B.fireEvent(this,"oncustomcut",t))return;var i=this.options.preventCopyColumn,o=i?i.split(","):[];if(this.options.preventCopy)return;if(s.v.browserCheck.safari){for(var n=document.activeElement,l=!1;null!=n;)n.id&&n.id==this.id&&(l=!0),n=n.parentNode;if(!l)return}var h=a.D.isIEAllVersion()?window.clipboardData:t.clipboardData,u=this.options.copyAmount;if(u||(u="cell"),"cell"==u&&this.focusedCell.length>0){for(var p=[],c=this.getColumnOrder(),g=this.htmlInfo.body.rowAttrArr.length,f=this.getDataLength()*g,m=0,y=c.length,b=0,w=0,v=0;v<this.focusedCell.length;v++){var I=this.focusedCell[v],C=I.focusedRowIndex,x=I.focusedColIndex,_=this.getLocationRowCol(C,x);C=_.rowIndex,x=_.colIndex,w+=_.rowSize*_.colSize-1,f>C&&(f=C),m<C+_.rowSize-1&&(m=C+_.rowSize-1),y>x&&(y=x),b<x+_.colSize-1&&(b=x+_.colSize-1)}var S=0;for(v=this.defaultColCnt+y;v<b+this.defaultColCnt;v++)1==this.hiddenList[v]&&(S+=1);if(this.focusedCell.length+w==(m-f+1)*(b-y-S+1))for(v=f;v<=m;v++){for(var D=[],R=y;R<=b;R++){var L=this.getOriginalRowCol(v,R),T=L.colIndex,k=L.rowIndex,A=R+this.defaultColCnt;if(1!=this.hiddenList[A]&&!(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(k,T)||e&&this.___getEditReadOnly(k,T)||this.options.checkDisabledOnCut&&this._getEditDisabled(k,T)||e&&this._getEditDisabled(k,T))){for(var F=this.getCellInfo(T),E=!1,M=0;M<o.length;M++)if(o[M]==F.colID){E=!0;break}if(!E&&!L.noLeftTop){var O=""!==F.options.escape?F.options.escape:this.options.escape;if(V="display"==F.options.copyOption?this._getDisplayData(this.getRealRowIndex(k),this.getColumnID(T)):this.dataList.getCellData(k,this.getColumnID(T)),O+""=="true"&&(V=WebSquare.xml._encode(V+"")),""!==V){var N={oldValue:V,newValue:"",rowIndex:k,colIndex:T};d.B.fireEvent(this,"onviewchange",N)}D.push(V),this.dataList.setCellData(k,this.getColumnID(T),"")}}}p.push(D)}else{var B=this.focusedCell[this.focusedCell.length-1],G=B.focusedRowIndex,H=this.getColumnID(B.focusedColIndex),W=!1;if(this.options.checkReadOnlyOnCut&&this.___getEditReadOnly(G,H)&&(W=!0),this.options.checkDisabledOnCut&&this._getEditDisabled(G,H)&&(W=!0),null!=B&&!0!==W){var V;for(F=this.getCellInfo(H),v=0;v<o.length;v++)if(o[v]==F.colID)return;O=""!==F.options.escape?F.options.escape:this.options.escape;if(V="display"==F.options.copyOption?this._getDisplayData(this.getRealRowIndex(G),H):this.dataList.getCellData(G,H),O+""=="true"&&(V=WebSquare.xml._encode(V+"")),""!==V){N={oldValue:V,newValue:"",rowIndex:G,colIndex:B.focusedColIndex};d.B.fireEvent(this,"onviewchange",N)}this.dataList.setCellData(G,H,""),p.push([V])}}if(!e){var q=Papa.unparse(p,{delimiter:"\t"});h.setData("Text",q)}}d.B.preventDefault(t)}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.clickRightButtonCell=function(t){for(var e=d.B.getTarget(t);e&&"TD"!=e.tagName&&"TH"!=e.tagName&&"DIV"!=e.tagName;)e=e.parentNode;var i=e&&this.hasClass(e,this.options.headerTdClass);if(e&&this.hasClass(e,this.options.bodyTdClass)&&(i=!1),i)d.B.preventDefault(t),
d.B.fireEvent(this,"onheaderrightbuttonclick",e.getAttribute("header_id"));else{for(var o=e;o;){if("TH"===o.tagName&&this.hasClass(o,this.options.headerTdClass)){i=!0;break}if("TD"===o.tagName&&this.hasClass(o,this.options.bodyTdClass)){i=!1;break}if("DIV"===o.tagName&&this.hasClass(o,"w2grid_dataLayer")&&0===this.getRowCount()){i=!1;break}o=o.parentNode}e=o}var s,r,a,n,l,h,u=null!=this.editedCell;if(!i&&u&&(s=this.editedCell.editRowIndex,r=this._dataList.getColumnIndex(this.editedCell.id),b=this.getCellInfo(this.editedCell.id),a=this.getColumnIndex(this.editedCell.id),n=this._grid.getRealRowIndex(s),l=this._dataList.dataArr[n*this._dataList.getColumnCount()+r],h=b.comp&&b.comp.selectedIndex),i&&this.options.useHeaderContextMenu){var p=void 0,c=-1,g=parseInt(e.getAttribute("colIndex"),10)-this.defaultColCnt;(_={}).result=p,_.rowIndex=c,_.colIndex=g,_.event=t;var f=[];if(this.focusedCell)for(var m=0;m<this.focusedCell.length;m++)f.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[m].focusedRowIndex),colIndex:this.focusedCell[m].focusedColIndex});_.focusedCell=f;var y={isHeader:!0};y.headerId=e.getAttribute("header_id"),(S=d.B.fireEvent(this,"oncontextopen",c,g,f,y))?this.createContextMenu(_,S):this.contextMenu?this.showContextMenu(_):this.createContextMenu(_)}else if(e&&"TD"==e.tagName&&this.hasClass(e,this.options.bodyTdClass)){var b;if(!1===(p=this.__setFocusedCell(t,e,{allowContextMenuMultiCell:this.options.allowContextMenuMultiCell}))){if(this.focusedCell.length>0)for(m=0;m<this.focusedCell.length;m++)this._applyFocusedCellOut(this.focusedCell[m]);var w=e.className,v=parseInt(e.getAttribute("tdIndex")),I=parseInt(v/this.realRowDataLength);null!=w.match("rowNum")?(c=I,g="rowNum"):null!=w.match("rowStatus")?(c=I,g="rowStatus"):null!=w.match("groupby")?(c="groupby",g=-1):null!=w.match("Subtotal")&&(c="subtotal",g="number"==typeof(g=parseInt(e.getAttribute("colIndex"),10))?g:-1)}else e&&(this.hasClass(e,"w2grid_textImage")||this.hasClass(e,"w2grid_textImage_image"))?(c=parseInt(e.getAttribute("rowIndex"),10),g=parseInt(e.getAttribute("colIndex"),10),this._setFocusedCell(c,g)):i?(c=parseInt(e.getAttribute("rowIndex"),10),g=parseInt(e.getAttribute("colIndex"),10)):(c=this.getFocusedRowIndex(),g=this.getFocusedColumnIndex());if(!i&&e&&u){var C=this._dataList.dataArr[n*this._dataList.getColumnCount()+r];if(l!=C){var x={oldValue:l,newValue:C,rowIndex:s,colIndex:a};isNaN(h)||(x.oldSelectedIndex=h,x.newSelectedIndex=b&&b.comp&&b.comp.selectedIndex),d.B.fireEvent(this,"onviewchange",x)}}if(this.options.senseReader)("text"!=(b=this.getCellInfo(g)).options.inputType&&"secret"!=b.options.inputType||this.___getEditReadOnly(c,g)||this.options.contextMenu)&&d.B.preventDefault(t);else d.B.preventDefault(t);if(d.B.fireEvent(this,"onrightbuttonclick",this._getGroupbyDisplayRowIndex(c),g,t),this.options.contextMenu){(_={}).result=p,_.rowIndex=c,_.colIndex=g;f=[];if(this.focusedCell)for(m=0;m<this.focusedCell.length;m++)f.push({rowIndex:this._getGroupbyDisplayRowIndex(this.focusedCell[m].focusedRowIndex),colIndex:this.focusedCell[m].focusedColIndex});_.focusedCell=f,_.event=t,(S=d.B.fireEvent(this,"oncontextopen",this._getGroupbyDisplayRowIndex(c),g,f))?this.createContextMenu(_,S):this.contextMenu?this.showContextMenu(_):this.createContextMenu(_)}}else if(e&&"DIV"==e.tagName&&this.hasClass(e,"w2grid_dataLayer")&&0===this.getRowCount()){var _,S;if(d.B.preventDefault(t),d.B.fireEvent(this,"onrightbuttonclick",-1,-1,t),this.options.contextMenu)(_={result:!1,rowIndex:-1,colIndex:-1,focusedCell:null}).event=t,(S=d.B.fireEvent(this,"oncontextopen",-1,-1,null))?this.createContextMenu(_,S):this.contextMenu?this.showContextMenu(_):this.createContextMenu(_)}},g.prototype.fireImageClick=function(t,e){var i=this.getCellInfo(e),o=this._getEditDisabled(t,e);if(this.options.useImageClick||0==o){var s=a.D.getGlobalFunction(i.options.imageClickFunction,this.scope_id);"function"==typeof s&&s.call(this,t,e,this.dataList._getCellData(t,e))}},
g.prototype.gridOut=function(t){var e=d.B.getTarget(t);if(this.overElem&&(e.id==this.id+"_dataLayer"||e.id==this.overElem.id||""==e.id)){if(this.options.rowMouseOver&&"TD"==this.overElem.tagName&&this.removeRowOverStyle(this.overElem.parentNode),"TD"===this.overElem.tagName){var i={};this.overElem.getAttribute("col_id")&&(i.rowIndex=this.getElemRowIndex(this.overElem),i.colIndex=this.getColumnIndex(this.overElem.getAttribute("col_id"))),d.B.fireEvent(this,"onbodymouseout",i)}this.bodyOut(t,this.overElem),this.overElem=null}},g.prototype.addRowOverStyle=function(t){for(;null!=t&&(1!=t.nodeType||null==t.getAttribute("trIndex"));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var e=parseInt(t.getAttribute("trIndex"));e>0;)e--,t=a.D.prev(t);var i=a.D.first(t),o=parseInt(i.getAttribute("tdIndex"));if(!isNaN(o)){o=parseInt(o/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var s=this.options.rowMouseOverColor.wq_trim(),r=""==this.options.selectedCellOverColor?"":this.options.selectedCellOverColor.wq_trim(),n=""==this.options.selectedRowOverColor?"":this.options.selectedRowOverColor.wq_trim(),l=0;l<this.realRowDataLength;l++){var h=this.all_data_td_list[o+l],d=s;if(""==r||"cell"!=this.options.focusMode&&"both"!=this.options.focusMode){if(!(""==n||"row"!=this.options.focusMode&&"both"!=this.options.focusMode||"row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&l<this.options.fixedColumn))for(u=parseInt(h.getAttribute("tdIndex")),p=parseInt(u/this.realRowDataLength)+this.rowIndex,g=0;g<this.focusedCell.length;g++)if(p==this.focusedCell[g].focusedRowIndex){d=n;break}}else for(var u=parseInt(h.getAttribute("tdIndex")),p=parseInt(u/this.realRowDataLength)+this.rowIndex,c=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),g=0;g<this.focusedCell.length;g++)if(p==this.focusedCell[g].focusedRowIndex&&c==this.focusedCell[g].focusedColIndex){d=r;break}if(!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&l<this.options.fixedColumn))if(l<this.defaultColCnt){var f=h.className;(""==this.options.rowNumBackgroundColor&&f.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||f.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)&&(h.style.backgroundColor=d)}else h.style.backgroundColor=d;h.removeAttribute("style_bak")}}}},g.prototype.removeRowOverStyle=function(t){if(!(this.options.tooltipHeader&&t&&t.getElementsByTagName("TH").length>0)){for(;null!=t&&(1!=t.nodeType||null==t.getAttribute("trIndex"));)if(null==(t=t.parentNode)||t.id==this.id+"_foot_table")return;if(null!=t){for(var e=parseInt(t.getAttribute("trIndex"));e>0;)e--,t=a.D.prev(t);var i=a.D.first(t),o=parseInt(i.getAttribute("tdIndex"));if(!isNaN(o)){o=parseInt(o/(this.oneRowDataLength+this.defaultColCnt),10)*(this.oneRowDataLength+this.defaultColCnt);for(var s=0;s<this.realRowDataLength;s++){var r=this.all_data_td_list[o+s];if(s<this.defaultColCnt){var n=r.className;if(""==this.options.rowNumBackgroundColor&&n.indexOf(this.options.bodyTdClass+"_rowNumber")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(var l=parseInt(r.getAttribute("tdIndex")),h=parseInt(l/this.realRowDataLength)+this.rowIndex,d=!1,u=0;u<this.focusedCell.length;u++)if(h==this.focusedCell[u].focusedRowIndex){d=!0;break}r.style.backgroundColor=d?this.options.selectedRowColor.wq_trim():""}else r.style.backgroundColor="";else if(n.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)if("row"==this.options.focusMode||"both"==this.options.focusMode){for(l=parseInt(r.getAttribute("tdIndex")),h=parseInt(l/this.realRowDataLength)+this.rowIndex,d=!1,u=0;u<this.focusedCell.length;u++)if(h==this.focusedCell[u].focusedRowIndex){d=!0;break}r.style.backgroundColor=d?this.options.selectedRowColor.wq_trim():""}else r.style.backgroundColor=""}else r.style.backgroundColor=r.getAttribute("or_bgColor")||"";r.removeAttribute("style_bak")}}}}},g.prototype.handleKeyDownEvent=function(t){
this.parentControl&&this.parentControl.options&&"gridViewItemTable"===this.parentControl.options.pluginName||"gridItemTable"===this.parentControl.options.pluginName||0!=d.B.fireEvent(this,"onkeydown",t)&&(this.lastEvent=t,this.headerFocus||this.handleBodyKeyDown(t))},g.prototype.handleKeyUpEvent=function(t){if(0!=d.B.fireEvent(this,"onkeyup",t)){if(this.lastEvent=t,this.editedCell&&this.editedCell._getEditedValue){var e=this.editedCell.options.inputType;if("custom"===e&&!this.editedCell.internal&&this.editedCell.editRowIndex){var i=this.getRealRowIndex(this.editedCell.editRowIndex);e=this.editedCell.cellManagerHashByRowIndex[i].options.inputType}if("text"===e||"textarea"===e||"calendar"===e||"textImage"===e||"secret"===e){var o=t.charCode?t.charCode:t.keyCode,s={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:e,keyCode:o};d.B.fireEvent(this,"oneditkeyup",s)}}else null!=this.beforeEditedCellInfo&&d.B.fireEvent(this,"oneditkeyup",this.beforeEditedCellInfo);this.beforeEditedCellInfo=null}},g.prototype.headerOver=function(t,e){if(!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=e.offsetWidth;if(!(i<2)&&e.firstChild){var o=e.getAttribute("col_id"),s=null;if(o){var n=this.getHeaderInfo(o),l=(g=this.getHeaderInputType(o),n.options.embeddedInput);if(l&&"text"==g){var h=this.getElemRowIndex(e),d=this.getColumnIndex(e.getAttribute("col_id"));l=!this._getEditDisabled(h,d)&&!this.___getEditReadOnly(h,d)}if("textImage"==g||("autoComplete"==g||"calendar"==g)&&"true"==n.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)s=e.getElementsByTagName("td")[0];else{var p=this.event.getTargetIterator(t),c="w2grid_textImage_image";for("true"===n.options.viewTypeIconImage&&("autoComplete"==g?c=this.mainGrid.options.bodyTdClass+"_autoComplete_img":"calendar"==g&&(c=this.mainGrid.options.bodyTdClass+"_calendar_div_img"));p.next();)if(p.match(null,null,"td")&&p.getElement().id){s=this.hasClass(e,c)?e.previousSibling:e,e=p.getElement();break}}}else var g="text";if("text"==g||"textarea"==g||"textImage"==g||"link"==g||"calendar"==g||"expression"==g||"select"==g&&!l||"drilldown"==g||"autoComplete"==g||"checkcombobox"==g||"button"==g||this.options.showImageTooltip&&"image"==g){var f;"textarea"==g?(f=e.cloneNode(!0)).firstChild.style.width="":f=s||e;var m=i,y=e.offsetHeight,b=WebSquare.style.getStyle(e,"text-overflow"),w=20,v=y+3;try{this.options.tooltipPositionX&&(w=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(m,y)),this.options.tooltipPositionY&&(v=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(m,y))}catch(t){u.k.printLog("tooltipPosistion 옵션 적용 중 오류 발생. 옵션 무시하고 기본값 적용.["+this.id+"]"),r.w.printStackTrace(t,null,this)}this.options.tooltipShowAlwaysColumns;if(this.options.tooltipHeaderShowAlways){var I=WebSquare.style.getAbsoluteLeft(e)+w,C=WebSquare.style.getAbsoluteTop(e)+v,x="";if(x="text"==g&&l?f.firstChild.value:"link"==g?"NOBR"==e.firstChild.tagName?f.firstChild.firstChild.innerHTML:f.firstChild.innerHTML:"textImage"==g||("autoComplete"==g||"calendar"==g)&&"true"==n.options.viewTypeIconImage?"NOBR"==s.firstChild.tagName?f.firstChild.innerHTML:f.innerHTML:"image"==g?f.firstChild.src:"drilldown"==g?"NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?f.firstChild.innerHTML:f.innerText.wq_trim(),this.options.tooltipFormatterHeader)try{if("function"==typeof(k=a.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=k(e.getAttribute("col_id"),x)}catch(t){r.w.printStackTrace(t,null,this)}""!=x&&this.showTooltip(I,C,x,v)}else if("ellipsis"==b){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),
this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=f.className,"text"==g&&l?(this.toolTipRuler.innerHTML="<div>"+f.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(f.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(f.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(f.firstChild,"font-weight")):(this.toolTipRuler.innerHTML=f.innerHTML,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(f,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(f,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(f,"font-weight"));var _=this.toolTipRuler.firstChild.offsetWidth;if("textImage"==g||("autoComplete"==g||"calendar"==g)&&"true"==n.options.viewTypeIconImage)var S=s.clientWidth;else S=e.clientWidth;if(3!=f.firstChild.nodeType){var D=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),R=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");_-=parseInt(D||"0",10),_-=parseInt(R||"0",10),"textImage"==g||("autoComplete"==g||"calendar"==g)&&"true"==n.options.viewTypeIconImage?(S-=parseInt(WebSquare.style.getStyle(s.firstChild,"padding-left"),10),S-=parseInt(WebSquare.style.getStyle(s.firstChild,"padding-right"),10),S-=parseInt(WebSquare.style.getStyle(s,"padding-left"),10),S-=parseInt(WebSquare.style.getStyle(s,"padding-right"),10)):(S-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),S-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),S-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),S-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(S<_||"image"==g||S==_&&e.clientWidth<e.scrollWidth){I=WebSquare.style.getAbsoluteLeft(e)+w,C=WebSquare.style.getAbsoluteTop(e)+v,x="";if(x="text"==g&&l?f.firstChild.value:"link"==g?"NOBR"==e.firstChild.tagName?f.firstChild.firstChild.innerHTML:f.firstChild.innerHTML:"textImage"==g||("autoComplete"==g||"calendar"==g)&&"true"==n.options.viewTypeIconImage?"NOBR"==s.firstChild.tagName?f.firstChild.innerHTML:f.innerHTML:"image"==g?f.firstChild.src:"drilldown"==g?"NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?f.firstChild.innerHTML:f.innerText.wq_trim(),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatterHeader)try{if("function"==typeof(k=a.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=k(e.getAttribute("col_id"),x)}catch(t){r.w.printStackTrace(t,null,this)}x.match('href=""')&&(x=x.wq_replaceAll('href=""',"")),this.showTooltip(I,C,x,v)}else this.render.removeChild(this.toolTipRuler)}else{var L=e.firstChild.offsetWidth;if(!0===this.options.showSortableImage){var T=e.firstChild.getElementsByTagName("nobr")[0];T&&(L=T.offsetWidth+parseInt(WebSquare.style.getStyle(e.firstChild,"margin-left"),10))}if(i+3<L){I=WebSquare.style.getAbsoluteLeft(e)+w,C=WebSquare.style.getAbsoluteTop(e)+v,x="";if(x="text"==g&&l?f.firstChild.value:"link"==g?"NOBR"==e.firstChild.tagName?f.firstChild.firstChild.innerHTML:f.firstChild.innerHTML:"image"==g?f.firstChild.src:"drilldown"==g?"NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?f.firstChild.innerHTML:f.innerText.wq_trim(),this.options.tooltipFormatterHeader)try{var k;if("function"==typeof(k=a.D.getGlobalFunction(this.options.tooltipFormatterHeader,this.scope_id)))x=k(e.getAttribute("col_id"),x)}catch(t){r.w.printStackTrace(t,null,this)}this.showTooltip(I,C,x,v)}}}}}},g.prototype.bodyOver=function(t,e){if(this.options.rowStatusTooltipDisplay&&e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0){
var i=p=e.offsetWidth,o="",s=20,n=(C=e.offsetHeight)+3;try{this.options.tooltipPositionX&&(s=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(i,C)),this.options.tooltipPositionY&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(i,C))}catch(t){u.k.printLog("tooltipPosistion 옵션 적용 중 오류 발생. 옵션 무시하고 기본값 적용.["+this.id+"]"),r.w.printStackTrace(t,null,this)}var l=WebSquare.style.getAbsoluteLeft(e)+s,h=WebSquare.style.getAbsoluteTop(e)+n,d=this.getElemRowIndex(e);switch(this.getRowStatus(d)){case"C":o=WebSquare.language.getMessage("Grid_rowStatus_insert");break;case"R":o=WebSquare.language.getMessage("Grid_rowStatus_initialValue");break;case"U":o=WebSquare.language.getMessage("Grid_rowStatus_update");break;case"D":o=WebSquare.language.getMessage("Grid_rowStatus_delete");break;case"V":o=WebSquare.language.getMessage("Grid_rowStatus_D_After_C");break;default:return}if(this.options.tooltipFormatter)try{if("function"==typeof(A=a.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id)))o=A(d=this.getElemRowIndex(e),y=this.getColumnIndex(e.getAttribute("col_id")),o)}catch(t){r.w.printStackTrace(t,null,this)}""!=o&&this.showTooltip(l,h,o,n)}else{if(!this.options.tooltipDisplay)return;if(e.className.indexOf(this.options.bodyTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.bodyTdClass+"_rowStatus")>=0)return;var p;if((p=e.offsetWidth)<2||!e.firstChild)return;var c=e.getAttribute("col_id");if(this.options.tooltipDisplayColumn&&c&&-1===this.options.tooltipDisplayColumn.indexOf(c))return;var g=null;if(c){var f=this.getCellInfo(c);if(0==f.internal&&"custom"==f.options.inputType){d=this.getRealRowIndex(this.getElemRowIndex(e));f=f.cellManagerHashByRowIndex[d]?f.cellManagerHashByRowIndex[d]:f}v=f.options.inputType;var m=f.options.embeddedInput;if(m&&"text"==v){d=this.getElemRowIndex(e);var y=this.getColumnIndex(e.getAttribute("col_id"));m=!this._getEditDisabled(d,y)&&!this.___getEditReadOnly(d,y)}if("textImage"==v||("autoComplete"==v||"calendar"==v)&&"true"==f.options.viewTypeIconImage)if("100%"==e.firstChild.style.width)g=e.getElementsByTagName("td")[0];else{var b=this.event.getTargetIterator(t),w="w2grid_textImage_image";for("true"===f.options.viewTypeIconImage&&("autoComplete"==v?w=this.mainGrid.options.bodyTdClass+"_autoComplete_img":"calendar"==v&&(w=this.mainGrid.options.bodyTdClass+"_calendar_div_img"));b.next();)if(b.match(null,null,"td")&&b.getElement().id){g=this.hasClass(e,w)?e.previousSibling:e,e=b.getElement();break}}}else var v="text";if("checkbox"==v||"radio"==v||"text"==v||"textarea"==v||"textImage"==v||"link"==v||"calendar"==v||"expression"==v||"select"==v&&!m||"drilldown"==v||"autoComplete"==v||"checkcombobox"==v||"button"==v||this.options.showImageTooltip&&"image"==v){var I;"textarea"==v?(I=e.cloneNode(!0)).firstChild.style.width="":I=g||e;i=p;var C=e.offsetHeight,x=WebSquare.style.getStyle(e,"text-overflow");s=20,n=C+3;try{this.options.tooltipPositionX&&(s=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionX)(i,C)),this.options.tooltipPositionY&&(n=new Function("cellWidth","cellHeight","return "+this.options.tooltipPositionY)(i,C))}catch(t){u.k.printLog("tooltipPosistion 옵션 적용 중 오류 발생. 옵션 무시하고 기본값 적용.["+this.id+"]"),r.w.printStackTrace(t,null,this)}var _=this.options.tooltipShowAlwaysColumns;if(this.options.tooltipShowAlways||c&&_&&_.indexOf(c)>-1){l=WebSquare.style.getAbsoluteLeft(e)+s,h=WebSquare.style.getAbsoluteTop(e)+n,o=""
;if("text"==v&&m)o=I.firstChild.value;else if("link"==v)o="NOBR"==e.firstChild.tagName?I.firstChild.firstChild.innerHTML:I.firstChild.innerHTML;else if("textImage"==v||("autoComplete"==v||"calendar"==v)&&"true"==f.options.viewTypeIconImage)o="NOBR"==g.firstChild.tagName?I.firstChild.innerHTML:I.innerHTML;else if("image"==v)o=I.firstChild.src;else if("drilldown"==v)o="NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText;else if("select"==v&&"ul"===f.options.tableRender)o=I.innerText.wq_trim();else if("checkbox"==v||"radio"==v){(S=I.getElementsByTagName("label")[0])&&(o=S.innerText)}else o="NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?I.firstChild.innerHTML:I.innerText.wq_trim();if(this.options.tooltipFormatter)try{if("function"==typeof(A=a.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id)))o=A(d=this.getElemRowIndex(e),y=this.getColumnIndex(e.getAttribute("col_id")),o,p<e.scrollWidth)}catch(t){r.w.printStackTrace(t,null,this)}""!=o&&this.showTooltip(l,h,o,n)}else if("ellipsis"==x){var S;if(("checkbox"==v||"radio"==v)&&!(S=I.getElementsByTagName("label")[0]))return;this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),this.render.appendChild(this.toolTipRuler),this.toolTipRuler.className=I.className,"text"==v&&m?(this.toolTipRuler.innerHTML="<div>"+I.firstChild.value+"</div>",this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(I.firstChild,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(I.firstChild,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(I.firstChild,"font-weight")):("drilldown"==v&&"line"==f.options.depthType?this.toolTipRuler.innerHTML=I.getElementsByTagName("nobr")[0].outerHTML:this.toolTipRuler.innerHTML="checkbox"==v||"radio"==v?S.outerHTML:I.innerHTML,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(I,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(I,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(I,"font-weight"));var D=this.toolTipRuler.firstChild.offsetWidth;if(null!=e.getBoundingClientRect&&(D=this.toolTipRuler.firstChild.getBoundingClientRect().width),"textImage"==v||("autoComplete"==v||"calendar"==v)&&"true"==f.options.viewTypeIconImage){var R=g.clientWidth;null!=e.getBoundingClientRect&&(R=g.getBoundingClientRect().width)}else{R=e.clientWidth;if(null!=e.getBoundingClientRect){var L=(WebSquare.style.getSize(e,"outerwidth")-WebSquare.style.getSize(e,"width"))/2;R=e.getBoundingClientRect().width-L}"drilldown"==v&&"line"==f.options.depthType?R=e.clientWidth-e.firstChild.clientWidth:"checkbox"!=v&&"radio"!=v||(R=e.clientWidth-WebSquare.style.getSize(e.firstChild,"outerMarginWidth"))}if(3!=I.firstChild.nodeType){var T=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-left"),k=WebSquare.style.getStyle(this.toolTipRuler.firstChild,"padding-right");D-=parseInt(T||"0",10),D-=parseInt(k||"0",10),"textImage"==v||("autoComplete"==v||"calendar"==v)&&"true"==f.options.viewTypeIconImage?(R-=parseInt(WebSquare.style.getStyle(g.firstChild,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(g.firstChild,"padding-right"),10),R-=parseInt(WebSquare.style.getStyle(g,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(g,"padding-right"),10)):(R-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(e.firstChild,"padding-right"),10),R-=parseInt(WebSquare.style.getStyle(e,"padding-left"),10),R-=parseInt(WebSquare.style.getStyle(e,"padding-right"),10))}if(R<D||"image"==v||R==D&&e.clientWidth<e.scrollWidth){l=WebSquare.style.getAbsoluteLeft(e)+s,h=WebSquare.style.getAbsoluteTop(e)+n,o=""
;if(o="text"==v&&m?I.firstChild.value:"link"==v?"NOBR"==e.firstChild.tagName?I.firstChild.firstChild.innerHTML:I.firstChild.innerHTML:"textImage"==v||("autoComplete"==v||"calendar"==v)&&"true"==f.options.viewTypeIconImage?"NOBR"==g.firstChild.tagName?I.firstChild.innerHTML:I.innerHTML:"image"==v?I.firstChild.src:"drilldown"==v?"NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?I.firstChild.innerHTML:I.innerText.wq_trim(),this.render.removeChild(this.toolTipRuler),this.options.tooltipFormatter)try{if("function"==typeof(A=a.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id)))o=A(d=this.getElemRowIndex(e),y=this.getColumnIndex(e.getAttribute("col_id")),o)}catch(t){r.w.printStackTrace(t,null,this)}o.match('href=""')&&(o=o.wq_replaceAll('href=""',"")),this.showTooltip(l,h,o,n)}else this.render.removeChild(this.toolTipRuler)}else{if(p+3<e.firstChild.offsetWidth){l=WebSquare.style.getAbsoluteLeft(e)+s,h=WebSquare.style.getAbsoluteTop(e)+n,o="";if(o="text"==v&&m?I.firstChild.value:"link"==v?"NOBR"==e.firstChild.tagName?I.firstChild.firstChild.innerHTML:I.firstChild.innerHTML:"image"==v?I.firstChild.src:"drilldown"==v?"NOBR"==e.firstChild.tagName?e.firstChild.innerText.replace(/^\s*/,""):e.innerText:"NOBR"==e.firstChild.tagName||"BUTTON"==e.firstChild.tagName?I.firstChild.innerHTML:I.innerText.wq_trim(),this.options.tooltipFormatter)try{var A;if("function"==typeof(A=a.D.getGlobalFunction(this.options.tooltipFormatter,this.scope_id)))o=A(d=this.getElemRowIndex(e),y=this.getColumnIndex(e.getAttribute("col_id")),o)}catch(t){r.w.printStackTrace(t,null,this)}this.showTooltip(l,h,o,n)}}}}},g.prototype.bodyOut=function(t,e){var i=this;(i.options.tooltipDisplay||i.options.headerTooltipDisplay||this.options.tooltipHeader||i.options.rowStatusTooltipDisplay)&&e&&i.hideTooltip()},g.prototype.showTooltip=function(t,e,i,o){if(null==this.editedCell){var r=document.body.scrollWidth;this.tooltip||(this.tooltip=new WebSquare.uiplugin.output(this.id+"_tooltip",{className:"w2grid_tooltip "+this.options.tooltipClass,style:"position:absolute;"+this.options.tooltipStyle}),this.tooltip.parentFrame=this.parentFrame,this.tooltip.writeTo(WebSquare.getBody()),this.tooltip.activate(),"click"===this.options.tooltipHide?this.tooltip.render.onclick=function(){this.style.display="none"}:this.tooltip.render.onmouseover=function(){this.style.display="none"}),"click"===this.options.tooltipHide&&(1==WebSquare.getBody().hasClass("w2drag_activate")?(this.tooltip.render.onclick=null,this.tooltip.render.onmouseover=function(){this.style.display="none"}):(this.tooltip.render.onclick=function(){this.style.display="none"},this.tooltip.render.onmouseover=null)),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",t+"px"),this.tooltip.setStyle("top",e+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.tooltip.render.innerHTML=i,d.B.fireEvent(this,"ontooltipshow");var a=this.tooltip.render.offsetTop+this.tooltip.render.offsetHeight+20,n=document.body.scrollHeight;if(null!=WebSquare.BootLoader.fullViewRatio&&(n=document.body.clientHeight+Math.abs(document.body.getBoundingClientRect().top)),a>n){var l=e-(o+this.tooltip.render.offsetHeight);l<0&&(l=0),this.tooltip.setStyle("top",l+"px")}if(document.body.scrollWidth>r){var h=t-(document.body.scrollWidth-r);h<0&&(h=0),this.tooltip.setStyle("left",h+"px")}this.options.tooltipDisplayTime>0&&s.v.setTimer(this.hideTooltip,{key:this.id+"_tooltip_hide_timer",caller:this,delay:this.options.tooltipDisplayTime})}},g.prototype.hideTooltip=function(){this.tooltip&&(this.options.tooltipDisplayTime>0&&s.v.clearTimer(this.id+"_tooltip_hide_timer"),d.B.fireEvent(this,"ontooltiphide"),this.tooltip.setStyle("display","none"))},g.prototype.bodyClick=function(t,e){try{var i=this.getLastFocusedCell().focusedTd
;this.options.rowMouseOver&&this.removeRowOverStyle(this.lastOverSrc,"grid_body_row_over","grid_body_row");var o=this.rowIndex,s=parseInt(e.getAttribute("tdIndex")),n=(S=parseInt(s/this.realRowDataLength))+this.rowIndex,l=e.getAttribute("col_id"),h=this._dataList.getRowPosition(),u=this.getColumnIndex(this._dataList.getColumnPosition()),p=S+o,c=s%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(l&&(x=this.getCellInfo(l)),"number"!=typeof(L=this.dataList.getRealRowIndex(n)))return void(L&&"header"==L.type&&this.toggleGroup(L.groupId));if(this.options.focusDefaultColumn){var g=e.getAttribute("id")||"",f="_headerRowNumber"===g.slice(0,"_headerRowNumber".length),m="_headerRowStatus"===g.slice(0,"_headerRowStatus".length);if(f||m)return this.__setFocusedCell(t,e,{editMode:!1}),void(m?d.B.fireEvent(this,"onrowstatusclick",p):d.B.fireEvent(this,"onrownumclick",p))}if(null==l)return;this.moveDirection=null;var y=u-c,b=h-p;0==y&&0==b?this.moveDirection="none":(y>0||y<0)&&(b>0||b<0)?this.moveDirection="both":y>0||y<0?this.moveDirection="column":(b>0||b<0)&&(this.moveDirection="row");var w=e.getAttribute("editModeEvent")||"",v=!1;if(""!=w&&"onsecondclick"==w.toLowerCase()||""==w&&"onsecondclick"==this.options.editModeEvent.toLowerCase())for(var I=0;I<this.focusedCell.length;I++)this.focusedCell[I].focusedRowIndex==p&&this.focusedCell[I].focusedColIndex==c&&(v=!0);var C,x=this.getCellInfo(e);d.B.getTarget(t);if(!x.options.blockSelect&&("button"!=x.options.inputType||this._getEditDisabled(p,c)||this.___getEditReadOnly(p,c))){var _=!0;if(this.options.preventDuplicateFocusedCell&&"linear"===this.options.focusFlow&&"link"!==x.options.inputType&&(_=!1),_){if("enter"===this.options.drilldownToggle&&this.isMobile&&this.isHammerEnabled())if(1==this.focusedCell.length)if((x=this.getCellInfo(this.focusedCell[0].focusedColIndex))&&"drilldown"==x.options.inputType){s=parseInt(e.getAttribute("tdIndex"));var S=parseInt(s/this.realRowDataLength),D=(l=parseInt(e.getAttribute("colIndex")),p=this._getGroupbyDisplayRowIndex(S+o),c=s%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),this.focusedCell[0].focusedColIndex),R=this.focusedCell[0].focusedRowIndex;if(p===R&&c===D){var L=this.dataList.getRealRowIndex(R);this.toggle(L)}}this.__setFocusedCell(t,e,{editMode:"none"==x.options.focusMode,dont_fixScroll:this.options.CellClickFixScrollX})}x.options.embeddedInput&&(this.focusedByApi=!1)}if(t.altKey&&!0===this.options.contextMenuAltClick)return void this.clickRightButtonCell(t);var T=!0;switch(C=a.D.isIE()?t.srcElement:t.target,x.options.inputType){case"radio":case"checkbox":if("INPUT"!=C.tagName)if(!this.options.checkOnCellClick||"LABEL"==C.tagName||this._getEditDisabled(p,c)||this.___getEditReadOnly(p,c))T=!1;else{var k=e.getElementsByTagName("input")[0];k&&(k.checked=!k.checked)}case"drilldown":this.options.ignoreToggleOnDisabled&&this._getEditDisabled(n,l)&&(T=!1)}var A,F=!1,E=this.isHammerEnabled();if(T&&!(A=this.setCellClickEdit(e))){w=e.getAttribute("editModeEvent")||x.options.editModeEvent||"";var M=null!=i&&i===e,O=""!=w&&"onclick"==w.toLowerCase()||""==w&&"onclick"==this.options.editModeEvent.toLowerCase()||v;if((!E||M)&&O){if(!this._getEditDisabled(n,l)){s=parseInt(e.getAttribute("tdIndex")),S=parseInt(s/this.realRowDataLength),l=parseInt(e.getAttribute("colIndex"));var N=e.getAttribute("col_id");p=this._getGroupbyDisplayRowIndex(S+o),c=s%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.hideTooltip(),!("button"===(x=this.getCellInfo(c)).options.inputType||!x.options.embeddedInput&&("checkbox"===x.options.inputType||"radio"===x.options.inputType)&&this.options.preventMultipleClick)){var B=!1
;if(0==x.internal&&"custom"==x.options.inputType)("button"===(G=x.cellManagerHashByRowIndex[this.getRealRowIndex(p)]?x.cellManagerHashByRowIndex[this.getRealRowIndex(p)]:x).options.inputType||!G.options.embeddedInput&&("checkbox"===G.options.inputType||"radio"===G.options.inputType)&&this.options.preventMultipleClick)&&(B=!0);B||"drilldown"==x.options.inputType&&this.options.ignoreCellClick&&A||d.B.fireEvent(this,"oncellclick",p,c,N)}F=!0}this.setEditMode(e)}}if(!F&&!this._getEditDisabled(n,l)){s=parseInt(e.getAttribute("tdIndex")),S=parseInt(s/this.realRowDataLength),l=parseInt(e.getAttribute("colIndex")),N=e.getAttribute("col_id"),p=S+o,c=s%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(E||this.options.tooltipDisplay&&this.isMobile?this.bodyOver(t,e):this.hideTooltip(),!("button"===(x=this.getCellInfo(c)).options.inputType||!x.options.embeddedInput&&("checkbox"===x.options.inputType||"radio"===x.options.inputType&&this.options.preventDuplicateFocusedCell)&&this.options.preventMultipleClick&&!(this.options.checkOnCellClick&&"LABEL"!=C.tagName))){var G;if(0==x.internal&&"custom"==x.options.inputType)if("button"===(G=x.cellManagerHashByRowIndex[this.getRealRowIndex(p)]?x.cellManagerHashByRowIndex[this.getRealRowIndex(p)]:x).options.inputType||!G.options.embeddedInput&&"checkbox"===G.options.inputType&&this.options.preventMultipleClick)return;p=this._getGroupbyDisplayRowIndex(p),"drilldown"==x.options.inputType&&this.options.ignoreCellClick?A||d.B.fireEvent(this,"oncellclick",p,c,N):("radio"!==x.options.inputType&&"checkbox"!==x.options.inputType||"LABEL"!==C.tagName)&&d.B.fireEvent(this,"oncellclick",p,c,N)}}}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.bodyDblClick=function(t,e){if("INPUT"==e.tagName)var i=this.getLastFocusedCell(),o=i.focusedRowIndex,s=i.focusedColIndex;else{var r=parseInt(e.getAttribute("tdIndex"));o=parseInt(r/this.realRowDataLength)+this.rowIndex,s=e.getAttribute("col_id")}if(null!=s){var a=e.getAttribute("editModeEvent")||"";if((""!=a&&"ondblclick"==a.toLowerCase()||""==a&&"ondblclick"==this.options.editModeEvent.toLowerCase())&&this.setEditMode(e),!this._getEditDisabled(o,s)){this.rollbackCommitFlag=!1;var n=this.isHammerEnabled(),l=this.getCellInfo(s);if(n||l.options.blockSelect)d.B.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(o),this.getColumnIndex(s),this.getColumnID(s));else{var h=this.getFocusedColumnIndex();d.B.fireEvent(this,"oncelldblclick",this._getGroupbyDisplayRowIndex(this._getFocusedRowIndex()),h,this.getColumnID(h))}this.rollbackCommitFlag=!0}}},g.prototype.headerClick=function(t,e){this.focusedByApi=!1,this.options.tooltipHeader&&this.hideTooltip();var i=e.getAttribute("header_id");if(this.options.preventMultipleClick&&this.headerInfoHash[i]&&this.headerInfoHash[i].options&&"checkbox"===this.headerInfoHash[i].options.inputType||1!=this._getHeaderDisabled(i)&&d.B.fireEvent(this,"onheaderclick",i),null!=this.editedCell&&this.editedCell.handleEndEdit(),1==this.noevent);else if(this.getDataLength()>0&&"onclick"==this.options.sortEvent&&(this.options.sortable||"true"==e.getAttribute("sortable"))&&!this.groupbyStatus.grouped&&(this.fireSortEvent(t,e),this.options.sortHeaderDiv)){var o=e.getElementsByTagName("button");if(o.length>0)o[o.length-1].focus(),1==this.options.senseReader&&(this.focusedCell=[],this.addGridScroll(0-this.rowIndex))}this.noevent=!1},g.prototype.headerDdlClick=function(t,e){d.B.fireEvent(this,"onheaderdblclick",e.getAttribute("header_id")),this.getDataLength()>0&&("ondblclick"!=this.options.sortEvent||!this.options.sortable&&"true"!=e.getAttribute("sortable")||this.groupbyStatus.grouped||this.fireSortEvent(t,e)),this.groupbyStatus.grouped&&this.options.sortable||(this.noevent=!1)},g.prototype.fireGroupByRangeSortEvent=function(t,e){try{return}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.recursiveRangeSort=function(t,e,i){try{return}catch(t){r.w.printStackTrace(t,null,this)}},
g.prototype.fireSortEvent=function(t,e){if(!e.disabled&&!(e.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||e.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0)){var i=e.getAttribute("header_id");if("false"!==this.getHeaderConfigValue(e,i,"sortable")){var o=this.headerToBodyRelation[i],s=e.getAttribute("orderByColumn");s&&this.bodyIdColIndexMap[s]&&(o=s);var r=!this.options.useCtrlOnMultisort||(t.ctrlKey||t.metaKey);this.options.preventMultisort&&(r=!1);var a=this.cellInfoHash[o];if("gridView"!=this.initializeType||"expression"!=a.options.inputType||"true"==a.options.expressionSort){if(null==this.headerSortStatusArr&&(this.headerSortStatusArr=[]),this.headerSortStatusArr[o]){if(this.options.noSortInit?-1==this.headerSortStatusArr[o].sortOrder?this.headerSortStatusArr[o].sortOrder=1:this.headerSortStatusArr[o].sortOrder=-1:this.options.sortOrderReverse?this.headerSortStatusArr[o].sortOrder=(this.headerSortStatusArr[o].sortOrder+3)%3-1:this.headerSortStatusArr[o].sortOrder=(this.headerSortStatusArr[o].sortOrder-3)%3+1,!r){var n=this.headerSortStatusArr[o];this.clearHeaderSort(),this.headerSortStatusArr.push(n),this.headerSortStatusArr[o]=this.headerSortStatusArr[0]}}else{(n={}).headerId=i,n.colID=o,this.options.sortOrderReverse?n.sortOrder=-1:n.sortOrder=1;a=this.getCellInfo(o);var l=this.getColumnOption(a.options.col_id,"dataType"),h=this._dataList.getCellInfo(o).options.dataType;n.dataType="number"==l||"bigDecimal"===l||"float"==l?l:h,r?(this.headerSortStatusArr.push(n),this.headerSortStatusArr[o]=this.headerSortStatusArr[this.headerSortStatusArr.length-1]):(this.clearHeaderSort(),this.headerSortStatusArr.push(n),this.headerSortStatusArr[o]=this.headerSortStatusArr[0])}var u=[],p=[],c=(l=[],{});if(c.headerId=i,c.bodyColId=o,c.sortOrder=this.headerSortStatusArr[o].sortOrder,0==this.headerSortStatusArr.length)this.dataList.clearSortFilter();else{for(var g=this.headerSortStatusArr.length-1;g>=0;g--)if(0==this.headerSortStatusArr[g].sortOrder){var f=this.headerSortStatusArr[g].colID;if(this.setHeaderSortImage(i,0,0),this.headerSortStatusArr.splice(g,1),delete this.headerSortStatusArr[f],0==this.headerSortStatusArr.length)return d.B.fireEvent(this,"onbeforesort",c),this.dataList.clearSort(),void d.B.fireEvent(this,"onsort",c)}else u.push(this.headerSortStatusArr[g].colID),p.push(this.headerSortStatusArr[g].sortOrder),l.push(this.headerSortStatusArr[g].dataType);if(u.reverse(),p.reverse(),l.reverse(),0==d.B.fireEvent(this,"onbeforesort",c))return;this.dataList.setFilter({type:"sort",sortIndex:u.join(" "),sortOrder:p.join(" "),dataType:l.join(" "),focuseMode:this.options.filterFocusMode,ignoreEmptyStringOnSort:this.options.ignoreEmptyStringOnSort,setEmptyStringFirstOnSort:this.options.setEmptyStringFirstOnSort,setEmptyStringSortableOnSort:this.options.setEmptyStringSortableOnSort})}this.drawHeaderSortImages(),d.B.fireEvent(this,"onsort",c)}}}},g.prototype.footerClick=function(t,e){d.B.fireEvent(this,"onfooterclick",e.getAttribute("footer_id")),null!=this.editedCell&&this.editedCell.handleEndEdit()},g.prototype.footerDblClick=function(t,e){d.B.fireEvent(this,"onfooterdblclick",e.getAttribute("footer_id")),null!=this.editedCell&&this.editedCell.handleEndEdit()},g.prototype.subtotalClick=function(t,e){try{for(var i=e.getAttribute("id"),o=e.parentNode.getAttribute("targetcolumnid"),s=0,a=-1,n=0;n<this.subtotalRowHash[o].length;n++)if(this.subtotalRowHash[o][n]===e.parentNode){a=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(a>-1){var l=this._dataList.getCellData(a,o);for(s=a-1;this._dataList.getCellData(s,o)==l&&s>=0;s--);s++}var h={colID:i,startRowIndex:s,endRowIndex:a,element:e};d.B.fireEvent(this,"onsubtotalclick",h),null!=this.editedCell&&this.editedCell.handleEndEdit()}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.subtotalDblClick=function(t,e){try{
for(var i=e.getAttribute("id"),o=e.parentNode.getAttribute("targetcolumnid"),s=0,a=-1,n=0;n<this.subtotalRowHash[o].length;n++)if(this.subtotalRowHash[o][n]===e.parentNode){a=parseInt(e.parentNode.getAttribute("data-subtotalrowindex"),10);break}if(a>-1){var l=this._dataList.getCellData(a,o);for(s=a-1;this._dataList.getCellData(s,o)==l&&s>=0;s--);s++}var h={colID:i,startRowIndex:s,endRowIndex:a,element:e};d.B.fireEvent(this,"onsubtotaldblclick",h)}catch(t){r.w.printStackTrace(t,null,this)}},g.prototype.handleTouchStart=function(t){!this.isHammerEnabled()&&this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip(),s.v.clearTimer(this.id+"_iScroll_slideX");var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;(e||i)&&(this.iScrollAddMoveClass(),this.iScroll.moveDirection=null,this.iScroll.propagation=null,this.iScroll.prevTouches=[{x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY}],s.v.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime}))},g.prototype.handleTouchMove=function(t){if("pass"!=this.iScroll.propagation){this.iScroll.addMoveClass&&(this.iScrollAddMoveClass(),this.iScroll.addMoveClass=!1);var e=t.touches&&1==t.touches.length,i=window.navigator.msPointerEnabled&&"touch"==t.pointerType;if(e||i){var o=this.scrollX_right,r=this.getElementById(this.id+"_scrollY_div");this.iScroll.prevTouches.push({x:e?t.touches[0].pageX:t.pageX,y:e?t.touches[0].pageY:t.pageY});var a=this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2),n=a[0].x-a[1].x,l=a[0].y-a[1].y,h=this.iScroll.moveDirection;if(h||(h=this.iScroll.moveDirection=Math.abs(l)>=Math.abs(n)?"Y":"X",this.iScroll.moveDistance=Math.abs(l)>=Math.abs(n)?Math.abs(l):Math.abs(n)),this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===h)return void d.B.stopEvent(t);var u=this.hasSubtotal&&this.lastSubtotalRow&&"none"==this.lastSubtotalRow.style.display;if("X"==h&&n<0&&0==o.scrollLeft||"X"==h&&n>0&&o.scrollLeft>=o.firstChild.offsetWidth-o.offsetWidth||"Y"==h&&l<0&&0==r.scrollTop||"Y"==h&&l>0&&this.rowIndex+this.lastIndex+1==this.getDataLength()&&!u||"Y"==h&&this.hasClass("w2grid_adaptive_crosstab")||"Y"==h&&0===this.getDataLength())return void("stop"==this.iScroll.propagation?d.B.stopEvent(t):(this.iScrollRemoveMoveClass(),this.iScroll.prevTouches=[],this.iScroll.propagation="pass"));"X"==h?this.moveXScroll(n):this.moveYScroll(l),this.iScroll.propagation="stop",d.B.stopEvent(t),s.v.setTimer((function(){this.iScrollRemoveMoveClass(),this.iScroll.addMoveClass=!0}),{key:this.id+"_iScroll",caller:this,delay:this.options.iScrollMoveEffectTime})}}},g.prototype.handleTouchEnd=function(t){if(this.isMobile||window.navigator.msPointerEnabled&&this.iScroll.prevTouches&&"touch"==t.pointerType){s.v.clearTimer(this.id+"_iScroll"),this.iScroll.prevTouches=this.iScroll.prevTouches.splice(-2);var e=this.iScroll.prevTouches;if(e.length>=2){var i=e[0].x-e[1].x;if(this.options.scrollByColumnAdaptive&&this.event.hasEvent(this.id+"_body_tbody","onscroll")&&"X"===this.iScroll.moveDirection){var o=this.getElementById(this.id+"_body_tbody"),r=o.firstChild.offsetWidth,a=0;return i>0?a=Math.ceil(i/r)*r:i<0&&(a=Math.floor(i/r)*r),void(o.scrollLeft=Math.floor((o.scrollLeft+a)/r)*r)}var n=new Date;this.slideX(i,n)}else this.iScrollRemoveMoveClass()}},g.prototype.iScrollAddMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__addClass(t,"w2grid_iScrollX_move"),this.__addClass(e,"w2grid_iScrollY_move")},g.prototype.iScrollRemoveMoveClass=function(){var t=this.getElementById(this.id+"_iScrollX"),e=this.getElementById(this.id+"_iScrollY");this.__removeClass(t,"w2grid_iScrollX_move"),this.__removeClass(e,"w2grid_iScrollY_move")},g.prototype.moveXScroll=function(t){
var e=this.getElementById(this.id+"_iScrollX"),i=this.getElementById(this.id+"_dataLayer"),o=this.getElementById(this.id+"_scrollX_left"),s=this.scrollX_right;s.scrollLeft+=t;var r=parseInt(o.style.width,10),a=s.firstChild.offsetWidth-s.offsetWidth,n=parseInt(s.offsetWidth*s.offsetWidth/s.firstChild.offsetWidth,10);e.style.width=(n<30?30:n)+"px",e.style.left=r+s.scrollLeft/a*(i.offsetWidth-r-e.offsetWidth)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},g.prototype.slideX=function(t,e){var i=new Date,o=parseInt(t/3,10);this.moveXScroll(o),t-=o,Math.abs(t)>=0&&i-e<this.options.iScrollSlideTime?(s.v.clearTimer(this.id+"_iScroll_slideX"),s.v.setTimer(this.slideX,{key:this.id+"_iScroll_slideX",caller:this,delay:this.options.iScrollSlidePeriod,args:[t,e]})):this.iScrollRemoveMoveClass()},g.prototype.moveYScroll=function(t){t*=parseInt(this.options.touchScrollDelta,10)||5;var e=this.getElementById(this.id+"_iScrollY"),i=this.getElementById(this.id+"_scrollY_div");i.scrollTop+=t;var o=i.firstChild.offsetHeight,s=this.getElementById(this.id+"_dataLayer"),r=o-s.offsetHeight,a=parseInt(s.offsetHeight*s.offsetHeight/o,10);e.style.height=(a<30?30:a)+"px",e.style.top=i.scrollTop/r*(s.offsetHeight-e.offsetHeight)+"px",this.options.tooltipDisplay&&this.isMobile&&this.hideTooltip()},g.prototype.tbodyMoveXScroll=function(t){if(this.editedCell&&this.editedCell.handleEndEdit(),!this.mobile&&this.options.scrollByColumnAdaptive,this.options.adaptiveSlideHeader){var e=this.options.adaptive,i=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==e&&!(a.D.isIE()&&parseInt(s.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=i&&this.slideHeadObj&&"absolute"==this.slideHeadObj.render.style.position){this.slideHeadObj.hidden&&($(this.slideHeadObj.render.firstChild).animate({width:"show"}),this.slideHeadObj.hidden=!1);var o=this,r=function(){a.D.setTimeout((function(){null!=WebSquare.userTimerHash[o.id+"_adaptiveSlideHeader"]?(a.D.clearTimeout(o.id+"_adaptiveSlideHeader"),r()):o.slideHeadObj.hidden||($(o.slideHeadObj.render.firstChild).animate({width:"hide"}),o.slideHeadObj.hidden=!0)}),{delay:1e3,key:o.id+"_adaptiveSlideHeader"})};r()}}};var f=function(){};f.prototype.nonCharKeys={4:"insert",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",9:"tab",13:"enter",46:"del",16:"shift",17:"ctrl",18:"alt",21:"hanyoung",25:"hanja",91:"window",20:"capslock",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"numlock",145:"scrolllock"},f.prototype.handleBodyKeyDown=function(t){if(this.isKeyPressed=!0,this.editMode){var e=this.editedCell.options.inputType;switch("text"!==e&&"textarea"!==e&&"calendar"!==e&&"textImage"!==e&&"secret"!==e||(this.beforeEditedCellInfo={rowIndex:this.editedCell.editRowIndex,colIndex:this.getColumnIndex(this.editedCell.id),colID:this.getColumnID(this.editedCell.id),oldValue:this.editedCell.beforeEditValue||"",newValue:this.editedCell._getEditedValue(),inputType:e,keyCode:t.charCode?t.charCode:t.keyCode}),D=t.keyCode){case 9:if(d.B.stopEvent(t),"down"==this.options.tabKeyMove){if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;l=!1,"calendar"===e&&(l=this.options.keyMoveEditMode&&"down"==this.options.tabKeyMove);var i=this.editedCell.id}if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t,l],{checkFunc:function(t){return t+""!="false"}})){var o=!1;if("down"===this.options.tabKeyMove){var r=this.getLastFocusedCell().focusedColIndex;o=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,i);var n=this.getLastFocusedCell().focusedColIndex
;"focusNextTabOrder"===o?(this._fireOnviewchange(i,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(i))]),this.focusNextTabOrder()):(!o||r!==n&&null!=r&&null!=n)&&this._fireOnviewchange(i,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(i))])}else o=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);o||this._setFocusedCell(this.editMode)}break;case 13:if("textarea"==this.editedCell.options.inputType&&!t.ctrlKey)break;if(0==this.editedCell.internal&&"custom"==this.editedCell.options.inputType&&"textarea"==(this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]?this.editedCell.cellManagerHashByRowIndex[this.editedCell.editRowIndex]:this.editedCell).options.inputType)break;var l=!1;a.D.isIEAllVersion()&&"calendar"===e&&(l=this.options.keyMoveEditMode&&"right"!=this.options.enterKeyMove&&"none"!=this.options.enterKeyMove);i=this.editedCell.id;if(!1!==this._fireOnviewchange(this.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}}))if(l){x=this;setTimeout((function(){var e=!1;if("right"==x.options.enterKeyMove||"editRight"==x.options.enterKeyMove)e=x.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=x.options.enterKeyMove&&"edit"!=x.options.enterKeyMove){var o=x.getLastFocusedCell().focusedColIndex;e=x.moveVertical(t,t.shiftKey?"up":"down",x.options.keyMoveEditMode,i);var s=x.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===e?(x._fireOnviewchange(i,"_handleEndEdit_focus",[x.getInput(x.getCellInfo(i))]),x.focusNextTabOrder()):(!e||o!==s&&null!=o&&null!=s)&&x._fireOnviewchange(i,"_handleEndEdit_focus",[x.getInput(x.getCellInfo(i))])}e||x._setFocusedCell(x.editMode)}),1)}else{o=!1;if("right"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove)o=this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode);else if("none"!=this.options.enterKeyMove&&"edit"!=this.options.enterKeyMove){r=this.getLastFocusedCell().focusedColIndex;o=this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode,i);n=this.getLastFocusedCell().focusedColIndex;"focusNextTabOrder"===o?(this._fireOnviewchange(i,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(i))]),this.focusNextTabOrder()):(!o||r!==n&&null!=r&&null!=n)&&this._fireOnviewchange(i,"_handleEndEdit_focus",[this.getInput(this.getCellInfo(i))])}o||this._setFocusedCell(this.editMode)}break;case 27:this.editedCell.handleCancelEdit(t),this._setFocusedCell(),d.B.stopEvent(t);break;case 86:if((t.ctrlKey||t.metaKey)&&this.options.preventPaste&&!this.editedCell){d.B.stopEvent(t);break}default:var h={};h.rowIndex=this.editedCell.editRowIndex,h.colIndex=this._dataList.getColumnIndex(this.editedCell.id),h.colID=this.editedCell.id,h.keyCode=t.charCode?t.charCode:t.keyCode,this.editedCell._getEditedValue&&(this.editedCell.beforeEditValue=this.editedCell._getEditedValue()),d.B.fireEvent(this,"oneditkeydown",h)}}else{if(this.options.ignoreKeyCheckFunction){var u=null,p=!1;try{if("function"==typeof this.options.ignoreKeyCheckFunction?u=this.options.ignoreKeyCheckFunction:"function"==typeof(u=a.D.getGlobalFunction(this.options.ignoreKeyCheckFunction,this.scope_id))&&(this.options.ignoreKeyCheckFunction=u),"function"==typeof u&&(p=u.call(this,t)),p)return void d.B.preventDefault(t)}catch(t){u=null}}if("none"!=this.options.focusMode&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){if(13==t.keyCode&&document.activeElement==this.render&&(this._setFocusedCell(),d.B.stopEvent(t)),"A"!=d.B.getTarget(t).tagName)return;for(var c=this.event.getTargetIterator(t,this.render),g=!1;c.next();)if(c.match("gridBodyDefault")){g=!0;var f=c.getElement(),m=parseInt(f.getAttribute("tdIndex")),y=parseInt(m/this.realRowDataLength),b=f.getAttribute("col_id"),w=this.getColumnIndex(b);this.focusedCell.push({focusedTd:f,focusedRowIndex:y,focusedColIndex:w});var v=f.getElementsByTagName("a")
;if(-1==this.focusedCellLinkIndex)for(var I=0;I<v.length;I++)document.activeElement==v[I]&&(this.focusedCellLinkIndex=I);this.focusedCellLinkLength=v.length;break}if(!g)return}var C=!1;if(s.v.browserCheck.safari&&(t.ctrlKey||t.metaKey)){this.tempEditableCell=document.activeElement,this.tempEditableCell.contentEditable="true",this.tempEditableCell.style.textShadow="0 0 0 "+WebSquare.style.getStyle(this.tempEditableCell,"color"),this.tempEditableCell.style.color="transparent";var x=this;s.v.setTimer((function(){x.tempEditableCell.contentEditable="inherit",this.tempEditableCell.style.color="",this.tempEditableCell.style.textShadow=""}),{key:this.id+"_tempEditableCell_contentEditable",caller:this,delay:500})}switch(t.keyCode){case 37:case 39:if(this.options.moveKeyEditMode){var _=37==t.keyCode?"left":"right";return this.moveHorizontal({byApi:!0},_,!0),void d.B.stopEvent(t)}case 38:case 40:if(this.skipScrollEndEvent=!1,this.skipScrollStartEvent=!1,this.options.moveKeyEditMode){_=38==t.keyCode?"up":"down";return this.moveVertical({},_,!0),void d.B.stopEvent(t)}case 33:case 34:case 35:case 36:case 9:C=!0;break;case 13:if(this.options.senseReader&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex)if((R=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"image"==R.options.inputType)for(c=this.event.getTargetIterator(t,this.render);c.next();)if(c.match("w2grid_image")){var S=a.D.getGlobalFunction(R.options.imageClickFunction,this.scope_id);"function"==typeof S&&S.call(this,this.getLastFocusedCell().focusedRowIndex,R.id,this.dataList.getCellData(this.getLastFocusedCell().focusedRowIndex,R.id))}if(this.options.senseReader&&null!=this.getLastFocusedCell().focusedColIndex)if((R=this.getCellInfo(this.getLastFocusedCell().focusedColIndex))&&"select"==R.options.inputType&&"ul"==R.options.tableRender)return this.setEditHtml(t),void d.B.stopEvent(t);C=!0;break;default:C=!1}if(1==C&&"false"==this.options.focusMove){var D=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return;if(9!=D)return}if(this.F2Mode)switch(t.keyCode){case 8:case 46:case 35:case 36:case 37:case 38:case 39:case 40:return}switch(t.keyCode){case 4:break;case 46:this.removeCellData(t),d.B.stopEvent(t);break;case 32:this.doDefaultAction(t);break;case 33:this.movePageUp(t),d.B.stopEvent(t);break;case 34:this.movePageDown(t),d.B.stopEvent(t);break;case 35:this.moveHorizontal(t,"end"),d.B.stopEvent(t);break;case 36:this.moveHorizontal(t,"home"),d.B.stopEvent(t);break;case 37:this.moveHorizontal(t,"left"),d.B.stopEvent(t);break;case 38:this.moveVertical(t,"up"),d.B.stopEvent(t);break;case 39:this.moveHorizontal(t,"right"),d.B.stopEvent(t);break;case 40:this.moveVertical(t,"down"),d.B.stopEvent(t);break;case 9:var R=this.getCellInfo(this.getLastFocusedCell().focusedColIndex);if(this.options.senseReader&&R&&"image"==R.options.inputType&&this.options.focusImage&&this.getLastFocusedCell().focusedColIndex){d.B.stopPropagation(t);for(c=this.event.getTargetIterator(t,this.render);c.next();){if(c.match("w2grid_image"))if(d.B.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else(this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)||"linear"!=this.options.focusFlow)&&d.B.stopEvent(t)}}else if(d.B.getTarget(t)==this.render)this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1);else{(("down"==this.options.tabKeyMove?this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode):"none"==this.options.tabKeyMove||this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode))||"linear"!=this.options.focusFlow)&&d.B.stopEvent(t)}break;case 13:R=this.getCellInfo(this.focusedCell[0].focusedColIndex);if("enter"===this.options.drilldownToggle&&1==this.focusedCell.length&&R&&"drilldown"==R.options.inputType){var L=this.focusedCell[0].focusedRowIndex,T=this.dataList.getRealRowIndex(L);this.toggle(T);break}
if(this.editMode||"autoComplete"!==R.options.inputType&&"select"!==R.options.inputType||!R.options.directOpen)if("edit"==this.options.enterKeyMove||"editRight"==this.options.enterKeyMove||"editDown"==this.options.enterKeyMove)this.setEditHtml(t);else if("none"==this.options.enterKeyMove);else if("right"==this.options.enterKeyMove){if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===R.options.inputType)(k=this.getInput(R,this.focusedCell[0].focusedTd))&&k.blur();this.moveHorizontal(t,t.shiftKey?"left":"right",this.options.keyMoveEditMode)}else{var k;if(!0===this.options.senseReader)if(1==this.focusedCell.length)if("text"===R.options.inputType)(k=this.getInput(R,this.focusedCell[0].focusedTd))&&k.blur();this.moveVertical(t,t.shiftKey?"up":"down",this.options.keyMoveEditMode)}else"autoComplete"===R.options.inputType&&(R.autoCompleteImageClicked=!0),this.setEditHtml(t);d.B.stopEvent(t);break;case 67:if("native"===this.options.copyType)break;if(t.ctrlKey||t.metaKey){if(a.D.isIEAllVersion())this.handleCopyEvent({});else if(!a.D.isIEAllVersion()&&(s.v.browserCheck.moz||s.v.browserCheck.chrome&&!this.options.preventCopy)){var A=document.activeElement,F=document.createElement("textarea"),x=this,E=document.getElementsByTagName("body")[0];F.oncopy=function(t){x.handleCopyEvent(t),E.removeChild(this),document.activeElement!=A&&A.focus()},F.textContent="temp",E.appendChild(F),F.select();try{document.execCommand("copy")}catch(t){}}}else a.D.getBoolean(t.srcElement.getAttribute("directItemChoice"))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 88:if(t.ctrlKey||t.metaKey){if(a.D.isIEAllVersion())this.handleCutEvent({});else if(!a.D.isIEAllVersion()&&(s.v.browserCheck.moz||s.v.browserCheck.chrome)){F=document.createElement("textarea"),x=this,E=document.getElementsByTagName("body")[0];F.oncut=function(t){x.handleCutEvent(t),E.removeChild(this)},F.textContent="temp",E.appendChild(F),F.select();try{document.execCommand("cut")}catch(t){}}}else a.D.getBoolean(t.srcElement.getAttribute("directItemChoice"))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 86:if(t.ctrlKey||t.metaKey){if(this.options.preventPaste&&!this.editedCell){d.B.stopEvent(t);break}if(a.D.isIEAllVersion())this.handlePasteEvent({});else if(!a.D.isIEAllVersion()&&(s.v.browserCheck.moz||s.v.browserCheck.chrome||s.v.browserCheck.safari)){F=document.createElement("textarea"),x=this;F.style.opacity="0",F.onpaste=function(t){x.handlePasteEvent(t),E.removeChild(this)},F.textContent="temp",(E=document.getElementsByTagName("body")[0]).appendChild(F),F.select();try{document.execCommand("paste")}catch(t){}}}else{a.D.getBoolean(t.srcElement.getAttribute("directItemChoice"))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}break;case 90:if(t.ctrlKey);else a.D.getBoolean(t.srcElement.getAttribute("directItemChoice"))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t);break;case 27:"none"!=this.options.focusMode&&"linear"!=this.options.focusFlow&&(this.getLastFocusedCell().focusedTd.setAttribute("tabIndex",-1),this.render.focus());break;case 16:case 17:case 18:case 21:case 229:case 25:case 91:case 20:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:break;case 65:if(this.options.useSelectAll&&t.ctrlKey){this.setFocusedMultiCell(0,0,this.getRowCount()-1,this.getColumnCount()-1);break}default:if(!t.ctrlKey&&!t.metaKey&&!t.altKey)a.D.getBoolean(t.srcElement.getAttribute("directItemChoice"))&&(this.directItemChoiceKeyObj.select=t.keyCode),this.setEditHtml(t),this.options.directEdit&&this._directEdit(t)}}this.isKeyPressed=!1},f.prototype.handleOnfocus=function(t){
if(this.getDataLength()>0&&(-1==this._getFocusedRowIndex()||null==this.getFocusedColumnIndex())){for(var e=null,i=this.colIndexInfo.body.colInfo.colIndexMatch,o=this.colIndexes.bodyColInfo.trIndexArr,s=o[this.defaultColCnt],r=0;r<i.length;r++){var a=i[r];if(!this.hiddenList[r]){for(var n=a.length-1;n>=0;n--){var l=a[n]-this.defaultColCnt;if(o[a[n]]<=s){if(this.options.readOnlyTabIgnore&&this.___getEditReadOnly(0,l))break;if(this.options.ignoreNonEditableCell&&(this.___getEditReadOnly(0,l)||this._getEditDisabled(0,l)))break;e=l;break}}if(null!==e)break}}null!==e&&this._setFocusedCell(0,e)}},f.prototype.removeCellData=function(t){this.handleCutEvent(t,!0)},f.prototype.doDefaultAction=function(t){if("none"==this.options.focusMode){for(var e=d.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;e&&this.getCellInfo(e).doDefaultAction(t)}else this.getCellInfo(this.getLastFocusedCell().focusedColIndex).doDefaultAction(t)},f.prototype.setEditHtml=function(t){var e=d.B.getTarget(t);if(this.options.fastEditMode||"INPUT"==e.tagName||d.B.stopEvent(t),this.focusedCell.length>0){var i=this.focusedCell[this.focusedCell.length-1];null!=i.focusedTd&&this.setEditMode(i.focusedTd)}},f.prototype.getFirstTdTrIndex=function(t){for(var e=t.parentNode;"0"!=e.getAttribute("trIndex");)e=a.D.prev(e);return e},f.prototype.fixScrollRightDirection=function(){var t=this.getLastFocusedCell(),e=this.getElementById(this.id+"_dataLayer").offsetWidth,i=this.getElementById(this.id+"_scrollX_right");if(t&&t.focusedTd){if("native"===this.options.drawType){var o=document.getElementById(this.id+"_scrollX_div");"hidden"===o.style.visibility||o.offsetWidth}var s=t.focusedTd.offsetLeft,r=t.focusedTd.offsetWidth+1;a.D.isFF()&&(r-=1),a.D.isOpera()&&(r+=2);var n=s+r-e;if(this.options.lazyDrawHiddenColumn){var l=this.focusedCell[0].focusedTd;if("none"==l.style.display||n>0)if(this.options.scrollByColumn){for(var h=e-this.fixedWidth,d=0;d<this.columnOrder.length;d++)if(this.columnOrder[d]==t.focusedColIndex){m=d+this.defaultColCnt;break}var u=-1,p=0;a.D.isOpera()&&(p=2);for(var c=m;c>=0;c--)if(!this.hiddenList[c]&&(h-=this.colWidthList[c])<0){u=c;break}c=0;for(this.fixedWidth>0&&(c=this.getFixedColumnLastIndex());c<=u;c++)this.hiddenList[c]||(p+=this.colWidthList[c]);this.scrollXPreventEndEdit=!0,i.scrollLeft=p,this._handleScrollX()}else{var g=parseInt(l.getAttribute("colIndex"),10),f=0;a.D.isOpera()&&(f=2);for(d=0;d<=g;d++)this.hiddenList[d]||(f+=this.colWidthList[d]);this.scrollXPreventEndEdit=!0,i.scrollLeft=f-e,this._handleScrollX()}}else if(n>0)if(this.options.scrollByColumn){h=e-this.fixedWidth;var m,y=t.focusedColIndex%this.columnOrder.length;for(d=0;d<this.columnOrder.length;d++)if(this.columnOrder[d]==y){m=d+this.defaultColCnt;break}for(u=-1,p=0,c=m;c>=0;c--)if(!this.hiddenList[c])if(0!=this.colIndexes.bodyColInfo.colSpanArr.length){if((h-=this.colWidthList[c]*(this.colIndexes.bodyColInfo.colSpanArr[c]?this.colIndexes.bodyColInfo.colSpanArr[c]:1))<0){u=c;break}}else if((h-=this.colWidthList[c])<0){u=c;break}c=0;for(this.fixedWidth>0&&(c=this.getFixedColumnLastIndex());c<=u;c++)this.hiddenList[c]||(0!=this.colIndexes.bodyColInfo.colSpanArr.length?p+=this.colWidthList[c]*(this.colIndexes.bodyColInfo.colSpanArr[c]?this.colIndexes.bodyColInfo.colSpanArr[c]:1):p+=this.colWidthList[c]);this.scrollXPreventEndEdit=!0,i.scrollLeft=p,this._handleScrollX()}else this.scrollXPreventEndEdit=!0,i.scrollLeft=i.scrollLeft+n,this._handleScrollX()}},f.prototype.fixScrollLeftDirection=function(){var t=this.getLastFocusedCell();if(t&&t.focusedTd){if("native"===this.options.drawType){var e=document.getElementById(this.id+"_scrollX_div");"hidden"===e.style.visibility||e.offsetWidth}var i=t.focusedTd.getAttribute("colIndex");i=parseInt(i);for(var o=this.getElementById(this.id+"_scrollX_right"),s=0,r=this.getFixedColumnLastIndex();r<i;r++){if(!this.hiddenList[r])s+=this.colWidthList[r]}o.scrollLeft>s&&(this.scrollXPreventEndEdit=!0,o.scrollLeft=s,this._handleScrollX())}},
f.prototype.getLeftMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.dataList.getRowCount()||t<0)return i;for(var o=0;o<e.length-this.defaultColCnt;o++){var s=!1,r=this.getCellInfo(o);if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}if(this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))if("user"==r.options.inputType||"link"==r.options.inputType)0!=this.data_td_list[o+(t-this.rowIndex)*this.oneRowDataLength].getElementsByTagName("a").length&&(s=!1);if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var n=this.dataList.getCellData(t-1,o),l=this.upperGroupingTest(t,o);n==this.dataList.getCellData(t,o)&&l&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o]&&!s){i=o;break}}return i},f.prototype.getRightMostFocusableColIndex=function(t){var e=this.colIndexInfo.body.colInfo.colIndexArr,i=null;if(t>=this.getRowCount()||t<0)return i;for(var o=e.length-1-this.defaultColCnt;o>=0;o--){var s=!1,r=this.getCellInfo(o);if(this.options.readOnlyTabIgnore&&(s=this.___getEditReadOnly(t,o)),(this.options.ignoreNonEditableCell||this.options.senseReader)&&(s=this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o)),this.options.senseReader&&"radio"==r.options.inputType&&this.getCellData(t,o)!=r.options.trueValue){var a=this.getCheckedIndex(r.colID);a?s=a[0]!==t:0!=t&&(s=!0)}if(this.options.senseReader&&this.___getEditReadOnly(t,o)||this._getEditDisabled(t,o))if("user"==r.options.inputType||"link"==r.options.inputType)if(t<this.rowIndex)s=!0;else s=0==this.data_td_list[o+(t>=this.rowIndex?t-this.rowIndex:t)*this.oneRowDataLength].getElementsByTagName("a").length;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[o]].options.colMerge){var n=this._dataList.getCellData(t-1,o),l=this.upperGroupingTest(t,o);n==this._dataList.getCellData(t,o)&&l&&(s=!0)}if(this.hiddenRowObj.length>0&&!this._getRowVisible(t)&&(s=!0),this.getMerged(t,o)&&!this.cellMergeInfo[t+"_"+o]&&(s=!0),!this.hiddenList[o+this.defaultColCnt]&&!s){i=o;break}}return i},f.prototype.moveHorizontal=function(t,e,i,o){if("false"==this.options.focusMove||"vertical"==this.options.focusMove){o=t.charCode?t.charCode:t.keyCode;if(!this.options.senseReader)return!1;if(9!=o)return!1}var s,r=this.getLastFocusedCell(),n=r.focusedRowIndex,l=r.focusedColIndex,h=(this.colIndexInfo.body.colInfo.colIndexArr,this._getRealColIndex("body",this.tdIdList[l])+this.defaultColCnt),d=this.colIndexInfo.body.colInfo.colIndexMatch,u=this.columnOrder,p=this.colIndexes.bodyColInfo.trIndexArr,c=p[l+this.defaultColCnt],g=!!t&&9==t.keyCode,f=!!t&&(9==t.keyCode||13==t.keyCode),m=!!t&&t.shiftKey,y=(e=e||"right",0==t||t&&!0===t.byApi);s=1==this.options.moveKeyEditModeAll&&y?!!o&&(37==o||39==o):!!t&&(37<=t.keyCode&&t.keyCode<=40),r.bTrIndex&&(c=r.bTrIndex);var b=null,w=n;if(this.options.focusMultiRow){if("left"==e)var v=h-1,I=this.defaultColCnt-1,C=-1;else if("right"==e)v=h+1,I=d.length,C=1;else if("home"==e)v=this.defaultColCnt,I=d.length,C=1;else v=d.length-1,I=this.defaultColCnt-1,C=-1;for(var x=v;x!=I;x+=C){var _=d[x];if(!this.hiddenList[x]){for(var S=_.length-1;S>=0;S--){var D=_[S]-this.defaultColCnt;if(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))if(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])if(p[_[S]]<=c&&("left"!=e&&"right"!=e||D!=l)){if((this.options.readOnlyTabIgnore||this.options.senseReader)&&this.___getEditReadOnly(n,D))break;if(f&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D)))break
;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){var R=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(R==this.dataList.getCellData(n,D)&&L)break}b=D;break}}if(null!==b)break}}}else{var T=this.getCellInfo(l),k=!1;this.options.senseReader&&"user"==T.options.inputType&&this.___getEditReadOnly(n,l)?k=!0:(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0);var A=this.getLocationRowCol(n,l),F=A.rowIndex,E=A.colIndex,M=this.htmlInfo.body.rowAttrArr.length;r.bMovedRow&&(F=r.bMovedRow);var O=F%M;if("left"==e)if(k&&this.focusedCellLinkIndex>0)v=E,I=u.length,C=1;else v=E-1,I=-1,C=-1;else if("right"==e)if(k&&this.focusedCellLinkIndex+1<this.focusedCellLinkLength)v=E,I=u.length,C=1;else{this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0;v=E+A.colSize,I=u.length,C=1}else if("home"==e){v=0,I=u.length,C=1;F-=O}else{v=u.length-1,I=0,C=-1;F=F+M-O-1}for(x=v;;x+=C){if(x==I)if("left"==e&&O>0)x=u.length-1,F--;else{if(!("right"==e&&O<M-1))break;x=0,F++}var N=this.getOriginalRowCol(F,x);if(!N.noLeftTop){C>0&&(C=N.colSize);D=N.colIndex;if(!this.hiddenList[x+this.defaultColCnt]&&(!(this.hiddenRowObj.length>0)||this._getRowVisible(n))&&(!this.getMerged(n,D)||this.cellMergeInfo[n+"_"+D])){T=this.getCellInfo(D);if(this.options.senseReader&&"radio"==T.options.inputType&&this.getCellData(n,D)!=T.options.trueValue&&0!=n){if(this.getCheckedIndex(T.colID))continue;if(0!=n)continue}if("left"!=e&&"right"!=e||(k||D!=l)){var B=!1;if(g&&this.___getEditReadOnly(n,D)&&(this.options.readOnlyTabIgnore||this.options.senseReader)){if("user"!=T.options.inputType&&"link"!=T.options.inputType||!this.options.senseReader)continue;var G=this.data_td_list[D+(w-this.rowIndex)*this.oneRowDataLength].getElementsByTagName("a");if("right"==e)for(var H=0;H<G.length;H++){if(document.activeElement==G[H]){this.focusedCellLinkIndex=H;break}this.focusedCellLinkIndex=-1}else if("left"==e)for(H=G.length-1;H>-1;H--){if(document.activeElement==G[H]){this.focusedCellLinkIndex=H;break}this.focusedCellLinkIndex=-1}if(!G[0])continue;("right"==e&&this.focusedCellLinkIndex!=G.length-1||"left"==e&&0!=this.focusedCellLinkIndex)&&(B=!0)}if((f||s)&&(this.options.ignoreNonEditableCell||this.options.senseReader)&&(this.___getEditReadOnly(n,D)||this._getEditDisabled(n,D))&&(!g||1!=B))continue;if(this.isColMerge&&this.cellInfoHash[this.tdIdList[D]].options.colMerge){R=this.dataList.getCellData(n-1,D),L=this.upperGroupingTest(n,D);if(R==this.dataList.getCellData(n,D)&&L)continue}b=D;break}if(null!==b)break}}}}if(null===b&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),null!==b){if(i&&(this.___getEditReadOnly(w,b)||this._getEditDisabled(w,b))&&(i=!1),i&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){T=this.getCellInfo(b);a.D.getBoolean(T.options.skipKeyMoveEditMode)&&(i=!1)}return this._setFocusedCell(n,b,i,{tabDirection:e}),(r=this.getLastFocusedCell()).bTrIndex=c,r.bMovedRow=F,!0}if("linear"==this.options.focusFlow){if(n>0&&m){var W=this.getRightMostFocusableColIndex(n-1);if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&null==W)for(;n>=0&&null==W;){this._setGridBorderNoRefresh=!0;var V=-1;this.hasSubtotal&&(V-=this.getHasSubtotalCount(n-1)),"true"!==this.options.keepScrollForSenseReader&&this.addGridScroll(V),this._setGridBorderNoRefresh=!1,1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(W=this.getRightMostFocusableColIndex(n-1)),null==W&&(n-=1)}else for(;n>=0&&null==W;)n-=1,W=this.getRightMostFocusableColIndex(n-1);if(null==W)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),n-1<this.rowIndex){this._setGridBorderNoRefresh=!0;V=-1;this.hasSubtotal&&(V-=this.getHasSubtotalCount(n-1)),this.addGridScroll(V),this._setGridBorderNoRefresh=!1,
1==this.options.senseReader&&null!=W&&"all"!=this.options.visibleRowNum&&(W=this.getRightMostFocusableColIndex(n-1))}return"custom"==(T=this.getCellInfo(W)).options.inputType&&n-1>=0&&(w=n-1),i&&(this.___getEditReadOnly(w,W)||this._getEditDisabled(w,W))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)&&a.D.getBoolean(T.options.skipKeyMoveEditMode)&&(i=!1),this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,W,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}if("left"==e&&n>0&&!m){for(var q=this.getRightMostFocusableColIndex(n-1);n>0&&null==q;)n-=1,q=this.getRightMostFocusableColIndex(n-1);if(null==q)return this.editedCell&&this.editedCell.handleEndEdit(t),!1;if(n-1>0&&n==this.rowIndex){this._setGridBorderNoRefresh=!0;V=-1;this.addGridScroll(V),this._setGridBorderNoRefresh=!1}if(i&&(this.___getEditReadOnly(w,q)||this._getEditDisabled(w,q))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){T=this.getCellInfo(q);a.D.getBoolean(T.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n-1,q,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}if("right"==e&&!m&&n<this.getDataLength()-this._getVisibleLastIndex(1)){for(q=this.getLeftMostFocusableColIndex(n+1);n!=this.dataList.getRowCount()&&null==q;)n+=1,q=this.getLeftMostFocusableColIndex(n+1);if(null==q)return this.editedCell&&this.editedCell.handleEndEdit(t),1==this.options.moveKeyEditModeAll&&n==this.dataList.getRowCount()&&document.getElementById(this.id+"_gridend_div").focus(),!1;var j=this._getVisibleLastIndex(this.lastIndex+1);if(n+1>this.rowIndex+j-1){this._setGridBorderNoRefresh=!0;V=1;this.hasSubtotal&&(V+=this.getHasSubtotalCount(n+1)),1==this.options.senseReader&&"all"!=this.options.visibleRowNum&&(V+=n-(this.rowIndex+j-1),this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),this.addGridScroll(V),this._setGridBorderNoRefresh=!1}if(i)"custom"==(T=this.getCellInfo(q)).options.inputType&&(w=n+1),(this.___getEditReadOnly(w,q)||this._getEditDisabled(w,q))&&(i=!1);if(i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){T=this.getCellInfo(q);a.D.getBoolean(T.options.skipKeyMoveEditMode)&&(i=!1)}return this._setGridBorderNoRefresh=!0,this._setFocusedCell(n+1,q,i,{tabDirection:e}),this._setGridBorderNoRefresh=!1,!0}}if(g&&null!=WebSquare.tabOrder[this.id])if(0===h&&0===n&&"left"==e){if(null!=WebSquare.tabOrder[this.id].preTabID&&(z=a.D.getPreTabbableComp(this.id)))return z.focus(),!0}else if(h===d.length-1&&n===this.getDataLength()-this._getVisibleLastIndex(1)&&"right"==e){var z;if(null!=WebSquare.tabOrder[this.id].nextTabID)if(z=a.D.getNextTabbableComp(this.id))return z.focus(),!0}return this.editedCell?(this._setGridBorderNoRefresh=!0,this.editedCell.handleEndEdit(t),this._setGridBorderNoRefresh=!1):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(n,l,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!1},f.prototype.moveVertical=function(t,e,i){if(this.moveDirection="row","false"==this.options.focusMove||"horizontal"==this.options.focusMove)return!1;var o=this.getLastFocusedCell(),s=o.focusedRowIndex,r=o.focusedColIndex,n=this.defaultColCnt,l=this.colIndexInfo.body.colInfo.colIndexArr,h=this.colIndexes.bodyColInfo.trIndexArr,u=this.colIndexes.bodyColInfo.colSpanArr,p=this.colIndexes.bodyColInfo.rowSpanArr,c=l[r+n],g=h[r+n],f=u[r+n],m=p[r+n],y=r,b=s,w=!!t&&13==t.keyCode,v=!!t&&9==t.keyCode,I=this.getDataLength()-this._getVisibleLastIndex(1),C=!1;if(f&&o.bColIndex&&(c=o.bColIndex),"up"==e)var x=0==g?this.oneRowDataLength-1:r-1,_=-1,S=-1;else x=g+m==this.oneRowLength?0:r+1,_=this.oneRowDataLength,S=1;for(var D=!1,R=x;R!=_;R+=S){var L=l[R+n],T=L+(u[R+n]?u[R+n]:1)-1,k=this._getArrayIndexOf(this.columnOrder,l[R+n]-n)+n;if(L<=c&&c<=T&&(!this.hiddenList[k]||D)){if(y=R,
k=this._getArrayIndexOf(this.columnOrder,y+1)+this.defaultColCnt,b==I&&"down"==e&&this.hiddenList[k]){D=!0,c++;continue}if(k=this._getArrayIndexOf(this.columnOrder,y-1)+this.defaultColCnt,0==b&&"up"==e&&this.hiddenList[k]){D=!0,c--;continue}if("up"==e){for(var A=s;A>=0;A--)if(b=0==g?A-1:A,(!(this.hiddenRowObj.length>0)||this._getRowVisible(b))&&(!this.getMerged(b,y)||this.cellMergeInfo[b+"_"+y])){if(this.hiddenCellObj.length>0&&!1===this.getCellVisible(b,y))for(;!1===this.getCellVisible(b,y);){if(0===(M=h[y+this.defaultColCnt])&&b>0){b--;for(var F=!1,E=y+1+n;E<l.length;E++)if(l[E]===r+n&&h[E]===this.oneRowLength-1){y=E-n,F=!0;break}if(!F)break}else if(M>0){for(F=!1,E=y+n;E>=0;E--)if(l[E]===r+n&&h[E]===M-1){y=E-n,F=!0;break}if(!F)break}}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(b,y)&&!this._getEditDisabled(b,y))break;if(!v&&!w&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(b,y))break}}else for(A=s;A<=I;A++)if(b=g+m==this.oneRowLength?A+1:A,(!(this.hiddenRowObj.length>0)||this._getRowVisible(b))&&(!this.getMerged(b,y)||this.cellMergeInfo[b+"_"+y])){if(this.hiddenCellObj.length>0)for(;!1===this.getCellVisible(b,y);){var M;if((M=h[y+this.defaultColCnt])>=this.oneRowLength-1&&b<=I){b++;for(F=!1,E=n;E<l.length;E++)if(l[E]===r+n&&0===h[E]){y=E-n,F=!0;break}if(!F)break}else if(M<this.oneRowLength-1){for(F=!1,E=y+1+n;E<l.length;E++)if(l[E]===r+n&&h[E]===M+1){y=E-n,F=!0;break}if(!F)break}}if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(b,y)&&!this._getEditDisabled(b,y))break;if(!v&&!w&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(b,y))break}break}}if(0<=b&&b<=I&&(s!=b||r!=y)){if(d.B.stopEvent(t),i&&(this.___getEditReadOnly(b,y)||this._getEditDisabled(b,y))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){var O=this.getCellInfo(y);a.D.getBoolean(O.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(b,y,i,{tabDirection:e})&&((o=this.getLastFocusedCell()).bColIndex=c,!0)}if("linear"==this.options.focusFlow){var N=!1;if((-1==b&&"up"==e&&0==r||b==I+1&&"down"==e&&null==l[r+n+1])&&(N=!0),!N&&(-1==b||b==I+1)){var B=this.getLastFocusedCell().focusedTd;if("text"==(O=this.getCellInfo(B)).options.inputType&&O.options.embeddedInput){var G=this.getInput(O,B);this.showFakeInput(G),this.fakeInput.setValue(G.getValue()),this.F2Mode=!1,G.select()}else{var H=!1;if("up"==e&&-1==b&&y-1>-1)for(var W=y-1;null!=l[W+n];W--){for(var V=I;V>-1;V--){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(V,W)&&!this._getEditDisabled(V,W)){b=V,y=W,H=!0;break}if(!v&&!w&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(V,W)){b=V,y=W,H=!0;break}}if(H)break}else if("down"==e&&b==I+1)for(W=y+1;null!=l[W+n];W++){for(V=0;V<=I;V++){if(!this.options.ignoreNonEditableCell&&!this.options.senseReader||!this.___getEditReadOnly(V,W)&&!this._getEditDisabled(V,W)){b=V,y=W,H=!0;break}if(!v&&!w&&this.options.ignoreNonEditableCell&&this.options.ignoreNonEditableCellTabEnter&&!this.options.senseReader&&!this._getEditDisabled(V,W)){b=V,y=W,H=!0;break}}if(H)break}if(H){if(d.B.stopEvent(t),i&&(this.___getEditReadOnly(b,y)||this._getEditDisabled(b,y))&&(i=!1),i&&this.isKeyPressed&&(this.options.keyMoveEditMode||this.options.moveKeyEditMode||this.options.moveKeyEditModeAll)){O=this.getCellInfo(y);a.D.getBoolean(O.options.skipKeyMoveEditMode)&&(i=!1)}return!!this.setFocusedCell2(b,y,i,{tabDirection:e})&&((o=this.getLastFocusedCell()).bColIndex=c,!0)}v&&WebSquare.tabOrder[this.id]&&WebSquare.tabOrder[this.id].nextTabID&&(C=!0)}}}
return this.editedCell?this.editedCell.handleEndEdit(t):this.options.moveKeyEditMode&&(this._setGridBorderNoRefresh=!0,this._setFocusedCell(s,r,!1),this._setGridBorderNoRefresh=!1),this.moveDirection=null,!0===C&&"focusNextTabOrder"},f.prototype.moveEnd=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(;this._moveRight(t););for(var e=!1;!e;){for(var i=!0,o=this.getLastFocusedCell(),s=parseInt(o.focusedTd.getAttribute("colIndex")),r=parseInt(o.focusedTd.getAttribute("colSpan")||1),a=0;a<r;a++)if(0==this.hiddenList[s+a]){i=!1;break}1==i?this._moveLeft(t):e=!0}this.fixScrollRightDirection()}},f.prototype.moveHome=function(t){if("false"!=this.options.focusMove&&"vertical"!=this.options.focusMove){for(;this._moveLeft(t););for(var e=!1;!e;){for(var i=!0,o=this.getLastFocusedCell(),s=parseInt(o.focusedTd.getAttribute("colIndex")),r=parseInt(o.focusedTd.getAttribute("colSpan")||1),a=0;a<r;a++)if(0==this.hiddenList[s+a]){i=!1;break}1==i?this._moveRight(t):e=!0}this.fixScrollLeftDirection()}},f.prototype.movePageUp=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(this.rowIndex<=0)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e),this.focusedCell&&this.focusedCell.pop();var s,r=this._getScrollRowIndex(this.rowIndex);return(s=r<this.lastIndex?-1:this._getVisibleRowIndex(r-this.lastIndex))>=0?(this.setTopRowIndex(s),this._setFocusedCell(i+this.rowIndex,o)):(this.setTopRowIndex(0),this._setFocusedCell(0,o)),!0}}},f.prototype.movePageDown=function(t){if("false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove&&!(null!=this.lastTopRowIndex&&this.rowIndex>=this.lastTopRowIndex)){var e=this.getLastFocusedCell(),i=e.focusedRowIndex;if(!(i<0)){i-=this.rowIndex;var o=e.focusedColIndex;this._applyFocusedCellOut(e);var s=this.rowIndex+this.lastIndex,r=this.getDataLength(),a=r-this._getVisibleLastIndex(1),n=r-this._getVisibleLastIndex(this.lastIndex+1);return s<=n?(this.setTopRowIndex(s),this._setFocusedCell(Math.min(i+this.rowIndex,a),o)):(this.setTopRowIndex(n),this._setFocusedCell(a,o)),!0}}},f.prototype.findTd=function(t,e,i){for(var o=0;null!=t;){for(var s=a.D.first(t);null!=s;){var r=parseInt(s.getAttribute("colIndex"));if(r<=e&&e<=r+s.colSpan-1&&o<=i&&i<=o+s.rowSpan-1)return s;if(r>e)break;s=a.D.next(s)}if(t=a.D.next(t),o>i)break;o++}},f.prototype.pasteFromClipboard=function(){for(var t=this.parseClipboardExcel(),e=this._getFocusedRowIndex(),i=this.getFocusedColumnIndex(),o=[],s=0;s<t.length;s++){o.push([]);for(var r=0;r<t[0].length;r++)o[s][r]=this.dataList._getCellData(s+e,this.getColumnID(r+i))}for(s=0;s<t.length;s++)for(r=0;r<t[0].length;r++){var a=t[s][r];try{a=a.wq_trim();var n=this.getCellInfo(r+i),l=this.mainGrid.getColumnOption(n.options.col_id,"dataType");"number"==l&&(a=a.replace(/[^(\-0-9)]/g,""))}catch(t){}1!=this.___getEditReadOnly(s+e,r+i)&&1!=this._getEditDisabled(s+e,r+i,!0)&&this.dataList.__setCellData(s+e,this.getColumnID(r+i),a)}var h=this;WebSquare.historyManager.set("grid","grid1",{focusRowIndex:e,focusColIndex:i,data2d:o},{onRestore:function(t){for(var o=t.data2d,s=0;s<o.length;s++)for(var r=0;r<o[0].length;r++){var a=o[s][r];h.dataList.__setCellData(s+e,this.getColumnID(r+i),a)}}})},f.prototype.parseClipboardExcel=function(){for(var t=[],e=window.clipboardData.getData("Text").split("\n"),i=0;i<e.length-1;i++){var o=e[i].split("\t");t.push(o)}return t},f.prototype.copyToClipboard=function(){var t=this.options.copyAmount;if(t||("cell"==this.options.focusMode?t="cell":"both"!=this.options.focusMode&&"row"!=this.options.focusMode||(t="row")),"cell"==t){for(var e=this.getDataLength(),i=this.getTotalCol(),o=[],s=0;s<this.focusedCell.length;s++){var r=(u=this.focusedCell[s]).focusedRowIndex,a=u.focusedColIndex;null==o[r]&&(o[r]=[]),o[r][a]=u,e>r&&(e=r),i>a&&(i=a)}var n=[];for(s=e;s<o.length;s++){var l=[];if(void 0!==(p=o[s]))for(var h=i;h<p.length;h++){
o[s][h]?l.push(this.dataList._getCellData(s,this.getColumnID(h))):l.push("")}n.push(l.join("\t"))}window.clipboardData.setData("Text",n.join("\n"))}else if("row"==t){var d=[];for(s=0;s<this.focusedCell.length;s++){var u;d[(u=this.focusedCell[s]).focusedRowIndex]=1}var p=[];for(var r in d)p.push(r);function t(t,e){return parseInt(t)>parseInt(e)?1:-1}p.sort(t);for(o=[],s=0;s<p.length;s++){r=p[s];var c=this.getRowData(r);o.push(c.join("\t"))}window.clipboardData.setData("Text",o.join("\n"))}},f.prototype.getEditCursorEnable=function(t,e){try{if(!t)return!1;var i=d.B.getTarget(t);if(!i)return!1;var o=i.tagName.toUpperCase();if(("INPUT"==o||"TEXTAREA"==o)&&null!=i.value){if(a.D.isIEAllVersion("6 7 8")){var s=document.selection.createRange();if(s.text.length>0)return!0;s.moveStart("character",-i.value.length);var n=s.text.length;if("left"===e){if(n>0)return!0}else if("right"===e&&n<i.value.length)return!0;return!1}if(null!=i.selectionStart&&i.selectionStart!=i.selectionEnd)return!0;if("left"===e){if(i.selectionEnd>0)return!0}else if("right"===e&&i.selectionEnd<i.value.length)return!0}return!1}catch(t){return r.w.printStackTrace(t,null,this),!1}},f.prototype._moveKeyEdit=function(t,e,i){try{if(void 0!==i&&null!=i||(i={}),!(this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.moveKeyEditMode))return;var o=this.uuid,s=WebSquare.idCache[t];s["_"+e]=s[e];var a=i.itemTable,n=i.skipVertical,l=i.skipHorizontal,h=this.options.moveKeyEditModeAll||!0===i.oldMode&&this.options.arrowMove;s[e]=function(t,i){this["_"+e]&&this["_"+e](t,i);var s=WebSquare.idCache[o],r=!1;if(s&&s.editedCell){var u=s.getCellInfo(s.editedCell.colID);(s.options.keyMoveEditMode||s.options.moveKeyEditMode||s.options.moveKeyEditModeAll)&&u.options.skipKeyMoveEditMode&&(r=!0)}var p={37:"left",38:"up",39:"right",40:"down"}[t.keyCode];if(p)switch(p){case"left":case"right":if(!0!==l&&(a||0==this.getValue().length||h&&!s.getEditCursorEnable(t,p)))s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"&&s.moveHorizontal({byApi:!0},p,!0,t.keyCode),d.B.stopEvent(t);break;case"up":case"down":if(!0!==n&&(!a||0==this.getItemCount()||this._keyIndex<0||this._keyIndex===this.getItemCount())){if(s._fireOnviewchange(s.editedCell.id,"handleEndEdit",[t],{checkFunc:function(t){return t+""!="false"}})+""!="false"){var c=!0!==r;s.moveVertical({},p,c,t.keyCode)}d.B.stopEvent(t)}}}}catch(t){r.w.printStackTrace(t,null,this)}},f.prototype._directEdit=function(t){var e=this.focusedCell[this.focusedCell.length-1],i=this.getCellInfo(e.focusedTd);if("textarea"!==i.options.inputType||!this._getEditDisabled(e.focusedRowIndex,e.focusedColIndex)&&!this.___getEditReadOnly(e.focusedRowIndex,e.focusedColIndex)){var o,s=i.comp,r=this.getInput(i);r&&(r.reFocus=!0,r._focusStatus="cancel");var a=s.render.tagName.toLowerCase();(o="input"===a||"textarea"===a?s.render:s.render.getElementsByTagName("input")[0])&&WebSquare.text.setCaretPos(o,o.value.length);var n=t.keyCode,l=null;t.key&&1===t.key.length?l=t.key:!t.shiftKey&&65<=n&&n<=90?(n+=32,l=String.fromCharCode(n)):l=n>=96||n<65?{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"}[n+""]||"":String.fromCharCode(n),"autoComplete"===i.options.inputType?(s.dom.input.value=l,s.inputKeyDown(t)):r&&r.setValueNM(l)}};var m=function(t){};m.prototype.initializeDrawController=function(){this.data_td_list=[],this.data_num_td_list=[],this.data_status_td_list=[],this.all_data_td_list=[]},m.prototype.showAllBodyTR=function(t){t=t||"";for(var e=0;e<this.drawedRowLength;e++)this._setRowDisplay(e,t);this.lastDisplayedRow="none"===t?-1:this.drawedRowLength-1},m.prototype._setRowDisplay=function(t,e){for(var i=null,o=0;o<this.oneRowLength;o++)(i=this.dataRowList[this.oneRowLength*t+o])&&(i.style.display=e,"none"==e?this.__addClass(i,"w2grid_hidedRow"):this.__removeClass(i,"w2grid_hidedRow"));return i},
m.prototype.drawColumnData=function(t,e){var i=this._dataList.rowPosition,o=!1;t=this.getColumnIndex(t);var s=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex,r=this.getCellInfo(t);if(r.dataComp){var a=this.modelControl.getDataComp(r.dataComp);null!=a&&"linkedDataList"===a.initializeType&&null!=a.conditionInfo&&a.conditionInfo.filterInfo.useRef&&"number"==typeof i&&(o=!0)}for(var n=0;n<=s;n++){var l=n+this.rowIndex;e&&r.select&&r.hasRef&&(r.select.itemArr=r.getRefItemArr(l),r.select.setSelectOptions(),r.select.setValueNM(r.mainGrid._dataList._getData(l,t))||r.mainGrid._dataList._setData(l,t,"")),o&&n===i||this.drawCellData(n,l,t)}o&&this.drawCellData(i,i+this.rowIndex,t)},m.prototype._setMouseOverTr=function(t,e){this.setOverClass(e,"overTd",!0)},m.prototype._setMouseOutTr=function(t,e){this.setOverClass(e,"overTd",!1)},m.prototype.setOverClass=function(t,e,i){for(var o=t.parentNode,s=parseInt(o.getAttribute("trIndex"));s>0;)s--,o=a.D.prev(o);do{for(var r=a.D.first(o);null!=r&&!(r.offsetLeft>this.render.offsetWidth);)r.offsetWidth>0&&(i?(r.setAttribute("row_out_style",r.style.cssText),r.style.cssText=r.style.cssText+";background-color:"+this.options.rowMouseOverColor):r.style.cssText=r.getAttribute("row_out_style")),r=a.D.next(r);o=a.D.next(o)}while(null!=o&&"0"!=o.getAttribute("trIndex"))},m.prototype.changeFocusedCellPosition=function(t,e,i){if(0!=this.focusedCell.length){this.applyFocusedCellOut();for(var o=0;o<this.focusedCell.length;o++){var s=this.focusedCell[o].focusedRowIndex-t,r=this.focusedCell[o].focusedColIndex,a=null;if(this.options.fixedRow>0&&this.options.fixedRow>this.focusedCell[o].focusedRowIndex||this.options.lastFixedRow>0&&this.focusedCell[o].focusedRowIndex>this.lastIndex-this.options.lastFixedRow)a=this.data_td_list[r+this.focusedCell[o].focusedRowIndex*this.oneRowDataLength],this.applyFocusedCellIn(a,e);else if(s<0||s>this.maxRowLength+this.hiddenRowObj.extraRow)a=null;else if(a=this.data_td_list[r+s*this.oneRowDataLength]){var n=this.getCellInfo(r);i&&n.options.embeddedInput&&(e=!1),this.applyFocusedCellIn(a,e)}this.focusedCell[o].focusedTd=a}}},m.prototype.setTRClass=function(t,e,i){for(var o=t.parentNode,s=parseInt(o.getAttribute("trIndex"));s>0;)s--,o=a.D.prev(o);do{for(var r=a.D.first(o);null!=r;)i?this.addClass(r,e):this.removeClass(r,e),r=a.D.next(r);o=a.D.next(o)}while(null!=o&&"0"!=o.getAttribute("trIndex"))},m.prototype.setEditMode=function(t){var e=t.getAttribute("col_id");if(null!=e&&""!=e.wq_trim()){var i,o=parseInt(t.getAttribute("tdIndex")),r=parseInt(o/this.realRowDataLength);if(this.options.fixedRow>0&&this.options.fixedRow>r)i=r;else if(this.options.lastFixedRow>0&&r>this.lastIndex-this.options.lastFixedRow){i=this.getDataLength()-1-(this.lastIndex-r)}else i=r+this.rowIndex;var n=a.D.getBoolean(s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/colIdToColIndex/@value"))?this.getColumnIndex(t.getAttribute("col_id")):t.getAttribute("col_id"),l=this.getCellInfo(n);if((l.options.colMergeEdit||"1"!=t.getAttribute("colMerged"))&&!l.options.embeddedInput&&!this.groupbyStatus.grouped){if(this.__getEditReadOnly(t,i))return this.editMode=!1,void(l.options.showReadOnly&&(this.editMode=!0,l.showReadonly(t,i)));if(this._getEditDisabled(i,n))return this.editMode=!1,void(l.options.showReadOnly&&(this.editMode=!0,l.showReadonly(t,i)));0!=d.B.fireEvent(this,"onbeforeedit",i,n,this.dataList._getCellData(i,this.getColumnID(n)))&&null==this.editedCell&&(this.editMode=!0,this.setCellEditMode(t,i),l.comp&&l.comp.setReadOnly(this.__getEditReadOnly(t,i)))}}},m.prototype.getEditReadOnly=function(t,e){var i=t.getAttribute("col_id");return this._getEditReadOnly(e,i)},m.prototype.getReadOnly=function(){var t=a.D.getBoolean,e=arguments[0];if("grid"==e||0==arguments.length)return t(this.options.readOnly);if("row"==e)return t(this.getRowReadOnly(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnReadOnly(i))}if("cell"==e){var o=arguments[1]
;i=this.getColumnID(arguments[2]);return t(this.getCellReadOnly(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this._getEditReadOnly(o,i)}},m.prototype.setReadOnly=function(){try{var t=arguments[0];if(1==arguments.length||"grid"==t){var e=arguments[arguments.length-1],i=this.options.readOnly,o=a.D.getBoolean(e);"clear"==e?(this.rowReadOnlyArr=[],this.cellReadOnlyArr=[]):this.options.readOnly=o;var s=this.getDataLength();if(0!=s&&i!==o){var n=this.options.showLastRow&&!this.hasSubtotal?this.lastIndex+1:this.lastIndex;for(var l in this.cellInfoHash){var h=this.getColumnIndex(l);if(!isNaN(h)){for(var d=0;d<=n;d++)this.drawCellData(d,d+this.rowIndex,h);this.applyColumnStyleOptions(h)}}}this.options.readOnly?this.addClass(" w2grid_readonly_outer"):this.removeClass("w2grid_readonly_outer")}else"row"==t?this.setRowReadOnly(arguments[1],arguments[2]):"column"==t?this.setColumnReadOnly(arguments[1],arguments[2]):"cell"==t&&this.setCellReadOnly(arguments[1],arguments[2],arguments[3])}catch(t){r.w.printStackTrace(t)}},m.prototype._getEditReadOnly=function(t,e,i){try{e=this.getColumnID(e);var o=this.getCellReadOnly(t,e,i),s=this.cellInfoHash[e];if(null==s)return;var n=a.D.getBoolean;if(o+""!="")return n(o);var l=this.options.readOnlyPriority,h=s.options.readOnly,d=this.getRowReadOnly(t,i);return"column"==l&&""!==h?n(h):"row"==l&&""!==d?n(d):h+""=="true"||d+""=="true"||h+""!="false"&&d+""!="false"&&(this.options.readOnly+""!=""&&n(this.options.readOnly))}catch(t){r.w.printStackTrace(t)}},m.prototype.__getEditReadOnly=function(t,e){var i=t.getAttribute("col_id");return this.___getEditReadOnly(e,i)},m.prototype.___getEditReadOnly=function(t,e,i){var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)?this.dataList.getRealRowIndex(t):this._getGroupbyDisplayRowIndex(t);return this._getEditReadOnly(o,e,i)},m.prototype.getDisabled=function(){var t=a.D.getBoolean,e=arguments[0];if("grid"==e||null==e)return t(this.options.disabled);if("row"==e)return t(this.getRowDisabled(arguments[1]));if("column"==e){var i=this.getColumnID(arguments[1]);return t(this.getColumnDisabled(i))}if("cell"==e){var o=arguments[1];i=this.getColumnID(arguments[2]);return t(this.getCellDisabled(o,i))}if("all"==e){o=arguments[1],i=this.getColumnID(arguments[2]);return this.getEditDisabled(o,i)}},m.prototype.setDisabled=function(t,e,i,o){try{for(var s=[t,e,i,o];s.length>0&&null==s[s.length-1];)s.pop();var n=s[0],l=1==s.length||"grid"==n,h=2==s.length&&"boolean"==typeof s[0]&&"boolean"==typeof s[1];if(l||h){var d=l?s[s.length-1]:s[0];if((d=a.D.getBoolean(d))!=this.options.disabled){this.options.disabled=d;var u=this.getElementById(this.id+"_dataLayer");!l&&d||(u.disabled=d),(h||!d&&u.disabledW2)&&(u.disabledW2=d),d?(this.addClass(u,"w2grid_disabled"),this.addClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowXHidden(),this.setOverflowYHidden())):(this.removeClass(u,"w2grid_disabled"),this.removeClass("w2grid_disabled_outer"),this.options.disabledScrollHidden&&(this.setOverflowX(),this.setOverflowY()));for(var p=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),c=0;c<p.length;c++){var g=p[c].getAttribute("header_id"),f=this.headerObj[g];f?f.setDisabled?f.setDisabled(d):f.render?f.render.disabled=d:f.disabled=d:p[c].disabled=d}for(var m in this.cellInfoHash){var y=this.cellInfoHash[m];y&&"checkbox"===y.options.inputType&&(""===y.options.disabled?(y._oriDisabled=y.options.disabled,y.options.disabled=d):""===y._oriDisabled&&(y.options.disabled=d));var b=this.getColumnIndex(m);this.drawColumnData(b),this.applyColumnStyleOptions(b)}}return d}"row"==n?this.setRowDisabled(s[1],s[2]):"column"==n?this.setColumnDisabled(s[1],s[2]):"cell"==n&&this.setCellDisabled(s[1],s[2],s[3])}catch(t){r.w.printStackTrace(t)}},m.prototype.getEditDisabled=function(t,e,i){return this._getEditDisabled(this._getGroupbyGroupedRowIndex(t),e,i)},m.prototype._getEditDisabled=function(t,e,i){try{var o=-1,s=""
;"number"==typeof e?(o=e,s=this.cellIdList[e]):(o=this.bodyIdColIndexMap[e],s=e);var a=-1;if(!0===i)a=t;else if(this._linkedDataList)a=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var n=!0;for(var l in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[l]){a=this._dataList.filteredRowIndexArr[t],n=!1;break}n&&(a=this.groupbyStatus.groupedRowIndexArr[t])}else a=this._dataList.filteredRowIndexArr[t];var h=this.cellInfoHash[s]||{options:{}},d=this.cellDisabledArr[a*this.oneRowDataLength+o];if(!0!==d&&!1!==d){var u=h.options.disabled,p=this.rowDisabledArr[a],c=this.options.disabledPriority;!0!==p&&!1!==p&&(p=""),d="column"===c&&""!==u?u:"row"===c&&""!==p?p:u+""=="true"||p+""=="true"||u+""!="false"&&p+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}return d}catch(t){r.w.printStackTrace(t)}},m.prototype.getElemRowIndex=function(t){var e=parseInt(t.getAttribute("tdIndex"));return parseInt(e/this.realRowDataLength)+this.rowIndex},m.prototype.notifyDataChanged=function(t){if("active"==this.activeStatus){this.initHeightCompleted=!1,this.checkResize();var e=t&&t.append||!1,i=t&&t.keepTop||!1,o=t&&t.refreshScroll||!1,s=t&&t.refreshInstance||!1,r=i&&this.rowIndex>=0?this.rowIndex:0,a=t&&!0===t.gridData;if(this.delayedDraw({rowIndex:r}))!0===s&&this._refreshInstance(void 0,e);else{this._mergeRefresh();var n=this._setGridBorderNoRefresh||!1;if(this._setGridBorderNoRefresh=!0,this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),o&&"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(),this.senseReaderMode=!1,this.displayNoResultMessage(),this._setGridBorderNoRefresh=n,!0===s&&this._refreshInstance(void 0,e),void this.refreshAdaptive({simple:!0});if("native"===this.options.drawType)return this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),!0===s&&this._refreshInstance(void 0,e),void this.refreshAdaptive({simple:!0});if(e&&!this.loadFlag)return this.drawFooter(),this.drawHeader(),void(!0===s&&this._refreshInstance(void 0,e));if(this.changeCount++,!0===e&&"true"===this.options.keepScrollForSenseReader&&!0===this.options.senseReader&&this.options.visibleRowNum>0)var l=this.drawDataTable(0,{keepScrollTop:!0});else l=this.drawDataTable(0);for(var h in o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),0==l&&(e&&!o&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.hiddenCellObj.length>0?(this.rowIndex=r,!0!==a&&this._setCellVisibleRefresh()):this.drawData(r)),this.displayNoResultMessage(),this.drawFooter(),this.drawHeader(),this._setGridBorderNoRefresh=n,this.refreshAdaptive({simple:!0}),this.cellInfoHash)this.cellInfoHash[h].refreshCell();if(this.hasCustomInputType)for(var d=0;d<this.cellIdList.length;d++){var u=this.cellInfoHash[this.cellIdList[d]];u&&u.options&&"custom"===u.options.inputType&&u.options.typeGetter&&u.refreshCellManagerHash()}!0===s&&this._refreshInstance(void 0,e)}}},m.prototype.notifyCellChanged=function(t,e,i,o){if(this.changeCount++,!this.delayedDraw({})){var s=t;if(this.rowIndex>=0){var r=this.getDataLength();this.options.fixedRow>0&&this.options.fixedRow>t||(this.options.lastFixedRow>0&&s>=r-this.options.lastFixedRow?s=this.lastIndex-(r-1-s):s-=this.rowIndex)}if(e=this.getColumnIndex(e),this._drawRowStatus(s,t),!0!==i&&(this.drawCellData(s,t,e),this.groupbyStatus.grouped&&this.options.groupbyDisplayRowIndex)){for(var a=t+1,n=s+1;"number"==typeof this.groupbyStatus.groupedRowIndexArr[a]&&a<this.groupbyStatus.groupedRowIndexArr.length;)a++,n++;if("object"==typeof this.groupbyStatus.groupedRowIndexArr[a]&&"footer"===this.groupbyStatus.groupedRowIndexArr[a].type){var l=this.dataList.getRealRowIndex(a);if(null!=l){var h=this.all_data_td_list[n*this.realRowDataLength];h&&this.drawGroupData(h,l,n)}}}var d=this.getColumnID(e),u=this.expressionAssArr[d];if(null!=u){
var p=this.searchExpression(u);for(var c in p){var g=this.getColumnIndex(c);this.drawCellData(s,t,g),this.drawFooter(g),this.drawHeader(g)}}var f=this.labelColumnAssArr[d];if(null!=f)for(c=0;c<f.length;c++){var m=this.getColumnIndex(f[c]);this.drawCellData(s,t,m)}this.displayNoResultMessage(),this.hasSubtotal&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex)),this.drawFooter(d),this.drawHeader(d),o||this._setCheckboxHead(d)}},m.prototype.searchExpression=function(t){for(var e={},i=[t];i.length>0;)for(var o=i.pop(),s=0;s<o.length;s++)if(e[o[s]]=!0,this.expressionAssArr[o[s]]){var r=this.expressionAssArr[o[s]];if(r.length>1)i.push(r);else null!=this.expressionAssArr[r]&&i.push(r),e[r]=!0}return e},m.prototype.notifyRowChanged=function(t,e){if(this.changeCount++,!this.delayedDraw({rowIndex:t})){if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(),this.senseReaderMode=!1,this.displayNoResultMessage(),void this.refreshAdaptive({simple:!0});if("native"===this.options.drawType)return this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),void this.refreshAdaptive({simple:!0});if(-1==this.rowIndex)this.drawDataTable(0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(e&&!0===e.keepScrollTop)this.lastTopRowIndex=null,this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0});else{this.lastTopRowIndex=null;var i=this._dataList.options.depthColumn?this.getDrawCount()+this.rowIndex:this.getDataLength(),o=(t=t||this.rowIndex)-this.rowIndex,s=this.rowIndex;if(0<=o&&o<=this.lastIndex&&(this.rowIndex<=0||this.rowIndex+this.lastIndex<i))if(this.isDrillDown&&!this.drilldown.isOpen(t)){var r=("linkedDataList"===this.drilldown.mode?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr).length-(t+1),n=this.lastIndex-o-r;s=l=n<=0?this.rowIndex:(l=this.rowIndex-n)>0?l:0}else s=this.rowIndex;else if(0<=o&&o<=this.lastIndex||o<0){var l;(l=this.rowIndex-1)+this.lastIndex>=i&&(l=i-this.lastIndex-1),s=l=l>0?l:0}this.hiddenCellObj.length>0?(this.rowIndex=s,a.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200})):this.drawData(s,0)}this.displayNoResultMessage(),this.hasSubtotal&&this.refreshSubtotalRow(t),this.drawFooter(),this.drawHeader(),this.refreshAdaptive({simple:!0})}},m.prototype.notifyRowInserted=function(t){if(t=parseInt(t,10),this.changeCount++,!this.delayedDraw({rowIndex:t})){if(this.options.senseReader&&this.rowIndex<=0)return this.senseReaderMode=!0,this.setDataTable(),this.drawData(0),"all"!==this.options.visibleRowNum&&(this.lastTopRowIndex=null,this.setScrollYHeight()),this.drawFooter(),this.drawHeader(),this.senseReaderMode=!1,this.displayNoResultMessage(),void this.refreshAdaptive({simple:!0});if("native"===this.options.drawType)return this.setDataTable(),this.drawData(0),this.drawFooter(),this.drawHeader(),this.displayNoResultMessage(),void this.refreshAdaptive({simple:!0});if(this.lastTopRowIndex=null,-1==this.rowIndex)0==this.drawDataTable(0)&&this.drawData(0,0),(this.options.fixedColumn>0||this.options.fixedRightColumn>0)&&this.arrangeOverflowXScroll(!0);else if(""!==this.options.visibleRowNum||this.options.initFixedHeightByRowNum>0)this.setDataTable(),this.drawData(0);else{var e=t-this.rowIndex,i=this.getElementById(this.id+"_scrollY_div");if(e<0){var o=this.getElementById(this.id+"_scrollY_div");this.scrollEvent=!1,o.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0)}else(i.offsetHeight>=i.scrollHeight||e<=this.lastIndex)&&(this.hasSubtotal&&(e=0),this.drawData(this.rowIndex,e))}0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight();var s=this._getVisibleLastIndex(this.lastIndex+1);if(this.rowIndex+s-1<t){this.scrollEvent=!1,
(o=this.getElementById(this.id+"_scrollY_div")).scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t);var r=this._getEpsilon(),n=Math.round(o.scrollTop)+r,l=this._getVisibleRowIndex(parseInt(n/this.oneRowScrollHeight));this.hiddenCellObj.length>0?(this.rowIndex=l,a.D.setTimeout(this._setCellVisibleRefresh,{key:this.id+"_setCellVisibleRefresh",caller:this,delay:200}),this.lastTopRowIndex=null):this.drawData(l)}this.displayNoResultMessage(),this.drawFooter(),this.drawHeader(),this.refreshAdaptive({simple:!0})}},m.prototype.displayNoResultMessage=function(){var t="removed"!==this.options.noResultMessageExclude||0==this.removed,e=this.getElementById(this.id+"_noresult");if(e&&this.options.noResultMessageVisible&&t&&0==this.initFlag&&0==this.getDataLength()){e.innerHTML=this.options.noResultMessage,e.style.display="block";var i=this.getElementById(this.id+"_main_div"),o=i.offsetHeight,s=this.getElementById(this.id+"_body_table").offsetHeight+3,r=this.getElementById(this.id+"_foot_table"),a=0;r&&(a=r.offsetHeight);var n=this.getElementById(this.id+"_noresult"),l=parseInt(WebSquare.style.getStyle(n,"margin-top"),10)||0,h=parseInt(WebSquare.style.getStyle(n,"margin-bottom"),10)||0,d=n.offsetHeight+l+h,u=o-s-a,p=this.getElementById(this.id+"_scrollX_div").offsetHeight;if(u<=0);else if(u<=d)this.getElementById(this.id+"_noresult").style.top=s+l+"px",this.setSize(i,s+a+d+p+l+h);else{var c=this.getElementById(this.id+"_head_table"),g=this.getElementById(this.id+"_noresult").style.top,f=0;if(c&&c.childNodes)for(var m=0;m<c.childNodes.length;m++)"string"==typeof c.childNodes[m].tagName&&"TR"===c.childNodes[m].tagName.toUpperCase()&&f++;f>1&&"40%"==g&&(this.getElementById(this.id+"_noresult").style.top=parseInt(f*this.oneRowHeight/2+4*o/10)+"px")}}else e.style.display="none";this.removed=!1,this.delayedDrawObj||this.removeAllFinish||(this.initFlag=!1)},m.prototype.delayedDraw=function(t){return!!this.startedDisplayNone||(0==this.resizeObj.width||0==this.resizeObj.height)&&(this.delayedDrawObj||(this.delayedDrawObj={}),this.delayedDrawObj.redraw=!0,t.hasOwnProperty("rowIndex")?this.delayedDrawObj.rowIndex=t.rowIndex:t.hasOwnProperty("subTotalVisible")&&(this.delayedDrawObj.subTotalVisible=t.subTotalVisible),!0)},m.prototype.delayedAction=function(){this.startedDisplayNone=!1,this.setPreAction(),this.getRowCount&&this.getRowCount()>0&&this.notifyDataChanged(),this.options.focusOnSetData&&this._setFocusedCell(0,0);var t=WebSquare.BootLoader.fullViewed||!1,e=a.D.fullViewed||!1;t||e||this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),a.D.isMobile()&&this.options.fixAdaptive||this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),this.delayedDrawObj=null,this.initFlag=!1},m.prototype.setRedrawStatus=function(t){if(!this.startedDisplayNone||"stop"!=t)if("stop"==t)this.delayedDrawObj||(this.delayedDrawObj={});else{this.setDataLayerPosition(),this.scrollX_right.scrollLeft=this.resizeObj.scrollLeft,this.getElementById(this.id+"_scrollY_div").scrollTop=this.resizeObj.scrollTop,this.handlerResize_drawInitializer(),this._handleScrollX();for(var e=!1,i=0;i<this.colWidthList.length;i++)if(this.colWidthList[i].toString().indexOf("*")>-1){e=!0;break}if((this.options.autoFit||e)&&this.autoFitFunc(),this.delayedDrawObj.redraw){this.lastTopRowIndex=null,this.setDataTable(),this.setTrRowTable(),this.setColIndexInfo();var o=this.delayedDrawObj.rowIndex||0,s=o,r=this.getDataLength();if(r-this.drawedRowLength<s&&(s=r-this.drawedRowLength)<0&&(s=0),"all"!==this.options.visibleRowNum)for(;this.hiddenRowObj.extraRow<this.hiddenRowObj.length;)this._addHiddenRow(this.drawedRowLength+this.hiddenRowObj.extraRow);this.drawData(s),
null!=this.delayedDrawObj.subTotalVisible&&this.delayedDrawObj.subTotalVisible!==this.hasSubtotal?this.setSubtotalVisible(this.delayedDrawObj.subTotalVisible):this.setScrollYHeight();var a=this.rowIndex+this.lastIndex,n=this._getScrollRowIndex(o);if(a<o||n<o){this.scrollEvent=!1;var l=this.getElementById(this.id+"_scrollY_div");l.scrollTop=this.oneRowScrollHeight*n;var h=this._getVisibleRowIndex(parseInt(l.scrollTop/this.oneRowScrollHeight));this.drawData(h)}this.drawFooter(),this.drawHeader(),this.displayNoResultMessage();var d="never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols;for(var u in d||(this._mergeRefresh(),this.dynamicMergeHTML()),this.cellInfoHash)this.cellInfoHash[u].refreshCell()}this._setVisibleRowNumFix(),this.delayedDrawObj=null,this.initFlag=!1}};var y=function(){};y.prototype.setScrollYHeight=function(t){void 0!==t&&null!=t||(t={});var e=this.getDataLength(),i=this.rowIndex,o=!0===t.noDraw,r=!0===t.keepScrollTop,n=this.getElementById(this.id+"_size_y"),l=this.getElementById(this.id+"_scrollY_div"),h=n.parentNode.offsetHeight;0==h&&(h=parseInt(this.getStyle("height")));var d=this._getScrollRowIndex(i);if(-1==i||0==d&&d+this._getVisibleLastIndex(this.lastIndex+1)==e){var u=!0;if(this.hasSubtotal&&this.drawedSubtotal.length>0){var p=this.drawedSubtotal[this.drawedSubtotal.length-1];(p.rowIndex+1!=e||"none"===p[p.length-1].style.display||this._getLastSubtotalCount()>this.drawedSubtotal.length)&&(u=!1)}else this.hasSubtotal&&0==this.drawedSubtotal.length&&this.lastSubtotalRow&&e>0&&(u=!1);if(u)return"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),void(0!==n.offsetHeight&&(n.style.height="0px",this.handlerResize_drawInitializer()))}var c=l.scrollTop;if(!0!==t.skipResize){var g;if("number"==typeof t.restRowCnt)g=t.restRowCnt;else if(""!==this.options.visibleRowNum)this.options.senseReader&&"all"===this.options.visibleRowNum||this.isDrillDown?g=e-(this.lastIndex+1):(g=e-this.drawedRowLength,this.options.initFixedHeightByRowNum>-1&&(g+=this._getLastSubtotalCount())),g<0&&(g=0),g=Math.max(0,g-this._getHiddenRowCount());else if(this.lastTopRowIndex&&this.lastTopRowIndex>0)g=this._getScrollRowIndex(Math.ceil(this.lastTopRowIndex));else{var f=this.getElementById(this.id+"_head_table"),m=this.dataLayerHeight-f.offsetHeight,y=parseInt(m/this.oneRowHeight),b=this.drawedRowLength;y+(this.isMobile?0:1)<b&&(b=y+(this.isMobile?0:1)),g=this.options.fixHeight||this.hasSubtotal?e-y>1?e-y:1:this.options.senseReader?e-(this.lastIndex+1)>0?e-(this.lastIndex+1):1:e-b+1>1?e-b+(this.isMobile?0:1):1,g=Math.max(0,g-this._getHiddenRowCount())}var w=h+this.oneRowScrollHeight*g;if(h=l.offsetHeight,w<=1e6&&"table"!=n.tagName.toLowerCase())n.style.height=w+"px";else if(w<=1e6)l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,(n=this.getElementById(this.id+"_size_y")).style.height=w+"px";else if(s.v.browserCheck.ieAllVersion&&!this.isIE6or7||a.D.isSpartan()){var v=[];for(v.push("<table id='"+this.id+"_size_y' style='border-collapse:collapse; border-spacing:0px;height:0px; position:absolute; top:0px; left:0px; width:18px'><tbody>");w>1e6;)v.push("<tr style='height:1000000px'><td></td></tr>"),w-=1e6;v.push("<tr style='height:"+w+"px'><td></td></tr></tbody></table>"),l.innerHTML=v.join(""),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")}else"table"==n.tagName.toLowerCase()&&(l.innerHTML=this.getScrollY(),this.dom[this.id+"_size_y"]=null,n=this.getElementById(this.id+"_size_y")),s.v.browserCheck.moz?n.style.height=w+1+"px":n.style.height=w+"px"}else h=l.offsetHeight;if(!0!==t.skipScrollEnd){var I=n.offsetHeight;I<1e6&&(I=parseInt(n.style.height,10));var C=I-h,x=this._getEpsilon(),_=Math.min(Math.round(c)+x,C),S=this._getScrollMaxRowIndex();if(S>e-this._getHiddenRowCount())this._applyScrollEnd(S,{noDraw:!0});else{
if((this.options.syncWithScrollTrack?Math.ceil:Math.floor).call(this,_/this.oneRowScrollHeight)!=this._getScrollRowIndex(i)){this.lastTopRowIndex&&this.lastTopRowIndex==i&&(i=this.lastTopRowIndex+1);var D=this._getScrollRowIndex(i);o&&l.scrollTop!=this.oneRowScrollHeight*D&&(this.scrollEvent=!1),_=Math.min(this.oneRowScrollHeight*D,C),l.scrollTop=_,this.bScrollTop=this._getVisibleRowIndex(parseInt(_/this.oneRowScrollHeight))}!r&&C>0&&C==_&&this._applyScrollEnd(this.rowIndex),this.lastScrollYTop=l.scrollTop,!0!==t.skipResize&&this.handlerResize_drawInitializer(),this.isMobile&&this.setIScrollY()}}else this.handlerResize_drawInitializer()},y.prototype._checkScrollEnd=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=t.offsetHeight;o<1e6&&(o=parseInt(t.style.height,10));var s=o-i,a=this._getEpsilon(),n=e.scrollTop,l=Math.min(Math.round(n)+a,s);return s>0&&s===l}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype._checkScrollEnd2=function(){try{var t=this.getElementById(this.id+"_size_y"),e=this.getElementById(this.id+"_scrollY_div"),i=e.offsetHeight,o=parseInt(t.style.height,10)-i,s=this._getEpsilon(),a=e.scrollTop,n=Math.min(Math.round(a)+s,o);return o<=0?-1:n<3?1:n<o?0:2}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype._applyScrollEnd=function(t,e){try{if(""!==this.options.visibleRowNum||this.lastTopRowIndex>0||0===this.lastTopRowIndex||this.groupbyStatus.grouped)return 0;if(this.hiddenCellObj.length>0)return 0;if(isNaN(t)&&(t=this.rowIndex),void 0!==e&&null!=e||(e={}),this._applyScrollEndCnt){if(this._applyScrollEndCnt>4)return;this._applyScrollEndCnt++}else this._applyScrollEndCnt=0;var i=0,o=this.getDataLength(),s=!1;if(this.hasSubtotal){if(this.drawedSubtotal.length>0){var a=this.drawedSubtotal[this.drawedSubtotal.length-1];if(a.rowIndex==o-1)"none"!=a[a.length-1].style.display&&(s=!0)}}else s=!0;var n=this.lastIndex+1,l=this._getVisibleLastIndex(n);if(t+l==o&&s)this.lastTopRowIndex=t;else{var h=o-l;i=this._getScrollRowIndex(h)-this._getScrollRowIndex(t);var d=this.getElementById(this.id+"_size_y");if(this.hasSubtotal&&!s)if(this.struct.subtotalArr.length>1&&""===this.options.visibleRowNum&&!0!==e.noDraw){var u=this._getDrawedRowCount();if(u>0)return this.options.initFixedHeightByRowNum=u,this.options.visibleRowNum=u,this.drawedRowLength=u,this.lastTopRowIndex=null,this.drawedRowLength=this.options.initFixedHeightByRowNum,void this.drawData(this.rowIndex,0);i+=this.struct.subtotalArr.length}else i+=this.struct.subtotalArr.length;if(0!==i){this.lastTopRowIndex=null;var p=d.offsetHeight;p<1e6&&(p=parseInt(d.style.height,10)),d.style.height=p+this.oneRowScrollHeight*i+"px",!0!==e.noDraw&&this.drawData(t+i),this.handlerResize_drawInitializer()}}return this._applyScrollEndCnt=0,i}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.addGridScroll=function(t){var e=this.rowIndex+t;e=(e=e<0?0:e)>=this.getDataLength()-this.lastIndex?this.getDataLength()-this.lastIndex:e,this.scrollEvent=!1,this.checkScrollEnd=!0,this.drawData(e,0)},y.prototype.handleScrollY=function(t,e){var i=this.getElementById(this.id+"_scrollY_div").scrollTop;if(i!=this.bScrollY&&(this.bScrollY=i,0!==this.getElementById(this.id+"_size_y").offsetHeight)){var o=this._getEpsilon(),s=Math.round(i)+o,r=this._getVisibleRowIndex(parseInt(s/this.oneRowScrollHeight)),n=this.getDataLength(),l=this._checkScrollEnd();if(this.scrollEvent&&(null!=this.editedCell&&this._fireOnviewchange(this.editedCell.id,"handleScrollY",[t]),this.bScrollTop!=r)){this.hasClass(document.activeElement,this.options.bodyTdClass)&&document.activeElement.blur&&document.activeElement.blur();var h="async";(e&&!0===e.changedHeight||l)&&(h="sync"),this.drawData(r,null,h)}this.bScrollTop=r;var u=this._getVisibleLastIndex(this.lastIndex+1);if(0==i&&this.checkScrollStart&&(this.skipScrollStartEvent||(this.scrollEvent=!0,this.checkScrollStart=this.options.alwaysTriggerScrollStart,d.B.stopEvent(t),
a.D.setTimeout((function(){d.B.fireEvent(this,"onscrollstart")}),{key:this.id+"_scrollstart",caller:this,delay:150}))),(this.scrollEvent||this.checkScrollEnd)&&this.options.loadCount>0&&this.loadFlag){var p=r+u-1;n-this.options.loadCount-1<=p&&null==this.loadCheck[n]&&(this.skipScrollEndEvent||(this.loadCheck[n]=!0,this.scrollEvent=!0,this.loadFlag=!1,d.B.stopEvent(t),a.D.setTimeout((function(){d.B.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150})))}else(this.scrollEvent||this.checkScrollEnd)&&0==this.options.loadCount&&!0===l&&(!this.scrollEvent||this._applyScrollEnd(this.rowIndex)<=0)&&(d.B.stopEvent(t),a.D.setTimeout((function(){d.B.fireEvent(this,"onscrollend")}),{key:this.id+"_scrollend",caller:this,delay:150}));if(this.skipScrollStartEvent=!1,this.skipScrollEndEvent=!1,this.scrollEvent=!0,this.checkScrollEnd=!1,1==this.options.syncScroll&&this.options.syncScrollId)for(var c=this.options.syncScrollId.split(","),g=0;g<c.length;g++){var f=a.D.getComponentById(c[g],this.scope_id);f&&this.getRowCount()==f.getRowCount()&&f.setScrollTop(i)}d.B.fireEvent(this,"onscrolly",t)}},y.prototype.drawDataTable=function(t,e){try{null==t&&(t=this.rowIndex),-1==t&&(t=0);var i=this.drawedRowLength;return this.setDataTable(),this.headerTds=null,this.footerTds=null,this.drawedRowLength!=i&&(this.setColIndexInfo(),e&&e.keepScrollTop?this.drawData(this.rowIndex,0,null,null,{keepScrollTop:!0}):this.drawData(t,0)),this.drawedRowLength-i}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.drawData=function(t,e,i,o,a){try{s.v.clearTimer(this.id+"_drawData"),s.v.clearTimer(this.id+"_completiveDrawData"),s.v.clearTimer(this.id+"_adjustDraw");i=i||"sync";var n=!0;this.options.senseReader&&(n=!1),t=Math.min(t,this.getDataLength()),this.changeFocusedCellPosition(t,n,!0);var l=this.maxRowLength;if(this.rowIndex=t,null!=this.editedCell&&this.editedCell.handleEndEdit(null,o),this.subtotalHidden(e?{startRowIndex:e+this.rowIndex}:null),-1!=this.rowIndex&&"sync"!=i&&"all"!==this.options.visibleRowNum||this.startedDisplayNone)e=this.fastDrawData(e,{scroll:!0}),s.v.setTimer((function(e){s.v.setTimer(this.completiveDrawData,{key:this.id+"_completiveDrawData",caller:this,delay:120,args:[e],callback:function(e){s.v.setTimer((function(){this.startedDisplayNone||(this.adjustDraw(e),this._setGridBorder(),this._setCheckboxHead()),l!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}),{key:this.id+"_adjustDraw",caller:this})}})}),{key:this.id+"_drawData",caller:this,delay:1,args:[e]});else{var h=this.completiveDrawData(e,!1);this.adjustDraw(h,a),this._setGridBorder(),this._setCheckboxHead(),l!=this.maxRowLength&&this.changeFocusedCellPosition(t,n)}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.fastDrawData=function(t,e){try{var i=this.options.initFixedHeightByRowNum>-1;i&&(void 0===e||null==e?e={skipSubtotal:!0}:e.skipSubtotal=!0),this.options.measureTime&&s.v.measureTime((function(t){var e=t.aver,i=parseInt(1e3/e*10,10)/10;u.k.printLog("Id : "+this.id+", time : "+e+"ms   ,fps : "+i)}),{key:this.id+"_measureDrawTime",caller:this});var o=this.rowIndex,a=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var n=this._getVisibleTrRowIndex(t,o),l=this.hiddenCellObj.length>0;if(a>0){0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);new Date;var h,d=1;l?(h=a,d=a):""===this.options.visibleRowNum?h=this._getVisibleTrRowIndex(this.drawedRowLength,o):("all"===this.options.visibleRowNum||(d=parseInt(this.options.visibleRowNum,10)-t),h=a);for(this._getVisibleTrRowIndex(this.options.drawLimitRow,o);n<h&&n+o<a&&d>0;n++){var p=!this.hiddenRowObj.length>0||this._getRowVisible(n+o);p&&!0===this.hiddenRowObj.init&&this._setRowDisplay(n,""),this.options.fixedRow>0&&this.options.fixedRow>n?this.fastDrawRowData(n,n,e):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.fastDrawRowData(n,n+o,e);var c=this.options.backgroundColorMode.toLowerCase()
;if("always"==c?"object"!=typeof this.dataList.getRealRowIndex()&&(this.options.fixedRow>0&&this.options.fixedRow>n?this.applyRowStyleOptions(n):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||this.applyRowStyleOptions(o+n)):"full"==c&&"object"!=typeof this.dataList.getRealRowIndex()&&(this.options.fixedRow>0&&this.options.fixedRow>n?(this.applyRowStyleOptions(n),this.setEvenOddBackground(n,n)):this.options.lastFixedRow>0&&n>this.lastIndex-this.options.lastFixedRow||(this.applyRowStyleOptions(o+n),this.setEvenOddBackground(n,o+n))),p?this.lastDisplayedRow<n&&!0!==this.hiddenRowObj.init&&(this._setRowDisplay(n,""),l||(this.lastDisplayedRow=n)):this._setRowDisplay(n,"none"),p&&""!==this.options.visibleRowNum)if(d--,i&&this.hasSubtotal&&d>=1)d-=this.drawSubtotalRow(n+1,n+o,{maxCount:d});if(l)for(var g=0;g<this.oneRowDataLength;g++){var f=n+o,m=this._getTdElem(n+o,g);if(m){var y=!0===this.hiddenCellObj[f+"_"+g];m.style.display=y?"none":""}}}}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),null!==this.lastTopRowIndex&&o>=this.lastTopRowIndex&&!0!==this.hiddenRowObj.init&&!l){for(g=n;g<=this.lastDisplayedRow;g++)this._setRowDisplay(g,"none");this.lastDisplayedRow=n-1}return this.options.mergeRefreshAlways&&this.dynamicMergeHTML(),!0===this.hiddenRowObj.init?t:n}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.completiveDrawData=function(t,e){try{!this.autofitDone&&this.options.autoFit&&this._setAutoFit();var i=this.getDataLength();t=t||0;!0===this.hiddenRowObj.init&&(t=0);var o=this.rowIndex,s=t-1,n=this.dataLayerHeight,l=this.hiddenCellObj.length>0;if(i>0){if(!0===this.hiddenRowObj.init)this._applyRowVisible({applyStyle:!0,drawRow:!0}),s=this.lastIndex;else{var h=this.options.initFixedHeightByRowNum>-1;0==t&&o!=this.lastTopRowIndex&&""===this.options.visibleRowNum&&this.drawSubtotalRow(0,o-1);var d,u=this.drawedRowLength;h&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength),h&&(d={skipSubtotal:!0});for(var p=t;p<u&&p+o<i;p++){var c=p+this.rowIndex;if(this.options.fixedRow>0&&this.options.fixedRow>p?this.fastDrawRowData(p,p,d):this.fastDrawRowData(p,c,d),s=p,h&&this.hasSubtotal&&p<u-1)u-=this.drawSubtotalRow(p+1,c,{maxCount:u-p-1})}if(h&&this.hasSubtotal&&u>s+1&&(u-=this.drawSubtotalRow(0,o-1,{maxCount:u-s-1})),this.options.rowResize&&this.rowResized){var g=n-this.getElementById(this.id+"_head_table").offsetHeight,f=0;for(p=0;p<this.dataRowList.length;p++){if(!(f<g)){s=p;break}f+=this.dataRowList[p].offsetHeight}}if("native"==this.options.drawType&&0!=t&&(s=this.getDataLength()-1),l){for(p=s+1;p<this.drawedRowLength+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=0;p<=s;p++)this._setRowDisplay(p,"")}else{for(p=s+1;p<=this.lastDisplayedRow+this.hiddenRowObj.extraRow;p++)this._setRowDisplay(p,"none");for(p=this.lastDisplayedRow+1;p<=s;p++)this._setRowDisplay(p,"")}var m=l||""===this.options.visibleRowNum&&-1==this.options.initFixedHeightByRowNum;if(m){var y=0,b=this.options.backgroundColorMode.toLowerCase();"always"!==b&&"full"!==b||(y=t);for(p=y;p<=s;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.applyRowStyleOptions(p):this.applyRowStyleOptions(o+p);this.options.autoResizeEmbeddedInput&&this.firstEmbeddedInputResize&&(this.setAutoResizeEmbeddedInput(),this.firstEmbeddedInputResize=!1)}this.lastDisplayedRow=s,m&&"all"!==this.options.visibleRowNum&&(s=this.cutGridBottom(s,e))}for(p=0;p<=s;p++)this.options.fixedRow>0&&this.options.fixedRow>p?this.setEvenOddBackground(p,p):this.setEvenOddBackground(p,o+p);if(this.options.lastFixedRow>0)for(p=0;p<this.options.lastFixedRow;p++)this.options.lastFixedRowStartIndex>0?(this.fastDrawRowData(s-p,this.options.lastFixedRowStartIndex+1-p),m&&this.applyRowStyleOptions(s-p),this.setEvenOddBackground(s-p,this.options.lastFixedRowStartIndex+1-p)):(this.fastDrawRowData(s-p,i-1-p),m&&this.applyRowStyleOptions(s-p),this.setEvenOddBackground(s-p,i-1-p));if(!0!==this.hiddenRowObj.init&&!l){
var w=this._getVisibleLastIndex(s+1);s+1<this.drawedRowLength&&(this._setRowDisplay(w,""),this.setEvenOddBackground(w,o+w),this.applyRowStyleOptions(o+w),this.options.showLastRow&&!this.hasSubtotal?this.getDataLength()<=o+w&&this._setRowDisplay(w,"none"):this._setRowDisplay(w,"none"))}}else{var v=this.options.showLastRow&&!this.hasSubtotal?1:0,I=this.lastDisplayedRow+v;!0===this.hiddenRowObj.init&&(I=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(p=0;p<=I;p++)this._setRowDisplay(p,"none");s=this.lastDisplayedRow=-1}if(this.hideDataLayer&&(this.hideDataLayer.style.display="none"),this.focusedCell.length>0&&!this.editedCell){var C=this.focusedCell[this.focusedCell.length-1].focusedRowIndex-this.rowIndex,x=this.focusedCell[this.focusedCell.length-1].focusedColIndex;if(0<=C&&C<=s){var _=this.data_td_list[x+C*this.oneRowDataLength];_&&this.applyFocusedCellIn(_)}}var S=WebSquare.BootLoader.fullViewed||!1,D=a.D.fullViewed||!1;if(!S&&!D&&"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")){this.hasSubtotal&&this.setAdaptiveGridSubtotalHeight();for(p=this.defaultColCnt;p<this.hiddenList.length;p++)1==this.hiddenList[p]&&this.setAdaptiveColumnVisible(p,!1)}return s}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.adjustDraw=function(t,e){try{void 0!==e&&null!=e||(e={});var i=this.rowIndex;this.dataLayerHeight;if(this.options.lazyDrawHiddenColumn)this.initVisibilityArr=this.colIndexInfo.body.visibilityArr.slice(0),this.hideInvisibleTds();else{this.rollbackCommitFlag=!1;var o=this.lastDisplayedRow;!0===this.hiddenRowObj.init&&(o=this.drawedRowLength+this.hiddenRowObj.extraRow-1);for(var s=0;s<=o-this.options.lastFixedRow;s++)this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(s+i)||(!0!==this.hiddenRowObj.init||this._getRowVisible(s+i))&&(this.options.fixedRow>0&&s<=this.options.fixedRow-1?this.lazyDrawRowData(s,s):this.lazyDrawRowData(s,s+i));this.rollbackCommitFlag=!0}t=this.options.initFixedHeightByRowNum>-1?this.adjustInitFixedByRowNum(t):""!==this.options.visibleRowNum?this.adjustVisibleRowNum(t):this.adjustDefault(t),this.maxRowLength=t,!this.isIE6or7||1==this.options.senseReader&&""==this.options.visibleRowNum||(this._setRowDisplay(t+1,""),this.dataRowList[(t+1)*this.oneRowLength]&&this.dataRowList[(t+1)*this.oneRowLength].offsetHeight,this._setRowDisplay(t+1,"none")),this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.adjustVisibleRowNum=function(t){try{if(""===this.options.visibleRowNum||"native"===this.options.drawType)return t;var e=this.rowIndex,i=this.getDataLength();this.setDataTable();var o={noDraw:!0,skipResize:null!=this.lastTopRowIndex};this.setScrollYHeight(o),!0===this.hiddenRowObj.init&&this.applyStyleOptions(t);var s,n=this.getElementById(this.id+"_scrollX_div"),l=parseInt(n.style.height,10),h=this.getElementById(this.id+"_body_table"),d=0;if(!0===this.hiddenRowObj.init)this.lastDisplayedRow=t,this.lastIndex=t,s=h.offsetHeight,a.D.isIE(9)&&(s=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d);else{var u="all"==this.options.visibleRowNum?i:u=parseInt(this.options.visibleRowNum,10);this.options.initFixedHeightByRowNum>-1&&this.hasSubtotal&&this.drawedSubtotal&&(u-=this.drawedSubtotal.drawedRowLength);for(var p=t+1;p+e<i&&p<u;p++)this.drawRowData(p,p+e),t++;for(p=this.lastDisplayedRow+1;p<=t;p++)this._setRowDisplay(p,"");this.applyStyleOptions(t);for(p=t+1;p<=this.lastDisplayedRow;p++)this._setRowDisplay(p,"none");this.lastDisplayedRow=t,this.lastIndex=t,s=h.offsetHeight,a.D.isIE(9)&&(s=h.getBoundingClientRect().height),this.hasFooter&&(d=0==(d=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:d)}!(this.options.initFixedHeightByRowNum>-1&&i>this.options.initFixedHeightByRowNum)&&s<this.defaultDataLayerHeight&&!0!==this.options.isItemTable&&(s=this.defaultDataLayerHeight)
;var c=this.getSize("height"),g=s+l+d,f="native"!==this.options.drawType;if(this.options.visibleRowNumFix){var m=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(!isNaN(m)){var y=this.getElementById(this.id+"_head_table").offsetHeight;g<this.oneRowHeight*m+y+l+d+1&&(f=!1)}}if(i>0&&c!=g&&(f&&this.setSize(null,g),null!=this.lastTopRowIndex)){var b=this._getScrollRowIndex(this.lastTopRowIndex);b!==this._getScrollMaxRowIndex()&&(o.skipResize=!1,o.restRowCnt=b,this.lastTopRowIndex=null)}if(this.options.autoFit&&this._setAutoFit(),this.resizeObj={width:this.render.offsetWidth,height:this.render.offsetHeight,clientWidth:this.render.clientWidth},this.dataLayerHeight=h.parentNode.offsetHeight,this.setScrollYHeight(o),null==this.lastTopRowIndex){var w=this._getVisibleRowIndex(this._getScrollMaxRowIndex()),v=this._getVisibleLastIndex(this.lastIndex+1);this.rowIndex===w&&this.rowIndex+v===i&&(this.lastTopRowIndex=this.rowIndex)}return t}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.adjustInitFixedByRowNum=function(t){try{return this.adjustVisibleRowNum(t)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.adjustDefault=function(t){try{return""!==this.options.visibleRowNum||(this.adjustDraw_keepTop?this.adjustDraw_keepTop=null:this.setScrollYHeight({skipResize:!0})),t}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.drawBottomData=function(t){if(!(this.rowIndex<0||0==this.rowIndex&&t<=this.lastIndex||this.rowIndex>=0&&this.rowIndex+this.lastIndex==t||isNaN(Number(t)))){var e=this.getDataLength();t>=e&&(t=e-1),this.subtotalHidden();for(var i=0;i<=this.lastDisplayedRow;i++)this._setRowDisplay(i,"none");var o=t+1-this.drawedRowLength;o<0&&(o=0);var s=(e<this.drawedRowLength?e:this.drawedRowLength)-1;for(i=0;i<=s;i++)this.drawRowData(i,i+o),this._setRowDisplay(i,"");var r=t-o,a=this.dataRowList[(t-o+1)*this.oneRowLength-1];if(this.hasSubtotal&&this.drawedSubtotal.length>0)for(i=0;i<this.drawedSubtotal.length;i++){var n=this.drawedSubtotal[i];if(n.rowIndex==t){a=n[n.length-1];break}}var l=a.offsetTop+a.offsetHeight,h=this.dataLayerHeight;if(l<=h){this.rowIndex=o,this.lastIndex=this.cutGridBottom(s);for(i=this.rowIndex;i<=this.rowIndex+this.lastIndex;i++)this.applyRowStyleOptions(i);this.setScrollYHeight({noDraw:!0})}else{this.subtotalHidden({startRowIndex:t+1});for(i=r+1;i<=s;i++)this._setRowDisplay(i,"none");var d=o-(this.hasSubtotal?.5:0),u=0,p=0;if(this.hasSubtotal)for(var c in this.subtotalTableList)p+=this.subtotalTableList[c].rows.length;for(;d<e;){if(this.hasSubtotal){for(i=0;i<this.drawedSubtotal.length;i++)if(this.drawedSubtotal[i].rowIndex==d-.5)for(var g=0;g<this.drawedSubtotal[i].length;g++)l-=this.drawedSubtotal[i][g].offsetHeight;if(d+=.5,l<=h){this.subtotalHidden({endRowIndex:d-1});break}u+=p}for(i=0;i<this.oneRowLength;i++)l-=this.dataRowList[this.oneRowLength*(d-o)+i].offsetHeight;if(u+=this.oneRowLength,d+=this.hasSubtotal?.5:1,l<=h){if(this.hasSubtotal){d+=.5;for(i=0;i<this.drawedSubtotal.length;i++)if(this.drawedSubtotal[i].rowIndex==d-1){d-=.5;break}}break}}var f=[],m=this.getElementById(this.id+"_body_tbody");for(i=0;i<u;i++){var y=m.removeChild(m.rows[0]);y.style.cssText="display:none",f.push(y)}for(i=p;i<f.length;i++)m.appendChild(f[i]);for(i=0;i<p;i++)m.appendChild(f[i]);for(var c in this.dataRowList=[],this.all_data_td_list=[],this.data_num_td_list=[],this.data_status_td_list=[],this.data_td_list=[],this.subtotalRowHash)this.subtotalRowHash[c]=[];var b=0;for(i=0;i<p;i++){c=(v=m.rows[b++]).getAttribute("targetcolumnid");this.subtotalRowHash[c].push(v)}for(i=0;i<this.drawedRowLength;i++){var w=[];for(g=0;g<this.oneRowLength;g++)w.push(m.rows[b++]);this.addBodyRow2(i,w);for(g=0;g<p;g++){var v;c=(v=m.rows[b++]).getAttribute("targetcolumnid");this.subtotalRowHash[c].push(v)}}this.hideDataLayer&&(this.hideDataLayer.style.display="none"),this.rowIndex=parseInt(d+.5,10),this.lastIndex=s=t-this.rowIndex,t>=e-1&&(this.lastTopRowIndex=d)
;for(i=0;i<=s;i++)this.setEvenOddBackground(i,this.rowIndex+i);for(i=t;i>=d;i--)this.applyRowStyleOptions(i);if(s+1<this.drawedRowLength){var I=this._getVisibleLastIndex(s+1);this._setRowDisplay(I,""),this.setEvenOddBackground(I,this.rowIndex+I),this.rowIndex--,this.applyRowStyleOptions(this.rowIndex+I),this.rowIndex++,this._setRowDisplay(s+1,"none")}this.setScrollYHeight({noDraw:!0}),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}}},y.prototype.cutGridBottom=function(t,e){try{if("native"===this.options.drawType)return;var i=this.rowIndex,o=this.dataLayerHeight,s=this.getElementById(this.id+"_head_table"),n=this.getElementById(this.id+"_body_tbody"),l=WebSquare.style.getStyle(s,"border-top-width");l="thin"==l?a.D.isIE(6)||a.D.isIE(7)?2:1:"medium"==l?a.D.isIE(6)||a.D.isIE(7)?4:3:"thick"==l?a.D.isIE(6)||a.D.isIE(7)||a.D.isOpera()?6:5:parseInt(l,10);var h=parseInt(l/2,10)-s.offsetTop;if(n.getBoundingClientRect){var d=n.getBoundingClientRect(),u=d.bottom-d.top;h+=u-parseInt(u,10)>0?1:0}for(var p=o-h,c=this.getElementById(this.id+"_body_tbody").childNodes,g=(t=-1,!0),f=this.getDataLength(),m=this.oneRowLength*f-1,y=i*this.oneRowLength,b=this.hiddenCellObj.length>0,w={row:[],cnt:0},v=0;v<c.length;v++){var I=c[v],C=!1,x=!1;if(0!==I.offsetHeight){w.row[v]="visible",w.cnt++,this.hasClass(I,"grid_body_row")?(g&&y+t<m?t++:(I.style.display="none",this.addClass(I,"w2grid_hidedRow")),C=!0):I.getAttribute("data-subtotal")&&(g||this._subtotalHidden([I]),x=!0);var _=I.offsetTop+I.offsetHeight-p;if(g&&_>0){if(g=!1,C){var S=t%this.oneRowLength;if(b){var D=this.oneRowHeight/this.oneRowLength;S=Math.floor(_/D)}for(var R=0;R<=S&&v>=R;R++){var L=c[v-R];L.style.display="none",this.addClass(L,"w2grid_hidedRow"),t--}}x&&this._subtotalHidden([I])}}else w.row[v]="hidden"}if(w.cnt-=t+1,b){var T=-1,k=-1;for(v=0;v<w.row.length&&k<t;v+=this.oneRowLength){var A=!1;for(R=0;R<this.oneRowLength;R++)"visible"===w.row[v+R]&&(!1===A&&(T++,A=!0),k++)}t=T}else if(t=Math.floor(t/this.oneRowLength),!this.senseReaderMode){if(!0!==this.hiddenRowObj.init)for(v=t+1;v<=this.drawedRowLength;v++)this._setRowDisplay(v,"none");this.lastDisplayedRow=t}var F=this.options.showLastRow&&!this.hasSubtotal,E=!(1==this.options.senseReader&&"all"!==this.options.visibleRowNum);if(F&&(!this.senseReaderMode||E)){f=this.getDataLength();var M=b?Math.floor(t/this.oneRowLength):t,O=this._getVisibleRowIndex(this._getScrollRowIndex(this.rowIndex)+M+1);if(f>0){for(;!this._getRowVisible(O)&&O<f;)O++;O<f&&this._getRowVisible(O)&&(this._setRowDisplay(O-this.rowIndex,""),this.lazyDrawRowData(O-this.rowIndex,O))}}this.lastIndex=t,!0===this.hiddenRowObj.init&&(this.lastDisplayedRow=t);var N=t;if(e&&!0===e.extraRowByCellHidden){var B=0;for(v=0;v<w.row.length&&w.cnt>0;v+=this.oneRowLength)for(A=!1,R=0;R<this.oneRowLength;R++)"visible"===w.row[v+R]&&(!1===A&&(B++,A=!0),w.cnt--);N=B}return N}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.getLastIndex=function(t){try{var e=this.dataLayerHeight;if(t<0)return this.lastDisplayedRow=-1,-1;for(;;){var i=this.dataRowList[(t+1)*this.oneRowLength-1];if(!(t>0&&i.offsetTop+i.offsetHeight>e))break;t--}return t}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.lazyDrawRowData=function(t,e){try{for(var i=0;i<this.colIndexInfo.body.invisibleTds.length;i++){var o=this.colIndexInfo.body.invisibleTds[i]-this.defaultColCnt,s=this._getColumnMoveIndex(o);s>=0&&this.drawCellData(t,e,s,!0)}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.fastDrawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),s=this.all_data_td_list[t*this.realRowDataLength],a=0;if("number"==typeof o){if((this.groupbyStatus.grouped||this.clearGrouping)&&this.defaultColCnt>0)for(var n=s,l=!0,h=0;h<this.defaultColCnt;h++){var d=this.colIndexes.bodyColInfo.colSpanArr[h]||1;n.setAttribute("colSpan",d),n.style.display="",n.innerText="",n.textContent="",n.className.match("w2grid_groupby")&&(n.className=s.className.split(" ").splice(0,1),
this.options.rowNumVisible&&l?(n.className+=" gridBodyDefault_rowNumber",l=!1):n.className+=" gridBodyDefault_rowStatus"),n=n.nextSibling}if(this.options.rowMerge){var u={rowMergeStartPoint:[],rowMergeSameDataLength:[]},p=this.getRowData(e),c=!1,g=0;for(h=0;h<p.length;h++)p[h]==p[h+1]?(c||u.rowMergeStartPoint.push(h),g++,c=!0):(c&&(g++,u.rowMergeSameDataLength.push(g)),c=!1,g=0)}this._drawRowNumData(t,e,i),this._drawRowStatus(t,e,i);var f=this.colIndexInfo.body.visibleTds,m=f.length;i&&!0===i.refreshColumn&&(m=this.oneRowDataLength);for(h=0;h<m;h++){var y;if(i&&!0===i.refreshColumn)y=h;else{var b=f[h]-this.defaultColCnt;y=this._getColumnMoveIndex(b)}if(y>=0)if(this.options.rowMerge){d=null;for(var w=0;w<u.rowMergeStartPoint.length;w++)y==u.rowMergeStartPoint[w]?d=u.rowMergeSameDataLength[w]:u.rowMergeStartPoint[w]<y&&y<u.rowMergeStartPoint[w]+u.rowMergeSameDataLength[w]&&(d=-1);this.drawCellData(t,e,y,null,d,i)}else this.drawCellData(t,e,y,null,null,i)}i&&!0===i.skipSubtotal||(a=this.drawSubtotalRow(t+1,e))}else"object"==typeof o&&this.drawGroupData(s,o,t);return a}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.clearGroupedRow=function(t,e){try{if(this.defaultColCnt>0)for(var i=this.all_data_td_list[t*this.realRowDataLength],o=i,s=!0,a=0;a<this.defaultColCnt;a++){var n=this.colIndexes.bodyColInfo.colSpanArr[a]||1;o.setAttribute("colSpan",n),o.style.display="",o.innerText="",o.textContent="",o.className.match("w2grid_groupby")&&(o.className=i.className.split(" ").splice(0,1),this.options.rowNumVisible&&s?(o.className+=" gridBodyDefault_rowNumber",s=!1):o.className+=" gridBodyDefault_rowStatus"),o=o.nextSibling}for(a=0;a<this.oneRowDataLength;a++){var l=a,h=this._getColumnMoveIndex(l);h>=0&&this.drawCellData(t,e,h)}this.drawSubtotalRow(t+1,e)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.drawRowData=function(t,e,i){try{var o=this.dataList.getRealRowIndex(this.rowIndex+t),s=0;if(null==o)return s;var a=this.all_data_td_list[t*this.realRowDataLength];if("number"==typeof o){this._drawRowNumData(t,e),this._drawRowStatus(t,e);for(var n=0;n<this.oneRowDataLength;n++){var l=n,h=this.getCellInfo(l);if(this.drawCellData(t,e,l),h&&h.options.colMerge&&!this.groupbyStatus.grouped)for(var d=this._dataList.getColumnIndex(this.getColumnID(l)),u=this._dataList.dataArr[e*this._dataList.oneRowDataLength+d],p=0;p<=this.maxRowLength-t;p++){var c=this.data_td_list[(t+p)*this.oneRowDataLength+l];if(c){var g=u==this.dataList.getCellData(t+p+1,l)?"1":"0";c.setAttribute("colMerged",g),this.drawCellData(t+p,e+p,l)}}}i&&!0===i.skipSubtotal||(s=this.drawSubtotalRow(t+1,e))}else this.drawGroupData(a,o,t);return s}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.hideNochangeDataLayer=function(t){if(null==this.hideDataLayer){this.hideDataLayer=document.createElement("div"),this.hideDataLayer.className="w2grid_fastScroll_layer";var e=document.createElement("div");e.innerHTML=this.options.scrollMsg,e.className="w2grid_fastScroll_msg",this.hideDataLayer.appendChild(e),this.getElementById(this.id+"_dataLayer").appendChild(this.hideDataLayer)}var i=this.all_data_td_list[(t-1)*this.realRowDataLength],o=i.offsetHeight;0!=o?(this.hideDataLayer.style.display="block",this.hideDataLayer.style.top=i.offsetTop+o+1+"px"):this.hideDataLayer.style.display="none"},y.prototype.setEvenOddBackground=function(t,e){if(this.options.oddEvenColorDisplay){var i=this.data_td_list[t*this.oneRowDataLength],o=null;if(i){o=i.parentNode;do{o.style.backgroundColor=e%2==1?this.options.evenRowBackgroundColor:this.options.oddRowBackgroundColor,o=a.D.next(o)}while(null!=o&&"0"!=o.getAttribute("trIndex"))}}},y.prototype._drawRowNumData=function(t,e,i){if(this.options.rowNumVisible){var o=this.data_num_td_list[t],s="";s=o&&null!=o.textContent?"textContent":o&&null!=o.innerText?"innerText":"innerHTML",this.rowNumArr?"number"==typeof this.rowNumArr[e]&&(o[s]=1+this.rowNumArr[e]):o&&(o[s]=1+e+this.startRowNumber)}},y.prototype._drawRowStatus=function(t,e,i){
if(this.options.rowStatusVisible){var o=this.data_status_td_list[t];if(o){var s=this._linkedDataList||this._dataList,r="";switch("linkedDataList"==s.initializeType?s.getRowStatusValue(e):this._dataList.options.depthColumn||this.groupbyStatus.grouped?s._getRowStatusValue(this.getRealRowIndex(e)):s.getRowStatusValue(e)){case 0:r="R";break;case 1:r="U";break;case 2:r="C";break;case 3:r="D";break;case 4:r="V"}if(void 0===o.imageName&&(o.imageName=""),o.imageName!=r||this.clearGrouping){switch(o.imageName){case"":case"R":break;case"C":this.removeClass(o,"w2grid_rowStatus_C");break;case"U":this.removeClass(o,"w2grid_rowStatus_U");break;case"D":this.removeClass(o,"w2grid_rowStatus_D");break;case"V":this.removeClass(o,"w2grid_rowStatus_V")}"R"!=r&&""!=r&&this.addClass(o,"w2grid_rowStatus_"+r),o.imageName=r}}}},y.prototype.drawCellData=function(t,e,i,o,s,a){try{o||null==this.editedCell||this.editedCell.options.colIndex+""!=i+""||this.editedCell.handleCancelEdit();var n=this.data_td_list[i+t*this.oneRowDataLength];if(n){var l=this.cellInfoHash[this.tdIdList[i]];if(this.groupbyStatus.grouped||this.clearGrouping){var h=this.colIndexes.bodyColInfo.colSpanArr[i+this.defaultColCnt]||1;n.setAttribute("colSpan",h),n.style.display="",n.style.textAlign=l.options.textAlign}if(this.options.rowMerge)if(null==s)n.setAttribute("colSpan",""),n.style.display="",n.style.textAlign="";else if(s>0){h=s;n.setAttribute("colSpan",h),n.style.display="",n.style.textAlign=l.options.textAlign}else-1==s&&(n.style.display="none");!l.options.embeddedInput&&this.groupbyStatus.grouped&&(n.innerText="",n.textContent=""),(this.groupbyStatus.grouped||this.clearGrouping)&&this.hasClass(n,"w2grid_groupby")&&(n.className="gridBodyDefault");var d=this.aria_labelledby[i];if(d){var u=t+e+1;n.setAttribute("aria-labelledby",d+" r"+u)}if(l.options.headers&&this.options.applyScopeHeaders){var p=this.scope_id?this.scope_id+"_":"";n.setAttribute("headers",p+l.options.headers)}this.isColMerge&&l.options.colMerge&&!this.groupbyStatus.grouped?this.setColMergeCellData(t,e,i,a):this.setInnerHTML(n,e,i,a)}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.setColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.setColMergeAndCellData(t,e,i,o);var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e);if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);var a=this.getColumnID(i),n=this.dataList._getCellData(e-1,a),l=this.data_td_list[i+(t-1)*this.oneRowDataLength],h=this.upperGroupingTest(e,i,t);if(n==this.dataList._getCellData(e,a)&&h){if(l.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px",s.innerHTML="","icon"==s.getAttribute("viewType")){var d=s.getAttribute("inputType");this.removeClass(s,this.options.bodyTdClass+"_"+d)}if(this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(l.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px"),null!=l)return this.applyCellStyleOptions(e,i,!1),"mergeCellBackgroundColor"}else{var u=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==u&&!this.groupbyStatus.grouped&&(u="1px"),s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=u}},y.prototype.setColMergeAndCellData=function(t,e,i,o){var s=this.data_td_list[i+t*this.oneRowDataLength],r=this.getHasSubtotalCount(e);if(0==t)return 0!=r&&(s.style.borderBottomWidth="1px"),void this.setInnerHTML(s,e,i,o);this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]};var a=this.getColumnID(i);if(null==this.colMergeObj.colArr[i]){var n=this.dataList._getCellData(e-1,a),l=this.dataList._getCellData(e,a);if(this.colMergeObj.colArr[i]=n==l,this.colMergeObj.colArr[i])for(var h=0;h<this.oneRowDataLength;h++){
if(null==this.colMergeObj.colArr[h])if(this.getCellInfo(h).options.colMerge){var d=this.getColumnID(h),u=this.dataList._getCellData(e-1,d),p=this.dataList._getCellData(e,d);this.colMergeObj.colArr[h]=u==p}else this.colMergeObj.colArr[h]=!0}}var c=!0;for(h=0;h<this.colMergeObj.colArr.length;h++)if(!this.colMergeObj.colArr[h]){c=!1;break}var g=this.data_td_list[i+(t-1)*this.oneRowDataLength];if(c)g.style.borderBottomWidth="0px",s.style.borderTopWidth="0px",s.style.borderBottomWidth="0px",s.innerHTML="",this.options.senseReader&&(0==r&&t!=this.lastDisplayedRow&&t!=this.lastIndex||(s.style.borderBottomWidth="1px"),t-1!=this.lastDisplayedRow&&t-1!=this.lastIndex||(g.style.borderBottomWidth="1px")),0!=r&&(s.style.borderBottomWidth="1px");else{var f=s.style.borderTopWidth;this.getCellInfo(i).options.colMergeEdit&&"0px"==f&&(f="1px"),s.style.borderTopWidth="0px",this.setInnerHTML(s,e,i,o),s.style.borderTopWidth=f}},y.prototype.drawColMergeCellData=function(t,e,i,o){if(this.isColMergeAnd)return this.drawColMergeAndCellData(t,e,i,o);var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(r.style.borderBottomWidth="0px",0!=t||o){var a=this.getHasSubtotalCount(e);0==a&&(r.style.borderBottomWidth="0px");var n=this.dataList._getCellData(e-1,s),l=this.data_td_list[i+(t-1)*this.oneRowDataLength];r.style.borderTopWidth="0px";var h=this.upperGroupingTest(e,i,t);if(n==this.dataList._getCellData(e,i)&&h){if(null!=l&&(l.style.borderBottomWidth="0px"),r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px",r.setAttribute("colMerged","1"),r.innerHTML="",0!=a&&(r.style.borderBottomWidth="1px"),"icon"===r.getAttribute("viewType")){var d=r.getAttribute("inputType");this.removeClass(r,this.options.bodyTdClass+"_"+d)}if(null!=l&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else r.style.borderTopWidth="1px"}},y.prototype.drawColMergeAndCellData=function(t,e,i,o){var s=this.getColumnID(i),r=this.data_td_list[i+t*this.oneRowDataLength];if(r.style.borderBottomWidth="0px",0!=t||o){var a=this.getHasSubtotalCount(e);if(0==a&&(r.style.borderBottomWidth="0px"),this.colMergeObj?this.colMergeObj.displayRowIndex!=e&&(this.colMergeObj={displayRowIndex:e,colArr:[]}):this.colMergeObj={displayRowIndex:e,colArr:[]},null==this.colMergeObj.colArr[i]){var n=this.dataList._getCellData(e-1,s),l=this.dataList._getCellData(e,s);if(this.colMergeObj.colArr[i]=n==l,this.colMergeObj.colArr[i])for(var h=0;h<this.oneRowDataLength;h++){if(null==this.colMergeObj.colArr[h])if(this.getCellInfo(h).options.colMerge){var d=this.getColumnID(h),u=this.dataList._getCellData(e-1,d),p=this.dataList._getCellData(e,d);this.colMergeObj.colArr[h]=u==p}else this.colMergeObj.colArr[h]=!0}}var c=!0;for(h=0;h<this.colMergeObj.colArr.length;h++)if(!this.colMergeObj.colArr[h]){c=!1;break}if(c){var g=this.data_td_list[i+(t-1)*this.oneRowDataLength];if(null!=g&&(g.style.borderBottomWidth="0px"),r.style.borderTopWidth="0px",r.style.borderBottomWidth="0px",r.setAttribute("colMerged","1"),r.innerHTML="",0!=a&&(r.style.borderBottomWidth="1px"),null!=g&&this.options.oddEvenColorDisplay&&!this.options.oddEvenColorMerged)return"mergeCellBackgroundColor"}else r.style.borderTopWidth="1px"}},y.prototype.upperGroupingTest=function(t,e,i){var o=this.getCellInfo(e),s=o.options.upperColumn;if(this.hasSubtotal&&this.hasUpperSubtotalRow(t))return!1;if(""!=s){if(i){var r=this.getColumnIndex(s),a=this.data_td_list[r+i*this.oneRowDataLength],n=this.getCellInfo(r);if(a&&""==a.style.width&&(""==n.options.upperColumn||n.options.upperColumn&&"1"!=a.getAttribute("colMerged"))&&"1"!=a.getAttribute("colMerged")&&1==n.options.colMerge&&!this.groupbyStatus.grouped)return!1}if(this.dataList._getCellData(t,s)!=this.dataList._getCellData(t-1,s))return!1;var l=this.getCellInfo(s);if(l.options.upperColumn&&""!=l.options.upperColumn&&l.options.upperColumn!=o.id)return this.upperGroupingTest(t,l.options.upperColumn,i)}else{
if(this.dataList._getCellData(t,e)!=this.dataList._getCellData(t-1,e))return!1}return!0},y.prototype.setDataTable=function(){try{var t=this.getElementById(this.id+"_head_table"),e=this.getElementById(this.id+"_body_table"),i=this.getElementById(this.id+"_body_tbody");if(this.dataLayerHeight=e.parentNode.offsetHeight,""===this.options.visibleRowNum&&0==this.dataLayerHeight)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({rowIndex:-1==this.rowIndex?0:this.rowIndex});this.defaultDataLayerHeight||(this.isIE6or7||a.D.isOpera()?this.defaultDataLayerHeight=this.getElementById(this.id+"_main_div").offsetHeight:this.defaultDataLayerHeight=this.dataLayerHeight);var o=0;if(this.options.senseReader&&"all"===this.options.visibleRowNum)o=this.getDataLength();else if(""===this.options.visibleRowNum)if(this.options.initFixedHeightByRowNum>-1)o=parseInt(this.options.initFixedHeightByRowNum,10)+1;else{var s=this.oneRowHeight;this.hiddenCellObj.length>0&&(s=this.oneRowHeight/this.oneRowLength),o=parseInt((this.dataLayerHeight-t.offsetHeight)/s)+1}else o="all"===this.options.visibleRowNum?this.getDataLength():parseInt(this.options.visibleRowNum,10);if(0==this.drawedRowLength&&(this.tdCellClassArr=new Array(o*this.oneRowLength)),o>this.drawedRowLength){var n=this.drawedRowLength;this.drawedRowLength=o;var l=[];0==n&&this.hasSubtotal&&(l=l.concat(this.createSubtotalRows(-1)));for(var h=n;h<this.drawedRowLength;h++){for(var d=[],u=0;u<this.oneRowLength;u++){var p=this.tempTr.rows[u].cloneNode(!0);d[u]=p,l.push(p),this.tdCellClassArr.push(null)}this.addBodyRow(h,d),this.hasSubtotal&&(l=l.concat(this.createSubtotalRows(h)))}0==this.drawedRowLength?e.style.borderWidth="0px":e.style.borderWidth="";for(u=0;u<l.length;u++)i.appendChild(l[u]);for(h=n+this.hiddenRowObj.extraRow;h<this.drawedRowLength+this.hiddenRowObj.extraRow;h++)this._setRowDisplay(h,"none")}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.applyStyleOptions=function(t){try{for(var e=this.rowIndex>=0?this.rowIndex:0,i=0;i<=t+1+this.hiddenRowObj.extraRow&&i<this.drawedRowLength+this.hiddenRowObj.extraRow;i++)"object"!=typeof this.dataList.getRealRowIndex(i+e)&&(this.options.fixedRow>0&&i<=this.options.fixedRow-1||this.options.lastFixedRow>0&&i>t-this.options.lastFixedRow?this.applyRowStyleOptions(i):(!this.hiddenRowObj.length>0||this._getRowVisible(i+e))&&this.applyRowStyleOptions(i+e))}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype._setCheckboxHead=function(t){try{if(t)this.checkHeader(this.bodyToHeaderRelation[t]);else for(var e in this.headerInfoHash)this.checkHeader(e)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.applyColumnStyleOptions=function(t){try{for(var e=0;e<this.drawedRowLength;e++)this.applyCellStyleOptions(e+this.rowIndex,t)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.applyRowStyleOptions=function(t){try{for(var e=this._getTrIndex(t),i=0,o=this.rowIndex;o<t&&this.hiddenRowObj.length>0;o++)this._getRowVisible(o)||i++;if(e<0||e-i>=this.drawedRowLength)return;var s=this.dataRowList[this.oneRowLength*e];if(!s)return;if("none"==s.style.display)return;if(this.options.fixedRow>0&&e==this.options.fixedRow-1){var a=this.dataRowList[this.oneRowLength*(e+1)-1];this.addClass(a,"w2grid_fixedRow")}if(this.options.lastFixedRow>0&&e==this.lastIndex-this.options.lastFixedRow+1){a=this.dataRowList[this.oneRowLength*(e-1)];this.addClass(a,"w2grid_lastFixedRow")}if(this.options.lazyDrawHiddenColumn){var n=this.colIndexInfo.body.visibleTds,l=e*this.oneRowDataLength;for(o=this.defaultColCnt;o<n.length;o++){var h=n[o]-this.defaultColCnt;this.all_data_td_list[l+h]&&this.applyCellStyleOptions(t,h)}}else for(o=0;o<this.oneRowDataLength;o++){l=e*this.oneRowDataLength;this.data_td_list[l+o]&&this.applyCellStyleOptions(t,o)}t===this.getRowCount()-1?this.__addClass(s,"w2grid_lastRow"):this.hasClass(s,"w2grid_lastRow")&&this.__removeClass(s,"w2grid_lastRow")}catch(t){
r.w.printStackTrace(t,null,this)}},y.prototype.setAutoResizeEmbeddedInput=function(){try{for(var t=this.data_td_list,e="",i=null,o=null,s=0,n=0,l=!1,h=0;h<t.length;h++)if("text"==t[h].getAttribute("inputType")||"secret"==t[h].getAttribute("inputType")){e=t[h].getAttribute("col_id"),o=this.cellInfoHash[e];var d=!1;if((this.dom[o.mainGridId+o.id]||this.dom[t[h].getAttribute("id")+"_"+t[h].getAttribute("inputType")])&&(d=!0),1==o.options.embeddedInput&&d){null==(i=this.getInput(o,t[h])).render.parentNode&&(t[h].innerHTML="",t[h].appendChild(i.render)),"none"==t[h].parentNode.style.display&&(t[h].parentNode.style.display="",l=!0);var u=parseInt(t[h].getAttribute("colindex"),10);this.embeddedStyleObj||(this.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t[h],"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t[h],"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t[h],"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t[h],"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(i.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(i.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(i.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(i.render,"padding-right"),10)});var p=parseInt(WebSquare.style.getStyle(i.render,"border-top-width"),10),c=parseInt(WebSquare.style.getStyle(i.render,"border-bottom-width"),10),g=parseInt(WebSquare.style.getStyle(i.render,"border-left-width"),10),f=parseInt(WebSquare.style.getStyle(i.render,"border-right-width"),10);s=t[h].offsetHeight-parseInt(WebSquare.style.getStyle(t[h],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[h],"border-bottom-width"),10),s-=this.embeddedStyleObj.top+this.embeddedStyleObj.bottom,s-=p+c,this.embeddedWidthObj[u]&&!this.embeddedWidthObj[u].isChanged||(this.embeddedWidthObj[u]={isChanged:!1,width:t[h].clientWidth}),n=this.embeddedWidthObj[u].width,n-=this.embeddedStyleObj.left+this.embeddedStyleObj.right,n-=g+f,n-=this.embeddedStyleObj.inputLeft+this.embeddedStyleObj.inputRight,a.D.isOpera()&&(s+=2),l?t[h].parentNode.style.display="none":a.D.isIE("6 7")&&(s-=2),i.setSize(n-2,s-(this.embeddedStyleObj.inputTop+this.embeddedStyleObj.inputBottom)),i.setStyle("lineHeight",s+"px")}}else if("calendar"==t[h].getAttribute("inputType")){e=t[h].getAttribute("col_id"),o=this.cellInfoHash[e];var m=null;1==o.options.embeddedInput&&(null==(m=this.getInput(o,t[h])).render.parentNode&&(t[h].innerHTML="",t[h].appendChild(m.render)),"none"==t[h].parentNode.style.display&&(t[h].parentNode.style.display="",l=!0)),s=t[h].offsetHeight-parseInt(WebSquare.style.getStyle(t[h],"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t[h],"border-bottom-width"),10),s-=this.embeddedCalendarStyleObj.top+this.embeddedCalendarStyleObj.bottom;u=parseInt(t[h].getAttribute("colindex"),10);this.embeddedWidthObj[u]&&!this.embeddedWidthObj[u].isChanged||(this.embeddedWidthObj[u]={isChanged:!1,width:t[h].clientWidth}),n=this.embeddedWidthObj[u].width,n-=this.embeddedCalendarStyleObj.left+this.embeddedCalendarStyleObj.right,l?t[h].parentNode.style.display="none":a.D.isIE("6 7")&&(s-=2),m.setSize(n-2,s)}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.applyCellStyleOptions=function(t,e,i,o){try{var s=this._getTrIndex(t),n=this._getTdElem(t,e);if(n){var l,h,d,u=[],p=!1;if("number"==typeof e?(l=e,h=this.cellIdList[e]):(l=this.bodyIdColIndexMap[e],h=e),this._linkedDataList)d=this._linkedDataList.filteredRowIndexArr[t];else if(this.groupbyStatus.grouped){var c=!0;for(var g in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[g]){d=this._dataList.filteredRowIndexArr[t],c=!1;break}c&&(d=this.groupbyStatus.groupedRowIndexArr[t])}else d=this._dataList.filteredRowIndexArr[t];var f=this.cellInfoHash[h]||{options:{}};if("custom"==f.options.inputType&&(f=f.cellManagerHashByRowIndex[d]?f.cellManagerHashByRowIndex[d]:f),
"crosstab"==this.options.adaptive&&this.hasClass("w2grid_adaptive_crosstab")&&"true"==f.options.hidden)return;null!=this.initStyleValueObj[l]&&u.push(this.initStyleValueObj[l].style),""!=f.options.textAlign&&u.push("text-align:"+f.options.textAlign),this.options.adjustAlign&&"left"==f.options.textAlign&&u.push("padding-left:"+this.options.adjustAlign+"px"),null!=this.defaultStyleValueObj[l]&&u.push(this.defaultStyleValueObj[l].style);var m=null,y=null,b=null,w=null,v=null,I=!1;(t<this.options.fixedRow||l<this.options.fixedColumn||l>=this.tdIdList.length-this.options.fixedRightColumn)&&(I=!0),null!=d?(m="number"==typeof d?this.rowStyleArr[d]:this.rowStyleArr[d.type+"_"+d.groupId],y="number"==typeof d?this.rowStyleFixedArr[d]:this.rowStyleFixedArr[d.type+"_"+d.groupId],b="number"==typeof d?this.rowStyleDataArr[d]:this.rowStyleDataArr[d.type+"_"+d.groupId],w="number"==typeof d?this.cellStyleArr[d*this.oneRowDataLength+l]:this.cellStyleArr[d.type+"_"+d.groupId+"_"+l],v=this.cellClassArr[d*this.oneRowDataLength+l]):v=this.cellClassArr[t*this.oneRowDataLength+l],null!=m&&u.push(this.rowStyleValueObj[m].style),null!=y&&I&&u.push(this.rowStyleFixedValueObj[y].style),null==b||I||u.push(this.rowStyleDataValueObj[b].style);var C=this.columnStyleValueObj[l],x=this.columnStyleFixedValueObj[l],_=this.columnStyleDataValueObj[l];if(null!=C&&u.push(this.columnStyleValueObj[l].style),null!=x&&I&&u.push(this.columnStyleFixedValueObj[l].style),null==_||I||u.push(this.columnStyleDataValueObj[l].style),null!=this.adaptiveColumnStyleValueObj[l]&&!0===this.checkRefreshAdaptive()&&u.push(this.adaptiveColumnStyleValueObj[l].style),null!=w&&u.push(this.cellStyleValueObj[w].style),m=="rowResizeStyle_"+t&&u.push(this.rowStyleValueObj[m].style),""!=this.options.readOnlyBackgroundColor&&"number"==typeof d)1==this.___getEditReadOnly(t,e)?(u.push(this.readOnlyTdStyle),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0));if(""!=this.options.readOnlyBackgroundImg||""!=this.options.readOnlyBackgroundImgCSS)1==this.___getEditReadOnly(t,e)?(u.push(this.readOnlyTdImg),this.options.readOnlyBackgroundImgCSS||(a.D.isIE(8)||a.D.isIE(6)||a.D.isIE(7))&&(u.push("filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\""),u.push("-ms-filter: \"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled='true', src='"+this.options.readOnlyBackgroundImg+"', sizingMethod='scale')\"")),n.readOnly=!0,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):(n.readOnly=!1,"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0));n.disabled=!1,n.removeAttribute("disabled");var S=this.cellDisabledArr[d*this.oneRowDataLength+l],D=S;if(!0!==S&&!1!==S){var R=f.options.disabled,L=this.rowDisabledArr[d],T=this.options.disabledPriority;!0!==L&&!1!==L&&(L=""),S="column"===T&&""!==R?R:"row"===T&&""!==L?L:R+""=="true"||L+""=="true"||R+""!="false"&&L+""!="false"&&(""!==this.options.disabled&&this.options.disabled)}!0!==S&&"true"!==S||(u.push(this.disabledTdStyle),this.disabledCellStyleObj&&this.disabledCellStyleObj[t+"_"+e]&&this.disabledCellStyleObj[t+"_"+e].style&&u.push(this.disabledCellStyleObj[t+"_"+e].style));var k=this.options.focusMode;if(o&&(k="cell"),!i&&"transparent"!=this.options.selectedRowColor&&("row"==k||"both"==k))for(var A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&!("row"==this.options.focusMode&&1==this.options.fixedColumnNoBGColor&&e<this.options.fixedColumn)){u.push("background-color:"+this.options.selectedRowColor),p=!0;break}
if(!i&&"transparent"!=this.options.selectedCellColor&&("cell"==k||"both"==k))for(A=0;A<this.focusedCell.length;A++)if(t==this.focusedCell[A].focusedRowIndex&&e==this.focusedCell[A].focusedColIndex){u.push("background-color:"+this.options.selectedCellColor),p=!0;break}("none"!=n.style.display||this.hiddenCellObj.length>0)&&!0!==this.hiddenCellObj[t+"_"+e]||u.push("display:none");var F=!1;this.hiddenCellObj.length>0&&(!0===this.hiddenCellObj[t+"_"+e]&&"none"!==n.style.display||!0!==this.hiddenCellObj[t+"_"+e]&&"none"===n.style.display)&&(F=!0);var E=u.join(";"),M=n.style.borderBottomWidth;(E!=n.getAttribute("style_bak")||this.groupbyStatus.grouped||F)&&(n.style.cssText=E);var O=this.cellStyleValueObj[w];if(O&&O["background-repeat"]?n.style.backgroundRepeat=O["background-repeat"]:O&&O["background-size"]?n.style.backgroundSize=O["background-size"]:O&&O["background-position"]&&(n.style.backgroundPosition=O["background-position"]),this.isColMerge&&f.options.colMerge&&!this.groupbyStatus.grouped){n.setAttribute("colMerged","0");var N=this.drawColMergeCellData(s,t,e);if(this.options.senseReader&&M&&-1!=M.indexOf("px")&&(n.style.borderBottomWidth=M),"mergeCellBackgroundColor"===N&&!p){var B,G=this.getCellStyleValue(t-1,h,"background-color",!0)||this.getColumnStyleValue(e,"background-color"),H=!0;n.readOnly||this.__getEditReadOnly(n,t)?(B=G,this.options.readOnlyBackgroundColor?B=this.options.readOnlyBackgroundColor:(f.options.readOnlyClass||this.options.readOnlyClass)&&(H=!1)):(B=""!=G?G:t%2?this.options.oddRowBackgroundColor:this.options.evenRowBackgroundColor,!this.options.disabledClass||!0!==S&&"true"!==S||(H=!1)),H&&(n.style.backgroundColor=B,this._setMergeCellBackground(t,h,B)),""!=f.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,f.options.readOnlyClass):this.removeClass(n,f.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.__getEditReadOnly(n,t)?this.addClass(n,this.options.readOnlyClass):this.removeClass(n,this.options.readOnlyClass))}}if(n.setAttribute("style_bak",E),n.setAttribute("or_bgColor",n.style.backgroundColor),this.cellReadOnlyArr[d*this.oneRowDataLength+e]?(n.setAttribute("readonly","true"),"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",-1)):!1===this.cellReadOnlyArr[d*this.oneRowDataLength+e]?(n.setAttribute("readonly","false"),"linear"!==this.options.focusFlow||!0!==this.options.readOnlyTabIgnore||f.options.embeddedInput||n.setAttribute("tabIndex",0)):n.removeAttribute("readonly"),null!=v){var W=s*this.oneRowDataLength+e;this.tdCellClassArr[W]&&this.tdCellClassArr[W]!=v&&this.removeClass(n,this.tdCellClassArr[W]),this.tdCellClassArr[W]=v,this.addClass(n,v)}else{W=s*this.oneRowDataLength+e;this.tdCellClassArr[W]&&(this.removeClass(n,this.tdCellClassArr[W]),this.tdCellClassArr[W]=void 0)}if(""!=f.options.disabledClass&&(!0===S||"true"===S?this.addClass(n,f.options.disabledClass):this.removeClass(n,f.options.disabledClass)),!0!==D&&"true"!==D||(""!=this.options.disabledClass?this.addClass(n,this.options.disabledClass):this.removeClass(n,this.options.disabledClass)),""!=this.options.hiddenClass||""!=f.options.hiddenClass){var V=this.options.hiddenClass;""!=f.options.hiddenClass&&(V=f.options.hiddenClass);var q=this._getRealColIndex("body",f.options.col_id)+this.defaultColCnt;this.hiddenList[q]?this.addClass(n,V):this.removeClass(n,V)}}}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.dynamicMergeHTML=function(){try{for(var t in this.tdMergeInfo){var e=this.data_td_list[t];this.tdMergeInfo[t].orgColSpan>1?e.setAttribute("colSpan",this.tdMergeInfo[t].orgColSpan):e.removeAttribute("colSpan"),this.tdMergeInfo[t].orgRowSpan>1?e.setAttribute("rowSpan",this.tdMergeInfo[t].orgRowSpan):e.removeAttribute("rowSpan"),e.style.display=this.tdMergeInfo[t].display,delete this.tdMergeInfo[t]}
var i=this.getRowCount(),o="native"===this.options.drawType?i:Math.min(this.lastIndex+2,i),s=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=!1;for(var l in this.cellMergeInfo){var h=l.split("_"),d=Number(h[0]);if(!(s&&(d=this.getDisplayRowIndex(d),isNaN(d)||d<0))){var u=Number(h[1]),p=d;this.rowIndex>=0&&(this.options.fixedRow>0&&this.options.fixedRow>d||this.options.lastFixedRow>0&&d>this.lastIndex-this.options.lastFixedRow||(p-=this.rowIndex));var c=this.cellMergeInfo[l].rowSpan,g=this.cellMergeInfo[l].colSpan,f=c,m=0;if(this.hiddenRowObj.length>0)for(var y=this.rowIndex;y<d;y++)this._getRowVisible(y)||m++;if(!(p<0&&p+c<=0||p-m>=o||(p<this.options.fixedRow&&p+c>this.options.fixedRow&&(f=p+c-this.options.fixedRow-m,p=this.options.fixedRow),p<this.options.fixedRow&&d>=this.options.fixedRow))){var b=0,w=0;if(this.hiddenRowObj.length>0)for(y=0;y<f;y++)this._getRowVisible(p+y+this.rowIndex)||(w++,y===b&&b++);p+(f-=w)>o+m&&(f=o-p+m);var v=f,I=this.oneRowLength;for(y=0;y<v;y++){for(var C=!1,x=0;x<g;x++){t=(p+y)*this.oneRowDataLength+(u+x);if(null!=(e=this.data_td_list[t]))if(this.hiddenRowObj.length>0&&!this._getRowVisible(p+y+this.rowIndex))e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),C=!0;else if(this.tdMergeInfo[t]={orgColSpan:e.getAttribute("colSpan"),orgRowSpan:e.getAttribute("rowSpan"),display:e.style.display},y===b&&0===x){g>1?(e.setAttribute("colSpan",g),n=!0):e.removeAttribute("colSpan");var _=f*I;if(_>1)if(I>1){var S=parseInt(e.getAttribute("rowSpan"),10);!isNaN(S)&&S>1&&(e.setAttribute("rowSpan",_),n=!0)}else e.setAttribute("rowSpan",f),n=!0;else e.removeAttribute("rowSpan");e.style.display=""}else e.removeAttribute("colSpan"),e.removeAttribute("rowSpan"),e.style.display="none"}!0===C&&v++}}}}!0===n&&this.isWebKit&&a.D.setTimeout(this.redrawTable,{key:this.id+"_dynamicMergeHTML",delay:50,caller:this})}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.createSubtotalRows=function(t){var e=[];for(var i in this.subtotalTableList){var o=this.subtotalRowHash[i];null==o&&(o=[]);for(var s=this.subtotalTableList[i],r=0;r<s.rows.length;r++){var a=s.rows[r].cloneNode(!0);if(a.style.display="none",this.options.rowNumStatusUniqueId)for(var n=a.getElementsByTagName("td"),l=0;l<this.defaultColCnt;l++){var h=n[l].getAttribute("id");"_headerRowNumber"!==h&&"_headerRowStatus"!==h||n[l].setAttribute("id",h+"_subtotal_"+t)}a.setAttribute("data-subtotal",i+"_"+r),o.push(a),e.push(a)}this.subtotalRowHash[i]=o}return e},y.prototype.addBodyRow=function(t,e){var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=0,a=0,n="grid_body_row";"native"===this.options.drawType&&(n+=" "+this.options.gridNativeClass);for(var l=0;l<e.length;l++){this.dataRowList.push(e[l]),e[l].className=n;for(var h=e[l].getElementsByTagName("td"),d=0;d<h.length;d++){var u=h[d],p=u.className;u.setAttribute("tdIndex",t*this.realRowDataLength+r),u.removeAttribute("title");var c=u.getAttribute("width");if(c&&(u.removeAttribute("width"),u.setAttribute("or_wd",c)),this.options.rowNumStatusUniqueId){var g=u.getAttribute("id");"_headerRowNumber"!==g&&"_headerRowStatus"!==g||u.setAttribute("id",g+"_bodyRow_"+t)}if(r++,this.all_data_td_list.push(u),i.test(p))this.data_num_td_list.push(u);else if(o.test(p))this.data_status_td_list.push(u);else if(!this.hasSubtotal||s.test(p)){this.data_td_list.push(u);var f=this.id+"_columnstyle_"+a+"_";this.addClass(u,f);var m=u.getAttribute("col_id"),y=this.getCellInfo(m);this.addClass(u,y.options.className),u.style.cssText=""==y.options.textAlign?"":"text-align:"+y.options.textAlign+";",u.setAttribute("id",this.id+"_cell_"+t+"_"+a),a++,
"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(y.options.embeddedInput||"custom"==y.options.inputType&&1==this.options.senseReader||("link"!=y.options.inputType&&"button"!=y.options.inputType&&"image"!=y.options.inputType&&"user"!=y.options.inputType&&"ul"!=y.options.tableRender&&("expression"==y.options.inputType&&1==this.options.senseReader||u.setAttribute("tabIndex","0")),this.event.addListener(u,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}"native"===this.options.drawType&&(u.className=p?p+" "+this.options.gridNativeClass:this.options.gridNativeClass)}}var b=[];if(!this.options.duplicateColumnId){for(l=0;l<e.length;l++){h=e[l].getElementsByTagName("td");var w=[];for(d=0;d<h.length;d++)w[d]=h[d];for(d=0;d<w.length;d++){p=w[d].className;i.test(p)||o.test(p)||b.push(w[d].parentNode.removeChild(w[d]))}}for(l=0;l<this.htmlInfo.body.rowArr.length;l++)for(d=0;d<this.htmlInfo.body.rowArr[l].length;d++)for(var v=this.htmlInfo.body.rowArr[l][d].col_id,I=0;I<b.length;I++)if(b[I].getAttribute("col_id")==v){e[l].appendChild(b[I]);break}}},y.prototype.addBodyRow2=function(t,e){for(var i=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowNumber(\\s|$)"),o=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_rowStatus(\\s|$)"),s=new RegExp("(^|\\s)"+this.options.bodyTdClass+"_data(\\s|$)"),r=[],a=0;a<e.length;a++){this.dataRowList.push(e[a]),e[a].className="grid_body_row";for(var n=e[a].getElementsByTagName("td"),l=0;l<n.length;l++){var h=n[l],d=h.className,u=parseInt(h.getAttribute("tdIndex"),10)%this.realRowDataLength;h.setAttribute("tdIndex",t*this.realRowDataLength+u),h.removeAttribute("title");var p=h.getAttribute("width");if(p&&(h.removeAttribute("width"),h.setAttribute("or_wd",p)),this.options.rowNumStatusUniqueId){var c=h.getAttribute("id");"_headerRowNumber"!==c&&"_headerRowStatus"!==c||h.setAttribute("id",c+"_bodyRow_"+t)}if(i.test(d))this.data_num_td_list.push(h),this.all_data_td_list.push(h);else if(o.test(d))this.data_status_td_list.push(h),this.all_data_td_list.push(h);else if(!this.hasSubtotal||s.test(d)){var g=u-this.defaultColCnt;r[g]=h;var f=this.id+"_columnstyle_"+g+"_";this.addClass(h,f);var m=h.getAttribute("col_id"),y=this.getCellInfo(m);this.addClass(h,y.options.className),h.style.cssText=""==y.options.textAlign?"":"text-align:"+y.options.textAlign+";",h.setAttribute("id",this.id+"_cell_"+t+"_"+g),"linear"==this.options.focusFlow&&"none"!=this.options.focusMode&&(y.options.embeddedInput||("link"!=y.options.inputType&&"button"!=y.options.inputType&&"image"!=y.options.inputType&&h.setAttribute("tabIndex","0"),this.event.addListener(h,"onfocus",this.event.bindAsEventListener(this,this.handleTdFocus))))}}}[].push.apply(this.all_data_td_list,r),[].push.apply(this.data_td_list,r)},y.prototype.addRows=function(t){for(var e=this.drawedRowLength,i=[],o=0;o<t;o++){for(var s=0;s<this.oneRowLength;s++){var r=this.tempTr.rows[s].cloneNode(!0);i.push(r)}this.addBodyRow(e+o,[]),this.hasSubtotal&&(i=i.concat(this.createSubtotalRows(e+o)))}var a=this.getElementById(this.id+"_body_tbody");for(o=0;o<i.length;o++)a.appendChild(i[o])},y.prototype.notifyStatusChanged=function(t){var e,i,o=!1;"object"==typeof t.rowIndex?(e=0,i=t.rowIndex.length,o=!0):"all"==t.rowIndex?(e=0,i=this.getRowCount()):"number"==typeof t.startIndex&&"number"==typeof t.endIndex&&(e=t.startIndex,i=t.endIndex);for(var s=e;s<i;s++){var r;if(r=o?t.rowIndex[s]:s,null!=this.rowStatusColIDArr)for(var a=0;a<this.rowStatusColIDArr.length;a++){var n=this.getColumnIndex(this.rowStatusColIDArr[a]);this.drawCellData(r-this.rowIndex,r,n)}}this.hasFooter&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&this.drawFooter(),this.hasSubtotal&&(this.options.excludeDeletedRows||this.options.excludeModifiedRows)&&(this.subtotalHidden({startRowIndex:0}),this.refreshSubtotalRow(this.rowIndex))},y.prototype.refreshColumn=function(t){try{t=this.getColumnIndex(t),this.redrawColumn(t)}catch(t){r.w.printStackTrace(t,null,this)}},
y.prototype.refreshRow=function(t){try{var e=t-this.rowIndex;this.drawRowData(e,t)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype.refreshCell=function(t,e){try{e=this.getColumnIndex(e);var i=t-this.rowIndex;this.drawCellData(i,t,e)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype._setVisibleRowNumFix=function(){try{if(!this.options.visibleRowNumFix)return;var t=this.options.initFixedHeightByRowNum>-1?this.options.initFixedHeightByRowNum:this.options.visibleRowNum;if(isNaN(t))return;var e=this.getElementById(this.id+"_scrollX_div"),i=parseInt(e.style.height,10),o=0;this.hasFooter&&(o=0==(o=this.getElementById(this.id+"_foot_table").offsetHeight)?this.footerHeight:o);var s=this.getElementById(this.id+"_head_table").offsetHeight;!0===this._visibleRowNumFixResetFlag&&this.setTrRowTable();var a=this.oneRowHeight*t+s+i+o+1;this.setSize(null,a)}catch(t){r.w.printStackTrace(t,null,this)}},y.prototype._getDrawedRowCount=function(){try{for(var t=0,e=this.getElementById(this.id+"_body_tbody").childNodes,i=0;i<e.length;i++){e[i].offsetHeight>0&&t++}}catch(e){r.w.printStackTrace(e,null,this),t=this.drawedRowLength}return t};var b=function(){};b.prototype.setCellInfo=function(){for(var t=this.tempDiv.getElementsByTagName("td"),e=0;e<t.length;e++){"drilldown"==t[e].getAttribute("inputType")&&(this.isDrillDown=!0,this.depthColumn=t[e].getAttribute("depthColumn"),this.showDepth=t[e].getAttribute("showDepth"),this._dataList.options.depthColumn||"grid"==this.options.pluginName&&!this.options.drilldownRealRowIndex||(this._dataList.options.depthColumn=this.depthColumn))}},b.prototype.setDataListCellInfo=function(){if(this.successBinding)for(var t=this.getColCnt(),e=0;e<t;e++){var i=this.getColumnID(e),o=this.getCellInfo(i);if(o&&o.options&&o.options.importExp){var s=this._dataList.getCellInfo(i);s&&s.options&&!s.options.importExp&&(s.options.importExp=o.options.importExp)}}},b.prototype.setInnerHTML=function(t,e,i,o){var s=this.getColumnID(i),r=this.dataList._getCellData(e,s),a=this.cellInfoHash[this.tdIdList[i]];""===r&&(r=a.options.groupName?this.dataList._getCellData(e,a.options.groupName)==a.options.groupValue?a.options.trueValue:a.options.falseValue:a.options.defaultValue);if(a.setInnerHTML(t,r,e,i,o),""!=a.options.disabledClass&&(this._getEditDisabled(e,i)?this.addClass(t,a.options.disabledClass):this.removeClass(t,a.options.disabledClass)),""!=this.options.disabledClass&&!1===this.options.disabled&&(this._getEditDisabled(e,i)?this.addClass(t,this.options.disabledClass):this.removeClass(t,this.options.disabledClass)),""!=a.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,a.options.readOnlyClass):this.removeClass(t,a.options.readOnlyClass)),""!=this.options.readOnlyClass&&(this.___getEditReadOnly(e,s)?this.addClass(t,this.options.readOnlyClass):this.removeClass(t,this.options.readOnlyClass)),""!=this.options.hiddenClass||""!=a.options.hiddenClass){var n=this.options.hiddenClass;""!=a.options.hiddenClass&&(n=a.options.hiddenClass);var l=this._getRealColIndex("body",s)+this.defaultColCnt;this.hiddenList[l]?this.addClass(t,n):this.removeClass(t,n)}},b.prototype.getCellInfo=function(t){try{var e="";return e="string"==typeof t?t:"number"==typeof t?this.tdIdList[t]:t?t.getAttribute("col_id"):null,this.cellInfoHash[e]||{options:{}}}catch(t){r.w.printStackTrace(t,null,this)}},b.prototype._endEdit=function(){null!=this.editedCell&&this.editedCell.handleEndEdit()},b.prototype.initColumns=function(){for(var t in this.cellInfoHash){var e=this.cellInfoHash[t];if("select"==e.options.inputType&&(e.initializeCellInfo(e.element),e.style="",e.comp=null),this.options.initColumns)for(var i in e.dynamicAttrInfo){var o=e.dynamicAttrInfo[i];o&&(e.options[i]=o.originalValue,"displayFormat"!=i&&"displayFormatter"!=i||e.initFormatter())}}},b.prototype.initHeaders=function(){for(var t in this.headerInfoHash){"checkbox"==this.headerInfoHash[t].options.inputType&&this.setHeaderValue(t,!1)}},b.prototype._setCellInfo=function(t,e){
this.cellInfoHash2[t]=e},b.prototype.getColumnCount=function(){return this.tdIdList.length},b.prototype.getColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[t];return e||null},b.prototype.getMovedColumnID=function(t){if("string"==typeof t)return t;var e=this.tdIdList[this.columnOrder[t]];return e||null},b.prototype.getColumnIndex=function(t){return"number"==typeof t?t:this.bodyIdColIndexMap[t]},b.prototype.getDisplayColumnIndex=function(t){return"number"==typeof t?t:this.colMoveIndexMap[t]},b.prototype.setExpressionAssociation=function(t,e){try{null==this.expressionAssArr[t]&&(this.expressionAssArr[t]=[]),this.expressionAssArr[t].push(e)}catch(t){r.w.printStackTrace(t,null,this)}},b.prototype.setLabelColumnAssociation=function(t,e){try{null==this.labelColumnAssArr[t]&&(this.labelColumnAssArr[t]=[]),this.labelColumnAssArr[t].push(e)}catch(t){r.w.printStackTrace(t,null,this)}},b.prototype.setCellEditMode=function(t,e){this.hideTooltip();var i=this.getCellInfo(t);this.editedCell=i,this.rollbackCommitFlag=!1;var o=this.render.offsetWidth,s=this.render.offsetHeight;i.setEditMode(t,e),o===this.render.offsetWidth&&s===this.render.offsetHeight||(this.handleResize(),i.setEditMode(t,e)),this.rollbackCommitFlag=!0},b.prototype.setCellClickEdit=function(t){var e=this.getElemRowIndex(t),i=this.getCellInfo(t);if("custom"==i.options.inputType&&!i.internal){var o=e;this.isDrillDown&&this._dataList.options.depthColumn&&(o=this.getRealRowIndex(e)),i=i.cellManagerHashByRowIndex[o]?i.cellManagerHashByRowIndex[o]:i}var s=!1;switch(i.options.inputType){case"checkbox":case"radio":case"drilldown":s=i.handleClick(t,e)}return s},b.prototype.getInput=function(t,e,i){var n=t.options.inputType||"text",l=t.options.embeddedInput,h=this.getColumnOption(t.id,"dataType");"text"===n&&"number"===h&&"true"===this.options.floatNumber&&(h="float",t.options.dataType="float");var p,c="bigDecimal"==h,g=this;if(this.options.titleFormatter)try{if("function"!=typeof this.options.titleFormatter){var f=a.D.getGlobalFunction(this.options.titleFormatter,this.scope_id);"function"==typeof f&&(this.options.titleFormatter=f,p=f.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i))}else p=this.options.titleFormatter.call(this,this.getElemRowIndex(e),this.getColumnIndex(t.id),i)}catch(t){r.w.printStackTrace(t,null,this)}if(l){if("custom"==t.options.inputType&&!t.internal){var m=this.getElemRowIndex(e);this.isDrillDown&&this._dataList.options.depthColumn&&(m=this.getRealRowIndex(m)),t=t.cellManagerHashByRowIndex[m]?t.cellManagerHashByRowIndex[m]:t}y=t.parentColumnInfo?this.id+"_"+t.id:e.getAttribute("id")+"_"+n,this.fakeInput||"text"!=n&&"secret"!=n&&"calendar"!=n||(this.makeFakeInput=function(){this.fakeInput=new WebSquare.uiplugin.input(this.id+"_fakeInput",{style:"visibility:hidden;position:absolute;z-index:100;background-color:"+this.options.selectedCellColor,className:"w2grid_embedded_input",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",useKeyupBlur:!1,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){g.lastEvent=t,d.B.stopEvent(t);var e=this;setTimeout((function(){e.lastInput.focus()}),1)}}},{name:"oncontextmenu",action:"script",param:{handler:function(t){g.lastEvent=t}}},{name:"ondblclick",action:"script",param:{handler:function(t){g.lastEvent=t,g.hideFakeInput(this),d.B.stopPropagation(t),g.F2Mode=!0,WebSquare.text.setCaretPos(this.lastInput.render,this.lastInput.render.value.length)}}}]}),this.fakeInput.setAction=function(){},this.fakeInput.writeTo(this.render),this.fakeInput.activate(),this.fakeInput.render.parentNode.removeChild(this.fakeInput.render);var t=null;this.showFakeInput=function(e){var i=e.render.parentNode;if(this.render.appendChild(this.fakeInput.render),!t){var o=this.all_data_td_list[0];t=1-o.offsetLeft}var s=this.getElementById(this.id+"_dataLayer")
;this.fakeInput.setPosition(i.offsetLeft+t-s.scrollLeft,i.offsetTop+t-s.scrollTop),this.fakeInput.setSize(i.clientWidth,i.clientHeight),a.D.isIE()&&this.fakeInput.setVerticalAlign(),this.fakeInput.lastInput=e;var r=e.getStyle("text-align");r?this.fakeInput.setStyle("text-align",r):this.fakeInput.setStyle("text-align","")},this.hideFakeInput=function(t){this.fakeInput.render.parentNode&&this.fakeInput.render.parentNode.removeChild(this.fakeInput.render)}})}else var y=t.mainGridId+t.id;var b=!!(M=this.dom[y]);if(M&&!M.render&&M.ownerDocument&&!M.parentNode&&(b=!1),b){if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){_=this.getElemRowIndex(e),S=this._getGroupbyDisplayRowIndex(_),D=(x=t.mainGridId+"_checkbox_"+t.id)+"_"+_,R=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(L=t.options.checkboxLabelColumn.split(","),T="",k=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",A=0;A<L.length;A++)A===L.length-1?T+=this._getCellDisplayData(_,L[A]):T+=this._getCellDisplayData(_,L[A])+k;R=R?T+k+R:T}if(t.options.checkboxLabelFormatter)try{"function"==typeof(F=a.D.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(R=F.call(this,S,this.getColumnIndex(t.colID),R))}catch(e){u.k.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}(w=e.getElementsByTagName("label")[0])&&(w.innerText=R)}}else if("radio"==n&&l&&(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter)){var w;_=this.getElemRowIndex(e),S=this._getGroupbyDisplayRowIndex(_),B=(N=t.mainGridId+"_radio_"+t.id)+"_"+_,G=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(L=t.options.radioLabelColumn.split(","),T="",k=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",A=0;A<L.length;A++)A===L.length-1?T+=this._getCellDisplayData(_,L[A]):T+=this._getCellDisplayData(_,L[A])+k;G=G?T+k+G:T}if(t.options.radioLabelFormatter)try{"function"==typeof(H=a.D.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(G=H.call(this,S,this.getColumnIndex(t.colID),G))}catch(e){u.k.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}(w=e.getElementsByTagName("label")[0])&&(w.innerText=G)}this.options.titleFormatter&&l&&p&&M.title!==p&&(M.title=p)}else{if("text"!=n&&"secret"!=n||!l){if("select"==n&&l){var v=p||t.options.title||"";if(this.options.titleAuto&&!v){K=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";v=""!==i&&null!=i?K+" "+(this.changeItemValue("label",t.id,[i])[0]||i):K+WebSquare.language.getMessage("Grid_select")}M=new WebSquare.uiplugin.selectbox_native(y,{className:"w2grid_embedded_select",style:"$blank",pluginName:"selectbox",renderType:"native",title:v,chooseOption:t.options.chooseOption,chooseOptionLabel:t.options.chooseOptionLabel,_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}},{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute("rowIndex"),10),i=this.render.parentNode.getAttribute("col_id"),o=g.getColumnIndex(i);d.B.fireEvent(g,"oncellclick",e,o,i)}}},{name:"onkeydown",action:"script",param:{handler:function(t){switch(t.keyCode){case 38:case 40:case 27:return void d.B.stopPropagation(t)}}}}]},t.xml),e.innerHTML=M.toHTML();var I=WebSquare.uiplugin.selectbox_native.prototype.handleOnchange;M.handleOnchange=function(t){var e=this.render.parentNode.getAttribute("col_id"),i=parseInt(this.render.getAttribute("rowindex"),10),o=g._getGroupbyDisplayRowIndex(i),s=g.getColumnIndex(e),r=this.selectedIndex,a=this.getValue();if(I.call(this,t),g.dataList.__setCellData(i,e,this.getValue()),g._dataList.setRowPosition(i),r!=this.selectedIndex){var n={oldValue:a,newValue:this.getValue(),oldSelectedIndex:r,newSelectedIndex:this.selectedIndex,rowIndex:i,colIndex:s};d.B.fireEvent(g,"onviewchange",n)}d.B.fireEvent(g,"onafteredit",o,s,this.getValue(),t)},M.activate()
;var C=M.uuid;M.event.addListener2(M.dom.select,"onfocus",(function(t){g.lastEvent=t;var e=WebSquare.idCache[C];g.getLastFocusedCell().focusedTd==e.render.parentNode||g.focusedByApi||g._setFocusedCell(e.render.getAttribute("rowindex"),e.render.parentNode.getAttribute("col_id")),g.focusedByApi=!1}))}else if("checkbox"==n&&l){if(t.options.checkboxLabel||t.options.checkboxLabelColumn||t.options.checkboxLabelFormatter){var x,_=this.getElemRowIndex(e),S=this._getGroupbyDisplayRowIndex(_),D=(x=t.mainGridId+"_checkbox_"+t.id)+"_"+_,R=t.options.checkboxLabel||"";if(t.options.checkboxLabelColumn){for(var L=t.options.checkboxLabelColumn.split(","),T="",k=t.options.checkboxLabelDelimiter||this.options.labelDelimiter||" ",A=0;A<L.length;A++)A===L.length-1?T+=this._getCellDisplayData(_,L[A]):T+=this._getCellDisplayData(_,L[A])+k;R=R?T+k+R:T}if(t.options.checkboxLabelFormatter)try{var F;"function"==typeof(F=a.D.getGlobalFunction(t.options.checkboxLabelFormatter,t.scope_id))&&(R=F.call(this,S,this.getColumnIndex(t.colID),R))}catch(e){u.k.printLog(this.id+"_"+t.id+" checkboxLabelFormatter error : "+e.message)}O="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check'  id='"+D+"' name='"+x+"'/>";var E="<label class='w2checkbox_label ' for='"+D+"'>"+R+"</label>";"left"===t.options.checkboxLabelPosition?O=E+O:O+=E,e.innerHTML=O;var M=e.getElementsByTagName("input")[0]}else{O="<INPUT style='border-width:0px;' type='checkbox' class='w2grid_embedded_check' />",e.innerHTML=O;M=e.getElementsByTagName("input")[0];if(p)M.title=p;else if(t.options.title)M.title=t.options.title;else if(this.options.titleAuto){K=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";M.title=i?K+WebSquare.language.getMessage("Grid_title"):K+WebSquare.language.getMessage("Grid_title_not_choose"),R&&(M.title=M.title+R)}}if(this.event.addListener(M,"onclick",this.event.bindAsEventListener(this,(function(t){var e=d.B.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&d.B.preventDefault(t)}))),t.options.noDisabledOnReadOnly){var _=this.getElemRowIndex(e);this._getEditReadOnly(_,t.id)?this.addClass(M,this.options.readOnlyClass+"_nodisabled"):this.removeClass(M,this.options.readOnlyClass+"_nodisabled")}}else if("radio"==n&&l){var O;if(t.options.radioLabel||t.options.radioLabelColumn||t.options.radioLabelFormatter){var N,_=this.getElemRowIndex(e),S=this._getGroupbyDisplayRowIndex(_),B=(N=t.mainGridId+"_radio_"+t.id)+"_"+_,G=t.options.radioLabel||"";if(t.options.radioLabelColumn){for(var L=t.options.radioLabelColumn.split(","),T="",k=t.options.radioLabelDelimiter||this.options.labelDelimiter||" ",A=0;A<L.length;A++)A===L.length-1?T+=this._getCellDisplayData(_,L[A]):T+=this._getCellDisplayData(_,L[A])+k;G=G?T+k+G:T}if(t.options.radioLabelFormatter)try{var H;"function"==typeof(H=a.D.getGlobalFunction(t.options.radioLabelFormatter,t.scope_id))&&(G=H.call(this,S,this.getColumnIndex(t.colID),G))}catch(e){u.k.printLog(this.id+"_"+t.id+" radioLabelFormatter error : "+e.message)}O="<INPUT style='border-width:0px;' type='radio' class='w2grid_embedded_radio'  id='"+B+"' name='"+N+"'/>";E="<label class='w2radio_label ' for='"+B+"'>"+G+"</label>";"left"===t.options.radioLabelPosition?O=E+O:O+=E,e.innerHTML=O;M=e.firstChild}else{O="<INPUT style='border-width:0px;' type='radio' name='"+(t.mainGridId+"_radio_"+t.id)+"' class='w2grid_embedded_radio' />",e.innerHTML=O;M=e.firstChild;if(p)M.title=p;else if(t.options.title)M.title=t.options.title;else if(this.options.titleAuto){K=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";M.title=i?K+WebSquare.language.getMessage("Grid_title"):K+WebSquare.language.getMessage("Grid_title_not_choose"),G&&(M.title=M.title+G)}}
if(this.event.addListener(M,"onclick",this.event.bindAsEventListener(this,(function(t){var e=d.B.getTarget(t);this.lastEvent=t;var i=this.getLastFocusedCell(),o=e.parentNode,s=this.getElemRowIndex(o),r=this.getCellInfo(o),a=r.id,n=this.getColumnIndex(a);i.focusedTd==e.parentNode||this.focusedByApi||this._setFocusedCell(s,a),this.focusedByApi=!1,r.options.noDisabledOnReadOnly&&this._getEditReadOnly(s,n)&&d.B.preventDefault(t)}))),t.options.noDisabledOnReadOnly){_=this.getElemRowIndex(e);this._getEditReadOnly(_,t.id)?this.addClass(M,this.options.readOnlyClass+"_nodisabled"):this.removeClass(M,this.options.readOnlyClass+"_nodisabled")}}else if("calendar"==n&&l){Z=p||t.options.title||"";if(this.options.titleAuto&&!Z){K=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";Z=""!==i?K+" "+i:K+WebSquare.language.getMessage("Grid_calendar")}var W=t.options.ioFormat,V={style:"width:0px; height:0px;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:W,ioFormatter:"$blank",displayFormat:t.options.displayFormat||W,displayFormatter:"$blank",displayFormatFunc:t.options.displayFormatFunc,calendarDisplayFormatFunc:t.options.calendarDisplayFormatFunc,footerDiv:!0,renderDiv:!0,keepFocusSelect:!0,focusOnOuterDiv:!0,renderType:"native",readOnly:"$blank",disabled:"$blank",title:Z,validCheck:!1,_scope_obj_uuid:t.options._scope_obj_uuid,senseReader:t.options.senseReader,xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute("rowIndex"),10),i=this.render.parentNode.getAttribute("col_id"),o=g.getColumnIndex(i);d.B.fireEvent(g,"oncellclick",e,o,i),d.B.stopPropagation(t)}}},{name:"onafterviewchange",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute("rowindex"),10),i=g._getGroupbyDisplayRowIndex(e),o=g.getColumnIndex(this.render.parentNode.getAttribute("col_id"));t.oldValue!=t.newValue&&d.B.fireEvent(g,"onviewchange",{oldValue:t.oldValue,newValue:t.newValue,rowIndex:i,colIndex:o})}}},{name:"ondateselect",action:"script",param:{handler:function(t,e){this.options.senseReader||this.dom.input.blur();var i=this.render.getAttribute("rowindex"),o=this.render.parentNode.getAttribute("col_id"),s=M.validator.validateString(this.getValue());g.dataList.__setCellData(i,o,s)}}},{name:"onconfirm",action:"script",param:{handler:function(){this.options.senseReader||this.dom.input.blur();var t=this.render.getAttribute("rowindex"),e=this.render.parentNode.getAttribute("col_id"),i=M.validator.validateString(this.getValue());g.dataList.__setCellData(t,e,i)}}}]};M=new WebSquare.uiplugin.inputCalendar(y,V,t.element);try{t.element&&!t.element.getAttribute("dateValidCheck")&&(M.options.dateValidCheck=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false")}catch(t){r.w.printStackTrace(t,null,this)}e.innerHTML="",M.writeTo(e),W!=M.options.ioFormat&&(t.options.ioFormat=M.options.ioFormat,t.initFormatter()),M.setVerticalAlign=function(){},M.handleKeyupEvent=function(){};var q=WebSquare.uiplugin.inputCalendar.prototype.handleFocusEvent;M.handleFocusEvent=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return d.B.stopEvent(t),!1;var e=this.render.getAttribute("rowindex"),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute("col_id");if(g.lastEvent=t,g.getLastFocusedCell().focusedTd==this.render.parentNode||g.focusedByApi||g._setFocusedCell(e,o),q.call(this,t),g.focusedByApi=!1,!this.reFocus&&(g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),this.select(),this.focus(),g.fakeInput.render.parentNode)){var s=g.getColumnIndex(o);d.B.fireEvent(g,"onbeforeedit",i,s,g._dataList.getCellData(e,s))}g.F2Mode=!1,this.reFocus=!1};var j=WebSquare.uiplugin.inputCalendar.prototype.handleKeyEvent;M.handleKeyEvent=function(t){switch(g.lastEvent=t,j.call(this,t),t.keyCode){case 46:
return!g.F2Mode&&g.fakeInput.render.parentNode&&(this.setValue(""),g.fakeInput.setValue("")),void d.B.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void d.B.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(this.render,this.render.value.length),g.hideFakeInput(this),void d.B.stopPropagation(t);case 9:for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2inputCalendar_divInput")){d.B.stopPropagation(t);break}return}var i=t.which||t.keyCode;g.nonCharKeys[i]||(32!=i?(g.fakeInput.render.parentNode&&g.hideFakeInput(this),d.B.stopPropagation(t)):d.B.stopPropagation(t))};var z=WebSquare.uiplugin.inputCalendar.prototype.handleBlurEvent;M.handleBlurEvent=function(t){var e=this.render.getAttribute("rowindex"),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute("col_id"),s=g.getColumnIndex(o),r=M.validator.validateString(this.getValue());if(!1===this.validate(r)&&""!=r){if(this.options.dateValidSet&&this.options.dateValidSetCustom);else if("false"!==this.options.displaymessage){var a=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"날짜 형식이 잘못 되었습니다.";alert(a)}return!1}var n,l=WebSquare.historyManager.get(this.options.pluginName,this.id);if(l&&(n=l.value),d.B.fireEvent(g,"oneditend",i,s,r,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=this.render.parentNode&&g._setFocusedCell(e,o),d.B.stopEvent(t),!1;g.editEndFlag=!1,z.call(this,t);var h=g.getCellInfo(o);g.dataList.__setCellData(e,o,r),r=g._dataList.getCellData(e,o),"all"==h.options.applyFormat||this.options.displayFormat||(r=h.getDisplayData(r)),this.setValue(r),d.B.fireEvent(this,"onafterviewchange",{oldValue:n,newValue:r});d.B.fireEvent(g,"onafteredit",e,s,r,g.lastEvent);g.F2Mode=!1},M.setStyle("z-index","10"),M.activate(),this.fakeInput||this.makeFakeInput()}else if("text"==n||"textImage"==n||"drilldown"==n||"secret"==n){Y=t.options.type?t.options.type:"text",Z=p||"";"secret"==n&&(Y="password"),c&&(h="bigDecimal");J={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;z-index:10;",ioFormat:"$blank",ioFormatter:"$blank",displayFormat:"all"==t.options.applyFormat?"":"$blank",displayFormatter:"$blank",readOnly:"$blank",disabled:"$blank",title:Z,type:Y,dataType:h,editType:t.options.editType,byteCheckIgnoreChar:t.options.byteCheckIgnoreChar,maxlength:t.options.maxLength||t.options.maxlength||-1,maskFormat:t.options.maskFormat,maskFormatModelNumber:t.options.maskFormatModelNumber,useMaxLength:t.options.useMaxLength,adjustMaxLength:t.options.adjustMaxLength,useKeyupBlur:!1,inputMode:t.options.inputMode||"",_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"ondblclick",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.B.fireEvent(g,"oneditdblclick",i,o,t.id)}}}]};t.options.maskFormat&&"display"==t.options.applyFormat&&(J.displayFormat=t.options.displayFormat),t.internal&&(J=o.x.extend(o.x.extend(J,t.initializeInfo.options))),"float"===t.options.dataType&&(J.dataType=t.options.dataType),(M=new WebSquare.uiplugin.input(y,J,t.element)).writeTo(this),this.options.editInputClass&&"text"==n&&this.addClass(M.render,this.options.editInputClass),M.event.addListener(M.render,"oncopy",this.event.bindAsEventListener(this,(function(t){d.B.stopPropagation(t)}))),M.event.addListener(M.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.B.stopPropagation(t)}))),M.activate(),
"number"==t.options.dataType?""==t.options.displayFormat?M.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):t.options.maskFormat||M.validator.addCommand(new WebSquare.validator.numberCommand):"euro"==t.options.dataType?M.validator.addCommand(new WebSquare.validator.euroCommand(M.options.delimiter,M.options.decimalDelimiter)):"text"==t.options.dataType&&(t.options.maskFormat||(t.options.applyFormat="display")),M.setVerticalAlign=function(){},this._moveKeyEdit(M.uuid,"handleKeydownEvent",{oldMode:!0})}else if("textarea"==n){if(l){var P,X,U;e&&(_=this.getElemRowIndex(e),P=this.getColumnIndex(e.getAttribute("col_id")),X=this._getEditDisabled(_,P),U=this.___getEditReadOnly(_,P)),M=new WebSquare.uiplugin.textarea(y,{style:"position:relative;display:none;width:150px;height:60px;z-index:1000;resize:none;",className:"$blank",readOnly:!0===U?U:"$blank",disabled:!0===X?X:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid,xmlEvents:[{name:"onkeydown",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}}]},t.element);z=WebSquare.uiplugin.textarea.prototype.handleBlurEvent;M.handleBlurEvent=function(t){z.call(this,t);var e=parseInt(this.render.getAttribute("rowindex"),10),i=this.render.parentNode.getAttribute("col_id"),o=g.getCellInfo(i),s=this.getValue();"number"==o.mainGrid.getColumnOption(o.options.col_id,"dataType")&&""!=s&&(s=Number(s)),o.mainGrid.dataList.__setCellData(e,i,s)}}else{V={style:"position:absolute;display:none;width:150px;height:60px;z-index:1000;resize:none;",className:"$blank",readOnly:"$blank",disabled:"$blank",maxlength:t.options.maxLength||-1,_scope_obj_uuid:t.options._scope_obj_uuid};!0===t.options.keepCellClass&&(V.className=""),t.internal&&(V=o.x.extend(o.x.extend(V,t.initializeInfo.options))),M=new WebSquare.uiplugin.textarea(y,V,t.element)}M.writeTo(this),M.event.addListener(M.render,"oncopy",this.event.bindAsEventListener(this,(function(t){d.B.stopPropagation(t)}))),M.event.addListener(M.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.B.stopPropagation(t)}))),this._moveKeyEdit(M.uuid,"handleKeydownEvent"),M.activate()}else if("calendar"==n){W=t.options.ioFormat,V={style:"position:absolute;display:none;border:1px solid "+this.options.selectedCellColor+";outline:none;",delimiter:"$blank",calendarValueType:t.options.calendarValueType,calendarClass:t.options.calendarClass||"class1",ioFormat:W,ioFormatter:"$blank",displayFormat:t.options.displayFormat||W,applyFormat:t.options.applyFormat||"display",displayFormatter:"$blank",holidayRef:t.options.holidayRef||"",keepFocusSelect:!0,focusOnOuterDiv:!0,footerDiv:t.options.footerDiv,_scope_obj_uuid:t.options._scope_obj_uuid,readOnly:"$blank",disabled:"$blank",validCheck:!1,renderDiv:!0,inputReadOnly:t.options.inputReadOnly,unformatOnPaste:t.options.unformatOnPaste,xmlEvents:[{name:"ondateselect",action:"script",param:{handler:function(e,i){var o=t.editRowIndex,s=g.getColumnIndex(t.id);d.B.fireEvent(g,"ondateselect",o,s,e,i)}}},{name:"onmonthselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.B.fireEvent(g,"onmonthselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}},{name:"onyearselect",action:"script",param:{handler:function(e){var i=t.editRowIndex,o=g.getColumnIndex(t.id);d.B.fireEvent(g,"onyearselect",i,o,{oldValue:e.oldValue,newValue:e.newValue})}}}]};t.internal&&(V=o.x.extend(o.x.extend(V,t.initializeInfo.options)));M=new WebSquare.uiplugin.inputCalendar(y,V,t.element);try{0==t.internal?t.element&&!t.element.getAttribute("dateValidCheck")&&(M.options.dateValidCheck=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="calendar"]/dateValidCheck/@value')||"false"):1!=t.options.dateValidCheck&&"true"!=t.options.dateValidCheck||(M.options.dateValidCheck="true")}catch(t){r.w.printStackTrace(t,null,this)}M.writeTo(this),M.event.addListener(M.render,"oncopy",this.event.bindAsEventListener(this,(function(t){
d.B.stopPropagation(t)}))),M.event.addListener(M.render,"onpaste",this.event.bindAsEventListener(this,(function(t){d.B.stopPropagation(t)}))),W!=M.options.ioFormat&&(t.options.ioFormat=M.options.ioFormat,t.initFormatter()),this._moveKeyEdit(M.uuid,"handleKeyEvent"),M.activate(),M.setVerticalAlign=function(){},"display"===t.options.applyFormat&&(M.handleKeyupEvent=function(){}),M.setStyle("z-index","10"),M.options.dateValidSet&&M.options.dateValidSetCustom&&(M._skipDateValidSet=!0)}}else{var Z=p||t.options.title||"",K=this.getHeaderValue(this.bodyToHeaderRelation[t.id])||"";Z||this.options.titleAuto&&("text"==n&&""!==i?Z=K+" "+i:"text"==n&&""==i?Z=K+WebSquare.language.getMessage("Grid_text"):"secret"==n&&(Z=K+WebSquare.language.getMessage("Grid_secret")));var Y=t.options.type?t.options.type:"text",$="w2grid_embedded_input";"secret"==n&&(Y="password",a.D.isIEAllVersion()?$+=" w2grid_secret":$="w2grid_embedded_secret");var J={className:$,style:"$blank",ioFormat:"$blank",ioFormatter:"$blank",readOnly:"$blank",disabled:"$blank",hidden:"$blank",title:Z,type:Y,adjustMaxLength:t.options.adjustMaxLength,useMaxLength:t.options.useMaxLength,useKeyupBlur:!1,xmlEvents:[{name:"onmousedown",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute("rowIndex"),10),i=this.render.parentNode.getAttribute("col_id");if(e-g.rowIndex>=g.lastIndex+1)return d.B.stopEvent(t),g.addGridScroll(1),void g._setFocusedCell(e,i,!0)}}},{name:"onclick",action:"script",param:{handler:function(t){var e=parseInt(this.render.getAttribute("rowIndex"),10),i=this.render.parentNode.getAttribute("col_id"),o=g.getColumnIndex(i);d.B.fireEvent(g,"oncellclick",e,o,i),d.B.stopPropagation(t)}}},{name:"oncopy",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}},{name:"onpaste",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}},{name:"oncut",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}},{name:"onkeydown",action:"script",param:{handler:function(t){this._SenSeReaderBeforeEditValue=null;var e={},i=this.render.parentNode.getAttribute("col_id");e.rowIndex=parseInt(this.render.getAttribute("rowIndex"),10),e.colIndex=g.getColumnIndex(i),e.colID=i,e.keyCode=t.charCode?t.charCode:t.keyCode,this._SenSeReaderBeforeEditValue=this.render.value,e.oldValue=this.render.value,d.B.fireEvent(g,"oneditkeydown",e)}}},{name:"onkeyup",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode,i=this.render.parentNode.getAttribute("col_id"),o={rowIndex:parseInt(this.render.getAttribute("rowIndex"),10),colIndex:g.getColumnIndex(i),colID:i,oldValue:this._SenSeReaderBeforeEditValue||"",newValue:this.render.value,inputType:"text",keyCode:e};this._SenSeReaderBeforeEditValue=null,d.B.fireEvent(g,"oneditkeyup",o),d.B.stopPropagation(t)}}}]};"float"===t.options.dataType&&(J.dataType=t.options.dataType),t.options.delimiter="",M=new WebSquare.uiplugin.input(y,o.x.extend(o.x.extend({},t.options),J)),e.innerHTML="",M.writeTo(e),"number"==t.options.dataType&&(""==t.options.displayFormat?M.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9")):M.validator.addCommand(new WebSquare.validator.numberCommand)),a.D.isIE()&&M.setVerticalAlign(),M.setVerticalAlign=function(){};var Q=WebSquare.uiplugin.input.prototype.handleBlurEventBasic,tt=this.uuid;M.handleBlurEventBasic=function(t){var e=parseInt(this.render.getAttribute("rowindex"),10),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute("col_id"),s=g._dataList.getColumnIndex(o),r=g.getColumnIndex(o),n=M.validator.validateString(this.getValue());if(d.B.fireEvent(g,"oneditend",i,r,n,t)+""=="false")return g.editEndFlag=!0,this.reFocus=!0,g.fakeInput.lastInput==this&&this.focus(),g.getLastFocusedCell().focusedTd!=this.render.parentNode&&g._setFocusedCell(e,o),d.B.stopEvent(t),!1;g.editEndFlag=!1,Q.call(this,t);var l=g.getCellInfo(o),h=g.getColumnOption(l.id,"dataType");if("number"==h||"float"==h){var u=n.wq_trim()
;"."!==u&&"-"!==u&&"+"!==u||(n="")}var p=!(!g.isDrillDown||!g._dataList.options.depthColumn),c=e,f=g._dataList.getRealRowIndex(c);p&&(c=f);var m=g._dataList.dataArr[f*g._dataList.getColumnCount()+s];if(g.dataList.__setCellData(e,o,n),n=g._dataList.getCellData(c,o),"all"==l.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(n=l.getDisplayData(n)),this.setValue(n),WebSquare.idCache[tt].options.senseReader&&this.options.customFormatter){var y=null;try{"function"==typeof this.options.customFormatter?y=this.options.customFormatter:"function"==typeof(y=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=y)}catch(t){y=null}var b=n,w=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&w&&(b=this.formatter.format(n)),"function"==typeof y){this.useCustomFormatter=!0;var v=y.call(this.mainGrid,n,b,i,s);this.render.value=v}}d.B.fireEvent(g,"onafteredit",i,r,n,g.lastEvent);m!=n&&d.B.fireEvent(g,"onviewchange",{oldValue:m,newValue:n,rowIndex:i,colIndex:r}),g.hideFakeInput(M),g.F2Mode=!1};var et=WebSquare.uiplugin.input.prototype.handleFocusValueEventAdv;M.handleFocusValueEventAdv=function(t){if(g.editEndFlag&&g.fakeInput.lastInput!=this)return d.B.stopEvent(t),!1;var e=parseInt(this.render.getAttribute("rowindex"),10),i=g._getGroupbyDisplayRowIndex(e),o=this.render.parentNode.getAttribute("col_id");g.lastEvent=t;var s=g.getLastFocusedCell();!(!g.isDrillDown||!g._dataList.options.depthColumn)&&(e=g._dataList.getRealRowIndex(e)),s.focusedTd!=this.render.parentNode&&(!g.focusedByApi||s.focusedRowIndex===e&&s.focusedColIndex===g.getColumnIndex(o)?g._setFocusedCell(e,o):g._setFocusedCell(e,o,!1));var r=this.reFocus;if(et.call(this,t),this.reFocus=r,g.focusedByApi=!1,!this.reFocus&&(this.setValue(g._dataList.getCellData(e,o)),g.showFakeInput(this),g.fakeInput.setValue(this.getValue()),"select"===this.options.editType&&this.select(),this.focus(),g.fakeInput.render.parentNode)){var a=g.getColumnIndex(o);d.B.fireEvent(g,"onbeforeedit",i,a,g._dataList.getCellData(e,a))}g.F2Mode=!1,this.reFocus=!1};var it=WebSquare.uiplugin.input.prototype.handleKeydownEvent;M.handleKeydownEvent=function(t){switch(g.lastEvent=t,it.call(this,t),t.keyCode){case 46:return!g.F2Mode&&g.fakeInput.render.parentNode&&(this.setValue(""),g.fakeInput.setValue("")),void d.B.stopPropagation(t);case 27:return g.F2Mode=!1,g.showFakeInput(this),this.setValue(g.dataList.getCellData(g._getFocusedRowIndex(),g.getFocusedColumnIndex())),this.select(),void d.B.stopPropagation(t);case 113:return g.F2Mode=!0,WebSquare.text.setCaretPos(this.render,this.render.value.length),g.hideFakeInput(this),void d.B.stopPropagation(t);case 9:for(var e=this.event.getTargetIterator(t,this.render);e.next();)if(e.match("w2inputCalendar_divInput")){d.B.stopPropagation(t);break}return}var i=t.which||t.keyCode;if(!g.nonCharKeys[i])if(32!=i){if(g.fakeInput.render.parentNode){var o=this.render.getAttribute("rowindex"),s=g._getGroupbyDisplayRowIndex(o),r=this.render.parentNode.getAttribute("col_id"),a=g.getColumnIndex(r);d.B.fireEvent(g,"onbeforeedit",s,a,g.dataList._getCellData(o,a)),g.hideFakeInput(this)}d.B.stopPropagation(t)}else d.B.stopPropagation(t)},M.activate(),this.fakeInput||this.makeFakeInput()}this.dom[y]=M,l&&this.adaptiveEmbeddedInputIdList.push(y)}return M},b.prototype.getTemporaryDataCollectionItemArr=function(t){try{var e=[],i=this.modelControl.getDataComp(t.dataCompID);if(i)switch(i.initializeType){case"linkedDataList":for(var o={},s=0;s<i.filteredRowIndexArr.length;s++){var a=i.getRealRowIndex(s),n=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[a*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataList":for(o={},s=0;s<i.filteredRowIndexArr.length;s++){n=i.dataArr[i.filteredRowIndexArr[s]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.label]],
l=i.dataArr[i.filteredRowIndexArr[s]*i.cellIdList.length+i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}break;case"dataMap":for(o={},s=0;s<i._dataList.oneRowDataLength;s++){n=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.label]],l=i._dataList.dataArr[i.bodyIdColIndexMap[t.itemsetObj.value]];o[n]!=l&&(o[n]=l,e.push({label:n,value:l}))}}return e}catch(t){r.w.printStackTrace(t)}};var w=function(){};w.prototype.initializeHead=function(){try{this.headerObj={},this.headerConfigOptions={};for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=[],i={},o=0;o<t.length;o++){if(i[t[o].id]){var n=WebSquare.language.getMessage("E_comp_duplicated_Msg",t[o].id)||"id["+t[o].id+"] 가 중복사용되었습니다. 소스코드를 확인하세요.";$l(n)}else i[t[o].id]=t[o].id;e.push(t[o])}for(o=0;o<e.length;o++){var l=e[o];if(!l.getAttribute("header_id")){var h=l.getAttribute("inputType"),d=l.getAttribute("dataType"),u=l.getAttribute("value"),p=null;if(this.setConfigOptions(l,u),"checkbox"==h)l.innerHTML="",(p=this.setCheckboxHead(l,u)).headInputType="checkbox";else if("select"==h)(p=this.setSelectboxHead(l,u)).headInputType="select";else if("text"==h&&"own"==d)(p=this.setInputHead(l,u)).headInputType="input";else if("checkcombobox"==h)(p=this.setCheckcomboboxHead(l,u)).headInputType="checkcombobox";else{var c=l.getAttribute("value"),g=l.getAttribute("useLocale");if("true"===g||this.options.useLocale&&!g){var f=l.getAttribute("localeRef");if(f){(y=this.getLocaleValue(f))&&(c=y)}else{var m=l.getAttribute("id");if(null!=m&&m.match("RowNumber")&&this.options.rowNumLocaleRef)(y=this.getLocaleValue(this.options.rowNumLocaleRef))&&(c=y);else if(null!=m&&m.match("RowStatus")&&this.options.rowStatusLocaleRef){var y;(y=this.getLocaleValue(this.options.rowStatusLocaleRef))&&(c=y)}}}c=null!=c?c:"",l.innerHTML="<nobr>"+c+"</nobr>"}var b=l.getAttribute("id");l.setAttribute("header_id",b);var w=l.className;if("native"===this.options.drawType&&(w+=" "+this.options.gridNativeClass),w+=" "+this.id+"_header__column"+o,this.headCellInfoHash[b]){var v=this.headCellInfoHash[b].getAttribute("class");v&&(w+=" "+v)}if(l.className=w,l.setAttribute("id",this.id+"_"+b),this.options.autoScope&&l.setAttribute("scope","col"),b&&!b.match("RowNumber")&&!b.match("RowStatus")){var I="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+h+"']/useFilter/@value",C=a.D.getBoolean(s.v.getConfiguration(I)),x=this.headCellInfoHash[b].getAttribute("useFilter");if((x=""===x||"string"!=typeof x||a.D.getBoolean(x))&&(C||"true"==l.getAttribute("useFilter"))){var _="width:100%;height:100%;",S="";this.options.filterShowAlways&&(_+="table-layout:fixed;",S="overflow:hidden;");var D=document.createElement("table");D.style=_;var R=document.createElement("tr"),L=document.createElement("td");L.style.cssText="width:100%;"+S;for(var T=l.childNodes.length,k=0;l.childNodes.length>0&&k<T;k++)L.appendChild(l.childNodes[0]);R.appendChild(L);var A=document.createElement("td");if(A.innerHTML="<input type='button' id='"+this.id+"_"+b+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+b+"\");'/>",R.appendChild(A),D.appendChild(R),l.appendChild(D),this.options.filterShowAlways){var F=document.getElementById(this.id+"_"+b+"_filter");F&&F.parentNode&&(F.parentNode.style.width=F.offsetWidth+2+"px")}}}"true"===l.getAttribute("sortable")&&(l.className+=" w2grid_head_sortable"),this.headerObj[b]=p,l.disabled=!1;var E=l.getAttribute("toolTip");E&&WebSquare.getBody().setToolTip(l,E)}}this.clearHeaderSort()}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.associateHeaderBody=function(){try{for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=0,i=-1,o="",s=0;s<t.length;s++){var n=t[s];if(n.className.indexOf(this.options.headerTdClass+"_rowNumber")>=0||n.className.indexOf(this.options.headerTdClass+"_rowStatus")>=0);else{var l=n.getAttribute("colIndex");parseInt(l)<=i&&e++,
i=parseInt(l);var h=e;h+1>this.tempTr.rows.length&&(h=this.tempTr.rows.length-1);for(var d=null;h>=0;){for(var u=this.tempTr.rows[h],p=a.D.first(u);p;){if(l==p.getAttribute("colIndex")){d=p;break}p=a.D.next(p)}if(d)break;h--}if(d){var c=n.getAttribute("header_id"),g=d.getAttribute("col_id");o=g,this.headerToBodyRelation[c]=g,this.bodyToHeaderRelation[g]=c}else{c=n.getAttribute("header_id");this.passiveColSpanRelation[c]=o}}}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setConfigOptions=function(t,e){try{var i=t.getAttribute("col_id"),o=this.options.pluginName,a=t.getAttribute("inputType");this.headerConfigOptions[i]=s.v.getConfig(o+"/header[@inputType='"+a+"']")}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderConfigValue=function(t,e,i){try{var o=t.getAttribute("col_id"),s=t&&(t.getAttribute(i)||t.getAttribute(i.toLowerCase())),a=this.headerConfigOptions[o]&&this.headerConfigOptions[o][i];return s||a||""}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setCheckboxHead=function(t,e){try{var i=t.getAttribute("col_id"),o=t.getAttribute("onChangeFunction")||t.getAttribute("onchangeFunction"),n="<INPUT type='checkbox' />",l=this.getHeaderConfigValue(t,e,"checkboxLabel");if(this.options.useLocale){var h=t.getAttribute("localeRef");if(h){var u=this.getLocaleValue(h);u&&(l=u)}}if(l){var p=this.uuid+"_header__"+i+"_checkboxLabel_",c=p+"_id";n="left"===this.getHeaderConfigValue(t,e,"checkboxLabelPosition")?"<label class='w2checkbox_label ' for='"+c+"'>"+l+"</label><INPUT type='checkbox' name='"+p+"' id='"+c+"'/>":"<INPUT type='checkbox' name='"+p+"' id='"+c+"'/><label class='w2checkbox_label ' for='"+c+"'>"+l+"</label>",t.getAttribute("checkboxLabel")||t.setAttribute("checkboxLabel",l)}t.innerHTML=n;var g=t.getElementsByTagName("input")[0];g.setAttribute("colId",e),("true"==t.getAttribute("disabled")||a.D.isIE()&&parseInt(s.v.browserVersion(),10)<9&&"true"==this.headCellInfoHash[i].getAttribute("disabled"))&&g.setAttribute("disabled","disabled");var f=t.getAttribute("title");f&&g.setAttribute("title",f);var m=this;d.B.addListener(g,"onkeydown",(function(t){d.B.fireEvent(m,"onkeydown",t),"32"==(t.charCode?t.charCode:t.keyCode)&&d.B.stopPropagation(t)})),d.B.addListener(g,"ondblclick",(function(t){d.B.stopPropagation(t)})),d.B.addListener(g,"onfocus",(function(t){var e=m.headerToBodyRelation[i];m.getCellInfo(e).options.focusOutOnCheckHeaderClick&&(m.removeFocusedCell(),1==m.options.senseReader&&m.rowIndex>0&&m.addGridScroll(0-m.rowIndex))}));var y=this.uuid;return null!=o&&""!=o?d.B.addListener(g,"onclick",(function(t){if(!WebSquare.idCache[y].options.checkHeaderOnly){m.noevent=!0;var s=a.D.getGlobalFunction(o,m.scope_id);if("function"==typeof s)try{s.call(this,this.checked,e)}catch(t){}m.options.preventMultipleClick&&d.B.fireEvent(m,"onheaderclick",i)}})):d.B.addListener(g,"onclick",(function(t){if(!WebSquare.idCache[y].options.checkHeaderOnly){m.noevent=!0;var e,o,s,a,n,l,h=m.headerToBodyRelation[i],u=m.getCellInfo(h),p=u,c=u.options.trueValue,g=u.options.falseValue,f=!(!m.isDrillDown||!m._dataList.options.depthColumn),b=!("checkbox"!==u.options.inputType||!m.options.ref);if(!0===b){var w=m._dataList._getXPath({colID:h,skipValueNode:!0});b=(e=WebSquare.ModelUtil.findInstanceNodes(w,null,m.scope_id)).length>=m.getTotalRow()}if("checkbox"===u.options.inputType||"custom"===u.options.inputType||"radio"===u.options.inputType){if(m.editedCell)try{n=m.editedCell.editRowIndex,l=m.getColumnIndex(m.editedCell.id);var v=m._dataList.getColumnIndex(m.editedCell.id);a=m._grid.getRealRowIndex(n)*m._dataList.getColumnCount()+v,s=m._dataList.dataArr[a]}catch(t){r.w.printStackTrace(t,null,this)}if(this.checked){for(var I=m.getUnCheckedIndex(h),C=0;C<I.length;C++)if("custom"==u.options.inputType&&0==u.internal&&(p=u.cellManagerHashByRowIndex[I[C]])&&(c=p.options.trueValue,g=p.options.falseValue),p.options.checkAlways||!m.___getEditReadOnly(I[C],h,f)&&!m._getEditDisabled(I[C],h,f)){var x=I[C]
;f?m._dataList._setCellData(x,h,c,!0,!0,null,null,b):m.dataList.setCellData(x,h,c,!0,!0,null,null,b),o=c;var _=x;f&&(_=m._dataList.getFilteredRowIndex(_)),null!=_&&m._dataList.broadcast({gridView:["notifyCellChanged",[_,h,null,!0]]})}}else{var S=m.getCheckedIndex(h);for(C=0;C<S.length;C++)if("custom"==u.options.inputType&&0==u.internal&&(p=u.cellManagerHashByRowIndex[S[C]])&&(c=p.options.trueValue,g=p.options.falseValue),p.options.checkAlways||!m.___getEditReadOnly(S[C],h,f)&&!m._getEditDisabled(S[C],h,f)){x=S[C];f?m._dataList._setCellData(x,h,g,!0,!0,null,null,b):m.dataList.setCellData(x,h,g,!0,!0,null,null,b),o=g;_=x;f&&(_=m._dataList.getFilteredRowIndex(_)),null!=_&&m._dataList.broadcast({gridView:["notifyCellChanged",[_,h,null,!0]]})}}if(m.checkHeader(i),!0===b)for(C=0;C<e.length;C++){var D=e[C];(p.options.checkAlways||!m.___getEditReadOnly(C,h,f)&&!m._getEditDisabled(C,h,f))&&(m._dataList.valueNode?D.setAttribute(m._dataList.valueNode,o):WebSquare.xml.setTextNodeValue(D,o))}m._dataList.broadcast({linkedDataList:["notifyRowChanged"],fusionChart:["refresh"],fwFunnelChart:["refresh"],fwSparkChart:["refresh"],fwPyramidChart:["refresh"],fwGanttChart:["refresh"],generalComp:"both"})}if(m.options.senseReader&&m.rowIndex<=0&&(m.senseReaderMode=!0,m._setGridBorderNoRefresh=!0),m.options.senseReader&&m.rowIndex<=0&&(m.senseReaderMode=!1,m._setGridBorderNoRefresh=!1),m.drawFooter(),m.drawHeader(),m.options.preventMultipleClick&&d.B.fireEvent(m,"onheaderclick",i),null!=a)try{var R=m._dataList.dataArr[a];s!=R&&d.B.fireEvent(m,"onviewchange",{oldValue:s,newValue:R,rowIndex:n,colIndex:l})}catch(t){r.w.printStackTrace(t,null,this)}}})),g}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.checkHeader=function(t){try{if(this.headerObj){var e=this.headerObj[t],i=this.headerToBodyRelation[t],o=this.headerInfoHash[t];if(e&&o&&o.options&&"checkbox"==o.options.inputType){var s=!(!this.isDrillDown||!this._dataList.options.depthColumn),n=this.getCellInfo(i),l=s?this.getTotalRow():this.getRowCount();if("checkbox"!==n.options.inputType&&"custom"!==n.options.inputType&&"radio"!==n.options.inputType)return;if(this.hasCustomInputType&&0==n.internal&&"custom"==n.options.inputType){for(var h=l,d=0;d<h;d++){var u=s?d:this.dataList.getRealRowIndex(d),p=n.cellManagerHashByRowIndex[u]?n.cellManagerHashByRowIndex[u]:n;"checkbox"!=p.options.inputType&&"radio"!=p.options.inputType&&l--}if(0===l)return}var c="exclude"===this.options.checkAllType?this.getCheckedIndex(i,!0):this.getCheckedIndex(i),g=c.length;if(0==l)e.checked=!1,e.indeterminate=!1;else if(l==g)e.checked=!0,e.indeterminate=!1;else if(g>0){var f=!1;if(n.options.checkAlways)n.options.usePartialCheck&&"uncheck"===n.options.partialCheckNextClick&&(f=!0);else{for(d=0;d<c.length;d++)if(!this.___getEditReadOnly(c[d],i,s)&&!this._getEditDisabled(c[d],i,s)){(n.options.usePartialCheck||a.D.isIEAllVersion())&&(f=!0);break}n.options.usePartialCheck&&"check"===n.options.partialCheckNextClick&&f&&(f=!1)}a.D.isIEAllVersion()?e.checked=!f:e.checked=f,n.options.usePartialCheck&&(e.indeterminate=!0)}else l-g==l&&(e.checked=!1,e.indeterminate=!1)}}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setSelectboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:select",i.A={style:"width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"};else{this.tmpSelectbox||(this.tmpSelectbox=new WebSquare.uiplugin.selectbox("___tmp_selectbox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",s.v._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:select xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:select>",!0).documentElement,this.tmpSelectbox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}
a.D.isIE(8)&&"true"==this.headCellInfoHash[n].getAttribute("disabled")&&i.setAttribute("disabled","true")}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_selectbox_"+t.getAttribute("id"),{pluginType:"uiplugin.selectbox",pluginName:"selectbox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=t.getAttribute("onChangeFunction")||t.getAttribute("onchangeFunction");return c.changeFuncName=g,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.D.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){}})),c.addEvent("onclick",(function(t){o.noevent=!0})),this.addControl(c),c}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setInputHead=function(t,e){try{t.innerHTML="<input type='text' class='w2grid_head_input' style='width:95%; height:18px;' />";var i=a.D.first(t),o=this,s=t.getAttribute("onChangeFunction")||t.getAttribute("onchangeFunction");i.setAttribute("changeFuncName",s),i.setAttribute("colId",e),i.scope_id=this.scope_id,i.headerId=t.getAttribute("col_id");var n=WebSquare.idCache[this.uuid];return d.B.addListener(i,"onfocus",(function(){o.noevent=!0,o.headerFocus=!0})),d.B.addListener(i,"onblur",(function(t){o.headerFocus=!1;var e=a.D.getGlobalFunction(this.getAttribute("changeFuncName"),this.scope_id);if("function"==typeof e)try{e.call(this,this.value,this.getAttribute("colId"),this.headerId)}catch(t){}})),d.B.addListener(i,"onclick",(function(t){o.noevent=!0})),d.B.addListener(i,"onkeyup",(function(t){13==t.keyCode&&this.blur()})),d.B.addListener(i,"onpaste",(function(t){n.options.preventPaste?d.B.preventDefault(t):13==t.keyCode&&this.blur()})),i}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setCheckcomboboxHead=function(t,e){try{var i,o=this,n=t.getAttribute("id"),l=this.headCellInfoHash[n];if("json"===l._elementType)(i=l.cloneNode(!0)._element).N="w2:checkcombobox",i.A={style:"width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"};else{this.tmpCheckcombobox||(this.tmpCheckcombobox=new WebSquare.uiplugin.checkcombobox("___tmp_checkcombobox__"+this.id,{},null));var h=WebSquare.Elem.api.getElementsByTagName(l,"choices",s.v._XML_NAMESPACE.W2)[0],d=WebSquare.xml.serialize(h);for(var u in i=WebSquare.xml.parse('<w2:checkcombobox xmlns:w2="http://www.inswave.com/websquare">'+d+"</w2:checkcombobox>",!0).documentElement,this.tmpCheckcombobox.options){var p=t.getAttribute(u);null!=p&&""!=p&&("style"==u&&(p="width:100%; height:20px;top:0px;left:0px;position:relative;background-color:#ffffff"),i.setAttribute(u,p))}}t.style.position="static",t.innerHTML="";var c=WebSquare.controlFactory.createControl(this.id+"_head_checkcombobox_"+t.getAttribute("id"),{pluginType:"uiplugin.checkcombobox",pluginName:"checkcombobox"},i,this.scope_obj,!0,this.parentFrame);c.writeTo(t),window[c.id]=c,c.activate(),c.itemArr.length>0&&c.setValueNM(c.itemArr[0].value);var g=t.getAttribute("onChangeFunction")||t.getAttribute("onchangeFunction");return c.changeFuncName=g,c.colId=e,c.headerId=n,c.addEvent("onchange",(function(t){var e=a.D.getGlobalFunction(this.changeFuncName,this.scope_id);if("function"==typeof e)try{e.call(this,this.getValue(),this.colId,this.headerId)}catch(t){}})),c.addEvent("onclick",(function(t){o.noevent=!0})),c}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderDIV=function(t){return this.getHeaderLayer(t)},w.prototype.getHeaderLayer=function(t){for(var e=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),i=0;i<e.length;i++){var o=e[i],s=o.getAttribute("header_id");if(null!=s&&null!=t&&t.toLowerCase()==s.toLowerCase())return o}},w.prototype.getHeaderInfo=function(t){try{return this.headerInfoHash[t]||{options:{}}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getTotalHeaderCol=function(t){try{
var e=this.getTotalCol();if(t){if(t.mergedColumn){e=0;for(var i=this.htmlInfo.head.headerTdHtml,o=0,s=i.length;o<s;o++)e+=i[o].length}t.defaultColumn&&(e+=this.defaultColCnt)}return e}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderColumnVisible=function(t){var e=this.getHeaderInfo(t),i=this._getRealColIndex("head",t),o=i+this.defaultColCnt,s=!this.hiddenList[o];if(e&&(0===i||i)){for(var r=0;r<e.options.colSpan;r++)s=!this.hiddenList[o+r]||s;return s}u.k.printLog("[getHeaderColumnVisible] 존재하지 않는 header 컬럼입니다.")},w.prototype.setHeaderValue=function(t,e,i){var o=this.getHeaderLayer(t);if(o)if("function"==typeof e)e(o);else{var s=this.headerObj[t],r=e;if(i&&(e=this.getFormattedHeaderValue(t,e)),s)if("select"==s.headInputType||"checkcombobox"==s.headInputType)s.setValue(e);else if("checkbox"==s.headInputType)s.checked!=a.D.getBoolean(e)&&(s.click(),s.checked=a.D.getBoolean(e));else if("input"==s.headInputType){if(s.value!=e){s.value=e;var n=a.D.getGlobalFunction(s.getAttribute("changeFuncName"),this.scope_id);if("function"==typeof n)try{n.call(s,s.value,s.getAttribute("colId"))}catch(t){}}}else"user"==s.headerInputType&&s.setValue(e);else{this.headerDataObj&&t&&(this.headerDataObj[t].value=r);var l=o.getElementsByTagName("nobr")[0];l?l.innerHTML=e:o.innerHTML="<nobr>"+e+"</nobr>"}o.setAttribute("value",e);for(var h=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],d=WebSquare.Elem.api.getElementsByTagName(h,"w2:column"),u=0;u<d.length;u++){var p=d[u];if(t==p.getAttribute("id")){p.setAttribute("value",e);break}}}},w.prototype.setHeaderNodeSet=function(t,e,i,o){if(this.getHeaderLayer(t)){var s=this.headerObj[t];s&&("select"!=s.headInputType&&"checkcombobox"!=s.headInputType||s.setNodeSet(e,i,o))}},w.prototype.setHeaderUserObject=function(t,e){this.headerObj[t]=e,e.headerInputType="user";var i=this.getHeaderLayer(t);i.innerHTML="",i.appendChild(e.getContent())},w.prototype.getHeaderValue=function(t){var e="";if(t&&(e=this.getHeaderLayer(t)),e){if(this.options.titleAuto&&"text"==e.getAttribute("inputtype")){var i=e.getElementsByTagName("NOBR")[0];return null!=i.textContent?i.textContent:i.innerHTML||""}var o=this.headerObj[t];if(o){var s="";return"select"==o.headInputType||"checkcombobox"==o.headInputType?s=o.getValue():"checkbox"==o.headInputType?s=!o.indeterminate&&o.checked:"input"==o.headInputType?s=o.value:"user"==o.headerInputType&&(s=o.getValue()),s}if(a.D.getBoolean(e.getAttribute("usefilter")))return e.getAttribute("value");var r=a.D.first(e),n=r.getElementsByTagName("NOBR")[0];if(n)r=n;else for(n=r;n&&"NOBR"!=n.tagName;){if("TD"==n.tagName){r=a.D.first(n);break}n=a.D.first(n)}return r?r.innerHTML:""}},w.prototype.getFormattedHeaderValue=function(t,e){var i=this.getHeaderLayer(t);if(i)return this.headerDataObj[i.getAttribute("header_id")]&&(e=this.headerDataObj[i.getAttribute("header_id")].formatter.format(e)),e},w.prototype.getHeaderValueList=function(t){for(var e=[],i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),o=0;o<i.length;o++)if(null==this.hiddenList[o]||1==t||1!=this.hiddenList[o]){var s=i[o],r=s.getAttribute("header_id");if(null!=r&&s)if(this.options.captionAuto||this.options.summaryOnlyAuto){if("text"!=s.getAttribute("inputtype"))continue;var n=s.getElementsByTagName("NOBR")[0];null!=n.innerText&&""!=n.innerText&&"\n"!=n.innerText?e.push(n.innerText):null!=n.textContent&&""!=n.textContent?e.push(n.textContent):null!=n.innerHTML&&""!=n.innerHTML?e.push(n.innerHTML):e.push("")}else{var l,h=this.headerObj[r];h&&("select"==h.headInputType||"checkcombobox"==h.headInputType?l=h.getValue():"checkbox"==h.headInputType?l=h.checked:"input"==h.headInputType?l=h.value:"user"==h.headerInputType&&(l=h.getValue()),e.push(l));for(var d=a.D.first(s),u=d;u&&"NOBR"!=u.tagName;){if("TD"==u.tagName){d=a.D.first(u);break}u=a.D.first(u)}d?e.push(d.innerHTML):e.push("")}}return e},w.prototype.getHeaderSpan=function(t,e){
for(var i=0;i<this.htmlInfo.head.rowArr.length;i++)for(var o=0;o<this.htmlInfo.head.rowArr[i].length;o++)if(this.htmlInfo.head.rowArr[i][o].id===t){if("row"===e)return this.htmlInfo.head.rowArr[i][o].rowSpan;if("col"===e)return this.htmlInfo.head.rowArr[i][o].colSpan}},w.prototype.getHeaderInputType=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].inputType},w.prototype.getSortableArr=function(){for(var t=[],e=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),i=0;i<e.length;i++)"true"===e[i].getAttribute("sortable")?t.push(!0):"false"===e[i].getAttribute("sortable")?t.push(!1):1==this.options.sortable?t.push(!0):t.push(!1);return t},w.prototype.getSortableStatus=function(){return this.headerSortStatusArr.slice(0)},w.prototype.clearHeaderSort=function(){this.headerSortStatusArr=[];for(var t=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table")),e=0;e<t.length;e++){var i=t[e].getAttribute("header_id");"_headerRowNumber"!==i&&"_headerRowStatus"!==i&&("false"===t[e].getAttribute("sortable")&&!0!==this.options.showSortableImage||this.setHeaderSortImage(i,0,0))}},w.prototype.drawHeaderSortImages=function(){for(var t=this.htmlInfo.head.rowArr,e=0;e<this.headerSortStatusArr.length;e++){var i="";if(t.length>1&&"top"==this.options.sortedImagePosition){for(var o=this.headerSortStatusArr[e].colID,s=this.getColumnIndex(o),r=t[0],a=0;a<r.length;a++)if(r[a]["@col"]==s){i=r[a].id;break}}else if(!(i=this.bodyToHeaderRelation[this.headerSortStatusArr[e].colID])){var n=this.headerSortStatusArr[e].colID,l=this.getColumnIndex(n);for(l--;l>=0&&(n=this.getColumnID(l),!(i=this.bodyToHeaderRelation[n]));)l--}i&&this.setHeaderSortImage(i,this.headerSortStatusArr[e].sortOrder,e+1)}},w.prototype.setHeaderSortImage=function(t,e,i){var o=this.getElementById(this.id+"_"+t);if(null!=o){e=parseInt(e,10),i=parseInt(i,10);isNaN(i)||i<=0||this.headerSortStatusArr.length<2?i="":i+="",this._clearHeaderSortImage(o,"table"),this._clearHeaderSortImage(o,"div");var r="",n=this.options.showSortableImage;if(this.options.showSortableImage){var l=o.getAttribute("sortable");n=!!(r=l?a.D.getBoolean(l):this.options.sortable)}var h=o.getAttribute("inputType"),d="/WebSquare/"+this.options.pluginName+"/header/column[@inputType='"+h+"']/useFilter/@value",p=a.D.getBoolean(s.v.getConfiguration(d)),c=o.getAttribute("useFilter"),g=!1;if((c=""===c||"string"!=typeof c||a.D.getBoolean(c))&&(p||"true"==o.getAttribute("useFilter"))&&(g=!0),!0!==this.options.showSortableImage){var f;if(0!==e){f=a.D.first(o);var m=null,y=null,b=null;try{this._useCheckboxLabel(t)&&(y=document.createElement("div"),m=a.D.next(f),y.appendChild(m))}catch(t){}"nobr"==f.nodeName.toLowerCase()?(f=o.innerHTML,o.innerHTML=""):f=o.removeChild(f),this.headerObjArr[t]=f;var w=0,v="w2grid_head_sort_table_main",I="w2grid_head_sort_td",C="<table sort='sort' class='"+v+"'><tr><td></td><td class='"+I+" "+(D=1==e?"w2grid_head_sort_asc":"w2grid_head_sort_desc")+"'>"+i+"</td></tr></table>";"left"===this.options.sortedIconPosition&&(w=1,C="<table sort='sort' class='"+v+"'><tr><td class='"+I+" "+D+"'>"+i+"</td><td></td></tr></table>"),o.innerHTML=C;var x=o.getElementsByTagName("td");"string"==typeof f?x[w].innerHTML=f:(x[w].appendChild(f),m&&y&&(x[w].appendChild(y.removeChild(m)),y=null))}}else{var _=this.headerObj[t];_?_.render&&(_=_.render):_=o.getElementsByTagName("nobr")[0];m=null;var S=null;try{this._useCheckboxLabel(t)&&("left"===this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?(S="left",y=document.createElement("div"),m=a.D.prev(_),y.appendChild(m)):(y=document.createElement("div"),m=a.D.next(_),y.appendChild(m)))}catch(t){}try{g&&this.options.showSortableUseFilter&&(b=o.getElementsByTagName("input")[0])}catch(t){}_.parentNode.removeChild(_);var D="",R="";switch(e){case 0:!1!==n||r?(D="w2grid_head_sort_none",
R=WebSquare.language.getMessage("Grid_sort_asc")):(D="w2grid_head_sort_image_none",R="");break;case 1:D="w2grid_head_sort_asc",R=WebSquare.language.getMessage("Grid_sort_desc");break;case-1:D="w2grid_head_sort_desc",R=WebSquare.language.getMessage("Grid_sort_none");break;default:D="w2grid_head_sort_none",R=WebSquare.language.getMessage("Grid_sort_asc")}if(this.options.sortHeaderDiv){D+="_btn";o.innerHTML="<div sort='sort' class='w2grid_head_sort_div_main_outer'><button class='w2grid_head_sort_div_main_btn "+D+"' >"+R+"</button></div>";x=o.getElementsByTagName("div");var L=o.getElementsByTagName("button")[0];if(x[0].insertBefore(_,L),m&&y)this._useCheckboxLabel(t)&&"left"!==this.headerInfoHash2[t].getAttribute("checkboxLabelPosition")?x[0].insertBefore(y.removeChild(m),L):x[0].insertBefore(y.removeChild(m),_),y=null;else if(g&&this.options.showSortableUseFilter){F=x[0].parentElement;(A=document.createElement("div")).appendChild(x[0]),A.appendChild(b),this.addClass(A,"w2grid_head_sort_div_main_outer_box"),F.appendChild(A),this.addClass(b,"w2grid_customFilter_sortable_open"),a.D.isIE()&&parseInt(s.v.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}else{var T="w2grid_head_sort_div_main",k="w2grid_head_sort_div_sub";if("left"===this.options.sortedIconPosition&&(T="w2grid_head_sort_div_main_left"),!0===this.options.showSortableImage&&(k="left"===this.options.sortedIconPosition?"w2grid_head_sort_div_sub_sortable_image_left":"w2grid_head_sort_div_sub_sortable_image"),o.innerHTML="<div sort='sort' class = '"+T+" "+D+"'><div class = '"+k+"'>"+i+"</div></div>",(x=o.getElementsByTagName("div"))[0].appendChild(_),m&&y)"left"===S?x[0].insertBefore(y.removeChild(m),_):x[0].appendChild(y.removeChild(m)),y=null;else if(g&&this.options.showSortableUseFilter){var A,F=x[0].parentElement;(A=document.createElement("div")).appendChild(x[0]),A.appendChild(b),this.addClass(A,"w2grid_head_sort_div_main_outer_box"),F.appendChild(A),this.addClass(b,"w2grid_customFilter_sortable_open"),a.D.isIE()&&parseInt(s.v.browserVersion(),10)<8?this.addClass(x[1],"w2grid_head_sort_usefilter_div_main_ie"):this.addClass(x[1],"w2grid_head_sort_usefilter_div_main")}}}}else u.k.printLog("headerId : "+t+"를 찾을 수 없습니다.["+this.id+"]")},w.prototype._clearHeaderSortImage=function(t,e){var i=t.getElementsByTagName(e);if(i.length>0&&"sort"==i[0].getAttribute("sort")){var o=t.getAttribute("header_id"),s=this.headerObjArr[o];if(s)if("string"==typeof s)t.innerHTML=s;else{var r=null,n=null;try{this._useCheckboxLabel(o)&&(n=document.createElement("div"),r=a.D.next(s),n.appendChild(r))}catch(t){}s=t.appendChild(s),r&&n&&(t.appendChild(n.removeChild(r)),n=null),t.removeChild(s.previousSibling)}}},w.prototype.getColIdByHeaderId=function(t){return this.headerToBodyRelation[t]},w.prototype.setHeaderHide=function(t){if(t=a.D.getBoolean(t),this.options.hideHeader!=t){this.options.hideHeader=t;var e=this.getElementById(this.id+"_head_table"),i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));if(t){e.style.display="none";for(var o=0;o<i.length;o++){var s=i[o].getAttribute("class");null!=s&&(i[o].setAttribute("data-bkclass",s),i[o].removeAttribute("class"))}}else{e.style.display="";for(o=0;o<i.length;o++){var r=i[o].getAttribute("data-bkclass");null!=r&&(i[o].setAttribute("class",r),i[o].removeAttribute("data-bkclass"))}}this.refresh(),this.setScrollYHeight()}},w.prototype.setHeaderDisabled=function(t,e){try{e=a.D.getBoolean(e);var i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?(o.setDisabled?o.setDisabled(e):o.render?o.render.disabled=e:o.disabled=e,i.disabled=e):i.disabled=e}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype._getHeaderDisabled=function(t){try{var e=!1,i=this.getHeaderLayer(t);if(i){var o=this.headerObj[t];o?o.getDisabled?e=o.getDisabled():o.render?e=o.render.disabled:o.disabled&&(e=o.disabled):i.disabled&&(e=i.disabled)}return e}catch(t){
r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderID=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,s=0;s<e.children.length;s++){var a=e.children[s].children;if((o+=a.length)>t){var n=a[i];return n?n.id.replace(this.id+"_",""):null}i-=a.length}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderIDArr=function(t){try{if("string"==typeof t)return t;var e=this.head_table;if(!e)return null;for(var i=t+=this.defaultColCnt,o=0,s=[],a=0;a<e.children.length;a++){var n=e.children[a].children;if((o+=n.length)>t){var l=n[i];l&&s.push(l.id.replace(this.id+"_",""))}else i-=n.length}return s}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderIndex=function(t){try{if("number"==typeof t)return t;var e=this.head_table;e||(e=this.getElementById(this.id+"_head_table"));for(var i=0,o=0;o<e.children.length;o++){for(var s=e.children[o].children,a=0;a<s.length;a++){if(s[a].id.replace(this.id+"_","")==t)return i+a-this.defaultColCnt}i+=s.length}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderRowIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return e},w.prototype.getHeaderColIndex=function(t){for(var e=0;e<this.htmlInfo.head.rowArr.length;e++)for(var i=0;i<this.htmlInfo.head.rowArr[e].length;i++)if(this.htmlInfo.head.rowArr[e][i].id===t)return this.htmlInfo.head.rowArr[e][i].colIndex},w.prototype.getHeaderColID=function(t,e){try{void 0!==e&&null!=e||(e={});for(var i="",o=this.struct.head.rowArr,s=!0===e.firstRow?1:o.length,a=0;a<s;a++){for(var n=o[a],l=0;l<n.length;l++)if(n[l].colIndex===t){i=n[l].id;break}if(i)break}return i}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setHeaderStyle=function(t,e,i){try{var o,s=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus";else if("number"==typeof t){t=(o=s[t+this.defaultColCnt]).getAttribute("header_id")}for(var a=0;a<s.length;a++)(o=s[a]).getAttribute("header_id")==t&&WebSquare.style.setStyle(o,e,i)}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.setHeaderClass=function(t,e){try{var i,o=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus";else if("number"==typeof t){t=(i=o[t+this.defaultColCnt]).getAttribute("header_id")}for(var s=0;s<o.length;s++)(i=o[s]).getAttribute("header_id")==t&&(this.addClass(i,e),this.headerCellClassObj[t]=e)}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.getHeaderClass=function(t){try{var e=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus";else if("number"==typeof t){t=e[t+this.defaultColCnt].getAttribute("header_id")}for(var i=0;i<e.length;i++)if(e[i].getAttribute("header_id")==t)return this.headerCellClassObj[t]}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.removeHeaderClass=function(t,e){try{var i,o=this.getElementById(this.id+"_head_table").getElementsByTagName("th");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus";else if("number"==typeof t){t=(i=o[t+this.defaultColCnt]).getAttribute("header_id")}for(var s=0;s<o.length;s++)(i=o[s]).getAttribute("header_id")==t&&(this.removeClass(i,e),delete this.headerCellClassObj[t])}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.drawHeader=function(t){try{if(!this.head_table)return;null==this.headerDataObj&&this.initHeaderDataObj();var e=this.head_table.getElementsByTagName("th");if(this.headerTempSum=[],t){t=this.getColumnID(t)
;for(var i=0;i<e.length;i++){if(n=(a=e[i]).getAttribute("header_id"))if(l=this.headerDataObj[n])if("expression"==l.inputType){var o=l.expression.match(/headercol(sum|avg|max|min)\s*\([^\)]*/g);if(o)for(var s=0;s<o.length;s++)o[s].split("(")[1].wq_replaceAll("'","").wq_replaceAll('"',"").wq_trim()==t&&(l.value=new Function("_this","return "+l.expression)(this),isNaN(l.value)&&"NaN"!=l.NaNFormat&&(l.value=l.NaNFormat),a.innerHTML="<nobr>"+l.formatter.format(l.value)+"</nobr>")}else""===l.displayFormat||"number"!=l.dataType||"text"!=l.inputType&&"textarea"!=l.inputType&&"button"!=l.inputType&&"textImage"!=l.inputType||(a.innerHTML="<nobr>"+l.formatter.format(l.value)+"</nobr>")}}else for(i=0;i<e.length;i++){var a,n,l;if(n=(a=e[i]).getAttribute("header_id"))if(l=this.headerDataObj[n])if("expression"==l.inputType){try{l.value=new Function("_this","return "+l.expression)(this),isNaN(l.value)&&"NaN"!=l.NaNFormat&&(l.value=l.NaNFormat)}catch(t){}a.innerHTML="<nobr>"+l.formatter.format(l.value)+"</nobr>"}else""===l.displayFormat||"number"!=l.dataType||"text"!=l.inputType&&"textarea"!=l.inputType&&"button"!=l.inputType&&"textImage"!=l.inputType||(a.innerHTML="<nobr>"+l.formatter.format(l.value)+"</nobr>")}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.initHeaderDataObj=function(){try{var t=this.head_table.getElementsByTagName("th");this.headerDataObj={};for(var e=0;e<t.length;e++){var i=t[e],o={};o.id=i.getAttribute("header_id");var a=i.getAttribute("expression")||"";if(""!=a&&(a=(a=(a=(a=a.replace(/[sS][uU][mM][\s]*[(]/g,"_this.headercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.headercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.headercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.headercolmin( ")),o.value=i.getAttribute("value")||"",this.options.useLocale){var n=i.getAttribute("localeRef");if(n){var l=this.getLocaleValue(n);l&&(o.value=l)}}o.inputType=i.getAttribute("inputType"),o.dataType=i.getAttribute("dataType")||"text",o.expression=a,o.displayFormat=i.getAttribute("displayFormat")||"",o.displayFormatter=i.getAttribute("displayFormatter")||"",o.formatter=WebSquare.format.createFormatter(o.dataType,o.displayFormat,o.displayFormatter,null,null,null,this.scope_id,this.id),o.NaNFormat=i.getAttribute("NaNFormat")||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==o.NaNFormat&&(o.NaNFormat=""),this.headerDataObj[o.id]=o}}catch(t){r.w.printStackTrace(t,null,this)}},w.prototype.headercolsum=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].sum){var e="";if(this.groupbyStatus.grouped);else{var i=this.getColumnAllDataArray(t);e=a.D.sum(i)}this.headerTempSum[t].sum=e}return a.D.setPrecision(this.headerTempSum[t].sum)},w.prototype.headercolavg=function(t){var e=this.getColumnAllDataArray(t);this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={});var i="";if(this.groupbyStatus.grouped)return i;if(void 0===this.headerTempSum[t].sum){if(e.length>0){for(var o=0;o<e.length;o++)""==e[o].replace(/^\s+|\s+$/g,"")&&(e[o]="0");i=a.D.sum(e)}this.headerTempSum[t].sum=i}return""==this.headerTempSum[t].sum?"":this.headerTempSum[t].sum/e.length},w.prototype.headercolmax=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped);else{for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e<s)&&(e=s)}e=null==e?"":e,e=a.D.setPrecision(e)}this.headerTempSum[t].max=e}return this.headerTempSum[t].max},w.prototype.headercolmin=function(t){if(this.headerTempSum||(this.headerTempSum=[]),this.headerTempSum[t]||(this.headerTempSum[t]={}),void 0===this.headerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped);else{
for(var i=this.getColumnAllDataArray(t),o=0;o<i.length;o++){var s=parseFloat(i[o]);isNaN(s)||(null==e||e>s)&&(e=s)}e=null==e?"":e,e=a.D.setPrecision(e)}this.headerTempSum[t].min=e}return this.headerTempSum[t].min},w.prototype._getMatchedHeaderId=function(t){try{return this.bodyToHeaderRelation[t]}catch(t){r.w.printStackTrace(t,null,this)}};var v=function(t,e){try{this.options={id:"",value:"",inputType:"text",useFilter:!1,textAlign:""},this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),this.id=this.options.id}catch(t){r.w.printStackTrace(t,null,this)}};w.prototype._setHeaderInfo=function(t,e){this.headerInfoHash2[t]=e},w.prototype.setCheckboxHeader=function(t){try{"function"==typeof this.cellInfoHash[t].checkHeader&&this.cellInfoHash[t].checkHeader()}catch(t){r.w.printStackTrace(t,null,this)}},v.prototype.setOptions=function(t){this.options.useFilter=a.D.getBoolean(s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/header/column/useFilter/@value")),this.options.hideCustomFilter=a.D.getBoolean(s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/header/column/hideCustomFilter/@value"));var e=[];for(var i in this.options)e[i.toLowerCase()]=i;var o=this.mainGrid.headerConfigOptions[t.getAttribute("id")]||{};for(var i in o)this.options[i]=o[i];var r=WebSquare.Parser.parseAttribute(t);for(var n in r){var l=r[n];"class"==n?this.options.className=l:""!=String(l).wq_trim()&&(e[n]&&(n=e[n]),"boolean"==typeof this.options[n]?l=a.D.getBoolean(l):"number"==typeof this.options[n]&&(l=a.D.getNumber(l)),this.options[n]=l)}},w.prototype._useCheckboxLabel=function(t){try{var e=this.getHeaderLayer(t);return"checkbox"===e.getAttribute("inputType")&&(e.getAttribute("checkboxLabel")||e.getAttribute("checkboxlabel"))}catch(t){r.w.printStackTrace(t,null,this)}};var I=function(){};I.prototype.getLastFocusedCell=function(){if(this.focusedCell.length>0)return this.focusedCell[this.focusedCell.length-1];var t={focusedRowIndex:-1,focusedColIndex:null};return this.options.groupbyDisplayRowIndex&&(t.groupbyDisplayRowIndex=-1),t},I.prototype.getFocusedRowIndex=function(){return this._getFocusedRowIndex(this.options.groupbyDisplayRowIndex)},I.prototype._getFocusedRowIndex=function(t){return this.getLastFocusedCell()[!0===t&&this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex"]},I.prototype.getFocusedRealRowIndex=function(){return this.getLastFocusedCell().focusedRealRowIndex},I.prototype.getAllFocusedIndex=function(){for(var t=this.focusedCell,e=[],i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<t.length;o++){var s={};s.col=t[o].focusedColIndex,s.row=t[o][i],e.push(s)}return e},I.prototype.getAllFocusedRowIndex=function(){for(var t=[],e={},i=this.options.groupbyDisplayRowIndex?"groupbyDisplayRowIndex":"focusedRowIndex",o=0;o<this.focusedCell.length;o++){e[this.focusedCell[o][i]]=!0}for(var s in e)t.push(parseInt(s,10));return t},I.prototype.getFocusedColumnIndex=function(){return this.getLastFocusedCell().focusedColIndex},I.prototype.getFocusedColumnID=function(){return this.getColumnID(this.getFocusedColumnIndex())},I.prototype.getFocusedRowStatus=function(){var t=this._getFocusedRowIndex(!0);return-1==t?null:this.dataList.getRowStatus(t)},I.prototype.setFocusedCell2=function(t,e,i,o){try{o=o||{};i=a.D.getBoolean(i),e=this.getColumnIndex(e);var s=!1;try{s=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){s=!1}var n=this.getLastFocusedCell(),l=i&&n.focusedColIndex==e;if((this.___getEditReadOnly(t,e)||this._getEditDisabled(t,e))&&(l=!1),this.editedCell&&!this.editedCell.handleEndEdit(null,l))return!1;if(!s&&"native"!==this.options.drawType){var h=this._getVisibleLastIndex(this.lastIndex+1),d=this.getDataLength(),u=this.rowIndex+this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex)
;!0===this.hiddenRowObj.init&&this.rowIndex===d-h&&(u=d-this._getVisibleLastIndex(1));var p=this.rowIndex,c=this.hiddenCellObj.length>0;if(c&&t===u&&(u=Math.max(u-1,0)),t<p||t>u){var g=t<p?t-p:t-u;if(t>u&&this.hasSubtotal){for(var f in this.rollbackCommitFlag=!1,this.subtotalTableList){if(u<d-1)this.dataList._getCellData(u,f)!=this.dataList._getCellData(u+1,f)&&g++}this.rollbackCommitFlag=!0}var m=this.rowIndex+g;m=(m=m<0?0:m)>d-h?d-h:m,c&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(m=Math.min(m,this.lastTopRowIndex)),m!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!0,m=Math.max(0,m),isNaN(this.lastTopRowIndex)||null==this.lastTopRowIndex||(m=Math.min(m,this.lastTopRowIndex)),this.drawData(m,0,"keymove",l),!0===this.hiddenRowObj.init||c||(this.lastIndex=this.getLastIndex(this.lastDisplayedRow)))}}var y=t-(this.rowIndex>0?this.rowIndex:0),b=this.data_td_list[e+y*this.oneRowDataLength];return!!b&&("rollback"==this.__setFocusedCell({ctrl:!1},b,{editMode:i,dont_hide:l,dont_fixScroll:!0,tabDirection:o.tabDirection})&&this._setFocusedCell(n.focusedRowIndex,n.focusedColIndex,!0,{tabDirection:o.tabDirection}),!0)}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype.setFocusedCell=function(t,e,i,o){try{(o=o||{}).groupbyDisplayRowIndex=this.options.groupbyDisplayRowIndex;var s=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),a=t;if(s&&(a=this.getDisplayRowIndex(t)),!isNaN(a))return this._setFocusedCell(a,e,i,o)}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype._setFocusedCell=function(t,e,i,o){try{if(o=o||{},"none"==this.options.focusMode)return;if(!0===o.groupbyDisplayRowIndex&&(t=this._getGroupbyGroupedRowIndex(t,!0)),0==arguments.length||1==arguments.length){i=0!=arguments.length&&arguments[0];var s=this.colIndexInfo.body.colInfo.colIndexMatch;if(this.focusedCell.length>0)t=this.focusedCell[this.focusedCell.length-1].focusedRowIndex,e=this.focusedCell[this.focusedCell.length-1].focusedColIndex;else if(this.lastFocusedCell&&null!=this.lastFocusedCell.focusedColIndex&&this.lastFocusedCell.focusedRowIndex>=0)t=this.lastFocusedCell.focusedRowIndex,e=this.lastFocusedCell.focusedColIndex;else{var n=this.getLastFocusedCell();t=n.focusedRowIndex;if(null==(e=n.focusedColIndex)||-1==t)return this.focusedCell=[{focusedRowIndex:0,focusedColIndex:s.length-this.defaultColCnt-1}],this.moveHorizontal(null,"home"),void(i&&this._setFocusedCell(!0))}}var l=this.getDataLength(),h=this.getDataLength()-this._getVisibleLastIndex(1);if(e=this.getColumnIndex(e),t<0||t>h||e<0||e>=this.oneRowDataLength)return;var d=!1;try{d=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){d=!1}if(i=a.D.getBoolean(i),this.delayedDraw({rowIndex:t}))return this.focusedCell=[{focusedRowIndex:t,focusedColIndex:e}],this._linkedDataList?this._linkedDataList.setRowPosition(t):this._dataList.setRowPosition(t),void this._dataList.setColumnPosition(this.getColumnID(e));var u=this.getElementById(this.id+"_scrollY_div");"native"!==this.options.drawType&&u&&0==u.scrollTop&&this.rowIndex>0&&(u.scrollTop=this.lastScrollYTop);var p=t-(this.rowIndex>0?this.rowIndex:0);if(!d&&"native"!==this.options.drawType)if(p<0)this.scrollEvent=!1,u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t),this.drawData(t,0),p=0;else if(this.options.showLastRow&&p-this.lastIndex==1&&""===this.options.visibleRowNum);else if(p>this._getVisibleTrRowIndex(this.lastIndex,this.rowIndex)){var c=this._getVisibleLastIndex(this.lastIndex+1);this.hiddenCellObj.length>0&&!isNaN(this.lastTopRowIndex)&&null!=this.lastTopRowIndex&&(c=l-this.lastTopRowIndex);var g=t+c>l?l-c:t;this.hiddenCellObj.length>0&&(g=Math.max(0,g)),g!==this.rowIndex&&(this.scrollEvent=!1,this.checkScrollEnd=!o.isSort||"string"!=typeof this.options.filterFocusMode||"followfocus"!==this.options.filterFocusMode.toLowerCase(),u.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(g),
g>this.rowIndex+c-1&&(this.adjustDraw_keepTop=!0),this.drawData(g,0),p=t-this.rowIndex)}var f=this.data_td_list[e+p*this.oneRowDataLength];if(f){for(var m=5;"native"!==this.options.drawType&&this.hiddenCellObj.length>0&&0===f.offsetHeight&&m>0;){this.lastTopRowIndex++;var y=this.getElementById(this.id+"_size_y"),b=(u=this.getElementById(this.id+"_scrollY_div"),y.offsetHeight);b<1e6&&(b=parseInt(y.style.height,10)),y.style.height=u.offsetHeight+this.oneRowScrollHeight*this.lastTopRowIndex+"px",this.drawData(this.lastTopRowIndex,0),p--,f=this.data_td_list[e+p*this.oneRowDataLength],m--}o.editMode=i,this.__setFocusedCell({ctrl:!1},f,o)}}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype.removeFocusedCell=function(){try{this.lastFocusedCell=this.getLastFocusedCell(),this.applyFocusedCellOut(),this.focusedCell=[],this._dataList.setRowPosition(null)}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype.applyFocusedCell=function(t,e){if(e||(this.applyFocusedCellOut(),this.focusedCell=[]),null!=t){this.applyFocusedCellIn(t);var i={};i.focusedTd=t,this.focusedCell.push(i)}},I.prototype.__setFocusedCell=function(t,e,i){i=i||{};var o=t.ctrlKey||i.ctrled,s=t.shiftKey||i.shifted,r=e.className;if(this.options.focusDefaultColumn){if(r.indexOf("_groupby")>=0||r.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1}else if(r.indexOf("_rowNum")>=0||r.indexOf("_rowStatus")>=0||r.indexOf("_groupby")>=0||r.indexOf("Subtotal")>=0)return null!=this.editedCell&&this.editedCell.handleEndEdit(),!1;var n=parseInt(e.getAttribute("tdIndex")),l=parseInt(n/this.realRowDataLength),h=parseInt(e.getAttribute("colIndex")),u=l+this.rowIndex,p=this._getGroupbyDisplayRowIndex(u),c=u;this.isDrillDown&&this._dataList.options.depthColumn&&(c=this.getRealRowIndex(u));var g=n%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),f=this.getColumnID(g),m=!0,y=this.getLastFocusedCell();if(this.focusedCell.length>0&&y.focusedTd==e&&(m=!1),m&&this.editedCell&&!this.editedCell.handleEndEdit(t,!!i.dont_hide,{focuseChanged:m}))return!1;var b=this._linkedDataList?this._linkedDataList.setRowPosition(p):this._dataList.setRowPosition(c),w=this._dataList.setColumnPosition(f);if(!1===b||!1===w)return!1;var v=this._getFocusedRowIndex(),I=this.getFocusedColumnIndex(),C=!(a.D.getBoolean(this.options.useCtrlKey)&&o||a.D.getBoolean(this.options.useShiftKey)&&s),x=!1;if(C&&a.D.getBoolean(i.allowContextMenuMultiCell)&&(C=!1,x=!0,this.focusedCell)){for(var _=!1,S=0;S<this.focusedCell.length;S++)if(this.focusedCell[S].focusedTd==e){_=!0;break}_||(C=!0,x=!1)}if(C&&(this.applyFocusedCellOut(),this.focusedCell=[]),i.tabDirection||(this.focusedCellLinkIndex=-1,this.focusedCellLinkLength=0),this.focusedCell.length>0&&a.D.getBoolean(this.options.useShiftKey)&&s){var D=this.focusedCell[0],R=D.focusedRowIndex,L=D.focusedColIndex;this._applyFocusedMultiCell(R,L,u,g,i.ignoreFocusMode),i.dont_fixScroll||(h>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds()}else if(!x){var T;if(this.getCellInfo(e).options.blockSelect)return;var k={focusedTd:e,focusedRealRowIndex:c,focusedRowIndex:T=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>u-this.rowIndex||this.options.lastFixedRow>0&&u-this.rowIndex>this.lastIndex-this.options.lastFixedRow?u-this.rowIndex:u,focusedColIndex:g};this.options.groupbyDisplayRowIndex&&(k.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(T)),this.focusedCell.push(k),i.dont_fixScroll||(h>=this.getFixedColumnLastIndex()&&this.fixScrollLeftDirection(),this.fixScrollRightDirection()),this.options.lazyDrawHiddenColumn&&this.hideInvisibleTds();var A="native"!==this.options.drawType&&!!i.editMode;if(this.applyFocusedCellIn(e,A,i.tabDirection,i.ignoreFocusMode),"linear"===this.options.focusFlow&&!0===i.editMode&&(this.focusedByApi=!1),y=this.getLastFocusedCell(),i.ignoreFocusMode||"cell"==this.options.focusMode){
for(S=this.focusedCell.length-2;S>=0;S--)if(this.focusedCell[S].focusedTd==y.focusedTd){this._applyFocusedCellOut(this.focusedCell[S]),this.focusedCell.pop(),this.focusedCell.splice(S,1);break}}else if("both"==this.options.focusMode){for(S=this.focusedCell.length-2;S>=0;S--)if(this.focusedCell[S].focusedTd==y.focusedTd){this._applyFocusedCellOut(this.focusedCell[S]),this.focusedCell.pop(),this.focusedCell.splice(S,1),this.changeFocusedCellPosition(this.rowIndex);break}}else if("row"==this.options.focusMode){var F=y.focusedTd?y.focusedTd.parentNode:null;for(S=this.focusedCell.length-2;S>=0;S--){var E=this.focusedCell[S];if(null!=E.focusedTd){var M=E.focusedTd.parentNode;for(l=parseInt(M.getAttribute("trIndex"));l>0;)l--,M=a.D.prev(M);do{if(M==F){this._applyFocusedCellOut(this.focusedCell[S]),this.focusedCell.pop(),this.focusedCell.splice(S,1),this.changeFocusedCellPosition(this.rowIndex,!0);break}if(!(M=a.D.next(M)))break}while("0"!=M.getAttribute("trIndex"))}}}}var O=this.getCellInfo(g);if("custom"==O.options.inputType&&(O=O.cellManagerHashByRowIndex[u]),(v=this._getGroupbyDisplayRowIndex(v))==(u=this._getGroupbyDisplayRowIndex(u))&&I==g||d.B.fireEvent(this,"oncellindexchange",u,g,v,I),v!=u&&d.B.fireEvent(this,"onrowindexchange",u,v),I!=g&&d.B.fireEvent(this,"oncolumnindexchange",g,I),i.editMode)if("native"===this.options.drawType){var N=this.uuid,B=e.id,G=e.parentNode,H=this.id+"_dataLayer",W=document.getElementById(H),V=Math.max(G.offsetTop-W.offsetHeight+G.offsetHeight*this.oneRowLength+2,0);a.D.setTimeout((function(){document.getElementById(H).scrollTop=V,a.D.setTimeout((function(){var t=WebSquare.idCache[N],e=document.getElementById(B);t.setEditMode(e)}),{key:this.id+"__setFocusedCell_after",delay:50})}),{key:this.id+"__setFocusedCell",delay:50})}else this.setEditMode(e)},I.prototype.applyFocusedCellOut=function(){if(this.focusedCell.length>0)for(var t=0;t<this.focusedCell.length;t++){var e=this.focusedCell[t];this._applyFocusedCellOut(e)}},I.prototype._applyFocusedCellOut=function(t){if("row"==this.options.focusMode||"both"==this.options.focusMode){if(null==(o=t.focusedTd)&&this.options.showLastRow){var e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&this.removeFocusRowStyle(o)}if("cell"==this.options.focusMode||"both"==this.options.focusMode){var o;if(null==(o=t.focusedTd)&&this.options.showLastRow){e=t.focusedRowIndex,i=t.focusedColIndex;o=this.data_td_list[i+e*this.oneRowDataLength]}null!=o&&("linear"!=this.options.focusFlow&&o.setAttribute("tabIndex",-1),this.removeClass(o,"focusedTd"),(!this.options.focusDefaultColumn||t.focusedColIndex>=0)&&(this.options.fixedRow>0&&t.focusedRowIndex-this.rowIndex>=0&&this.options.fixedRow>t.focusedRowIndex-this.rowIndex||this.options.lastFixedRow>0&&t.focusedRowIndex-this.rowIndex>this.lastIndex-this.options.lastFixedRow?this.applyCellStyleOptions(t.focusedRowIndex-this.rowIndex,t.focusedColIndex,!0):this.applyCellStyleOptions(t.focusedRowIndex,t.focusedColIndex,!0)),this.options.rowMouseOver&&this.addRowOverStyle(this.overElem))}},I.prototype.removeFocusRowStyle=function(t){if(null!=t){for(var e=t.parentNode,i=parseInt(e.getAttribute("trIndex"));i>0;)i--,e=a.D.prev(e);for(var o=a.D.first(e),s=parseInt(o.getAttribute("tdIndex")),r=(i=parseInt(s/this.realRowDataLength),0);r<this.realRowDataLength;r++){var n=r;r>=this.defaultColCnt&&(n=Math.floor((r-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(r-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var l=i*this.realRowDataLength+n,h=this.all_data_td_list[l];if(this.removeClass(h,"focusedTr"),r<this.defaultColCnt){var d=h.className;d.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""==this.options.rowNumBackgroundColor&&(h.style.backgroundColor="",h.removeAttribute("style_bak")):d.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(h.style.backgroundColor="",h.removeAttribute("style_bak"))}else{
var u=parseInt(h.getAttribute("tdIndex")),p=i+this.rowIndex,c=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(p,c,!0)}}}},I.prototype.applyFocusedCellIn=function(t,e,i,o){if("none"!=this.options.focusMode){var s=this.getCellInfo(t.getAttribute("col_id")),r=s.options.inputType||"text";if(this.focusedByApi=!0,s.options.embeddedInput)if(e){var n=this.getElemRowIndex(t);if("text"!=r&&"link"!=r||!this._getEditDisabled(n,s.id)&&!this.__getEditReadOnly(t,n))this.getInput(s,t).focus();else t.focus()}else{if(i)this.getInput(s,t).focus()}else{var l=!1;try{var h=this.focusedCell[this.focusedCell.length-1].focusedRealRowIndex-this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&h>=0&&this.options.fixedRow>h||this.options.lastFixedRow>0&&h-this.rowIndex>this.lastIndex-this.options.lastFixedRow)&&(l=!0)}catch(t){}if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum||this.___getEditReadOnly(h,t.getAttribute("col_id"))&&!0===this.options.readOnlyTabIgnore||t.setAttribute("tabIndex",0),"custom"==r&&this.options.senseReader){n=this.getElemRowIndex(t);var d=s.cellManagerHashByRowIndex[n];r=d?d.options.inputType:"text"}if(e&&("text"==r||"secret"==r||"textarea"==r||"textImage"==r||"calendar"==r)||l);else if("button"==r&&this.options.senseReader){var u=t.getElementsByTagName("button");(u=u[0]).focus()}else if("link"==r&&this.options.senseReader){(c=(c=t.getElementsByTagName("a"))[0]).focus()}else if("checkbox"==r&&this.options.senseReader){t.getElementsByTagName("input")[0].focus()}else if("user"==r&&this.options.senseReader){var p,c=t.getElementsByTagName("a");if(-1!=this.focusedCellLinkIndex)if("right"==i){for(var g=0;g<c.length;g++)document.activeElement==c[g]&&(this.focusedCellLinkIndex=g);p=this.focusedCellLinkIndex+1}else p=this.focusedCellLinkIndex-1;else{if("right"==i)p=0;else if(null==i){if(p=0,document.activeElement)for(g=0;g<c.length;g++)document.activeElement==c[g]&&(p=g)}else p=c.length-1;this.focusedCellLinkLength=c.length}c=c[p],this.focusedCellLinkIndex=p,c?i&&c.focus():this._getEditDisabled(n,s.id)||this.__getEditReadOnly(t,n)?t.blur():t.focus()}else if("select"!=r||1!=this.options.senseReader||"ul"!=s.options.tableRender||this.isVirtualCursor())a.D.isIE(8)?"none"!=t.parentElement.style.display&&t.focus():t.focus();else{(c=(c=t.getElementsByTagName("a"))[0]).focus()}}var f=!1;try{f=this.lastEvent&&void 0!==this.lastEvent.type&&"unknown"!=typeof this.lastEvent.type&&("focus"==this.lastEvent.type||"focusin"==this.lastEvent.type)}catch(t){f=!1}if(!f&&!e&&"native"!==this.options.drawType){var m=this.getElementById(this.id+"_dataLayer");m.scrollLeft=0,m.scrollTop=0}var y=this.options.focusMode;if(o&&(y="cell"),"row"!=y&&"both"!=y||this.setFocusRowStyle(t),"cell"==y||"both"==y){this.addClass(t,"focusedTd");var b=parseInt(t.getAttribute("tdIndex")),w=parseInt(b/this.realRowDataLength),v=w+this.rowIndex;(this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>w||this.options.lastFixedRow>0&&w>this.lastIndex-this.options.lastFixedRow)&&(v=w);var I=b%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);if(this.options.focusDefaultColumn&&I<0)return;this.applyCellStyleOptions(v,I,null,o)}}},I.prototype.setFocusRowStyle=function(t){if(null!=t){for(var e=t.parentNode,i=parseInt(e.getAttribute("trIndex"));i>0;)i--,e=a.D.prev(e);for(var o=a.D.first(e),s=parseInt(o.getAttribute("tdIndex")),r=(i=parseInt(s/this.realRowDataLength),0);r<this.realRowDataLength;r++){var n=r;r>=this.defaultColCnt&&(n=Math.floor((r-this.defaultColCnt)/this.columnOrder.length)*this.columnOrder.length+this.columnOrder[(r-this.defaultColCnt)%this.columnOrder.length]+this.defaultColCnt);var l=i*this.realRowDataLength+n,h=this.all_data_td_list[l];if(this.addClass(h,"focusedTr"),r<this.defaultColCnt){var d=h.className;d.indexOf(this.options.bodyTdClass+"_rowNumber")>=0?""==this.options.rowNumBackgroundColor&&(h.style.backgroundColor=this.options.selectedRowColor.wq_trim(),
h.removeAttribute("style_bak")):d.indexOf(this.options.bodyTdClass+"_rowStatus")>=0&&(h.style.backgroundColor=this.options.selectedRowColor.wq_trim(),h.removeAttribute("style_bak"))}else{var u=parseInt(h.getAttribute("tdIndex")),p=i+this.rowIndex,c=u%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.applyCellStyleOptions(p,c)}}}},I.prototype.outFocusedCell=function(){this.removeFocusedCell()},I.prototype.getFocusedCellData=function(){var t=this._getFocusedRowIndex(),e=this.getFocusedColumnIndex(),i=this.getColumnID(e);return t>-1?this.dataList._getCellData(t,i):null},I.prototype.getFocusedRowData=function(){var t=this._getFocusedRowIndex();return t>-1?this.dataList.getRowData(t):null},I.prototype.getFocusedRowXML=function(){var t=this._getFocusedRowIndex(!0);return t>-1?this.dataList.getRowXML(t):null},I.prototype.removeRowFocus=function(t){for(var e=[],i=0;i<this.focusedCell.length;i++)t!=this.focusedCell[i].focusedRowIndex?e.push(this.focusedCell[i]):this._applyFocusedCellOut(this.focusedCell[i]);this.focusedCell=e},I.prototype.setFocusedHeaderObj=function(t){if(this.getHeaderLayer(t)){var e=this.headerObj[t];if(e)switch(e.headInputType){case"checkcombobox":case"select":case"checkbox":case"input":e.focus()}}},I.prototype.focus=function(){try{var t=this.getLastFocusedCell(),e=-1!=t.focusedRowIndex?t.focusedRowIndex:0,i=null!=t.focusedColIndex?t.focusedColIndex:0;this._setFocusedCell(e,i,!1)}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype.setFocusedMultiCell=function(t,e,i,o,s){try{s=s||{};var a=this.options.useShiftKey;this.options.useShiftKey=!0,this._setFocusedCell(Number(t),Number(e),null,{ignoreFocusMode:s.ignoreFocusMode}),this._setFocusedCell(Number(i),Number(o),!1,{shifted:!0,ignoreFocusMode:s.ignoreFocusMode}),this.options.useShiftKey=a}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype.removeFocusedMultiCell=function(t,e,i,o){try{for(var s="focusedColIndex",a="focusedRowIndex",n=this.focusedCell.length-1;n>=0;n--){var l=this.focusedCell[n];l[a]>=t&&l[a]<=i&&l[s]>=e&&l[s]<=o&&(this._applyFocusedCellOut(l),this.focusedCell.splice(n,1))}}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype._applyFocusedMultiCell=function(t,e,i,o,s){try{this.applyFocusedCellOut(),this.focusedCell=[];var a=this.getLocationRowCol(t,e);t=a.rowIndex,e=a.colIndex;var n=t,l=e,h=this.getLocationRowCol(i,o);i=h.rowIndex,o=h.colIndex;for(var d=i,u=o,p=t>i,c=e>o,g=this.htmlInfo.body.rowAttrArr.length,f=p?i:t,m=p?t:i,y=c?o:e,b=c?e:o,w=!0;w;){w=!1;var v=m,I=0;for(var C in this.cellMergeInfo)this.cellMergeInfo.hasOwnProperty(C)&&I++;m-f>g&&I<1&&(v=f+g);for(var x=y,_=f;_<=v;_++){var S=this.getOriginalRowCol(_,y);S.colSize>1&&x>(S=this.getLocationRowCol(S.rowIndex,S.colIndex)).colIndex&&(x=S.colIndex,w=!0),y=x}var D=b;for(_=f;_<=v;_++){var R=this.getOriginalRowCol(_,b);R.colSize>1&&D<(R=this.getLocationRowCol(R.rowIndex,R.colIndex)).colIndex+R.colSize-1&&(D=R.colIndex+R.colSize-1,w=!0),b=D}for(var L=f,T=y;T<=b;T++){var k=this.getOriginalRowCol(f,T);k.rowSize>1&&L>(k=this.getLocationRowCol(k.rowIndex,k.colIndex)).rowIndex&&(L=k.rowIndex,w=!0),f=L}var A=m;for(T=y;T<=b;T++){var F=this.getOriginalRowCol(m,T);F.rowSize>1&&A<(F=this.getLocationRowCol(F.rowIndex,F.colIndex)).rowIndex+F.rowSize-1&&(A=F.rowIndex+F.rowSize-1,w=!0),m=A}}i=p?f:m,e=c?b:y,o=c?y:b;for(_=t=p?m:f;p?_>=i:_<=i;p?_--:_++)for(T=e;c?T>=o:T<=o;c?T--:T++){var E=this.getOriginalRowCol(_,T),M=E.colIndex,O=E.rowIndex;if(!E.noLeftTop){var N=this.data_td_list[M+(O-this.rowIndex)*this.oneRowDataLength];if(O<this.rowIndex&&(N=null),!(this.groupbyStatus.grouped&&N&&this.hasClass(N,"w2grid_groupby"))){var B=this.getCellInfo(M),G=this._getRealColIndex("body",B.options.col_id)+this.defaultColCnt;if(!B.options.blockSelect&&!this.hiddenList[G]){var H={focusedTd:N,focusedRowIndex:O,focusedColIndex:M};if(this.options.groupbyDisplayRowIndex&&(H.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(O)),_==n&&T==l?this.focusedCell.unshift(H):this.focusedCell.push(H),
null!=N){var W=!0;(B.options.embeddedInput||T==u&&_==d)&&(W=!1),this.applyFocusedCellIn(N,W,null,s)}(""==B.options.inputType||"text"==B.options.inputType&&!B.options.embeddedInput||"textImage"==B.options.inputType||"calendar"==B.options.inputType)&&(this.getInput(B).options.editType=B.options.editType?B.options.editType:this.options.editType)}}}}}catch(t){r.w.printStackTrace(t,null,this)}},I.prototype._addFocus=function(t){try{var e=parseInt(t.getAttribute("tdIndex")),i=parseInt(e/this.realRowDataLength)+this.rowIndex,o=i;this.isDrillDown&&this._dataList.options.depthColumn&&(o=this.getRealRowIndex(i));var s,a=e%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength),n={focusedTd:t,focusedRealRowIndex:o,focusedRowIndex:s=this.rowIndex>0&&this.options.fixedRow>0&&this.options.fixedRow>i-this.rowIndex||this.options.lastFixedRow>0&&i-this.rowIndex>this.lastIndex-this.options.lastFixedRow?i-this.rowIndex:i,focusedColIndex:a};this.options.groupbyDisplayRowIndex&&(n.groupbyDisplayRowIndex=this._getGroupbyDisplayRowIndex(s)),this.focusedCell.push(n)}catch(t){r.w.printStackTrace(t,null,this)}};var C=function(t){};C.prototype._subtotalHidden=function(t){try{for(var e=0;e<t.length;e++){if(this.isIE6or7)for(var i=t[e].getElementsByTagName("td"),o=0;o<i.length;o++)i[o].style.borderWidth="0px";"none"!==t[e].style.display&&(this.drawedSubtotal&&this.drawedSubtotal.drawedRowLength--,t[e].style.display="none")}}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalHidden=function(t){try{if(!this.hasSubtotal)return;if(t){if("number"==typeof t.index)for(var e=this.drawedSubtotal.splice(t.index,1),i=0;i<e.length;i++)this._subtotalHidden(e[i]);if("number"==typeof t.rowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex==t.rowIndex){e=this.drawedSubtotal.splice(i,1);for(var o=0;o<e.length;o++)this._subtotalHidden(e[o])}if("number"==typeof t.startRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex>=t.startRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o]);if("number"==typeof t.endRowIndex)for(i=this.drawedSubtotal.length-1;i>=0;i--)if(this.drawedSubtotal[i].rowIndex<=t.endRowIndex)for(e=this.drawedSubtotal.splice(i,1),o=0;o<e.length;o++)this._subtotalHidden(e[o])}else{for(var s in this.subtotalTableList){var a=this.subtotalRowHash[s];a&&this._subtotalHidden(a)}this.drawedSubtotal=[],this.drawedSubtotal.drawedRowLength=0}}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.refreshSubtotalRow=function(t){try{for(var e=t-this.rowIndex;e<=this.lastIndex;e++)this.drawSubtotalRow(e+1,e+this.rowIndex);var i=WebSquare.BootLoader.fullViewed||!1,o=a.D.fullViewed||!1;if(!i&&!o){var n=this.options.adaptive,l=parseInt(this.options.adaptiveThreshold)||480;if("crosstab"==n&&!(a.D.isIE()&&parseInt(s.v.browserVersion(),10)<10)&&parseInt(top.document.documentElement.clientWidth||top.document.body.clientWidth)<=l){for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!0);this.removeAdaptiveGridSubtotalHeight(),this.setAdaptiveGridSubtotalHeight();for(e=this.defaultColCnt;e<this.hiddenList.length;e++)1==this.hiddenList[e]&&this.setAdaptiveColumnVisible(e,!1);this.event.hasEvent(this.id+"_body_tbody","onscroll")||this.event.addListener(this.getElementById(this.id+"_body_tbody"),"onscroll",this.event.bindAsEventListener(this,this.tbodyMoveXScroll))}}}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.drawSubtotalRow=function(t,e,i){try{var o=0;if(!this.hasSubtotal||e<0||e>=this.getDataLength())return o;var s=NaN;if(i&&!isNaN(i.maxCount)&&(s=i.maxCount),s<=0)return o;for(var a in this.subtotalTableList){var n=this.dataList._getCellData(e,a),l=n+"_12";if(e<this.getDataLength()-1)l=this.dataList._getCellData(e+1,a);if(n!=l){var h=this.subtotalRowHash[a],d=this.subtotalTableList[a],u=d.rows.length,p=[];p.rowIndex=e,p.targetID=a;for(var c=0;c<u;c++){var g=h?h[t*u+c]:void 0;if(g){
if(this.isIE6or7)for(var f=g.getElementsByTagName("td"),m=0;m<f.length;m++)f[m].style.borderWidth="";o>=s?g.style.display="none":(g.style.display="",o++),g.setAttribute("data-subtotalrowindex",e),p.push(g),this.lastSubtotalRow=g}}if(this.drawedSubtotal.push(p),this.drawedSubtotal.drawedRowLength+=o,this.setSubtotalData(d,a,n,e,p,i),o>=s)break}}return o}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.hasUpperSubtotalRow=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return!1;for(var e in this.subtotalTableList){var i=this.dataList._getCellData(t,e),o=i;if(t<this.getDataLength())o=this.dataList._getCellData(t-1,e);if(i!=o)return!0}return!1}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.getHasSubtotalCount=function(t){try{if(!this.hasSubtotal||t<0||t>=this.getDataLength())return 0;var e=0;for(var i in this.subtotalTableList){var o=this.dataList._getCellData(t,i),s=o;t+1<this.getDataLength()?s=this.dataList._getCellData(t+1,i):t+1==this.getDataLength()&&e++,o!=s&&e++}return e}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.setSubtotalData=function(t,e,i,o,s,n){try{var l,h=this.subtotalDataArr[e+"_"+i];if(null==h&&(h=this.getSubtotalData(t,e,i,o)),this.options.subtotalStyleFormatter)try{"function"==typeof this.options.subtotalStyleFormatter?l=this.options.subtotalStyleFormatter:null!=(l=a.D.getGlobalFunction(this.options.subtotalStyleFormatter,this.scope_id))&&(this.options.subtotalStyleFormatter=l)}catch(t){l=null}for(var d=0;d<s.length;d++)for(var u=s[d].getElementsByTagName("td"),p=0;p<u.length;p++){var c=u[p],g=c.getAttribute("id");if(null!=h[g]){var f=h[g];if("expression"==c.getAttribute("inputType")&&isNaN(f)&&null!=c.getAttribute("NaNFormat")&&"NaN"!=c.getAttribute("NaNFormat")&&(f=c.getAttribute("NaNFormat")),c.innerHTML="<nobr>"+f+"</nobr>","function"==typeof l){var m=h[g+"_org"];null==m&&(m=f);var y=l(m,f,c.id);if(c&&y){var b=c.getAttribute("data-bkclassname");null==b&&(b=c.className,c.setAttribute("data-bkclassname",b)),c.className=c.getAttribute("data-bkclassname")+" "+y}}}else if("true"!=c.getAttribute("colMerge")||this.groupbyStatus.grouped){var w=c.getAttribute("value"),v=c.getAttribute("useLocale"),I=c.getAttribute("inputType");if("true"===v||this.options.useLocale&&!v){var C=c.getAttribute("localeRef");if(C&&"expression"!==I){var x=this.getLocaleValue(C);x&&(w=x)}}w=null!=w?w:"",c.innerHTML="<nobr>"+w+"</nobr>"}else c.style.borderTopWidth="0px",c.style.borderBottomWidth="0px"}}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.getSubtotalData=function(t,e,i,o){try{var s=e,n=this.subtotalObj[e];if(null==n){n={};for(var l=0;l<t.rows.length;l++)for(var h=t.rows[l].getElementsByTagName("td"),d=0;d<h.length;d++){var u=h[d];if("expression"==u.getAttribute("inputType")){(v={}).id=u.getAttribute("id");var p=u.getAttribute("expression")||"";""!=p&&(p=(p=(p=(p=(p=(p=(p=(p=p.replace(/[sS][uU][mM][\s]*[(]/g,"this.subtotalcolsum( obfuscator_st, obfuscator_en ,")).replace(/[aA][vV][gG][\s]*[(]/g,"this.subtotalcolavg( obfuscator_st, obfuscator_en ,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.subtotalcolmax( obfuscator_st, obfuscator_en ,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.subtotalcolmin( obfuscator_st, obfuscator_en ,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"this.subtotalcolcnt( obfuscator_st, obfuscator_en ,")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][vV][aA][lL][uU][eE][\s]*[(]/g,"this.dataList._getCellData( obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][cC][oO][lL][lL][aA][bB][eE][lL][\s]*[(]/g,"this.subtotaltargetcollabel( obfuscator_st, obfuscator_en, obfuscator_targetID")).replace(/[tT][aA][rR][gG][eE][tT][fF][oO][oO][tT][eE][rR][vV][aA][lL][uU][eE][\s]*[(]/g,"this.subtotaltargetfootervalue( obfuscator_st, obfuscator_en,"));var c="text",g=parseInt(u.getAttribute("colindex"))-this.defaultColCnt;g>=0&&(c=this._dataList.getCellInfo(g).options.dataType),v.dataType=u.getAttribute("dataType")||c,v.expression=p,
v.displayFormat=u.getAttribute("displayFormat")||"",v.displayFormatter=u.getAttribute("displayFormatter")||"",v.formatter=WebSquare.format.createFormatter(v.dataType,v.displayFormat,v.displayFormatter,null,null,null,this.scope_id,this.id),n[v.id]=v}}this.subtotalObj[e]=n}for(var f=o;f>0&&i==this.dataList._getCellData(f-1,e);)f--;var m=f,y=o,b={};for(var w in n){var v=n[w],I=a.D.scopingFuncBody(v.expression,this.scope_id);this._subtotalDisplayFormat=v.displayFormat||"";var C=Function("obfuscator_st","obfuscator_en","obfuscator_targetID",I).call(this,m,y,s),x=v.formatter.format(C);b[w]=x,this.options.subtotalStyleFormatter&&C!==x&&(b[w+"_org"]=C)}return this._subtotalDisplayFormat="",b}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.getSubtotalRowList=function(t){try{var e=[];t&&"object"===t.returnType&&(e={});var i=this.getDataLength();for(var o in this.subtotalStrList)for(var s=1;s<i;s++){this.dataList._getCellData(s-1,o)!=this.dataList._getCellData(s,o)&&(t&&"object"===t.returnType?e[s]=!0:e.push(s))}return e}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalcolsum=function(t,e,i){try{var o,s=this.getColumnSubtotalRangeDataArray(t,e,i),n="";if(s.length>0)if(o=this.getColumnOption(i,"dataType"),n=0,"bigDecimal"===o)for(var l=0;l<s.length;l++)n=WebSquare.bigDecimal(n+"").plus(s[l]);else if("time"===o)for(l=0;l<s.length;l++){var h=WebSquare.text.fillZero(n,4);n=WebSquare.date.dateTimeAdd(h,s[l],"hour","time")}else n=a.D.sum(s,{displayFormat:this._subtotalDisplayFormat});return a.D.setPrecision(n)}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalcolavg=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),s="";if("bigDecimal"===this.getColumnOption(i,"dataType")){for(var n in s="0",o)s=WebSquare.bigDecimal(s).plus(o[n]);s=s.divide(WebSquare.bigDecimal(o.length))}else o.length>0&&(s=a.D.sum(o,{displayFormat:this._subtotalDisplayFormat})/o.length);return s}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalcolmax=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),s=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===s)for(var l in o)n=null==n?o[l]:n.compare(o[l]);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n<h)&&(n=h)}return n=null==n?"":n,a.D.setPrecision(n)}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalcolmin=function(t,e,i){try{var o=this.getColumnSubtotalRangeDataArray(t,e,i),s=this.getColumnOption(i,"dataType"),n=null;if("bigDecimal"===s)for(var l in o)n=null==n?o[l]:n.compare(o[l],!0);else for(l=0;l<o.length;l++){var h=parseFloat(o[l]);isNaN(h)||(null==n||n>h)&&(n=h)}return n=null==n?"":n,a.D.setPrecision(n)}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotalcolcnt=function(t,e,i,o){try{o=o||{};return(this.getColumnSubtotalRangeDataArray(t,e,i,o)||[]).length}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.subtotaltargetcollabel=function(t,e,i,o){var s="";try{s=this.dataList._getCellData(e,i);var a=this.getCellInfo(i),n=a.options.inputType;"select"!==n&&"autoComplete"!==n&&"checkcombobox"!==n||(s=a.getData(s,e))}catch(t){r.w.printStackTrace(t,null,this)}return s},C.prototype.subtotaltargetfootervalue=function(t,e,i,o){var s;try{this.hasFooter&&this.footerTempSum&&this.footerTempSum[i]&&(s=this.footerTempSum[i].sum)}catch(t){r.w.printStackTrace(t,null,this)}return s},C.prototype.getColumnSubtotalRangeDataArray=function(t,e,i,o){try{for(var s,a=[],n=this.getColumnID(i),l=this.getColumnOption(n,"dataType"),h=this.dataList.getDeletedIndex(),d=this.dataList.getModifiedIndex(),u=t;u<=e;u++){if(this.options.excludeDeletedRows){for(var p=!1,c=0;c<h.length;c++)if(h[c]===u){p=!0;break}if(p)continue}if(this.options.excludeModifiedRows){for(p=!1,c=0;c<d.length;c++)if(d[c]===u){p=!0;break}if(p)continue}"bigDecimal"===l?s=WebSquare.bigDecimal(this.dataList._getCellData(u,i)):(s=this.dataList._getCellData(u,i),s+=""),void 0===s||""==s?(s="0",
"object"==typeof o&&!1!==o.blank&&a.push(s)):a.push(s)}return a}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype._getLastSubtotalCount=function(){try{if(!this.hasSubtotal)return 0;for(var t=0,e=this.getDataLength(),i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength),0),o=0,s=e-1;s>=i;s--){for(var a=0;a<this.struct.subtotalArr.length;a++){var n=this.struct.subtotalArr[a],l=n.attr.targetColumnID,h=this.dataList._getCellData(s,l),d=h+"_12";if(s<e-1)d=this.dataList._getCellData(s+1,l);if(h!=d&&(t+=n.rowArr.length,this.options.initFixedHeightByRowNum>-1)){if(o+t>=this.options.initFixedHeightByRowNum){i=s+1;break}i=Math.max(e-this._getVisibleLastIndex(this.drawedRowLength-t),0)}}o++}return t}catch(t){r.w.printStackTrace(t,null,this)}},C.prototype.setSubtotalVisible=function(t){try{if(0===this.render.offsetHeight&&0===this.render.offsetWidth)return this.resizeObj={width:0,height:0,scrollLeft:0,scrollTop:0,clientWidth:0},this.setRedrawStatus("stop"),void this.delayedDraw({subTotalVisible:t});!0===t?(this.hasSubtotal=!0,this.lastTopRowIndex=null,this._applyRowVisible(),this.setScrollYHeight()):!1===t&&(this.subtotalHidden(),this.lastTopRowIndex=null,this.hasSubtotal=!1,this.setScrollYHeight())}catch(t){r.w.printStackTrace(t,null,this)}};var x=function(t){};x.prototype.initializeFooter=function(){try{if(!this.hasFooter)return;for(var t=this.getDomList("foot_tds","td",this.getElementById(this.id+"_foot_table")),e=0;e<t.length;e++){var i=t[e],o=i.getAttribute("id");if(o&&!i.getAttribute("footer_id")){for(var s="",a=0;a<this.struct.foot.rowArr.length;a++)for(var n=0;n<this.struct.foot.rowArr[a].length;n++)if(this.struct.foot.rowArr[a][n].id==o&&this.struct.foot.rowArr[a][n].class){s=this.struct.foot.rowArr[a][n].class;break}if("_headerRowNumber"!==o&&"_headerRowStatus"!==o||(o+="_footer"),i.setAttribute("footer_id",o),i.setAttribute("id",this.id+"_"+o),i.setAttribute("class",i.getAttribute("class")+" "+this.id+"_footer__column"+e+" "+s),"expression"!=i.getAttribute("inputType")){var l=i.getAttribute("value"),h=i.getAttribute("useLocale");if("true"===h||this.options.useLocale&&!h){var d=i.getAttribute("localeRef");if(d){var u=this.getLocaleValue(d);u&&(l=u)}}l=null!=l?l:"",i.innerHTML="<nobr>"+l+"</nobr>"}}}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.drawFooter=function(t){try{if(!this.hasFooter||!this.drawFooterStatus)return;null==this.footerDataObj&&this.initFooterDataObj();var e=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if(this.footerTempSum=[],t){t=this.getColumnID(t);for(var i=0;i<e.length;i++){var o=(d=e[i]).getAttribute("footer_id"),s=parseInt(d.getAttribute("colindex"))-this.defaultColCnt;if(o)if("expression"==(u=this.footerDataObj[o]).inputType){var n=u.expression.match(/footercol(sum|avg|max|min|custom)\s*\([^\)]*/g);if(n){for(var l=0;l<n.length;l++)if(n[l].indexOf(t)>=0){var h=a.D.scopingFuncBody(u.expression,this.scope_id);u.value=Function("_this",h).call(this,this),isNaN(u.value)?"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat):"number"===u.dataType&&0===Number(u.value)&&(u.value=0),d.innerHTML="<nobr>"+u.formatter.format(u.value)+"</nobr>"}}else if(t==this.getCellInfo(s).id){try{h=a.D.scopingFuncBody(u.expression,this.scope_id);u.value=Function("_this",h).call(this,this),isNaN(u.value)&&"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat)}catch(t){}d.innerHTML="<nobr>"+u.formatter.format(u.value)+"</nobr>"}}}}else for(i=0;i<e.length;i++){var d;if(o=(d=e[i]).getAttribute("footer_id")){var u;if("expression"==(u=this.footerDataObj[o]).inputType)try{h=a.D.scopingFuncBody(u.expression,this.scope_id);u.value=Function("_this",h).call(this,this),isNaN(u.value)?"NaN"!=u.NaNFormat&&(u.value=u.NaNFormat):"number"===u.dataType&&0===Number(u.value)&&(u.value=0)}catch(t){}d.innerHTML="<nobr>"+u.formatter.format(u.value)+"</nobr>"}}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.initFooterDataObj=function(t){try{
var e=this.getElementById(this.id+"_foot_table").getElementsByTagName("td"),i=-1,o=!1;t?(i=this.getColumnIndex(t),o=!0):this.footerDataObj={};for(var a=0;a<e.length;a++){var n=e[a],l=n.getAttribute("footer_id");l||(l="f_"+Math.random().toString(),n.setAttribute("footer_id",l));var h=parseInt(n.getAttribute("colindex"))-this.defaultColCnt;if(!(i>=0&&i!==h)){var d={};d.id=l;var u=n.getAttribute("expression")||"";""!=u&&(u=(u=(u=(u=(u=(u=u.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( ")),d.value=n.getAttribute("value");var p=n.getAttribute("useLocale");if("true"===p||this.options.useLocale&&!p){var c=n.getAttribute("localeRef");if(c){var g=this.getLocaleValue(c);g&&(d.value=g)}}if(d.inputType=n.getAttribute("inputType"),d.dataType=n.getAttribute("dataType"),!d.dataType)try{if(d.dataType=this.getColumnOption(d.col_id,"dataType"),"expression"===d.inputType)d.col_id=new Function("_this","return "+u.substring(u.indexOf("(")+1,u.indexOf(")")))(this),d.dataType=this._dataList.getCellInfo(d.col_id).options.dataType||"text";else{var f="text",m=h;m>=0&&(f=this._dataList.getCellInfo(m).options.dataType),d.dataType=f}}catch(t){d.dataType="text"}d.expression=u,d.displayFormat=n.getAttribute("displayFormat")||"",d.displayFormatter=n.getAttribute("displayFormatter")||"",d.formatter=this._initFooterFormatter(d.col_id,d.dataType,d.displayFormat,d.displayFormatter,this.scope_id,this.id,o),d.NaNFormat=n.getAttribute("NaNFormat")||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/column[@inputType='expression']/NaNFormat/@value")||"NaN","$blank"==d.NaNFormat&&(d.NaNFormat=""),this.footerDataObj[d.id]=d}}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype._initFooterFormatter=function(t,e,i,o,a,n,l){try{if(t){var h=this.getCellInfo(t).options.dataType,d=i;return"euro"==h?(e=h,i||(d=this.options.euroMask||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/euroMask/@value')||""),".",","):"rupee"==h?(e=h,i||(d=this.options.rupeeMask||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/rupeeMask/@value')||""),",","."):"tenge"==h?(e=h,i||(d=this.options.tengeMask||s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/tengeMask/@value')||"")," ","-"):!l||"number"!==h&&"float"!==h&&"bigDecimal"!==h||(e=h,i||(d=this.options.numberMask||s.v.getConfiguration('/WebSquare/input/dataType[@valueType="'+e+'"]/numberMask/@value')||"")," ","-"),WebSquare.format.createFormatter(e,d,o,null,null,null,a,n)}return WebSquare.format.createFormatter(e,i,o,null,null,null,a,n)}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolsum=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].sum){var e="",i=5e3;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"SUM('"+t+"')");else{var o=this.getColumnAllDataArray(t),s=this.getColumnOption(t,"dataType"),n=!1;if("bigDecimal"!==s&&"euro"!==s&&"tenge"!==s&&"rupee"!=s||(n=!0),o.length>0&&n){for(var l=WebSquare.bigDecimal("0"),h=0;h<o.length;h++)""==o[h].replace(/^\s+|\s+$/g,"")&&(o[h]="0");for(var d=0;d<o.length;d++)o[d]=WebSquare.bigDecimal(o[d]),l=l.plus(o[d]);e=l.toString()}else if(o.length>0)if(o.length>i){var u,p=Math.ceil(o.length/i),c=0;e=0;for(h=0;h<p;h++){for(var g=o.slice(c,i*(h+1)),f=0;f<g.length;f++)""==g[f].replace(/^\s+|\s+$/g,"")&&(g[f]="0"),g[f]=g[f]-0+"";u=a.D.sum(g),c=parseInt(c,10)+parseInt(g.length,10),
e=parseFloat(e,10)+parseFloat(u,10)}}else e=a.D.sum(o)}this.footerTempSum[t].sum=e}return a.D.setPrecision(this.footerTempSum[t].sum)}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolavg=function(t){try{var e=this.getColumnAllDataArray(t);this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={});var i="",o=5e3;if(this.groupbyStatus.grouped)return i=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"AVG('"+t+"')");if(void 0===this.footerTempSum[t].sum){var s=this.getColumnOption(t,"dataType");if(e.length>0&&"bigDecimal"==s){for(var n=WebSquare.bigDecimal("0"),l=0;l<e.length;l++)""==e[l].replace(/^\s+|\s+$/g,"")&&(e[l]="0");for(var h in e)e[h]=WebSquare.bigDecimal(e[h]),n=n.plus(e[h]);return n.divide(WebSquare.bigDecimal(e.length)).toString()}if(e.length>0)if(e.length>o){var d,u=Math.ceil(e.length/o),p=0;i=0;for(l=0;l<u;l++){for(var c=e.slice(p,o*(l+1)),g=0;g<c.length;g++)""==c[g].replace(/^\s+|\s+$/g,"")&&(c[g]="0");d=a.D.sum(c),p=parseInt(p,10)+parseInt(c.length,10),i=parseFloat(i,10)+parseFloat(d,10)}}else i=a.D.sum(e);this.footerTempSum[t].sum=i}return""===this.footerTempSum[t].sum?"":i=this.cellInfoHash[t]&&"bigDecimal"==this.cellInfoHash[t].options.dataType?WebSquare.bigDecimal(this.footerTempSum[t].sum).divide(WebSquare.bigDecimal(e.length)).toString():this.footerTempSum[t].sum/e.length}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolmax=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].max){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MAX('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&"bigDecimal"==o){for(var s,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),s=null==s?i[l]:s.compare(i[l],!1);e=s.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e<h)&&(e=h)}e=null==e?"":e,e=a.D.setPrecision(e)}this.footerTempSum[t].max=e}}return this.footerTempSum[t].max}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolmin=function(t){try{if(this.footerTempSum||(this.footerTempSum=[]),this.footerTempSum[t]||(this.footerTempSum[t]={}),void 0===this.footerTempSum[t].min){var e=null;if(this.groupbyStatus.grouped)e=this.groupExpression(this._dataList.filteredRowIndexArr,0,this._dataList.filteredRowIndexArr.length-1,"MIN('"+t+"')");else{var i=this.getColumnAllDataArray(t),o=this.getColumnOption(t,"dataType");if(i.length>0&&"bigDecimal"==o){for(var s,n=0;n<i.length;n++)""==i[n].replace(/^\s+|\s+$/g,"")&&(i[n]="0");for(var l in i)i[l]=WebSquare.bigDecimal(i[l]),s=null==s?i[l]:s.compare(i[l],!0);e=s.toString()}else{for(n=0;n<i.length;n++){var h=parseFloat(i[n]);isNaN(h)||(null==e||e>h)&&(e=h)}e=null==e?"":e,e=a.D.setPrecision(e)}this.footerTempSum[t].min=e}}return this.footerTempSum[t].min}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolcnt=function(t,e){try{e=e||{};return(this.getColumnAllDataArray(t,e)||[]).length}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getColumnAllDataArray=function(t,e){try{var i=[],o=this.getColumnID(t),s=this.dataList.getDeletedIndex(),n=this.dataList.getModifiedIndex();if(null!==o){for(var l=this.isDrillDown&&a.D.getBoolean(this.options.drilldownFooterExpressionAllData)?this.getTotalRow():this.getDataLength(),h=0;h<l;h++){if(this.options.excludeDeletedRows){for(var d=!1,p=0;p<s.length;p++)if(s[p]===h){d=!0;break}if(d)continue}if(this.options.excludeModifiedRows){for(d=!1,p=0;p<n.length;p++)if(n[p]===h){d=!0;break}if(d)continue}var c;c=this.isDrillDown&&a.D.getBoolean(this.options.drilldownFooterExpressionAllData)?this._dataList.getCellData(h,o):this.dataList._getCellData(h,o),void 0===(c+="")||""==c?(c="0",
"object"==typeof e&&!1!==e.blank&&i.push(c)):i.push(c)}return i}u.k.printLog("[Warning] Invalid colIndex("+t+"). ["+this.id+"] getColumnAllDataArray.")}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getFooterData=function(t,e){try{var i=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if("number"==typeof t){t=i[t+this.defaultColCnt].getAttribute("footer_id");var o=(l=this.footerDataObj[t]).value;if("expression"==l.inputType){var s=a.D.scopingFuncBody(l.expression,this.scope_id);o=Function("_this",s).call(this,this)}return"displayData"!=e?o:l.formatter.format(o)}for(var n=0;n<i.length;n++)if(i[n].getAttribute("footer_id")==t){var l;o=(l=this.footerDataObj[t]).value;if("expression"==l.inputType){s=a.D.scopingFuncBody(l.expression,this.scope_id);o=Function("_this",s).call(this,this)}return"displayData"!=e?o:l.formatter.format(o)}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.setFooterValue=function(t,e){this.setFooterData(t,e)},x.prototype.setFooterData=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute("footer_id");for(var s=0;s<o.length;s++)if((i=o[s]).getAttribute("footer_id")==t){var a=this.footerDataObj[t];"text"==a.inputType&&(a.value=e,i.innerHTML="<nobr>"+a.formatter.format(a.value)+"</nobr>")}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.setFooterDisplayFormat=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute("footer_id");for(var s=0;s<o.length;s++)if((i=o[s]).getAttribute("footer_id")==t){var a=this.footerDataObj[t];a.displayFormat=e,a.formatter=WebSquare.format.createFormatter(a.dataType,a.displayFormat,a.displayFormatter,null,null,null,this.scope_id,this.id),"number"==a.dataType&&(i.innerHTML="<nobr>"+a.formatter.format(a.value)+"</nobr>")}var n=this.footerXml;if(n)for(var l=WebSquare.xml.getElementsByTagName(n,"w2:row"),h=0;h<l.length;h++){var d=WebSquare.xml.getElementsByTagName(l[h],"w2:column");for(s=0;s<d.length;s++){var u=d[s];if(u.getAttribute("id")==t){u.setAttribute("displayFormat",e);break}}}}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getFooterStyle=function(t,e){try{var i,o=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if("number"==typeof t)t=(i=o[t+this.defaultColCnt]).getAttribute("footer_id");for(var s=0;s<o.length;s++)if((i=o[s]).getAttribute("footer_id")==t)return WebSquare.style.getStyle(i,e)}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.setFooterStyle=function(t,e,i){try{var o,s=this.getElementById(this.id+"_foot_table").getElementsByTagName("td");if("$rownum"==t.wq_trim().toLowerCase())t="_headerRowNumber_footer";else if("$rowstatus"==t.wq_trim().toLowerCase())t="_headerRowStatus_footer";else if("number"==typeof t){t=(o=s[t+this.defaultColCnt]).getAttribute("footer_id")}for(var a=0;a<s.length;a++)(o=s[a]).getAttribute("footer_id")==t&&WebSquare.style.setStyle(o,e,i)}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getExcelAllFooterXML=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=[];e.push("<array><![CDATA["),e.push('["'),this.footerDataObj||this.initFooterDataObj();for(var i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0].getChildNodes(),n=0;n<o.length;n++){var l=o[n];if(1==l.nodeType)for(var h=l.getChildNodes(),d=0;d<h.length;d++){var u=h[d];if(1==u.nodeType){var p=u.getAttribute("id"),c=this.footerDataObj[p];if("expression"!=c.inputType)i=c.value,i=c.formatter.format(i);else{var g=a.D.scopingFuncBody(c.expression,this.scope_id);i=Function("_this",g).call(this,this),i=c.formatter.format(i)}e.push(i),e.push('"'+t+'"')}}}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){r.w.printStackTrace(t,null,this)}},
x.prototype.getExcelAllFooterXMLDisplay=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";var e=[];e.push("<array><![CDATA["),e.push('["');var i=this.getElementById(this.id+"_foot_table").getElementsByTagName("tbody")[0].getElementsByTagName("td");if(this.groupbyStatus.grouped){this.footerDataObj||this.initFooterDataObj();var o=0;if(this.options.rowNumVisible){var n=(g=this.footerDataObj[i[o].getAttribute("footer_id")]).value||"";e.push(n),e.push('"'+t+'"'),o++}if(this.options.rowStatusVisible){n=(g=this.footerDataObj[i[o].getAttribute("footer_id")]).value||"";e.push(n),e.push('"'+t+'"')}}this.footerDataObj||this.initFooterDataObj();n="";for(var l=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0].getChildNodes(),h=0;h<l.length;h++){var d=l[h];if(1==d.nodeType)for(var u=d.getChildNodes(),p=0;p<u.length;p++){var c=u[p];if(1==c.nodeType){var g,f=c.getAttribute("id");if("expression"!=(g=this.footerDataObj[f]).inputType)n=g.value,n=g.formatter.format(n);else{var m=a.D.scopingFuncBody(g.expression,this.scope_id);n=Function("_this",m).call(this,this),n=g.formatter.format(n)}e.push(n),e.push('"'+t+'"')}}}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getExcelAllFooterXMLRaw=function(t){try{if(t||(t=","),!this.hasFooter)return"<array><![CDATA[[]]]></array>";this.footerDataObj||this.initFooterDataObj();for(var e=[],i="",o=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0].getChildNodes(),a=0;a<o.length;a++){var n=o[a];if(1==n.nodeType)for(var l=n.getChildNodes(),h=0;h<l.length;h++){var d=l[h];if(1==d.nodeType){var u=d.getAttribute("id"),p=this.footerDataObj[u];i=p.value,i=p.formatter.format(i),e[e.length]=i}}}return e[0]='<array><![CDATA[["'+e[0],e[e.length-1]+='"]]]></array>',e.join('"'+t+'"')}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.getExpressionValue=function(t){try{return this.hasFooter||(this.footerTempSum=[]),t=(t=(t=(t=(t=(t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.footercolsum( ")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.footercolavg( ")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.footercolmax( ")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.footercolmin( ")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.footercolcnt( ")).replace(/[cC][uU][sS][tT][oO][mM][\s]*[(]/g,"_this.footercolcustom( "),new Function("_this","return "+t)(this)}catch(t){r.w.printStackTrace(t,null,this)}},x.prototype.footercolcustom=function(t,e){try{var i=a.D.getGlobalFunction(t,this.scope_id),o="";return"function"==typeof i&&(o=i(this.getColumnAllDataArray(e),this.getColumnOption(e,"dataType"))),o}catch(e){u.k.printLog("[Warning] "+t+" is not valid function.["+this.id+"]")}};var _=i(9049),S=function(t){};S.prototype.setStartRowNumber=function(t){this.startRowNumber=t;for(var e=0;e<=this.lastIndex;e++)this._drawRowNumData(e,e+this.rowIndex)},S.prototype.setNoResultMessage=function(t){this.options.noResultMessage=t,this.displayNoResultMessage()},S.prototype.setNoResultMessageVisible=function(t){this.options.noResultMessageVisible=t,this.displayNoResultMessage()},S.prototype.checkAll=function(t,e){var i=!1,o=this.getCellInfo(t),s=o.id;if("checkbox"!=o.options.inputType){if("custom"!=o.options.inputType){var r=WebSquare.language.getMessage("Grid_warning1")||"선택하신 컬럼은 checkbox가 아닙니다.";return void $l(r)}i=!0}var a=o.options.trueValue,n=o.options.falseValue;this.drawFooterStatus=!1;var l,h=!(!this.isDrillDown||!this._dataList.options.depthColumn),d=h?this.getTotalRow():this.getDataLength(),u=!1,p=!1;if(this._linkedDataList){(p=this._linkedDataList.getBroadcast())&&this._linkedDataList.setBroadcast(!1);for(var c=0;c<d;c++){var g=this._linkedDataList.initialRowIndexArr[c],f=h?g:this._dataList.getFilteredRowIndex(g);if(i){if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}
if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{var m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}else{(u=this._dataList.getBroadcast())&&this._dataList.setBroadcast(!1);for(f=0;f<d;f++){if(i){var y;g=this.dataList.getRealRowIndex(f);if("checkbox"!=(y=o.cellManagerHashByRowIndex[g]?o.cellManagerHashByRowIndex[g]:o).options.inputType)continue;a=y.options.trueValue,n=y.options.falseValue}if(l=this._dataList.getCellData(f,s),1==e||1==e||e==a)l!=a&&this._dataList.setCellData(f,s,a);else if(0==e||0==e||e==n)l!=n&&this._dataList.setCellData(f,s,n);else{m=l==a?n:a;this._dataList.setCellData(f,s,m)}}}p&&this._linkedDataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]}),u&&this._dataList.setBroadcast(!0,!0,{gridView:[{keepTop:!0,refreshInstance:!1}]}),this.drawFooterStatus=!0,this.drawFooter(),this.drawHeader()},S.prototype.getColumnType=function(t){return this.getCellInfo(t).options.inputType},S.prototype.getColumnNodeSet=function(t){return this.getCellInfo(t).itemsetObj},S.prototype.getDefaultStyle=function(){return this.options.style},S.prototype.setCellChecked=function(t,e,i){if("boolean"==typeof i){var o=this.getCellInfo(e),s=o.id,r=!1;if(0==o.internal&&"custom"==o.options.inputType){var a=this.dataList.getRealRowIndex(t);o=o.cellManagerHashByRowIndex[a]?o.cellManagerHashByRowIndex[a]:o,r=!0}if("checkbox"==o.options.inputType||"radio"==o.options.inputType){if("radio"==o.options.inputType&&0!=i){var n=!(!this.isDrillDown||!this._dataList.options.depthColumn),l=n?this.getTotalRow():this.getDataLength();if(this._linkedDataList)if(r);else for(var h=0;h<l;h++){a=this._linkedDataList.initialRowIndexArr[h];var d=n?a:this._dataList.getFilteredRowIndex(a);this._dataList.setCellData(d,s,o.options.falseValue)}else if(r);else for(d=0;d<l;d++)this._dataList.setCellData(d,s,o.options.falseValue);this.drawColumnData(e)}i=1==i?o.options.trueValue:o.options.falseValue,this._dataList.setCellData(t,s,i)}else{var u=WebSquare.language.getMessage("Grid_warning3")||"checkbox나 radio가 아닙니다.";alert(u)}}else{var p=WebSquare.language.getMessage("Grid_warning2")||"입력데이터가 옳바르지 않습니다. true/false boolean 타입으로 입력하세요";alert(p)}},S.prototype.getGridHTML=function(){alert("현재 구현중")},S.prototype.redrawColumn=function(t,e){try{var i=void 0===e||e;this.drawColumnData(t,i)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getDrawCount=function(){return this.getVisibleRowNum()},S.prototype.getVisibleRowNum=function(){return this.rowIndex>=0?this.lastIndex+1:0},S.prototype.getTopRowIndex=function(){return this.rowIndex},S.prototype.setTopRowIndex=function(t,e,i){var o=this.getElementById(this.id+"_scrollY_div");if(t<=0&&(t=0),null!==this.lastTopRowIndex)t>this.lastTopRowIndex&&(t=parseInt(this.lastTopRowIndex+.5,10));else if(o.offsetHeight<o.scrollHeight){if(this.rowIndex<t){var s=this._getVisibleLastIndex(this.lastIndex+1);(t=t+s>this.getDataLength()?this.getDataLength()-s:t)>this.rowIndex+s-1&&(this.adjustDraw_keepTop=!0)}}else t=0;if(this.rowIndex!=t){if(this.delayedDraw({rowIndex:t}))return;this.scrollEvent=!1,this.checkScrollEnd=!e,i&&this.setFocusedCell2(0,0,!1),this.drawData(t),o.scrollTop=this.oneRowScrollHeight*this._getScrollRowIndex(t)}},S.prototype.getBottomRowIndex=function(){return this.rowIndex>=0?this.rowIndex+this.lastIndex:-1},S.prototype.setBottomRowIndex=function(t){this.drawBottomData(t)},S.prototype.getCellPosition=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=this.data_td_list[e+t*this.oneRowDataLength];if(!o){var s=t-this.rowIndex;o=this.data_td_list[e+s*this.oneRowDataLength]}if(o){if("top"==i)return o.offsetTop;if("left"==i)return o.offsetLeft}return null},S.prototype.getCellSize=function(t,e,i){e=this.getColumnIndex(e),i=(i||"").toLowerCase();var o=t-this.rowIndex,s=this.data_td_list[e+o*this.oneRowDataLength];return"width"==i?s.clientWidth:"height"==i?s.clientHeight:null},
S.prototype.getHeaderPosition=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);if("top"==e){var o=i.offsetTop;return this.options.groupbyZone&&(o+=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight),o}return"left"==e?i.offsetLeft:null},S.prototype.getHeaderSize=function(t,e){e=(e||"").toLowerCase();var i=this.getHeaderLayer(t);return"width"==e?i.clientWidth:"height"==e?i.clientHeight:null},S.prototype.setSummary=function(t){this.getElementById(this.id+"_body_table").setAttribute("summary",t)},S.prototype.setFooterSummary=function(t){this.hasFooter&&this.getElementById(this.id+"_foot_table").setAttribute("summary",t)},S.prototype.setCaption=function(t){var e=this.getElementById(this.id+"_body_table").getElementsByTagName("caption")[0];if(e)e.innerHTML=t;else{(e=document.createElement("caption")).innerHTML=t;var i=this.render.getElementsByTagName("colgroup")[0];i.parentNode.insertBefore(e,i)}var o=e.className;e.className=o&&""!=o?o+" setcaption":"setcaption"},S.prototype.setCaptionAuto=function(t){for(var e=this.getHeaderValueList(),i="",o="",s=0;s<e.length;s++)i.length>0&&(o=","),i=i+o+e[s];t&&(this.options.captionTitle=t),this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+i+WebSquare.language.getMessage("Grid_caption")):this.setCaption(i+WebSquare.language.getMessage("Grid_caption"))},S.prototype.setFooterCaption=function(t){if(this.hasFooter){var e=this.getElementById(this.id+"_foot_table"),i=e.getElementsByTagName("caption")[0];if(i)i.innerHTML=t;else{(i=document.createElement("caption")).innerHTML=t;var o=e.getElementsByTagName("colgroup")[0];o.parentNode.insertBefore(i,o)}}},S.prototype.groupby=function(t){try{this.hideCustomFilterList(),this._clearMergeCellBackground(),this.clearSearchData({clearValue:!0});var e="string"==typeof t.sortIndex?t.sortIndex.split(" "):t.sortIndex,i="string"==typeof t.sortOrder?t.sortOrder.split(" "):t.sortOrder,s=e.length;if(-1!=this.options.groupbyMaxCount&&this.options.groupbyMaxCount<s)return void u.k.printLog("groupby max column count has been exceeded.["+this.id+"]");for(var n=0;n<s;n++){var l=parseInt(e[n],10);e[n]=isNaN(l)?this.getColumnIndex(e[n]):l}if(!(t=t||{}).filter&&!this.groupbyStatus.grouped&&this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var h=this.groupbyFilterBox_history[this.groupbyFilterBox_select.getSelectedIndex()];if(!h.groupbyOptions&&h.customFilterListFilterInfo){t.filter=JSON.parse(h.customFilterListFilterInfo,(function(t,e){try{var i=new Function("return "+e)();return"function"==typeof i||"object"==typeof i&&i.constructor===RegExp?i:"object"==typeof i&&"func"===i.type&&"string"==typeof i.key?(i.key=new Function("return "+i.key)(),i):e}catch(t){return e}}));var d=e.length-1,p=!1;for(var c in t.filter){var g=!1;for(n=d;n>=0;n--)if(this.tdIdList[e[n]]===c){g=!0;break}g||(e.push(this.bodyIdColIndexMap[c]),i.push(i[i.length-1]),p=!0)}p&&(t.sortIndexArr=e,t.sortOrderArr=i),this.groupbyFilterList||this.createGroupbyFilterList({noDraw:!0}),this.groupbyStatus.filter=t.filter,this._dataList.sortStatusInfo={},this._dataList.sortStatusArr=[],s=e.length}}this.removeFocusedCell(),this._dataList.clearFilter(!0),this.clearHeaderSort(),this.headerSortStatusArr=[],this.groupbyStatus.groupbyOptions=JSON.stringify(t,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e}));var f={};if(t.filter){var m="",y="";for(var c in t.filter){var b,w=t.filter[c];m=',"'+c+'"'+m,y=",["+this._dataList.filteredRowIndexArr.join(",")+"]"+y,"func"===w.type?(w.noRefresh=!0,w.noRefreshAfter=!0,f[this.bodyToHeaderRelation[w.colIndex]]=!0,
this.dataList.setColumnFilter(w)):(w.constructor===/a/.constructor?b=w:t.filterRegExp&&t.filterRegExp[c]&&t.filterRegExp[c].constructor===/a/.constructor?b=t.filterRegExp[c]:"object"==typeof w&&(w=0==w.length?"/^[a-z0-9_-]{3,16}$/":"^"+w.join("$|^")+"$",b=new RegExp(w,"gi")),b&&this.dataList.setColumnFilter({type:"regExp",colIndex:c,key:b,condition:"and",noRefresh:!0,noRefreshAfter:!0}))}if(this.groupbyFilterList){var v='{"column":['+(m=m.slice(1)+"],")+'"filteredRowIndexArr":['+(y=y.slice(1)+"]}");if(this.groupbyFilterList.filterHistory=JSON.parse(v),this.getRowCount()<=0)for(;this.groupbyFilterList.filterHistory.filteredRowIndexArr.length>0&&this.groupbyFilterList.filterHistory.filteredRowIndexArr[0].length<=0;)this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift()}t.noRefreshAfter||this._dataList.broadcast({gridView:["notifyAfterSettedColumnFilter"]})}if(t.sortOrder&&t.sortIndex){var I=o.x.extend({},t);I.noRefresh=!0,I.sortIndex=[];for(n=0;n<e.length;n++)I.sortIndex.push(this.getColumnID(e[n]));this.dataList.multisort(I)}this.groupbyInfo={},this.statusArr=[];var C=this._linkedDataList?this._linkedDataList.filteredRowIndexArr:this._dataList.filteredRowIndexArr,x=[],_=[],S=0,D=[],R=[];for(var L in this.groupbyStatus.groupedRowIndexArr=[],this.groupbyStatus.groupbyRowIndexArr=C.slice(),this.groupbyStatus.groupbyDepthDelimiter="||",this.customFilterStatusObj={},f)this.customFilterStatusObj[L]=!0;this.groupbyStatus.grouped=!0,this.groupbyStatus.filter=t.filter||{},this.groupbyStatus.sortIndexArr=e,this.groupbyStatus.sortOrderArr=i,this.groupbyStatus.headerValueObj={},this.groupbyStatus.footerValueObj={},t.keepDisplayOptions||(this.groupbyDisplayOptions={},this.groupbyDisplayOptions.rowNumHeader=t.rowNumHeader||{},this.groupbyDisplayOptions.rowStatusHeader=t.rowStatusHeader||{},this.groupbyDisplayOptions.groupbyHeader=t.groupbyHeader||[],this.groupbyDisplayOptions.rowNumFooter=t.rowNumFooter||{},this.groupbyDisplayOptions.rowStatusFooter=t.rowStatusFooter||{},this.groupbyDisplayOptions.groupbyFooter=t.groupbyFooter||[],this.groupbyDisplayOptions.closeGroup=t.closeGroup||!1,this.groupbyDisplayOptions.hideHeader=t.hideHeader||!1,this.groupbyDisplayOptions.hideFooter=t.hideFooter||!1);for(n=0;n<C.length;n++){D=R,R=[];for(var T=C[n],k=T*this._dataList.cellIdList.length,A=0;A<s;A++){var F=this.tdIdList[e[A]],E=this.cellInfoHash[F];E&&"expression"==E.options.inputType?R[A]=E.getExpressionValue(T):R[A]=this._dataList.dataArr[k+this._dataList.bodyIdColIndexMap[F]]||""}if(n>0){var M=!1,O=[];for(A=0;A<s;A++)if(M||D[A]!==R[A]){var N=D.slice(0,A+1).join(this.groupbyStatus.groupbyDepthDelimiter);M=!0;var B={type:"footer",groupId:N,depth:A,status:"open",index:""};this.groupbyInfo[N]=this.groupbyInfo[N]?this.groupbyInfo[N]:{},this.groupbyInfo[N].footer=B,O.push(B)}for(A=O.length-1;A>=0;A--)O[A].index=x.length,this.groupbyDisplayOptions.hideFooter||(x.push(O[A]),_.push("footer"))}var G=!1;for(A=0;A<s;A++)if(G||0==n||D[A]!==R[A]){N=R.slice(0,A+1).join(this.groupbyStatus.groupbyDepthDelimiter);G=!0;B={type:"header",groupId:N,depth:A,status:"open",index:x.length};this.groupbyInfo[N]={header:B},this.groupbyDisplayOptions.hideHeader||(x.push(B),_.push("header"))}x.push(C[n]),_.push(S++)}if(_.length>0)for(n=s-1;n>=0;n--){B={type:"footer",groupId:N=R.slice(0,n+1).join(this.groupbyStatus.groupbyDepthDelimiter),depth:n,status:"open",index:x.length};this.groupbyInfo[N]=this.groupbyInfo[N]?this.groupbyInfo[N]:{},this.groupbyInfo[N].footer=B,this.groupbyDisplayOptions.hideFooter||(x.push(B),_.push("footer"))}if(this.groupbyStatus.groupedRowIndexArr=x,this.rowNumArr=_,this.options.foldAll)for(var N in this.groupbyInfo){"open"==(W=this.groupbyInfo[N].header).status&&0==W.depth&&this._foldRow(W)}else if(this.groupbyDisplayOptions.closeGroup&&_.length>0)for(var H in this.groupbyInfo){var W
;s==(W=this.groupbyInfo[H].header).groupId.split(this.groupbyStatus.groupbyDepthDelimiter).length&&"number"!=typeof W&&this.groupbyStatus.groupedRowIndexArr[W.index]==W&&this._foldRow(W)}this.lastTopRowIndex=null,this.rowIndex=0,this.setScrollYHeight(),t.sortOrder&&t.sortIndex?(this._dataList.broadcast({gridView:["notifyMultisort"]}),this._dataList.broadcast({gridView:["notifySettedFilter",[{isSort:!0,keepTop:t.keepTop}]],generalComp:"both"})):this.notifyDataChanged(),this.options.groupbyZoneMessage&&this.hideGroupbyZoneMessage(),this.options.groupbyZone&&this.syncWithGroupbyZone();var V=e.length;if(this.groupbyStatus.beforeSortIndexLength=V,a.D.isIE("8")&&this.drawData(0,null,"async"),this.groupbyStatus.grouped){var q=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(n=0;n<q.length;n++){var j=q[n],z=j.getAttribute("id");!z||z.match("RowNumber")||z.match("RowStatus")||"true"==j.getAttribute("useFilter")&&(document.getElementById(z+"_filter").style.display="none")}}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.clearGroupby=function(){try{this.clearGrouping=!0,this.groupbyStatus={},this.groupbyZoneStatus.beforeOpenedColIndex=null,this.groupbyZoneStatus.beforeOpenedColTagName=null,this.groupbyZoneStatus.clickedHeaderInfo=null,this.groupbyDisplayOptions=null,this.rowIndex=0,this.dataList.clearFilter(),this.clearHeaderSort(),this.clearGroupbyZone(),a.D.isIE("8"),this.options.groupbyZoneMessage&&this.showGroupbyZoneMessage(),this.groupbyFilterList&&this.hideGroupbyFilterList();var t=this.getDataLength();if(t<this.rowIndex+this.drawedRowLength)for(var e=t-this.rowIndex;e<this.drawedRowLength;e++)this.clearGroupedRow(e,e+this.rowIndex);this.clearGrouping=!1;var i=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(e=0;e<i.length;e++){var o=i[e],s=o.getAttribute("id");!s||s.match("RowNumber")||s.match("RowStatus")||"true"==o.getAttribute("useFilter")&&(document.getElementById(s+"_filter").style.display="")}if(this.options.customFilterBox&&this.groupbyFilterBox_history&&this.groupbyFilterBox_history.length>0&&!0===this.getElementById(this.id+"_groupbyFilterBox_apply").checked){var n=this.groupbyFilterBox_select.getSelectedIndex();this.groupbyFilterBox_history[n].groupbyOptions&&(this.notifyBeforeSettedColumnFilter(),this.refreshCustomFilterHistory(n),this.notifyAfterSettedColumnFilter())}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.toggleGroup=function(t){if(this.groupbyInfo[t]){var e=this.groupbyInfo[t].header;"number"!=typeof e&&this.dataList.getRealRowIndex(e.index)==e&&("open"==e.status?this._foldRow(e):this._unfoldRow(e),this.lastTopRowIndex=null,this.setScrollYHeight(),"open"==e.status?this.notifyRowInserted(e.index):this.notifyRowChanged(e.index),this.removeFocusedCell(),this.drawFooter())}},S.prototype._foldRow=function(t){if("open"==t.status){if(t.status="closed",this.groupbyDisplayOptions.hideFooter){for(var e,i=t.index+1;i<this.rowNumArr.length&&!("header"==this.rowNumArr[i]&&this.groupbyStatus.groupedRowIndexArr[i].depth<=t.depth);i++)e=i;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,e-t.index)}else{var o=this.groupbyInfo[t.groupId].footer;t.closedChildArr=this.groupbyStatus.groupedRowIndexArr.splice(t.index+1,o.index-t.index-1)}var s=[],r=t.closedChildArr.slice(0).sort();for(i=0;i<this.groupbyStatus.groupbyRowIndexArr.length;i++){for(var a=!1,n=0,l=r.length-1,h=0,d=this.groupbyStatus.groupbyRowIndexArr[i];n<=l;){if(d==r[h=Math.floor((n+l)/2)]){a=!0;break}d<r[h]?l=h-1:n=h+1}a||s.push(this.groupbyStatus.groupbyRowIndexArr[i])}this.groupbyStatus.groupbyRowIndexArr=s;var u=this.groupbyStatus.groupedRowIndexArr.length,p=0;this.rowNumArr=[];for(i=0;i<u;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?this.rowNumArr.push(p++):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,
this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},S.prototype._unfoldRow=function(t){if("closed"==t.status){t.status="open",t.closedChildArr.unshift(t.index+1,0),[].splice.apply(this.groupbyStatus.groupedRowIndexArr,t.closedChildArr),t.closedChildArr=[];var e=0;this.rowNumArr=[],this.groupbyStatus.groupbyRowIndexArr=[];for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++)"number"==typeof this.groupbyStatus.groupedRowIndexArr[i]?(this.rowNumArr.push(e++),this.groupbyStatus.groupbyRowIndexArr.push(this.groupbyStatus.groupedRowIndexArr[i])):(this.groupbyInfo[this.groupbyStatus.groupedRowIndexArr[i].groupId][this.groupbyStatus.groupedRowIndexArr[i].type].index=this.rowNumArr.length,this.rowNumArr.push(this.groupbyStatus.groupedRowIndexArr[i].type))}},S.prototype.foldAll=function(){for(var t in this.groupbyInfo){var e=this.groupbyInfo[t].header;"open"==e.status&&0==e.depth&&this._foldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},S.prototype.unfoldAll=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++){var e=this.groupbyStatus.groupedRowIndexArr[t];"number"!=typeof e&&"header"==e.type&&"closed"==e.status&&this._unfoldRow(e)}this.lastTopRowIndex=null,this.notifyDataChanged({keepTop:!0}),0==this.getDataLength()&&this.removeFocusedCell(),this.setScrollYHeight(),this.drawFooter(),this.drawHeader()},S.prototype.drawGroupData=function(t,e,i){var o,s,r,a=t,n=i*this.realRowDataLength,l=this.realRowDataLength;if("header"==e.type)o=this.groupbyDisplayOptions.rowNumHeader,s=this.groupbyDisplayOptions.rowStatusHeader,r=this.groupbyDisplayOptions.groupbyHeader;else{if("footer"!=e.type)return void(t.innerHTML="");o=this.groupbyDisplayOptions.rowNumFooter,s=this.groupbyDisplayOptions.rowStatusFooter,r=this.groupbyDisplayOptions.groupbyFooter}this.options.rowNumVisible&&(this._drawGroupData(a,e,o),o.hidden||(l-=o.colSpan||1),n++,a=this.all_data_td_list[n]),this.options.rowStatusVisible&&(this._drawGroupData(a,e,s),s.hidden||(l-=s.colSpan||1),n++,a=this.all_data_td_list[n]);for(var h={},d=0;d<l;d++)if(!h["domIndex_"+n]){n++;var u={};if(r instanceof Array?u=r[d]||{}:r instanceof Object&&"object"==typeof r&&(u=r["depth_"+e.depth][d]||{}),Number(u.targetIndex)>-1){var p=i*this.realRowDataLength+u.targetIndex;h["domIndex_"+p]=!0,this._drawGroupData(this.all_data_td_list[p],e,u)}else this._drawGroupData(a,e,u);a=this.all_data_td_list[n]}},S.prototype._drawGroupData=function(t,e,i){try{var o=i.className||"",s="gridBodyDefault w2grid_groupby w2grid_groupby_depth_"+e.depth+" "+o;t.className=s,t.innerHTML="";var a,n=i.colSpan,l=i.value||"",h=i.inputType||"",d=i.depthVisible||!1,u=i.align||"",p=i.expression||"",c=(n=i.colSpan||1,i.hidden?"none":""),g=i.displayFormatType||"text",f=i.displayFormat||"",m=i.displayFormatter||null;if(t.setAttribute("colSpan",n),t.style.align="",t.style.textAlign="",t.style.display=c,t.style.borderTopWidth="1px",t.style.borderBottomWidth="1px",h)switch((f||m)&&(a=new WebSquare.format.createFormatter(g,f,m,null,null,null,this.scope_id,this.id)),h){case"toggleButton":var y="<span class='"+("open"==e.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block;"+(u?"float:"+u+";":"")+" margin-left:"+20*e.depth+"px;'></span>";t.innerHTML+=y;break;case"expression":if(p){var b=this.groupbyInfo[e.groupId].header;b.colID=t.getAttribute("col_id");var w=0;if("open"==b.status){for(var v,I=!0,C=0,x=b.index;x<this.groupbyStatus.groupedRowIndexArr.length;x++){var _=this.groupbyStatus.groupedRowIndexArr[x];if(this.groupbyDisplayOptions.hideFooter&&I){I=!1;for(var S=x+1;S<this.groupbyStatus.groupedRowIndexArr.length;S++){var D=this.groupbyStatus.groupedRowIndexArr[S];if("header"==D.type&&_.depth>=D.depth)break;C=S}}if(this.groupbyDisplayOptions.hideFooter){if(x>=C){v=x;break}}else if("footer"==_.type&&_.depth==b.depth){v=_.index;break}}
w=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,b.index,v,p,b)}else w=this.groupExpression(b.closedChildArr,0,b.closedChildArr.length-1,p,b);a&&(w=a.format(w));var R="<span style='display:inline-block;"+(u?"float:"+u+";":"")+"''>"+w+"</span>";t.innerHTML+=R}}if(d){var L="";"toggleButton"!=h&&(L="margin-left: "+20*e.depth+"px"),t.innerHTML+="<span style='display:inline-block;"+(u?"float:"+u+";":"")+" "+(L||"")+"'>"+e.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - ")+"</span>"}l&&(a&&(l=a.format(l)),t.innerHTML+="<span style='display:inline-block;"+(u?"float:"+u+";":"")+"'>"+l+"</span>")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.groupExpression=function(t,e,i,o,s){try{var a=o;return a=(a=(a=(a=(a=(a=(a=(a=a.replace(/[sS][uU][mM][\s]*[(]/g,"_this.groupbySum(arr, startIndex, endIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.groupbyAvg(arr, startIndex, endIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.groupbyMax(arr, startIndex, endIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.groupbyMin(arr, startIndex, endIndex,")).replace(/[cC][oO][uU][nN][tT][\s]*[(]/g,"_this.groupbyCount(arr, startIndex, endIndex,")).replace(/[dD][eE][pP][tT][hH][\s]*[(]/g,"_this.groupbyDepth(header")).replace(/[tT][oO][gG][gG][lL][eE][\s]*[(]/g,"_this.groupbyToggle(header")).replace(/[dD][eE][pP][tT][hH][sS][tT][rR][\s]*[(]/g,"_this.groupbyDepthStr(header"),a=new Function("_this","arr","startIndex","endIndex","expression","header","return "+a)(this,t,e,i,o,s)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.groupbySum=function(t,e,i,o){for(var s=this.getColumnIndex(o),r=0,a=e;a<=i;a++)"number"==typeof t[a]?r+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0:"header"==t[a].type&&"closed"==t[a].status&&(r+=this.groupbySum(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o));return r},S.prototype.groupbyAvg=function(t,e,i,o){var s=this._groupbyAvg(t,e,i,o);return s.sum/s.number},S.prototype._groupbyAvg=function(t,e,i,o){for(var s=this.getColumnIndex(o),r={sum:0,number:0},a=e;a<=i;a++)if("number"==typeof t[a])r.sum+=parseFloat(this.dataList._getCellData(t[a],this.getColumnID(s),3))||0,r.number++;else if("header"==t[a].type&&"closed"==t[a].status){var n=this._groupbyAvg(t[a].closedChildArr,0,t[a].closedChildArr.length-1,o);r.sum+=n.sum,r.number+=n.number}return r},S.prototype.groupbyMax=function(t,e,i,o){for(var s=this.getColumnIndex(o),r=0,a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?r=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(s),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(r=this.groupbyMax(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(a=n=r),n&&a<r&&(a=r);return a},S.prototype.groupbyMin=function(t,e,i,o){for(var s,r=this.getColumnIndex(o),a=0,n=!1,l=e;l<=i;l++)"number"==typeof t[l]?a=parseFloat(this.dataList._getCellData(t[l],this.getColumnID(r),3))||0:"header"==t[l].type&&"closed"==t[l].status&&(a=this.groupbyMin(t[l].closedChildArr,0,t[l].closedChildArr.length-1,o)),n||(s=n=a),n&&s>a&&(s=a);return s},S.prototype.groupbyToggle=function(t){return"<span class='"+("open"==t.status?"w2grid_minus":"w2grid_plus")+"' style='display:inline-block; margin-left:"+20*t.depth+"px;'></span>"},S.prototype.groupbyDepth=function(t){return t.depth},S.prototype.groupbyDepthStr=function(t){for(var e=t.groupId.wq_replaceAll(this.groupbyStatus.groupbyDepthDelimiter," - "),i=!1,o=e.split(" - "),s=0;s<this.groupbyStatus.sortIndexArr.length;s++){var r=this.getCellInfo(this.groupbyStatus.sortIndexArr[s]);if("true"==r.options.groupbyDepthStrLabel)try{i=!0;var n=o[s];if(r.dataComp){var l=a.D.getComponentById(r.dataComp,r.scope_id);if(l){var h,d;r.itemsetObj&&(h=r.itemsetObj.label||"label",d=r.itemsetObj.value||"value"),r.element&&(h=r.element.getValue("w2:label","ref"),d=r.element.getValue("w2:value","ref"));for(var u=l.getAllJSON(),p=0;p<u.length;p++){var c=u[p];if(n==c[d]){o[s]=c[h];break}}}}else for(p=0;p<r.itemArr.length;p++)if(n==r.itemArr[p].value){
o[s]=r.itemArr[p].label;break}}catch(t){break}}return i&&(e=o.join(" - ")),e},S.prototype.groupbyCount=function(t,e,i){for(var o=0,s=e;s<=i&&s<t.length;s++)"number"==typeof t[s]?o++:"header"!=t[s].type||"closed"!=t[s].status||this.groupbyDisplayOptions.hideFooter||(o+=this.groupbyCount(t[s].closedChildArr,0,t[s].closedChildArr.length-1));return o},S.prototype.getCellInputType=function(t,e){try{var i=this.getCellInfo(e);if("custom"==i.options.inputType){var o=this.getRealRowIndex(t);return i.cellManagerHashByRowIndex[o].options.inputType}return i.options.inputType}catch(t){r.w.printStackTrace(t)}},S.prototype.setCellOption=function(t,e,i,o){var s=this.getColumnIndex(e),r=this.getExtraDataObj("cell",t,s);switch(i){case"viewType":r.key=o,this.rowIndex>=0&&this.drawCellData(t-this.rowIndex,t,s);break;default:var a=WebSquare.language.getMessage("Grid_warning4",this.id,i)||"["+this.id+"] "+i+"에 대한 변경은 처리할 수 없습니다.";$l(a)}},S.prototype.getCellOption=function(t,e,i){var o=this.getColumnIndex(e),s=this.getCellInfo(e);if("custom"!=s.options.inputType){var r=this.getExtraDataObj("cell",t,o);return null==r.key?s.options[i]:r.key}var a=s.cellManagerHashByRowIndex[t];if(a)return a.options[i]},S.prototype.getCustomCellOptions=function(t,e){try{var i=this.getCellInfo(e),o={};if("custom"==i.options.inputType){var s=this.getRealRowIndex(t),a=i.cellManagerHashByRowIndex[s];for(var n in a.initializeInfo)"id"!=n&&"displayRowIndex"!=n&&"realRowIndex"!=n&&(o[n]=a.initializeInfo[n])}return o}catch(t){r.w.printStackTrace(t)}},S.prototype.ungroupColumn=function(t){try{if(this.groupbyStatus.grouped){var e;"string"==typeof t?e=this.getColumnIndex(t):"number"==typeof t&&(e=t);for(var i=!0,o=this.groupbyStatus.sortIndexArr.length-1;o>=0;o--)if(this.groupbyStatus.sortIndexArr[o]==e){this.groupbyStatus.sortIndexArr.splice(o,1),this.groupbyStatus.sortOrderArr.splice(o,1),delete this.groupbyStatus.filter[this.getColumnID(e)],i=!1;break}if(i)return;if(this.groupbyFilterList&&this.groupbyFilterList.filterHistory.column.length>0)if(this.groupbyFilterList.filterHistory.column[0]===this.getColumnID(e))this.groupbyFilterList.filterHistory.column.shift(),this.groupbyFilterList.filterHistory.filteredRowIndexArr.shift();else{var s=this.groupbyFilterList.filterHistory.column.length,a=this.groupbyFilterList.filterHistory.filteredRowIndexArr[s-1].slice(0),n=0;for(o=0;o<s;o++)if(this.groupbyFilterList.filterHistory.column[o]===this.getColumnID(e)){this.groupbyFilterList.filterHistory.column.splice(o,1),this.groupbyFilterList.filterHistory.filteredRowIndexArr.splice(o,1),n=1;break}for(o=0;o<s-n;o++)this.groupbyFilterList.filterHistory.filteredRowIndexArr[o]=a}if(this.clearSearchData({clearValue:!0}),0==this.groupbyStatus.sortIndexArr.length)this.clearGroupby();else{var l=this.groupbyDisplayOptions;l.filter=this.groupbyStatus.filter,l.sortIndex=this.groupbyStatus.sortIndexArr,l.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(l)}}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.changeGroupDepth=function(t,e){try{if(this.groupbyStatus.grouped){var i,o,s,a;"string"==typeof t?i=this.getColumnIndex(t):"number"==typeof t&&(i=t),"string"==typeof e?o=this.getColumnIndex(e):"number"==typeof e&&(o=e);for(var n=0;n<this.groupbyStatus.sortIndexArr.length;n++)this.groupbyStatus.sortIndexArr[n]==i&&(a=n),this.groupbyStatus.sortIndexArr[n]==o&&(s=n);if("number"!=typeof a||"number"!=typeof s||a==s)return;this.groupbyStatus.sortIndexArr.splice(a,1),this.groupbyStatus.sortIndexArr.splice(s,0,i);var l=this.groupbyStatus.sortOrderArr.splice(a,1);this.groupbyStatus.sortOrderArr.splice(s,0,l);var h=this.groupbyDisplayOptions;h.filter=this.groupbyStatus.filter,h.sortIndex=this.groupbyStatus.sortIndexArr,h.sortOrder=this.groupbyStatus.sortOrderArr,this.groupby(h)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.removeGroupbyFilterList=function(){try{this.groupbyFilterList&&this.groupbyFilterList.remove()}catch(t){r.w.printStackTrace(t,null,this)}},
S.prototype._getGroupbyDisplayRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyDisplayRowIndex(t,e):t}catch(e){return r.w.printStackTrace(e,null,this),t}},S.prototype.__getGroupbyDisplayRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;var i=this._dataList.getFilteredRowIndex(this.getRealRowIndex(t));return null==i&&!0!==e&&(i=t),i}catch(e){return r.w.printStackTrace(e,null,this),t}},S.prototype._getGroupbyGroupedRowIndex=function(t,e){try{return this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped?this.__getGroupbyGroupedRowIndex(t,e):t}catch(e){return r.w.printStackTrace(e,null,this),t}},S.prototype.__getGroupbyGroupedRowIndex=function(t,e){try{if(!this.groupbyStatus.grouped)return t;for(var i,o=this._dataList.getRealRowIndex(t),s=0;s<this.groupbyStatus.groupedRowIndexArr.length;s++)if(o===this.groupbyStatus.groupedRowIndexArr[s]){i=s;break}return null==i&&!0!==e&&(i=t),i}catch(e){return r.w.printStackTrace(e,null,this),t}},S.prototype.isEditing=function(){try{return!!this.editedCell}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.readExcelFile=function(t,e,i,o,s,r,a,n){this.readFile(t,e,i,o,s,"excel",null,r,a,n)},S.prototype.readFile=function(t,e,i,o,s,r,a,n,l,h){o=void 0===o||"string"!=typeof o?this.options.excelUploadPopupURL:this.getURL(o),void 0!==s&&"string"==typeof s||(s="top=280,height=80,left=160,width=400,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no"),o+=1==(t=parseInt(t,10))?"?header=true":"?header=false",o+=1==(e=parseInt(e,10))?"&append=true":"&append=false",o+=1==n?"&fillHidden=true":"&fillHidden=false",o+=1==(i=parseInt(i,10))?"&hidden=true":"&hidden=false",o+=1==(h=h||0)?"&type=true":"&type=false",a&&(o+="&"+a),o+="&action="+this.options.excelUploadURL,o+="&gridID="+this.id;for(var d=[],u=this.defaultColCnt;u<this.hiddenList.length;u++)1==this.hiddenList[u]&&d.push(u-this.defaultColCnt);o+="&columnNum="+this.getTotalCol(),o+="&expressionColumns="+this.getExpressionColumnArr().join(","),o+="&hiddenColumns="+d.join(","),o+="&headerRows="+this.getElementById(this.id+"_head_table").rows.length,o+=l?"&gridStartRow="+l:"&gridStartRow=1",WebSquare.domain&&(o+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain)),window.open(o,"fileupWindow",s)},S.prototype.getExpressionColumnArr=function(t){var e,i=[];e=t&&"1"==t.ignoreSpan?this.getColCnt():this.getTotalCol();for(var o=0;o<e;o++)"expression"==this.getCellInfo(o).options.inputType?i.push("true"):i.push("false");return i},S.prototype.saveExcelFile=function(t,e,i,o,s,r,a,n){var l={};l.fileName=t,l.hidden=e,l.checkButton=i,l.type=o,l.hiddenExpand=s,l.saveList=r,l.useEuroLocale=a,l.httpReadOnly=n,this.saveExcel(l)},S.prototype.saveExcel=function(t){var e=t.processMsg;e&&e.length>0?WebSquare.layer.showProcessMessage(e,{scope:this.scope_id||""}):WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""});for(var i=t.fileName||"default",o=t.hidden||0,r=t.checkButton||0,a=t.type+""||"0",n=t.hiddenExpand||0,l=t.saveList||[],h=t.useEuroLocale||"false",d=t.password||"",u=new _.h.Hashtable,p=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],c=WebSquare.Elem.api.getElementsByTagName(p,"w2:column"),g=0;g<c.length;g++){var f=c[g],m=f.getAttribute("id");f.setAttribute("value",this.getHeaderValue(m))}if(u.put("style",WebSquare.xml.serialize(this.element._element)),"0"==a||""==a)u.put("data",this.getExcelAllXML()),u.put("footer_data",this.getExcelAllFooterXML());else if("2"==a){var y=this.getExcelAllXMLRaw();u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLRaw())}else{y=this.getExcelAllXMLDisplay(a);u.put("data",y),u.put("footer_data",this.getExcelAllFooterXMLDisplay())}var b=[];for(g=0;g<this.getTotalCol();g++){var w=this.getCellInfo(g).options.inputType;"checkbox"!=w&&"radio"!=w&&"button"!=w||b.push('"'+g+'"')}u.put("hiddenArr",this.getHiddenColumnArr()),u.put("fileName",i),u.put("hidden",o),
u.put("checkButton",r),u.put("type",a),u.put("rowNumVisible",this.options.rowNumVisible+"");var v=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var I=this.getLocaleValue(this.options.rowNumLocaleRef);I&&(v=I)}u.put("rowNumHeaderValue",v),u.put("hiddenExpand",n),u.put("checkButtonArr","<array><![CDATA[["+b.join(",")+"]]]></array>"),u.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),u.put("useEuroLocale",h),u.put("password",d),t.scopeId=this.scope_id||"",s.v.excelDownload(this.options.excelDownloadURL,u.toString(),"post",t)},S.prototype.saveExcelFile2=function(t,e,i,o,s,r){var a={};if(a.fileName=t,a.type=o,e+""=="0"){for(var n=[],l=this.defaultColCnt;l<this.hiddenList.length;l++)this.hiddenList[l]&&n.push(l-this.defaultColCnt);a.removeColumns=n.join(",")}var h=[];if(i+""=="0")for(l=0;l<this.getTotalCol();l++){var d=this.getCellInfo(l).options.inputType;"checkbox"!=d&&"radio"!=d&&"button"!=d||h.push(this.getCellInfo(l).options.colIndex-this.defaultColCnt)}for(l=this.defaultColCnt;l<this.hiddenList.length;l++)e+""=="1"&&s+""=="0"&&1==this.hiddenList[l]&&h.push(l-this.defaultColCnt);a.foldColumns=h.join(","),this.advancedExcelDownload(a)},S.prototype.getHiddenColumnArr=function(){for(var t=[],e=this.defaultColCnt;e<this.hiddenList.length;e++)t.push(this.hiddenList[e]);return'<array><![CDATA[["'+t.join('","')+'"]]]></array>'},S.prototype.fireFileReadEnd=function(t){var e=this;setTimeout((function(){d.B.fireEvent(e,"onfilereadend",t)}),10)},S.prototype.readCSV=function(t){var e={};t=t||{};e.wframe=t.wframe||!1;var i=t.type||"1",s=t.delim||",",r=t.escapeChar||"",n=t.header||"1",l=t.footer||"1",h=t.startRowIndex||"0",d=t.startColumnIndex||"0",u=t.append||"0",p=t.hidden||"0",c=t.advancedHidden||"0",g=t.fillHidden||"0",f=t.skipSpace||"0",m=t.removeColumns||"",y=t.optionParam||"",b=document.location.protocol+"//"+document.location.host+"/",w=t.popupUrl?b+t.popupUrl:o.x.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.js"),v=t.popupUrl||this.options.csvUploadPopupURL;v+="?";var I,C=t.processMsg||"",x="";if(e.name=t.name||"FILE UPLOAD",this.options.dataList){var _=this.modelControl.getDataComp(this.options.dataList);null!=_&&(x=_.id)}var S=t.status||"R",D=t.expression||"1",R=t.ignoreSpan||"0",L=t.maxFileSize||-1,T=t.csvUploadURL||"",k=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",A=t.columnOrder||"",F=t.useModalDisable||"false",E=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";if(e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,void 0===t.features||"string"!=typeof t.features)I="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else if(1==t.wframe){for(var M=t.features.split(","),O={},N=0;N<M.length;N++)0!=M[N].toLowerCase().indexOf("top")?0!=M[N].toLowerCase().indexOf("left")?0!=M[N].toLowerCase().indexOf("height")?0!=M[N].toLowerCase().indexOf("width")||(O.width=parseInt(M[N].split("=")[1])):O.height=parseInt(M[N].split("=")[1]):O.left=parseInt(M[N].split("=")[1]):O.top=parseInt(M[N].split("=")[1]);I=O}else I=t.features;e.sFeatures=I,n=parseInt(n,10),u=parseInt(u,10),p=parseInt(p,10),i=i||0,e.type=1==i?"true":"false",e.uploadType=i,e.delim=s,e.escapeChar=r,e.header=1==n?"true":"false",e.footer=1==l?"true":"false",e.append=1==u?"true":"false",e.hidden=1==p?"true":"false",1==c?(v+="&advancedHidden=true",e.advancedHidden="true"):(v+="&advancedHidden=false",e.advancedHidden="false"),e.fillHidden=1==g?"true":"false",e.skipSpace=1==f?"true":"false",e.removeColumns=m,e.optionParam=y,v+="&gridID="+this.id,e.gridID=this.id;var B=[];for(N=this.defaultColCnt;N<this.hiddenList.length;N++)1==this.hiddenList[N]&&B.push(N-this.defaultColCnt);var G,H=this.getExpressionColumnArr(t);if(e.expressionColumns=H.join(","),e.columnNum=H.length,e.hiddenColumns=B.join(","),
e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=h||"1",e.gridStartCol=d||"1",WebSquare.domain?(v+="&domain="+WebSquare.text.URLEncoder(WebSquare.domain),e.domain=WebSquare.text.URLEncoder(WebSquare.domain)):e.domain="",""==T&&(T=this.options.csvUploadURL),e.action=T,e.processMsg=WebSquare.text.BASE64URLEncoder(C),e.dataList=x,1==R){var W=[],V={},q=0;for(N=0;N<this.cellIdList.length;N++){for(var j=this.cellInfoHash[this.cellIdList[N]],z=parseInt(j.options.rowSpan)||1,P=parseInt(j.options.colSpan)||1,X=q,U=0;U<this.getRowCount()*this.getColCnt()&&W[X+U];U++)q++;for(var Z=0;Z<P;Z++){var K=q;W[K]=j.id,V[K]=!0;for(U=1;U<z;U++){var Y=q+U*this.getColCnt();W[Y]=j.id,V[Y]=!0}q+=1}}G=W.join(",")}else G=this.cellIdList.join(",");e.columnIds=G,e.expression=1==D?"false":"true",e.status=S,e.maxFileSize=L,e.postMsg=k,e.columnOrder=A,e.useModalDisable=F,e.useXHR=E;var $=a.D.getBoolean(e.wframe);if(this._csvUploadInfo=JSON.stringify(e),!0===$){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.D.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.D.isIE(7)||a.D.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.D.isIE(9)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.D.isIE(10)?(e.sizeInfo.height=162,e.sizeInfo.width=455):a.D.isIEAllVersion(11)?(e.sizeInfo.height=161,e.sizeInfo.width=455):a.D.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):a.D.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=198,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=200,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=198,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=197,e.sizeInfo.width=454):a.D.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.D.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.D.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==typeof e.sFeatures&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var J={type:"json",name:"csvPopupParam",data:e},Q={id:this.id+"_csvPop",type:"wframePopup",dataObject:J,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:w,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]&&(Q.scope_uuid=this.scope_obj.uuid),a.D.openPopup(Q.popupUrl,Q)}else v=WebSquare.BootLoader.getEngineUri(v),window.open(v,"csvupWindow",e.sFeatures)},S.prototype.saveCSV=function(t){var e=t.maxCellCount||-1;if(-1!=(e=parseInt(e,10))&&e<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var i=WebSquare.language.getMessage("Grid_warning8",e)||"Cell 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+e;return void alert(i)}var o=t.maxRowCount||-1;if(-1!=(o=parseInt(o,10))&&o<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){i=WebSquare.language.getMessage("Grid_warning10",o)||"Row 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+o;return void alert(i)}WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,
this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var r=(t=t||{}).fileName||"csvfile.csv",n=t.type||"1",l=t.delim||";",h=t.displayDelim||"true",d=t.removeColumns||"",u=t.header||"1",p=t.hidden||"0",c=t.checkButton||"1",g=t.removeQuotation||"1",f=t.removeNewLine||"1",m=t.saveList||"",y=this.options.rowNumHeaderValue||"";this.options.useLocale&&this.options.rowNumLocaleRef&&((W=this.getLocaleValue(this.options.rowNumLocaleRef))&&(y=W));var b="";"1"!=t.rowNumVisible&&"true"!=t.rowNumVisible&&1!=t.rowNumVisible||(b=this.options.rowNumVisible||"false");var w=t.textTable||"false",v=t.textTableAlign||"right",I=t.useFooter||"false",C=t.columnMove+""=="true",x=t.columnOrder||"",S=t.optionParam||"",D=t.aposPrefixOnNum||"0",R=t.aposPrefixOnText||"0",L=t.ignoreSpan||"0",T=t.maxDataSize||-1;T=parseInt(T,10);var k=t.csvDownloadURL||"",A=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=A+""=="true";for(var F=t.openFile||"false",E=t.sameSite||"",M=t.useHeaderCheckBoxLabel+""=="true",O=t.opencsv+""=="true",N=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],B=WebSquare.Elem.api.getElementsByTagName(N,"w2:column"),G=0;G<B.length;G++){var H=B[G];if("checkbox"===H.getAttribute("inputType")&&!0===M){var W,V=H.getAttribute("checkboxLabel")||H.getAttribute("value"),q=H.getAttribute("localeRef");if(this.options.useLocale&&q)(W=this.getLocaleValue(q))&&(V=W);H.setAttribute("value",V+"")}else{var j=H.getAttribute("id");H.setAttribute("value",this.getHeaderValue(j)+"")}}var z=new _.h.Hashtable,P="";P="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),z.put("style",P),"0"==n?(z.put("data",this.getExcelAllXML()),"true"==I?z.put("footer_data",this.getExcelAllFooterXML()):z.put("footer_data","<array><![CDATA[[]]]></array>")):(z.put("data",this.getExcelAllXMLDisplay(n)),"true"==I?z.put("footer_data",this.getExcelAllFooterXMLDisplay()):z.put("footer_data","<array><![CDATA[[]]]></array>"));var X,U=[];for(G=0;G<this.getTotalCol();G++){var Z=this.getCellInfo(G).options.inputType;"checkbox"!=Z&&"radio"!=Z&&"button"!=Z||U.push('"'+G+'"')}C&&(X=""==x?this.getColumnOrder()||"":x.split(","));var K=[];if(""!=d){var Y=(d+="").split(",");if(C)for(G=0;G<Y.length;G++)for(var $=0;$<X.length;$++)Y[G]==X[$]&&K.push($);else K=Y;K.sort((function(t,e){return 1*t-1*e})),d=K.join(",")}var J=d;J='"'+J.wq_replaceAll(",",'","')+'"',z.put("hiddenArr",this.getHiddenColumnArr()),z.put("fileName",r),z.put("hidden",p),z.put("checkButton",c),z.put("type",n),z.put("rowNumVisible",b),z.put("rowNumHeaderValue",y),z.put("removeQuotation",g),z.put("delim",l),z.put("displayDelim",h),z.put("header",u),z.put("textTable",w),z.put("textTableAlign",v),z.put("useFooter",I),z.put("columnMove",C),z.put("columnOrder",X),z.put("optionParam",S),z.put("aposPrefixOnNum",D),z.put("aposPrefixOnText",R),z.put("ignoreSpan",L),z.put("removeNewLine",f),z.put("checkButtonArr","<array><![CDATA[["+U.join(",")+"]]]></array>"),""!=m&&z.put("saveList",'<array><![CDATA[["'+m.join('","')+'"]]]></array>'),z.put("removeColumns","<array><![CDATA[["+J+"]]]></array>"),z.put("openFile",F),""!=E&&z.put("sameSite",E),z.put("opencsv",O),z.put("useXHR",A);var Q=z.toString();if(-1!=T&&T<a.D.getByteLengthUtf8(Q)){i=WebSquare.language.getMessage("Grid_warning9",T)||"전송 data가 제한 크기를 초과 하였습니다.\n 제한 크기 : "+e+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(i)}""==k&&(k=this.options.csvDownloadURL),t.scopeId=this.scope_id||"",s.v.excelDownload(k,Q,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,
this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0))},S.prototype.saveCSVFile=function(t,e,i,o,r,a,n,l,h){WebSquare.layer.showProcessMessage("download...",{scope:this.scope_id||""}),n+="";var d=new _.h.Hashtable,u="";u="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),d.put("style",u),"0"==n||""==n?(d.put("data",this.getExcelAllXML()),d.put("footer_data",this.getExcelAllFooterXML())):(d.put("data",this.getExcelAllXMLDisplay(n)),d.put("footer_data",this.getExcelAllFooterXMLDisplay()));for(var p=[],c=0;c<this.getTotalCol();c++){var g=this.getCellInfo(c).options.inputType;"checkbox"!=g&&"radio"!=g&&"button"!=g||p.push('"'+c+'"')}var f=h||"";f='"'+f.wq_replaceAll(",",'","')+'"',d.put("hiddenArr",this.getHiddenColumnArr()),d.put("fileName",t),d.put("hidden",o),d.put("checkButton","1"),d.put("type",n),d.put("rowNumVisible",this.options.rowNumVisible);var m=this.options.rowNumHeaderValue||"";if(this.options.useLocale&&this.options.rowNumLocaleRef){var y=this.getLocaleValue(this.options.rowNumLocaleRef);y&&(m=y)}d.put("rowNumHeaderValue",m),d.put("removeQuotation",a),d.put("delim",e),d.put("header",i),d.put("checkButtonArr","<array><![CDATA[["+p.join(",")+"]]]></array>"),void 0!==l&&l&&d.put("saveList",'<array><![CDATA[["'+l.join('","')+'"]]]></array>'),d.put("removeColumns","<array><![CDATA[["+f+"]]]></array>"),s.v.excelDownload(this.options.csvDownloadURL,d.toString(),"post",{scopeId:this.scope_id||""})},S.prototype.getExcelUploadInfo=function(t){var e={},i=(t=t||{}).type||"0",o=t.removeColumns||"",s=t.startRowIndex||"0",r=t.startColumnIndex||"0",a=t.endColumnIndex||"-1",n=t.ignoreStartRowIndexInSAX+""||"1",l=t.ignoreStartColumnIndexInSAX+""||"1",h=t.sheetNo||"0",d=t.sheetName||"",u=t.activeSheet||!1,p=t.headerExist||"0";0===t.footerExist&&(t.footerExist="0");var c=t.footerExist||"1",g=t.append||"0",f=t.hidden||"0",m=t.fillHidden||"0",y=t.optionParam||"",b=t.skipSpace||"0",w=t.insertColumns||[],v=t.processMsg||"",I="";if(this.options.dataList){var C=this.modelControl.getDataComp(this.options.dataList);null!=C&&(I=C.id)}for(var x=t.status||"R",_=t.delim||",",S="",D="",R="",L=t.pwd||"",T=t.loadingMode||"",k=t.maxFileSize||"-1",A=t.cellDataConvertor||"",F=t.decimal||"4",E=t.applyDecimal||"0",M=t.useModalDisable||"false",O=t.useMaxByteLength||"false",N=1==this.options.postMsg?this.options.postMsg:t.postMsg||"false",B=t.dateFormat||"yyyy-MM-dd",G=t.byteCheckEncoding||"EUC-KR",H=t.columnOrder||"",W=t.columnMove+""=="true",V=t.chunkNum||0,q=t.trim||0,j=t.useXHR+""=="true",z=0;z<w.length;z++){var P=w[z],X=P.columnIndex+""||"",U=P.columnValue+""||"";""!=X&&(S=S+D+X+","+U,D="|")}if(void 0===t.features||"string"!=typeof t.features)R="top=280,height=137,left=160,width=446,location=no,menubar=no,resizable=yes,scrollbars=auto,status=no,titlebar=yes,toolbar=no";else if(1==t.wframe){var Z=t.features.split(","),K={};for(z=0;z<Z.length;z++)0!=Z[z].toLowerCase().indexOf("top")?0!=Z[z].toLowerCase().indexOf("left")?0!=Z[z].toLowerCase().indexOf("height")?0!=Z[z].toLowerCase().indexOf("width")||(K.width=parseInt(Z[z].split("=")[1])):K.height=parseInt(Z[z].split("=")[1]):K.left=parseInt(Z[z].split("=")[1]):K.top=parseInt(Z[z].split("=")[1]);R=K}else R=t.features;e.sFeatures=R,p=parseInt(p,10),g=parseInt(g,10),f=parseInt(f,10),c=parseInt(c,10),e.header=1==p?"true":"false",e.footer=1==c?"true":"false",e.append=1==g?"true":"false",e.removeColumns=o,e.fillHidden=1==m?"true":"false",e.hidden=1==f?"true":"false",e.type=1==i?"true":"false",e.uploadType=i,e.skipSpace=1==b?"true":"false",e.insertColumns=S,e.optionParam=y,t.advancedExcelUploadURL?e.action=t.advancedExcelUploadURL:e.action=this.options.advancedExcelUploadURL,e.gridID=this.id;var Y=[];for(z=this.defaultColCnt;z<this.hiddenList.length;z++)1==this.hiddenList[z]&&Y.push(z-this.defaultColCnt);if(e.columnNum=this.getTotalCol(),
e.expressionColumns=this.getExpressionColumnArr().join(","),e.hiddenColumns=Y.join(","),e.headerRows=this.getElementById(this.id+"_head_table").rows.length,e.gridStartRow=s||"1",e.gridStartCol=r||"1",e.gridEndCol=a,e.ignoreStartRowIndexInSAX="0"==n?"true":"false",e.ignoreStartColumnIndexInSAX="0"==l?"true":"false",e.gridSheetNo=h||"0",e.gridSheetName=d,e.activeSheet=u,e.applyDecimal="0"==E?"false":"true",WebSquare.domain&&(e.domain=WebSquare.text.URLEncoder(WebSquare.domain)),e.processMsg=WebSquare.text.BASE64URLEncoder(v),e.delim=_,e.dataList=I,!0===W){var $=this.htmlInfo.body.rowAttrArr.length,J=this.getColumnOrder(),Q=J.length,tt=new Array(Q);for(z=0;z<$;z++)for(var et=0;et<Q;et++)tt[Q*z+et]=this.getColumnID(Q*z+J[et]);e.columnIds=tt.join(",")}else e.columnIds=this.cellIdList.join(",");return e.trim=1==q,e.status=x,e.pwd=L,e.loadingMode=T,e.maxFileSize=k,e.cellDataConvertor=A,e.decimal=F,e.useModalDisable=M+"",e.useMaxByteLength=O+"",e.postMsg=N+"",e.dateFormat=B,e.byteCheckEncoding=G,e.columnOrder=H,e.wframe=t.wframe||!1,e.name=t.name||"FILE UPLOAD",e.className=t.className||"",e.resizable=0!=t.resizable||t.resizable,e.windowDragMove=t.windowDragMove||!1,e.chunkNum=parseInt(V,10),e.useXHR=j,t.convertIndex&&(t.convertIndex=t.convertIndex.wq_replaceAll(" ",""),e.convertIndexArr=t.convertIndex.split(",")),"grid"==this.initializeType&&this.options.ref&&t.instanceBind&&(e.instanceBind=t.instanceBind),e},S.prototype.advancedExcelUpload=function(t){var e=this.getExcelUploadInfo(t),i=t.popupUrl||this.options.advancedExcelUploadPopupURL,s=document.location.protocol+"//"+document.location.host+"/",r=t.popupUrl?s+t.popupUrl:o.x.baseURI+WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.js"),n=t.advancedHidden||"0",l="";i+="?gridID="+e.gridID,WebSquare.domain&&(i+="&domain="+e.domain),i+=1==n?"&advancedHidden=true":"&advancedHidden=false",""!=e.pwd&&(l=WebSquare.text.BASE64Encoder(e.pwd)),e.pwd=l;var h=a.D.getBoolean(e.wframe);if(this._excelUploadInfo=JSON.stringify(e),!0===h){e.sizeInfo={},e.osName="",e.sizeInfo.top=e.sFeatures.top?e.sFeatures.top:160,e.sizeInfo.left=e.sFeatures.left?e.sFeatures.left:280,-1!=navigator.userAgent.indexOf("Windows")?e.osName="window":-1!=navigator.userAgent.indexOf("Macintosh")&&(e.osName="mac"),a.D.isIE(6)?(e.sizeInfo.height=212,e.sizeInfo.width=456):a.D.isIE(7)||a.D.isIE(8)?(e.sizeInfo.height=218,e.sizeInfo.width=457):a.D.isIE(9)?(e.sizeInfo.height=204,e.sizeInfo.width=446):a.D.isIE(10)?(e.sizeInfo.height=162,e.sizeInfo.width=455):a.D.isIEAllVersion(11)?(e.sizeInfo.height=198,e.sizeInfo.width=455):a.D.isSpartan()?(e.sizeInfo.height=178,e.sizeInfo.width=446):a.D.isChrome()?-1!=navigator.userAgent.indexOf("OPR")?"window"==e.osName?(e.sizeInfo.height=164,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):"window"==e.osName?(e.sizeInfo.height=200,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=198,e.sizeInfo.width=454):a.D.isFF()?"window"==e.osName?(e.sizeInfo.height=163,e.sizeInfo.width=454):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.D.isSafari()?"window"==e.osName?(e.sizeInfo.height=160,e.sizeInfo.width=470):"mac"==e.osName&&(e.sizeInfo.height=160,e.sizeInfo.width=454):a.D.isOpera()&&("window"==e.osName?(e.sizeInfo.height=189,e.sizeInfo.width=446):"mac"==e.osName&&(e.sizeInfo.height=233,e.sizeInfo.width=460)),"object"==typeof e.sFeatures&&(e.sizeInfo.height=e.sFeatures.height?e.sFeatures.height:e.sizeInfo.height,e.sizeInfo.width=e.sFeatures.width?e.sFeatures.width:e.sizeInfo.width);var d={type:"json",name:"popupParam",data:e},u={id:this.id+"_excelPop",type:"wframePopup",dataObject:d,popupName:e.name,style:"",useIFrame:!1,className:e.className,modal:!0,srcORurl:"",srcData:null,destData:null,xml:null,popupUrl:r,left:e.sizeInfo.left,top:e.sizeInfo.top,width:e.sizeInfo.width,height:e.sizeInfo.height,resizable:e.resizable,status:!1,menubar:!1,scrollbars:!1,title:!0,useControl:!1,controls:{minimize:!0,maximize:!0,close:!0},
disableCloseButton:!1,fullscreen:!1,alwaysOnTop:!0,foldSize:{width:500},windowDragMove:e.windowDragMove,processMsgFrame:!0};if(this.scope_obj&&WebSquare.idCache[this.scope_obj.uuid]){u.scope_uuid=this.scope_obj.uuid;for(var p=this.scope_obj;p;){if(p._isWframePopup){u.useModalStack=!0;break}p=p.getParentFrame()}}a.D.openPopup(u.popupUrl,u)}else i=WebSquare.BootLoader.getEngineUri(i),window.open(i,"fileupWindow",e.sFeatures)},S.prototype.advancedExcelDownload=function(t,e){try{var i=t.maxCellCount||-1;if(-1!=(i=parseInt(i,10)))if(i<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()*this.getColCnt()){var o=WebSquare.language.getMessage("Grid_warning8",i)||"Cell 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+i;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}var s=t.maxRowCount||-1;if(-1!=(s=parseInt(s,10)))if(s<(this.htmlInfo.body.rowAttrArr.length||1)*this.getRowCount()){o=WebSquare.language.getMessage("Grid_warning10",s)||"Row 개수가 제한 크기를 초과 하였습니다.\n 제한 개수 : "+s;return WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(o)}this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.orgStatusArr=this.drilldown.statusArr,this.orgFilteredRowIndexArr=this._dataList.filteredRowIndexArr,this.orgShowDepth=this.showDepth,this.showDepth="9999",this.initDrilldown());var a=parseInt(t.rowsByN);switch(t.rowsByN=a>100?a:100,t.dataLength=this.getDataLength(),t.multiexcel=!1,t.dataProvider=t.dataProvider||"",t.splitProvider=t.splitProvider||"",t.scope=this.scope_id||"",t.type+""){case"":case"0":t.type=0;break;case"2":t.type=2;break;default:t.type=1}if(!1===t.showProcess)WebSquare.getBody().showModal("w2modal_gridDownload");else if(!0===t.showConfirm)t.massStorage=!0,window.downloadGridId=this.id,WebSquare.getBody().showModal(),this.showSendExcelLayer();else{var n=t.processMsg;n&&n.length>0?WebSquare.layer.showProcessMessage(n,t):WebSquare.layer.showProcessMessage("download...",t)}if(0===t.type||1===t.type||2==t.type){t.cellInfo=[],t.isPlainDataCol=[],t.isSelectCol=[],t.isBasicCol=[],t.isExpCol=[],t.isCustomCol=[],t.isCustomModelCol=[],t.isCustomType=[],t.isEscapeFormatter=[];for(var l=this.oneRowDataLength,h=0;h<l;h++){var d=this.getCellInfo(h),u=d.options.inputType;t.cellInfo[h]=d,t.isCustomType[h]="custom"===u,t.isPlainDataCol[h]="checkbox"===u||"image"===u||"radio"===u,t.isSelectCol[h]="select"===u||"checkcombobox"===u||"autoComplete"===u,t.isExpCol[h]="expression"===u,t.isCustomCol[h]=d.useCustomFormatter,t.isCustomModelCol[h]=d.useCustomModelFormatter,t.isBasicCol[h]=!(t.isPlainDataCol[h]||t.isSelectCol[h]||t.isExpCol[h]||t.isCustomCol[h]||t.isCustomModelCol[h]||t.isCustomType[h]),t.isEscapeFormatter[h]=d.useEscapeFormatter}}this.makeExcelData(0,[],t,e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.showSendExcelLayer=function(){if(void 0!==window.gridExceldownloadIframe){window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.style.display="block";var t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.visibility="visible",window.gridExceldownloadIframe.contentWindow.initialize()}else{window.gridExceldownloadIframe=document.createElement("iframe"),window.gridExceldownloadIframe.style.visibility="hidden",window.gridExceldownloadIframe.setAttribute("id","gridDownLoadLayer"),window.gridExceldownloadIframe.setAttribute("src",this.options.advancedExcelDownloadPopupURL),window.gridExceldownloadIframe.setAttribute("frameBorder","0"),window.gridExceldownloadIframe.className="w2grid_downloadIframe",window.gridExceldownloadIframe.style.width="300px",window.gridExceldownloadIframe.style.overflow="hidden",
document.body.appendChild(window.gridExceldownloadIframe);t=document.documentElement.scrollTop+document.documentElement.clientHeight/2-parseInt(window.gridExceldownloadIframe.offsetHeight)/2,e=document.documentElement.scrollLeft+document.documentElement.clientWidth/2-parseInt(window.gridExceldownloadIframe.offsetWidth)/2;window.gridExceldownloadIframe.style.left=e+"px",window.gridExceldownloadIframe.style.top=t+"px",window.gridExceldownloadIframe.style.position="absolute",window.gridExceldownloadIframe.style.visibility="visible"}},S.prototype.checkUpload=function(){var t=this;setTimeout((function(){1==t.downloadInit?window.gridExceldownloadIframe.contentWindow.checkUpload("end"):t.checkUpload()}),10)},S.prototype.sendExcelData=function(t,e,i){"boolean"==typeof t.useFooter&&(t.useFooter=t.useFooter+"");var o=WebSquare.xml.encode(t.fileName)||"excel",r=t.sheetName||"sheet",n=t.type||"0",l="false";if(1==t.multiexcel){var h=t.multipleSheet;void 0===t.multipleSheet&&(h=""),l=h+""=="true"||h+""==""?"true":"false"}else l="false";var d=t.removeColumns||"",u=t.removeHeaderRows||"",p=t.foldColumns||"",c=t.startRowIndex||"0",g=t.startColumnIndex||"0",f=t.headerColor||"",m=t.headerFontName||"",y=t.headerFontSize||"",b=t.headerFontColor||"",w=t.headerFontBold||"",v=t.bodyColor||"",I=t.bodyFontName||"",C=t.bodyFontSize||"",x=t.bodyFontColor||"",_=t.footerColor||"",S=t.footerFontName||"",D=t.footerFontSize||"",R=t.footerFontColor||"",L=t.subTotalColor||"",T=t.subTotalFontName||"",k=t.subTotalFontSize||"",A=t.subTotalFontColor||"",F=t.rowNumHeaderColor||"",E=t.rowNumHeaderFontName||"",M=t.rowNumHeaderFontSize||"",O=t.rowNumHeaderFontColor||"",N=t.rowNumBodyColor||"",B=t.rowNumBodyFontName||"",G=t.rowNumBodyFontSize||"",H=t.rowNumBodyFontColor||"",W=t.rowNumFooterColor||"",V=t.rowNumFooterFontName||"",q=t.rowNumFooterFontSize||"",j=t.rowNumFooterFontColor||"",z=t.rowNumSubTotalColor||"",P=t.rowNumSubTotalFontName||"",X=t.rowNumSubTotalFontSize||"",U=t.rowNumSubTotalFontColor||"",Z=t.dataProvider||"",K=t.footerDataProvider||"",Y=t.splitProvider||"",$=t.providerRequestXml||"",J=t.userDataXml||"",Q=t.optionParam||"",tt=t.bodyWordwrap||"",et=t.subtotalWordwrap||"",it=t.footerWordwrap||"",ot=t.useEuroLocale||"false",st=t.useHeader||"true",rt=t.useSubTotal||"false",at=t.useFooter||"true";t.printSet=t.printSet||{};var nt=t.printSet.fitToPage||"false",lt=t.printSet.landScape||"false",ht=t.printSet.fitWidth||"1",dt=t.printSet.fitHeight||"1",ut=t.printSet.scale||"100",pt=t.printSet.pageSize||"A4",ct=t.separator||",",gt=t.subTotalScale||-1,ft=t.subTotalRoundingMode||"",mt=t.footerScale||-1,yt=t.footerRoundingMode||"",bt=t.useStyle+""=="true",wt=t.setFontSize+""=="true",vt=t.freezePane||"",It=t.autoSizeColumn||"false",Ct=t.autoSizeAdjustWith||512,xt=t.displayGridlines||"",_t=t.colMerge||"false",St=t.colMergeValue||"false",Dt=t.colMergeTextAlign||"center",Rt=t.useDataFormat||"false",Lt=t.applyDataFormat||"false",Tt=t.customToDataType||"false",kt=t.useSubTotalData+""=="true",At=t.useFooterData+""=="true",Ft=t.calcFooter+""=="true",Et=t.columnMove+""=="true",Mt=t.columnOrder||"";Ft&&(Et=!1);var Ot=t.columnMoveWithSubTotal||"",Nt=t.columnMoveWithFooter||"",Bt=t.oddRowBackgroundColor||"",Gt=t.evenRowBackgroundColor||"",Ht=t.indent||"0",Wt=WebSquare.xml.encode(this.options.rowNumHeaderValue)||t.rowNumHeaderValue||"";this.options.useLocale&&this.options.rowNumLocaleRef&&((ti=this.getLocaleValue(this.options.rowNumLocaleRef))&&(Wt=ti));var Vt=t.rowNumVisible+""=="true",qt=this.options.startRowNumber||"1",jt=t.bodyNumberDefaultValue||"",zt=t.numberToText||"false",Pt=t.rowHeight||"-1",Xt=t.headerRowHeight||"-1",Ut=t.maxDataSize||-1;Ut=parseInt(Ut,10);var Zt=t.pwd||"",Kt=t.useImage||"false",Yt=t.headerAutoFilter||"false",$t=t.filterRowIndex||"-1",Jt=t.mergeCell+""=="true",Qt=t.noMerge+""=="true";t.httpReadOnly=t.httpReadOnly+""=="true";var te=t.advancedExcelDownloadURL||"",ee=1==this.options.useXHR?this.options.useXHR:t.useXHR||"false";t.useXHR=ee+""=="true"
;var ie,oe=t.openFile||"false",se=t.macroFileName||"",re=t.useMacro||"false",ae=t.showDialog||"false",ne=t.dialogFilter||"",le=t.keepType||"false",he=t.useHeaderCheckBoxLabel+""=="true",de=t.lazyInfoArr||"false",ue=t.decimal||"",pe=t.sameSite||"",ce=t.customProvider||"",ge=t.customProviderIndex||"",fe=t.rowAccessWindowSize||"",me=t.trim||"",ye=t.chart||{};if(ye.chartName)var be=ye.chartName||"line",we=ye.chartType||"",ve=ye.title||"",Ie=ye.xTitle||"",Ce=ye.yTitle||"",xe=ye.startRowIndex||0,_e=ye.startColIndex||0,Se=ye.endRowIndex||0,De=ye.endColIndex||0,Re=ye.serAxis||"true",Le=ye.catAxis||"true",Te=ye.catAxisRange||{},ke=Te.startColIndex||0,Ae=Te.startRowIndex||0,Fe=Te.endColIndex||0,Ee=Te.endRowIndex||0,Me=ye.serAxisRange||{},Oe=Me.startColIndex||0,Ne=Me.startRowIndex||0,Be=Me.endColIndex||0,Ge=Me.endRowIndex||0,He=ye.dataAxisRange||{},We=He.startColIndex||0,Ve=He.startRowIndex||0,qe=He.endColIndex||0,je=He.endRowIndex||0,ze=ye.catGridLines||"true",Pe=ye.serGridLines||"true",Xe=ye.legend||"true",Ue=ye.legendPosition||"bottom";Et&&(ie=""==Mt?this.getColumnOrder()||"":Mt.split(","));var Ze=[];if(""!=d){var Ke=(d+="").split(",");if(Et)for(var Ye=0;Ye<Ke.length;Ye++)for(var $e=0;$e<ie.length;$e++)Ke[Ye]==ie[$e]&&Ze.push($e);else Ze=Ke;Ze.sort((function(t,e){return 1*t-1*e})),d=Ze.join(",")}var Je=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:header")[0],Qe=WebSquare.Elem.api.getElementsByTagName(Je,"w2:column");for(Ye=0;Ye<Qe.length;Ye++){if("checkbox"===(mi=Qe[Ye]).getAttribute("inputType")&&!0===he){var ti,ei=mi.getAttribute("checkboxLabel")||mi.getAttribute("value"),ii=mi.getAttribute("localeRef");if(this.options.useLocale&&ii)(ti=this.getLocaleValue(ii))&&(ei=ti);mi.setAttribute("value",ei+"")}else{var oi=mi.getAttribute("id");mi.setAttribute("value",this.getHeaderValue(oi)+"")}}var si=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:gBody");if(si.length>0){var ri=si[0],ai=WebSquare.Elem.api.getElementsByTagName(ri,"w2:row");for(Ye=0;Ye<ai.length;Ye++)for(Qe=WebSquare.Elem.api.getElementsByTagName(ai[Ye],"w2:column"),$e=0;$e<Qe.length;$e++){oi=(mi=Qe[$e]).getAttribute("id");var ni=this.getCellInfo(oi);ni.options.displayFormat&&mi.setAttribute("displayFormat",ni.options.displayFormat);var li=mi.getAttribute("excelCellType"),hi="";(hi=null==li?this._dataList.getColumnOption(oi,"dataType"):li)?mi.setAttribute("dataType",hi):mi.setAttribute("dataType","text");var di=mi.getAttribute("excelFormatter");if(yi=a.D.getGlobalFunction(di,this.scope_id)){var ui=yi.call(this,oi);mi.setAttribute("excelFormat",ui)}}}var pi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:subTotal");for(Ye=0;Ye<pi.length;Ye++){ai=WebSquare.Elem.api.getElementsByTagName(pi[Ye],"w2:row");for($e=0;$e<ai.length;$e++){Qe=WebSquare.Elem.api.getElementsByTagName(ai[$e],"w2:column");for(var ci=0;ci<Qe.length;ci++){oi=(mi=Qe[ci]).getAttribute("id"),di=mi.getAttribute("excelFormatter");if(yi=a.D.getGlobalFunction(di,this.scope_id)){ui=yi.call(this,oi);mi.setAttribute("excelFormat",ui)}}}}var gi=WebSquare.Elem.api.getElementsByTagName(this.element,"w2:footer");if(gi.length>0){var fi=gi[0];ai=WebSquare.Elem.api.getElementsByTagName(fi,"w2:row");for(Ye=0;Ye<ai.length;Ye++)for(Qe=WebSquare.Elem.api.getElementsByTagName(ai[Ye],"w2:column"),$e=0;$e<Qe.length;$e++){var mi,yi;oi=(mi=Qe[$e]).getAttribute("id"),di=mi.getAttribute("excelFormatter");if(yi=a.D.getGlobalFunction(di,this.scope_id)){ui=yi.call(this,oi);mi.setAttribute("excelFormat",ui)}}}var bi=[];bi.push("<vector result='1'>"),bi.push("<data vectorkey='0'><hashtable>");var wi="";wi="json"===this.element._elementType?WebSquare.xmljs.json2xml(this.element._element,{changeKey:{"w2:select":"w2:column"}}):WebSquare.xml.serialize(this.element._element),bi.push("<data hashkey='style'>"+wi+"</data>"),bi.push("<data hashkey='data'>"+i+"</data>"),(this.startedDisplayNone||0==this.resizeObj.width||0==this.resizeObj.height)&&this.drawFooter(),
bi.push("<data hashkey='groupby' value='"+this.groupbyStatus.grouped+"'/>"),t.groupby&&this.groupbyStatus.grouped?(bi.push("<data hashkey='groupbyStyle'>"+this.getExcelGroupbyStyle()+"</data>"),bi.push("<data hashkey='groupbyHeaderValue'>"+this.getExcelGroupbyHeaderValue()+"</data>"),bi.push("<data hashkey='groupbyFooterValue'>"+this.getExcelGroupbyFooterValue()+"</data>"),bi.push("<data hashkey='groupbyStatusValue'>"+this.getExcelGroupbyStatusValue()+"</data>"),bi.push("<data hashkey='groupbyStyleData'>"+this.getExcelGroupbyStyleData()+"</data>"),bi.push("<data hashkey='rowNumVisible' value='"+this.options.rowNumVisible+"'/>"),bi.push("<data hashkey='rowStatusVisible' value='"+this.options.rowStatusVisible+"'/>"),a.D.isEmptyObject(this.groupbyDisplayOptions.rowNumHeader)&&a.D.isEmptyObject(this.groupbyDisplayOptions.rowStatusHeader)||bi.push("<data hashkey='rowNone' value='true'/>")):bi.push("<data hashkey='rowNumVisible' value='"+Vt+"'/>"),0==n?bi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXML(ct)+"</data>"):1==n?bi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLDisplay(ct)+"</data>"):bi.push("<data hashkey='footer_data'>"+this.getExcelAllFooterXMLRaw(ct)+"</data>"),bi.push("<data hashkey='fileName' value='"+o+"'/>"),bi.push("<data hashkey='sheetName' value='"+r+"'/>"),bi.push("<data hashkey='multipleSheet' value='"+l+"'/>"),bi.push("<data hashkey='stRowIndex' value='"+c+"'/>"),bi.push("<data hashkey='stColIndex' value='"+g+"'/>"),bi.push("<data hashkey='removeColumns' value='"+d+"'/>"),bi.push("<data hashkey='removeHeaderRows' value='"+u+"'/>"),bi.push("<data hashkey='foldColumns' value='"+p+"'/>"),bi.push("<data hashkey='headerColor' value='"+f+"'/>"),bi.push("<data hashkey='headerFontName' value='"+m+"'/>"),bi.push("<data hashkey='headerFontSize' value='"+y+"'/>"),bi.push("<data hashkey='headerFontColor' value='"+b+"'/>"),bi.push("<data hashkey='headerFontBold' value='"+w+"'/>"),bi.push("<data hashkey='bodyColor' value='"+v+"'/>"),bi.push("<data hashkey='bodyFontName' value='"+I+"'/>"),bi.push("<data hashkey='bodyFontSize' value='"+C+"'/>"),bi.push("<data hashkey='bodyFontColor' value='"+x+"'/>"),bi.push("<data hashkey='footerColor' value='"+_+"'/>"),bi.push("<data hashkey='footerFontName' value='"+S+"'/>"),bi.push("<data hashkey='footerFontSize' value='"+D+"'/>"),bi.push("<data hashkey='footerFontColor' value='"+R+"'/>"),bi.push("<data hashkey='subTotalColor' value='"+L+"'/>"),bi.push("<data hashkey='subTotalFontName' value='"+T+"'/>"),bi.push("<data hashkey='subTotalFontSize' value='"+k+"'/>"),bi.push("<data hashkey='subTotalFontColor' value='"+A+"'/>"),Vt&&(bi.push("<data hashkey='rowNumHeaderColor' value='"+F+"'/>"),bi.push("<data hashkey='rowNumHeaderFontName' value='"+E+"'/>"),bi.push("<data hashkey='rowNumHeaderFontSize' value='"+M+"'/>"),bi.push("<data hashkey='rowNumHeaderFontColor' value='"+O+"'/>"),bi.push("<data hashkey='rowNumBodyColor' value='"+N+"'/>"),bi.push("<data hashkey='rowNumBodyFontName' value='"+B+"'/>"),bi.push("<data hashkey='rowNumBodyFontSize' value='"+G+"'/>"),bi.push("<data hashkey='rowNumBodyFontColor' value='"+H+"'/>"),bi.push("<data hashkey='rowNumFooterColor' value='"+W+"'/>"),bi.push("<data hashkey='rowNumFooterFontName' value='"+V+"'/>"),bi.push("<data hashkey='rowNumFooterFontSize' value='"+q+"'/>"),bi.push("<data hashkey='rowNumFooterFontColor' value='"+j+"'/>"),bi.push("<data hashkey='rowNumSubTotalColor' value='"+z+"'/>"),bi.push("<data hashkey='rowNumSubTotalFontName' value='"+P+"'/>"),bi.push("<data hashkey='rowNumSubTotalFontSize' value='"+X+"'/>"),bi.push("<data hashkey='rowNumSubTotalFontColor' value='"+U+"'/>")),bi.push("<data hashkey='footerDataProvider' value='"+K+"'/>"),bi.push("<data hashkey='dataProvider' value='"+Z+"'/>"),bi.push("<data hashkey='splitProvider' value='"+Y+"'/>"),bi.push("<data hashkey='providerRequestXml' value=''>"+$+"</data>"),bi.push("<data hashkey='userDataXml' value=''>"+J+"</data>"),
bi.push("<data hashkey='optionParam' value='"+Q+"'/>"),""!=tt&&bi.push("<data hashkey='bodyWordwrap' value='"+tt+"'/>"),""!=et&&bi.push("<data hashkey='subtotalWordwrap' value='"+et+"'/>"),""!=it&&bi.push("<data hashkey='footerWordwrap' value='"+it+"'/>"),bi.push("<data hashkey='useEuroLocale' value='"+ot+"'/>"),bi.push("<data hashkey='useHeader' value='"+st+"'/>"),bi.push("<data hashkey='useSubTotal' value='"+rt+"'/>"),bi.push("<data hashkey='useFooter' value='"+at+"'/>"),bi.push("<data hashkey='fitToPage' value='"+nt+"'/>"),bi.push("<data hashkey='landScape' value='"+lt+"'/>"),bi.push("<data hashkey='fitWidth' value='"+ht+"'/>"),bi.push("<data hashkey='fitHeight' value='"+dt+"'/>"),bi.push("<data hashkey='scale' value='"+ut+"'/>"),bi.push("<data hashkey='pageSize' value='"+pt+"'/>"),bi.push("<data hashkey='separator' value='"+ct+"'/>"),bi.push("<data hashkey='subTotalScale' value='"+gt+"'/>"),bi.push("<data hashkey='subTotalRoundingMode' value='"+ft+"'/>"),bi.push("<data hashkey='footerScale' value='"+mt+"'/>"),bi.push("<data hashkey='footerRoundingMode' value='"+yt+"'/>"),bi.push("<data hashkey='useStyle' value='"+bt+"'/>"),1==wt&&bi.push("<data hashkey='setFontSize' value='"+bt+"'/>"),bi.push("<data hashkey='freezePane' value='"+vt+"'/>"),bi.push("<data hashkey='autoSizeColumn' value='"+It+"'/>"),bi.push("<data hashkey='autoSizeAdjustWith' value='"+Ct+"'/>"),bi.push("<data hashkey='displayGridlines' value='"+xt+"'/>"),bi.push("<data hashkey='colMerge' value='"+_t+"'/>"),bi.push("<data hashkey='colMergeValue' value='"+St+"'/>"),bi.push("<data hashkey='colMergeTextAlign' value='"+Dt+"'/>"),bi.push("<data hashkey='useDataFormat' value='"+Rt+"'/>"),bi.push("<data hashkey='customToDataType' value='"+Tt+"'/>"),bi.push("<data hashkey='applyDataFormat' value='"+Lt+"'/>"),bi.push("<data hashkey='useSubTotalData' value='"+kt+"'/>"),bi.push("<data hashkey='useFooterData' value='"+At+"'/>"),bi.push("<data hashkey='calcFooter' value='"+Ft+"'/>"),bi.push("<data hashkey='columnMove' value='"+Et+"'/>"),bi.push("<data hashkey='columnOrder' value='"+ie+"'/>"),""!=Ot&&bi.push("<data hashkey='columnMoveWithSubTotal' value='"+Ot+"'/>"),""!=Nt&&bi.push("<data hashkey='columnMoveWithFooter' value='"+Nt+"'/>"),bi.push("<data hashkey='oddRowBgColor' value='"+Bt+"'/>"),bi.push("<data hashkey='evenRowBgColor' value='"+Gt+"'/>"),bi.push("<data hashkey='indent' value='"+Ht+"'/>"),bi.push("<data hashkey='rowNumHeaderValue' value='"+Wt+"'/>"),bi.push("<data hashkey='startRowNumber' value='"+qt+"'/>"),bi.push("<data hashkey='bodyNumberDefaultValue' value='"+jt+"'/>"),bi.push("<data hashkey='numberToText' value='"+zt+"'/>"),bi.push("<data hashkey='rowHeight' value='"+Pt+"'/>"),bi.push("<data hashkey='headerRowHeight' value='"+Xt+"'/>"),bi.push("<data hashkey='pwd' value='"+Zt+"'/>"),bi.push("<data hashkey='useImage' value='"+Kt+"'/>"),bi.push("<data hashkey='headerAutoFilter' value='"+Yt+"'/>"),bi.push("<data hashkey='filterRowIndex' value='"+$t+"'/>"),bi.push("<data hashkey='mergeCell' value='"+Jt+"'/>"),bi.push("<data hashkey='noMerge' value='"+Qt+"'/>"),bt&&bi.push("<data hashkey='styleData'><array><![CDATA[["+this._getExcelStyle(t)+"]]]></array></data>"),kt&&bi.push("<data hashkey='subtotalData'><array><![CDATA[["+this._getExcelSubtotalData(ct)+"]]]></array></data>");var vi="",Ii=t.mergeCellHeaderInfo||"";Jt&&(rt=a.D.getBoolean(rt),vi=this.getMergeAll(d,rt)),bi.push("<data hashkey='mergeCellInfo'><array><![CDATA[["+vi+"]]]></array></data>"),bi.push("<data hashkey='mergeCellHeaderInfo'><array><![CDATA[["+Ii+"]]]></array></data>"),bi.push("<data hashkey='openFile' value='"+oe+"'/>"),bi.push("<data hashkey='macroFileName' value='"+se+"'/>"),bi.push("<data hashkey='useMacro' value='"+re+"'/>"),bi.push("<data hashkey='showDialog' value='"+ae+"'/>"),bi.push("<data hashkey='dialogFilter' value='"+ne+"'/>"),bi.push("<data hashkey='keepType' value='"+le+"'/>"),bi.push("<data hashkey='lazyInfoArr' value='"+de+"'/>"),
bi.push("<data hashkey='decimal' value='"+ue+"'/>"),""!=pe&&bi.push("<data hashkey='sameSite' value='"+pe+"'/>"),bi.push("<data hashkey='customProvider' value='"+ce+"'/>"),bi.push("<data hashkey='customProviderIndex' value='"+ge+"'/>"),bi.push("<data hashkey='rowAccessWindowSize' value='"+fe+"'/>"),bi.push("<data hashkey='trim' value='"+me+"'/>"),bi.push("<data hashkey='useXHR' value='"+ee+"'/>"),ye.chartName&&(bi.push("<data hashkey='c_chartName' value='"+be+"'/>"),bi.push("<data hashkey='c_chartType' value='"+we+"'/>"),bi.push("<data hashkey='c_title' value='"+ve+"'/>"),bi.push("<data hashkey='c_xTitle' value='"+Ie+"'/>"),bi.push("<data hashkey='c_yTitle' value='"+Ce+"'/>"),bi.push("<data hashkey='c_startRowIndex' value='"+xe+"'/>"),bi.push("<data hashkey='c_startColIndex' value='"+_e+"'/>"),bi.push("<data hashkey='c_endRowIndex' value='"+Se+"'/>"),bi.push("<data hashkey='c_endColIndex' value='"+De+"'/>"),bi.push("<data hashkey='c_serAxis' value='"+Re+"'/>"),bi.push("<data hashkey='c_catAxis' value='"+Le+"'/>"),bi.push("<data hashkey='c_catAxisStartX' value='"+ke+"'/>"),bi.push("<data hashkey='c_catAxisStartY' value='"+Ae+"'/>"),bi.push("<data hashkey='c_catAxisEndX' value='"+Fe+"'/>"),bi.push("<data hashkey='c_catAxisEndY' value='"+Ee+"'/>"),bi.push("<data hashkey='c_serAxisStartX' value='"+Oe+"'/>"),bi.push("<data hashkey='c_serAxisStartY' value='"+Ne+"'/>"),bi.push("<data hashkey='c_serAxisEndX' value='"+Be+"'/>"),bi.push("<data hashkey='c_serAxisEndY' value='"+Ge+"'/>"),bi.push("<data hashkey='c_dataAxisStartX' value='"+We+"'/>"),bi.push("<data hashkey='c_dataAxisStartY' value='"+Ve+"'/>"),bi.push("<data hashkey='c_dataAxisEndX' value='"+qe+"'/>"),bi.push("<data hashkey='c_dataAxisEndY' value='"+je+"'/>"),bi.push("<data hashkey='c_catGridLines' value='"+ze+"'/>"),bi.push("<data hashkey='c_serGridLines' value='"+Pe+"'/>"),bi.push("<data hashkey='c_legend' value='"+Xe+"'/>"),bi.push("<data hashkey='c_legendPosition' value='"+Ue+"'/>")),null!=e&&void 0!==e||(e=[]),bi.push("<data hashkey='information'><vector result='"+e.length+"'>");for(Ye=0;Ye<e.length;Ye++){var Ci=e[Ye];for(var xi in bi.push("<data vectorkey='"+Ye+"'><hashtable>"),Ci)"text"==xi?bi.push("<data hashkey='"+xi+"' value='"+WebSquare.xml.encode(Ci[xi])+"'/>"):bi.push("<data hashkey='"+xi+"' value='"+Ci[xi]+"'/>");bi.push("</hashtable></data>")}if(bi.push("</vector></data>"),0!=t.multiexcel)return bi.push("</hashtable></data>"),bi.push("</vector>"),bi;bi.push("</hashtable></data>"),bi.push("</vector>");var _i=bi.join("");if(-1!=Ut&&Ut<a.D.getByteLengthUtf8(_i)){var Si=WebSquare.language.getMessage("Grid_warning9",Ut)||"전송 data가 제한 크기를 초과 하였습니다.\n 제한 크기 : "+Ut+" byte";return!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm?this.hideDownloadLayer():WebSquare.layer.hideProcessMessage({scope:this.scope_id||""}),void alert(Si)}""==te&&(te=this.options.advancedExcelDownloadURL),t.scopeId=this.scope_id||"",s.v.excelDownload(te,_i,"post",t),this._dataList.options.depthColumn&&"true"==t.spanAll&&(this.drilldown.statusArr=this.orgStatusArr,this._dataList.filteredRowIndexArr=this.orgFilteredRowIndexArr,this.showDepth=this.orgShowDepth,this.orgStatusArr=null,this.orgFilteredRowIndexArr=null,this.orgShowDepth=null,this.drawData(this.rowIndex,0)),this.xmlData=null,!1===t.showProcess?WebSquare.getBody().hideModal(!0):!0===t.showConfirm&&this.hideDownloadLayer()},S.prototype.saveFile=function(t){var e=t.type||"xml",i=t.fileName||"gridView",o=t.extension||"xml",r=t.sameSite||"",a=[];a.push("<vector result='1'>"),a.push("<data vectorkey='0'><hashtable>"),a.push("<data hashkey='type' value='"+e+"'/>"),a.push("<data hashkey='fileName' value='"+i+"'/>"),a.push("<data hashkey='extension' value='"+o+"'/>"),a.push("<data hashkey='sameSite' value='"+r+"'/>"),a.push("</hashtable></data>"),a.push("</vector>");var n=a.join("");n+="\x3c!----VALUESTR----!>",n+=WebSquare.xml.serialize(this.getAllXML());var l=t.action||WebSquare.baseServletURI+"gridToFile.wq"
;s.v.excelDownload(l,n,"post",t)},S.prototype.getExcelExpression=function(t){var e,i="";return void 0!==t.type&&void 0!==t.id&&void 0!==t.attr&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",s.v._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",s.v._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0]),void 0!==e&&(i=this._getAttribute(e,t))),i},S.prototype.setExcelExpression=function(t){var e;void 0!==t.type&&void 0!==t.id&&void 0!==t.excelExpression&&("header"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"header",s.v._XML_NAMESPACE.W2)[0]:"body"==t.type?e=WebSquare.Elem.api.getElementsByTagName(this.element,"gBody",s.v._XML_NAMESPACE.W2)[0]:"footer"==t.type&&(e=WebSquare.Elem.api.getElementsByTagName(this.element,"footer",s.v._XML_NAMESPACE.W2)[0]),void 0!==e&&this._setAttribute(e,t))},S.prototype._getAttribute=function(t,e){for(var i="",o=0;o<t.childNodes.length;o++){var s=t.childNodes[o];if(1==s.nodeType)for(var r=0;r<s.childNodes.length;r++){var a=s.childNodes[r];if(1==a.nodeType){if(("body"==e.type?a.getAttribute("col_id"):a.getAttribute("id"))==e.id){i=a.getAttribute(e.attr);break}}}}return i},S.prototype._setAttribute=function(t,e){for(var i=0;i<t.childNodes.length;i++){var o=t.childNodes[i];if(1==o.nodeType)for(var s=0;s<o.childNodes.length;s++){var r=o.childNodes[s];if(1==r.nodeType){if(("body"==e.type?r.getAttribute("col_id"):r.getAttribute("id"))==e.id){r.setAttribute("excelExpression",e.excelExpression);break}}}}},S.prototype.cancleDownload=function(){clearTimeout(this.excelTime),this.hideDownloadLayer()},S.prototype.hideDownloadLayer=function(){window.gridExceldownloadIframe.style.display="none",this.excelOptions=null,this.excelInfoArr=null,this.excelFinalStr=null,window.downloadGridId=null,WebSquare.getBody().hideModal(!0)},S.prototype.saveBigExcelFile=function(t,e,i){i&&(t.rowsByN=i),t.massStorage=!0,this.advancedExcelDownload(t,e)},S.prototype._getExcelStyle=function(t){for(var e={},i={},o={},s={},r={},n=this.getColumnCount(),l=0;l<n;l++){var h=(u=this.getCellInfo(l)).options.className;if(h){var d=document.querySelector("."+h);d&&(e[l]={"text-align":WebSquare.style.getComputedStyle(d,"text-align")})}}for(var l in this.columnStyleValueObj){var u,p={};for(var c in this.columnStyleValueObj[l])"style"!=c&&(p[c]=this.columnStyleValueObj[l][c]);if((u=this.getCellInfo(parseInt(l,10)))&&u.options.textAlign){var g="";""==(g=this.getColumnStyleValue(parseInt(l,10),"text-align"))&&""==(g=u.options.textAlign)&&(g="center"),p["text-align"]=g}e[l]=p}for(l=0;l<this.rowStyleArr.length;l++)if(this.rowStyleArr[l]){p={};for(var c in this.rowStyleValueObj[this.rowStyleArr[l]])"style"!=c&&(p[c]=this.rowStyleValueObj[this.rowStyleArr[l]][c]);var f=this.getDisplayRowIndex(l);isNaN(f)||(i[f]=p)}for(l=0;l<this.cellStyleArr.length;l++)if(this.cellStyleArr[l]){p={};var m=parseInt(l/this.oneRowDataLength,10),y=(f=this.getDisplayRowIndex(m),l%this.oneRowDataLength);for(var c in this.cellStyleValueObj[this.cellStyleArr[l]])"style"!=c&&this.cellStyleValueObj[this.cellStyleArr[l]][c]&&(p[c]=this.cellStyleValueObj[this.cellStyleArr[l]][c]);o[f+","+y]=p}for(l=0;l<this.cellClassArr.length;l++)if(this.cellClassArr[l]){p={},m=parseInt(l/this.oneRowDataLength,10),f=this.getDisplayRowIndex(m),y=l%this.oneRowDataLength;var b=a.D.getStyleFromCssStr(this.cellClassArr[l],["backgroundColor","color","textAlign","fontSize","fontWeight","fontFamily"]);o[f+","+y]&&(p=o[f+","+y]),b.backgroundColor&&(p["background-color"]=b.backgroundColor),b.color&&(p.color=b.color),b.textAlign&&(p["text-align"]=b.textAlign),b.fontSize&&(p["font-size"]=b.fontSize),b.fontWeight&&(p["font-weight"]=b.fontWeight),b.fontFamily&&(p["font-family"]=b.fontFamily),o[f+","+y]=p}var w="",v=this.getDomList("head_tds","th",this.getElementById(this.id+"_head_table"));for(l=this.defaultColCnt;l<v.length;l++){
var I="",C=v[l].id.replace(this.id+"_",""),x=this.headerCellStyleValueObj[C];w=x&&x["background-color"]?x["background-color"]:t.headerColor?t.headerColor:WebSquare.style.getStyle(v[l],"background-color"),I+="color:"+WebSquare.style.getStyle(v[l],"color")+";",I+="background-color:"+w+";",I+="font-weight:"+WebSquare.style.getStyle(v[l],"font-weight")+";",I+="font-family:"+WebSquare.style.getStyle(v[l],"font-family")+";",I+="text-align:"+WebSquare.style.getStyle(v[l],"text-align")+";",s[v[l].getAttribute("header_id")]=I}if(this.hasFooter){var _=this.getDomList("foot_tds","th",this.getElementById(this.id+"_foot_table"));for(l=this.defaultColCnt;l<_.length;l++){I="";I+="color:"+WebSquare.style.getStyle(_[l],"color")+";",I+="background-color:"+WebSquare.style.getStyle(_[l],"background-color")+";",I+="font-weight:"+WebSquare.style.getStyle(_[l],"font-weight")+";",I+="font-family:"+WebSquare.style.getStyle(_[l],"font-family")+";",I+="text-align:"+WebSquare.style.getStyle(_[l],"text-align")+";",r[_[l].getAttribute("footer_id")]=I}}return JSON.stringify({row:i,col:e,cell:o,header:s,footer:r})},S.prototype._getExcelSubtotalData=function(t){t||(t=",");var e=[];e.push('"');for(var i=this.getDataLength(),o=0;o<i;o++){var s=o;for(var r in this.subtotalTableList){var a=this.dataList._getCellData(s,r),n=a+"_12";if(s<i-1)n=this.dataList._getCellData(s+1,r);if(a!=n){var l=this.subtotalTableList[r],h=this.subtotalDataArr[r+"_"+a];null==h&&(h=this.getSubtotalData(l,r,a,s));for(var d="",u=l.getElementsByTagName("td"),p=0;p<u.length;p++){var c=u[p],g=c.getAttribute("id");if(!g.startsWith("_headerRowNumber")&&!g.startsWith("_headerRowStatus")){if(null!=h[g])d=h[g];else if("true"==c.getAttribute("colMerge"))d="";else{d=null!=(d=c.getAttribute("value"))?d:""}e.push(d),e.push('"'+t+'"')}}}}}return e[e.length-1]='"',e.join("")},S.prototype.getExcelGroupbyStyle=function(){try{if(this.groupbyStatus.grouped){var t={rowNumHeader:{type:"H",index:2},rowNumFooter:{type:"F",index:2},rowStatusHeader:{type:"H",index:3},rowStatusFooter:{type:"F",index:3},groupbyHeader:{type:"H",index:-1},groupbyFooter:{type:"F",index:-1}},e=4,i=4,o=!1,s=!1,a=[],n=[],l=[],h={};a.push("<w2:groupby>"),n.push("<w2:groupbyHeader>"),l.push("<w2:groupbyFooter>"),n.push("<w2:row>"),l.push("<w2:row>");var d=this.defaultColCnt+this.getColCnt(),u=0,p=0;this.options.rowNumVisible&&(this.groupbyDisplayOptions.rowNumHeader&&(this.groupbyDisplayOptions.rowNumHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowNumHeader.colSpan,10)||1)<=d&&(h.rowNumHeader=this.groupbyDisplayOptions.rowNumHeader)),this.groupbyDisplayOptions.rowNumFooter&&(this.groupbyDisplayOptions.rowNumFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowNumFooter.colSpan,10)||1)<=d&&(h.rowNumFooter=this.groupbyDisplayOptions.rowNumFooter))),this.options.rowStatusVisible&&(this.groupbyDisplayOptions.rowStatusHeader&&(this.groupbyDisplayOptions.rowStatusHeader.hidden||(p+=parseInt(this.groupbyDisplayOptions.rowStatusHeader.colSpan,10)||1)<=d&&(h.rowStatusHeader=this.groupbyDisplayOptions.rowStatusHeader)),this.groupbyDisplayOptions.rowStatusFooter&&(this.groupbyDisplayOptions.rowStatusFooter.hidden||(u+=parseInt(this.groupbyDisplayOptions.rowStatusFooter.colSpan,10)||1)<=d&&(h.rowStatusFooter=this.groupbyDisplayOptions.rowStatusFooter))),h.groupbyHeader=[],h.groupbyFooter=[];for(var c=this.groupbyDisplayOptions.groupbyHeader,g=0;g<c.length;g++)c[g].hidden||(p+=parseInt(c[g].colSpan,10)||1,h.groupbyHeader[g]=c[g]);var f=this.groupbyDisplayOptions.groupbyFooter;for(g=0;g<f.length;g++)f[g].hidden||(u+=parseInt(f[g].colSpan,10)||1,h.groupbyFooter[g]=f[g]);if(e<d){var m=d-p;for(g=0;g<m;g++)h.groupbyHeader.push({temp:!0})}if(i<d)for(m=d-u,g=0;g<m;g++)h.groupbyFooter.push({temp:!0});for(var y in this.groupbyStatus.excelDisplayOptions=h,h){var b,w=[];switch(y){case"rowNumHeader":case"rowNumFooter":case"rowStatusHeader":case"rowStatusFooter":w.push("<w2:column");var v=h[y],I=!1
;for(var C in v)if("align"==C||"hidden"==C||"colSpan"==C){if("hidden"==C){I=!0;break}w.push(" "+C+'="'+v[C]+'"'),"rowNumHeader"!=y&&"rowNumFooter"!=y||"colspan"==C.toLowerCase()&&v[C]>=this.defaultColCnt+this.getColCnt()&&("rowNumHeader"==y?o=!0:s=!0)}if(I)break;if("rowStatusHeader"==y&&o)break;if("rowStatusFooter"==y&&s)break;y.match("rowNum")?w.push(' type="rowNum"'):y.match("rowStatus")&&w.push(' type="rowStatus"'),w.push("/>"),b=t[y];break;case"groupbyHeader":case"groupbyFooter":I=!1;var x=h[y];if(x.length>0){var _,S=0,D=0,R=0,L=0,T=this.htmlInfo?this.htmlInfo.body.rowArr:this.struct.body.rowArr;for(g=0;g<T.length;g++){for(var k=T[g],A=0;A<k.length;A++){var F=k[A];S+=parseInt(F.colSpan,10)||1}D<S&&(D=S),S=0}_=new Array(D);for(g=0;g<x.length;g++){var E=[];for(var C in E.push("<w2:column"),x[g])if("align"==C||"hidden"==C||"colSpan"==C||"rowSpan"==C||"displayFormat"==C){if("hidden"==C){E.pop();break}E.push(" "+C+'="'+x[g][C]+'"')}E.push("/>"),w.push(E.join(""));var M=parseInt(x[g].colSpan,10)||1,O=parseInt(x[g].rowSpan,10)||1;if(0===L){if(void 0===_[R])if(M>1)for(var N=0;N<M;N++)_[R+N]=O;else _[R]=O}else{_[R]>1?_[R]-=1:_[R]=O;for(var B=R+1;1!==_[B]&&B<D;)_[B]-=1,R+=1,B+=1}D<=(R+=M)&&g!=x.length-1&&(w.push("</w2:row><w2:row>"),R=0,L+=1)}}b=t[y]}b&&("H"==b.type?-1==b.index?(n[e]=w.join(""),e++):n[b.index]=w.join(""):"F"==b.type&&(-1==b.index?(l[i]=w.join(""),i++):l[b.index]=w.join(""))),b=null}return n.push("</w2:row>"),l.push("</w2:row>"),n.push("</w2:groupbyHeader>"),l.push("</w2:groupbyFooter>"),a.push(n.join("")),a.push(l.join("")),a.push("</w2:groupby>"),a.join("")}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getExcelGroupbyHeaderValue=function(){this.groupbyStatus.headerValueObj={},this.getAllGroupbyHeaderValueObj();var t=[];t.push("<array><![CDATA["),t.push("[");for(var e=0;e<this.groupbyStatus.groupedRowIndexArr.length;e++){var i=this.groupbyStatus.groupedRowIndexArr[e];if("header"==i.type){for(var o=this.groupbyStatus.headerValueObj[i.groupId],s=0;s<o.length;s++)null!=o[s]&&(t.push('"'+o[s]+'"'),s<o.length-1&&t.push(","));o.length>0&&t.push(",")}}return t.pop(),t.push("]"),t.push("]]></array>"),t.join("")},S.prototype.getExcelGroupbyFooterValue=function(){this.groupbyStatus.footerValueObj={},this.getAllGroupbyFooterValueObj();var t=[];t.push("<array><![CDATA["),t.push("[");for(var e=0;e<this.groupbyStatus.groupedRowIndexArr.length;e++){var i=this.groupbyStatus.groupedRowIndexArr[e];if("footer"==i.type){for(var o=this.groupbyStatus.footerValueObj[i.groupId],s=0;s<o.length;s++)null!=o[s]&&(t.push('"'+o[s]+'"'),s<o.length-1&&t.push(","));o.length>0&&t.push(",")}}return t.pop(),t.push("]"),t.push("]]></array>"),t.join("")},S.prototype.getExcelGroupbyStatusValue=function(){var t=[];t.push("<array><![CDATA["),t.push("[");for(var e=0;e<this.groupbyStatus.groupedRowIndexArr.length;e++){var i=this.groupbyStatus.groupedRowIndexArr[e];if("number"==typeof i)t.push('"0B"');else{switch(i.type){case"header":var o='"'+i.depth+'H"';break;case"footer":o='"'+i.depth+'F"'}t.push(o)}e<this.groupbyStatus.groupedRowIndexArr.length-1&&t.push(",")}return t.push("]"),t.push("]]></array>"),t.join("")},S.prototype.getExcelGroupbyStyleData=function(){var t=this.getElementById(this.id+"_body_tbody").childNodes,e=[];e.push("<array><![CDATA["),e.push("[");for(var i=0;i<this.groupbyStatus.groupedRowIndexArr.length;i++){var o=this.groupbyStatus.groupedRowIndexArr[i];if("number"!=typeof o){var s=t[o.index];if(!e[o.depth+2]){var r,a='"';for(var n in 0!=i&&(a=',"'),this.groupbyStatus.excelDisplayOptions){var l=!1;switch(n){case"rowNumHeader":l=!0,r=0;break;case"rowStatusHeader":l=!0,r=this.defaultColCnt-1;break;case"groupbyHeader":l=!0,r=this.defaultColCnt}if(l)break}var h=s.getElementsByTagName("TD")[r];a+="background-color:"+WebSquare.style.getStyle(h,"background-color")+";",a+="font-size:"+WebSquare.style.getStyle(h,"font-size")+";",a+="color:"+WebSquare.style.getStyle(h,"color")+";",
a+="font-weight:"+WebSquare.style.getStyle(h,"font-weight")+";",a+="font-family:"+WebSquare.style.getStyle(h,"font-family")+";",a+='"',e[o.depth+2]=a}}}return e.push("]"),e.push("]]></array>"),e.join("")},S.prototype.getAllGroupbyHeaderValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumHeader),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusHeader),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyHeader.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyHeader[o]),i++}},S.prototype.getAllGroupbyFooterValueObj=function(){for(var t=0;t<this.groupbyStatus.groupedRowIndexArr.length;t++)if("number"!=typeof this.groupbyStatus.groupedRowIndexArr[t]){var e=this.groupbyStatus.groupedRowIndexArr[t],i=0;this.options.rowNumVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowNumFooter),i++),this.options.rowStatusVisible&&(this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.rowStatusFooter),i++);for(var o=0;o<this.groupbyStatus.excelDisplayOptions.groupbyFooter.length;o++)this.setGroupbyData(e,i,this.groupbyStatus.excelDisplayOptions.groupbyFooter[o]),i++}},S.prototype.getGroupbyData=function(t){try{if(this.options.groupbyZone)return!1===t?this.groupbyStatus.groupbyOptions:JSON.parse(this.groupbyStatus.groupbyOptions)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setGroupbyData=function(t,e,i){var o,s,r=(i=i||{}).value||"",a=i.inputType||"",n=i.depthVisible||!1,l=i.expression||"",h=i.hidden?"none":"",d=i.displayFormatType||"text",u=i.displayFormat||"",p=i.displayFormatter||null;if(a)switch((u||p)&&(o=new WebSquare.format.createFormatter(d,u,p,null,null,null,this.scope_id,this.id)),a){case"toggleButton":s="open"==t.status?"-":"+";break;case"expression":if(l){var c=this.groupbyInfo[t.groupId].header;c.colIndex=e;var g=0;if("open"==c.status){for(var f,m=c.index;m<this.groupbyStatus.groupedRowIndexArr.length;m++){if("footer"==(y=this.groupbyStatus.groupedRowIndexArr[m]).type&&y.depth==c.depth){f=y.index;break}}if(!f){for(m=c.index+1;m<this.groupbyStatus.groupedRowIndexArr.length;m++){var y;if("header"==(y=this.groupbyStatus.groupedRowIndexArr[m]).type&&y.depth==c.depth){f=y.index;break}}f||(f=this.groupbyStatus.groupedRowIndexArr.length-1)}g=this.groupExpression(this.groupbyStatus.groupedRowIndexArr,c.index,f,l,c)}else g=this.groupExpression(c.closedChildArr,0,c.closedChildArr.length-1,l,c);if(o&&(g=o.format(g)),"string"==typeof(s=g)&&(s.match("w2grid_minus")||s.match("w2grid_plus"))){var b=s.lastIndexOf("</span>");b>-1&&(b+=7,s=s.slice(b),"open"==t.status?s="-||"+s:"closed"==t.status&&(s="+||"+s))}}}if(n&&(s=t.groupId),r&&(o&&(r=o.format(r)),s=r),!s){s="";m=0;for(var w in i)m++;0==m&&(h="none")}"none"!=h&&("header"==t.type?(this.groupbyStatus.headerValueObj[t.groupId]||(this.groupbyStatus.headerValueObj[t.groupId]=[]),this.groupbyStatus.headerValueObj[t.groupId][e]=s):"footer"==t.type&&(this.groupbyStatus.footerValueObj[t.groupId]||(this.groupbyStatus.footerValueObj[t.groupId]=[]),this.groupbyStatus.footerValueObj[t.groupId][e]=s))},S.prototype.getTotalRow=function(){return this.dataList.getTotalRow()},S.prototype.getTotalCol=function(){return this.oneRowDataLength},S.prototype.editEndBeforeGetData=function(){this.editedCell&&this.rollbackCommitFlag&&1==this.options.rollbackCommit&&(1==this.options.moveKeyEditModeAll&&1==this.checkScrollEnd||(this.rollbackCommitFlag=!1,this.editedCell.handleEndEdit(),this.rollbackCommitFlag=!0))},S.prototype.getExtraDataObj=function(t,e,i){var o=this.extraData;return"grid"==t?o.grid:"row"==t?(o.row[e]||(o.row[e]={}),o.row[e]):"col"==t?(o.col[e]||(o.col[e]={}),o.col[e]):"cell"==t?(o.cell[e]||(o.cell[e]=[]),
o.cell[e][i]||(o.cell[e][i]={}),o.cell[e][i]):null},S.prototype.finalize=function(){try{for(var t in null!=this.tempDiv&&null!=this.tempDiv.parentNode&&(this.tempDiv.innerHTML=""),null!=this.tempTr&&null!=this.tempTr.parentNode&&(this.tempTr.innerHTML=""),n.s.removeCheckResize(this.uuid),a.D.clearInterval(this.id+"_dragSelectAutoScroll"),s.v.clearTimer(this.id+"initializeEvent"),this.dom){var e=this.dom[t],i=null;null!=e&&(i=WebSquare.idCache[e.uuid]),i&&"function"==typeof i.remove&&i.remove(),delete this.dom[t]}this._dataList&&this._dataList.childCompHash&&delete this._dataList.childCompHash[this.id],null!=this._manager&&this._manager.destroy(),null!=this.customFilter&&this.customFilter.remove()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setFixedColumn=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedColumn>0)for(var e=this.getColumnCount(),i=0;i<this.lastIndex+1;i++){var o=this.data_td_list[i*e+this.options.fixedColumn];o&&this.removeClass(o,"w2grid_fixedColumn")}this.options.fixedColumn=t,this.arrangeOverflowXScroll()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setFixedRightColumn=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRightColumn>0)for(var e=this.getColumnCount(),i=this.getFixedRightColumnLastIndex(),o=0;o<this.lastIndex+1;o++){var s=this.data_td_list[o*e+(i-this.defaultColCnt)];s&&this.removeClass(s,"w2grid_fixedRightColumn")}this.options.fixedRightColumn=t,this.arrangeOverflowXScroll(),this._handleScrollX()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.fixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.options.fixedRow-1)];e&&this.removeClass(e,"w2grid_fixedRow")}this.options.fixedRow=t,this.applyRowStyleOptions(t-1)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setLastFixedRow=function(t){try{if(t=parseInt(t,10),t=isNaN(t)?0:t,this.options.lastFixedRow>0){var e=this.dataRowList[this.oneRowLength*(this.lastIndex-this.options.lastFixedRow)];e&&this.removeClass(e,"w2grid_lastFixedRow")}this.options.lastFixedRow=t,this.drawData(this.rowIndex,this.lastIndex-t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getOverflowX=function(){return this.options.overflowX},S.prototype.getOverflowY=function(){return this.options.overflowY},S.prototype.getColumnVisible=function(t){var e=t,i=(t=this.getColumnIndex(t),s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/getColumnVisible/@useRealColIndex"));if(a.D.getBoolean(i)){if("number"!=typeof e){for(var o=this.getCellInfo(e),r=this._getRealColIndex("body",e),n=r+this.defaultColCnt,l=!this.hiddenList[n],h=0;h<o.options.colSpan;h++)l=!this.hiddenList[n+h]||l;return 0===r||r?l:void u.k.printLog("[getColumnVisible] 존재하지 않는 body 컬럼입니다.")}t=e%this.columnOrder.length;for(var d=0;d<this.columnOrder.length;d++)if(this.columnOrder[d]==t){t=d;break}if(e>this.columnOrder.length||d===this.columnOrder.length)return void u.k.printLog("[getColumnVisible] 존재하지 않는 body 컬럼입니다.")}return!this.hiddenList[this.defaultColCnt+t]},S.prototype.getColumnWidth=function(t,e){var i=e?this.defaultColCnt:0;if(t=this.getColumnIndex(t)+i,this.colWidthList[t])return this.colWidthList[t]},S.prototype.setColumnWidth=function(t,e,i){t=this.getDisplayColumnIndex(t);var o=this.colWidthList[t],s=!0===i?0:this.defaultColCnt;this.colWidthList[t]&&(this.options.autoFit&&!this.hiddenList[t+s]?(this.autoFitColWidthList=null,this._setAutoFit({exceptCol:s+t,exceptWidth:e})):this._setColumnWidth(s+t,e)),i&&(t-=this.defaultColCnt),d.B.fireEvent(this,"oncolumnwidthchange",{columnIndex:t,columnID:this.getColumnID(t),oldWidth:o,newWidth:e})},S.prototype.isColumnResizable=function(t){try{if(t<this.defaultColCnt)return!0===this.options.rowNumStatusResize;if(void 0===t||""===t)return!1;if(isNaN(t)&&(t=this.getColumnIndex(t)+this.defaultColCnt),isNaN(t)||t>=this.getColumnCount()+this.defaultColCnt)return!0
;for(var e,i=this.htmlInfo.head.rowArr[0],o=!0,s=0;s<i.length;s++)if(i[s].colIndex==this.columnOrder[t]&&"string"==typeof i[s].fixColumnWidth&&"true"===i[s].fixColumnWidth.toLowerCase()){o=!1;break}if(!this.cellInfoHash||a.D.isEmptyObject(this.cellInfoHash))(e=this.cellInfoHash2[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&!0===a.D.getBoolean(e.getAttribute("fixColumnWidth"))&&(o=!1);else(e=this.cellInfoHash[this.getColumnID(this.columnOrder[t-this.defaultColCnt])])&&e.options.fixColumnWidth&&(o=!1);return o}catch(t){return r.w.printStackTrace(t,null,this),!0}},S.prototype.setColumnDisableEdit=function(t,e){try{var i=this.getCellInfo(t);"autoComplete"==i.options.inputType&&i.setColumnDisableEdit(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnNodeSet=function(t,e,i,o){try{var s=this.getCellInfo(t);("select"==s.options.inputType||"autoComplete"==s.options.inputType||"checkcombobox"==s.options.inputType)&&s.setColumnNodeSet(e,i,o),s.hasRef&&(s.refHash=[]),s.itemsetObj&&s.mainGrid.refresh()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnGridItemset=function(t,e){try{var i=this.getCellInfo(t);("select"==i.options.inputType||"autoComplete"==i.options.inputType||"checkcombobox"==i.options.inputType)&&i.setColumnGridItemset(e),i.hasRef&&(i.refHash=[]),i.itemsetObj&&i.mainGrid.refresh()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormat=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnIoFormat=function(t,e,i){try{"object"==typeof arguments[0]?this._setColumnIoFormat(arguments[0]):this._setColumnIoFormat({colIndex:t,ioFormat:e,dateMask:i})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._setColumnIoFormat=function(t){try{var e=t.colIndex,i=t.ioFormat,o=t.dateMask,s=t.useMonthYearFormat,a=t.calendarDisplayFormat,n=this.getCellInfo(e);if(!n||"date"!==n.options.dataType)return;var l=!1,h=n.options.ioFormat;if("string"==typeof i&&(l=i!==h,n.options.ioFormat=i),"string"==typeof o&&(n.options.displayFormat=o),"calendar"===n.options.inputType&&(n.options.useMonthYearFormat=s,"string"==typeof a&&(n.options.calendarDisplayFormat=a)),n.initFormatter(),!0===l){var d=this.getInput(n);if(d&&"function"==typeof d.setIoFormat){t={ioFormat:i,displayFormat:o,useMonthYearFormat:s,calendarDisplayFormat:a};d.setIoFormat(t)}if(n.options.useMonthYearFormat)this.drawColumnData(e);else for(var u=this.getRowCount(),p=WebSquare.format.createFormatter(n.options.dataType,i,"",h,null,null,this.scope_id,this.id),c=0;c<u;c++){var g=this.dataList._getCellData(c,n.colID),f=p.format(g);this.dataList.__setCellData(c,n.colID,f)}}else this.drawColumnData(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnChooseOption=function(t,e,i){try{var o=this.getCellInfo(t);"select"==o.options.inputType&&o.setColumnChooseOption(e,i)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnVisibleColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setVisibleColumn&&o[o.options.inputType].setVisibleColumn(e,i))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnEnableColumn=function(t,e,i){try{var o=this.getCellInfo(t);!0==={select:!0,checkcombobox:!0,autoComplete:!0}[o.options.inputType]&&(null==o[o.options.inputType]&&o._createComponent(0),o[o.options.inputType]&&"function"==typeof o[o.options.inputType].setEnableColumn&&o[o.options.inputType].setEnableColumn(e,i))}catch(t){r.w.printStackTrace(t,null,this)}},
S.prototype.showChooseOption=function(t,e){try{var i=this.getCellInfo(t);"select"==i.options.inputType&&i.showChooseOption(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setRowNumColumnWidth=function(t){this.options.rowNumVisible&&!isNaN(Number(t))&&this._setColumnWidth(0,t)},S.prototype.setRowStatusColumnWidth=function(t){var e=0;this.options.rowNumVisible&&(e=1),this.options.rowStatusVisible&&(this.options.autoFit&&!this.hiddenList[e]?(this.autoFitColWidthList=null,this._setColumnWidth(e,t),this._setAutoFit()):this._setColumnWidth(e,t))},S.prototype.setGridHeight=function(t){try{parseInt(t)+""==t&&(t+="px"),this.setStyle("height",t),-1!==this.options.initFixedHeightByRowNum&&(this.options.initFixedHeightByRowNum=-1,this.options.visibleRowNum=""),this.handleScrollY({},{changedHeight:!0}),this.handleResize()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setGridWidth=function(t){parseInt(t)+""==t&&(t+="px"),this.setStyle("width",t),this.handlerResize_drawInitializer()},S.prototype.setGridSize=function(t,e){var i=parseInt(t),o=parseInt(e);i>=0&&o>=0?(this.setGridWidth(t),this.setGridHeight(e)):u.k.printLog("[Warning] Number of Entered in the width and height must be a valid integer greater than 0.["+this.id+"]")},S.prototype.setGridReadOnly=function(t){try{t=a.D.getBoolean(t),this.options.readOnly=t,this.notifyDataChanged()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getGridReadOnly=function(){try{return this.options.readOnly}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.initGrid=function(){try{this.loadCheck=[],this.initFlag=!0,this.skipScrollEndEvent=!0,this.skipScrollStartEvent=!0,this.removeAllFinish=!0,this.lastIndex=-1,this.lastTopRowIndex=null,this.bScrollTop=-1;var t=this.hiddenRowObj.extraRow;this.hiddenRowObj={length:0,extraRow:t,row:{},init:!1},this.initHeightCompleted=!1,this.hasFooter&&this.initFooterDataObj(),this.initHeaderDataObj();var e=this.dataList.removeAll();return this.removeAllFinish=!1,this.dataList.clearFilter(),this.initColumns(),e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setInitValue=function(){try{this.initGrid()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setDisplayFormat=function(t,e){try{var i=this.getCellInfo(t);return i.element&&i.element.setAttribute("displayFormat",e),i.options.displayFormat=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setDisplayFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.displayFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setFormat=function(t,e){try{var i=this.getCellInfo(t);if(e.ioFormat){var o=i.mainGridId+i.id,s=this.dom[o];s&&s.setFormat({ioFormat:e.ioFormat,displayFormat:e.ioFormat});for(var a=WebSquare.format.createFormatter("date",e.ioFormat,"",i.options.ioFormat,null,null,this.scope_id,this.id),n=0;n<this.getDataLength();n++){var l=this.getColumnID(t),h=this.dataList._getCellData(n,l),d=a.format(h);this.dataList.__setCellData(n,l,d)}}return i.options.ioFormat=e.ioFormat||i.options.ioFormat,i.options.displayFormat=e.displayFormat||i.options.displayFormat,i.options.displayFormatter=e.displayFormatter||i.options.displayFormatter,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCustomFormatter=function(t,e){try{var i=this.getCellInfo(t);return i.options.customFormatter=e,i.initFormatter(),void this.drawColumnData(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setAllowChar=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return $l("cell의 inputType이 올바르지 않습니다."),!1;var s=this.getInput(i);return i.options.allowChar=e,void(s&&s.options&&("input"===s.options.pluginName||"textarea"===s.options.pluginName)&&s.setAllowChar(e))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.changeCurrency=function(t,e,i,o,a){try{
var n=this.getColumnIndex(t),l=this.getCellInfo(n);if(!e||"float"!==e&&"number"!==e&&"euro"!==e&&"rupee"!==e&&"tenge"!==e)return;"number"===e&&"true"===this.options.floatNumber&&(e="float");var h=e;switch(e){case"number":case"float":i||(this.options.numberMask||(this.options.numberMask=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+h+'"]/numberMask/@value')||""),i=this.options.numberMask),l.options.delimiter=o||",",l.options.decimalDelimiter=a||".";break;case"euro":i||(this.options.euroMask||(this.options.euroMask=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+h+'"]/euroMask/@value')||""),i=this.options.euroMask),l.options.delimiter=o||".",l.options.decimalDelimiter=a||",";break;case"rupee":i||(this.options.rupeeMask||(this.options.rupeeMask=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+h+'"]/rupeeMask/@value')||""),i=this.options.rupeeMask),l.options.delimiter=o||",",l.options.decimalDelimiter=a||".";break;case"tenge":i||(this.options.tengeMask||(this.options.tengeMask=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+h+'"]/tengeMask/@value')||""),i=this.options.tengeMask),l.options.delimiter=o||" ",l.options.decimalDelimiter=a||"-"}if(!i)return;l.options.dataType=e,l.options.displayFormat=i,l.initFormatter(),this.drawColumnData(n),this.initFooterDataObj(l.colID),this.drawFooter(l.colID);var d=l.mainGridId+l.id,u=this.dom[d];if(u)if(u.options.dataType=e,u.options.displayFormat=i,u.options.delimiter=l.options.delimiter,u.options.decimalDelimiter=l.options.decimalDelimiter,u.validator.clearCommand(),"number"===u.options.dataType)u.validator.addCommand(new WebSquare.validator.numberCommand(u.options.delimiter,u.options.decimalDelimiter)),u.validator.addCommand(new WebSquare.validator.digitCommand(u.options.delimiter,u.options.decimalDelimiter),!0);else if("euro"===u.options.dataType||"rupee"===u.options.dataType||"tenge"===u.options.dataType)if(u.options.maxlength>=0||-1!==(u.options.maxlength+"").indexOf("*")||u.floatMaxlength>=0){var p=u.floatMaxlength>=0?u.floatMaxlength:u.options.maxlength;u.validator.addCommand(new WebSquare.validator.floatCommand(u.options.delimiter,u.options.decimalDelimiter,u.options.applyFormat)),u.validator.addCommand(new WebSquare.validator.maxFloatLengthCommand(p,u.options.decimalDelimiter,u.options.delimiter)),u.validator.removeCommand(new WebSquare.validator.maxLengthCommand(p)),u.floatMaxlength=p,u.options.maxlength="-1"}else u.validator.addCommand(new WebSquare.validator.floatCommand(u.options.delimiter,u.options.decimalDelimiter,u.options.applyFormat),!0)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setDataType=function(t,e){try{if(!e||"number"!=e&&"text"!=e&&"float"!=e)return;var i=this.getCellInfo(t);if(i.options.dataType==e)return;i.options.dataType;i.options.dataType=e;var o=this.getColumnID(t);this.setColumnOption(o,"dataType",e);var s=i.mainGrid.getElementById(i.mainGridId+o);if(i.options.displayFormat="",s){switch(s.validator.clearCommand(),e){case"number":s.validator.addCommand(new WebSquare.validator.allowCharCommand("+\\-.0-9"));break;case"float":s.validator.addCommand(new WebSquare.validator.floatCommand(s.options.delimiter,s.options.decimalDelimiter,s.options.applyFormat))}var a=s.options.maxlength&&parseInt(s.options.maxlength)>-1?s.options.maxlength:null;a||(a=s.options.maxLength&&parseInt(s.options.maxLength)>-1?s.options.maxLength:null),a&&("float"==e?(i.setFloatMaxLength(a),s.render&&"input"==s.render.tagName.toLowerCase()&&s.render.removeAttribute("maxLength")):i.setMaxLength(a))}i.initFormatter()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setDefaultDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!=i.options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;var o=this.getInput(i)
;i.options.defaultDate=e,o&&o.setDefaultDate(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.disableBeforeDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!=i.options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;var o=this.getInput(i);i.options.disableBeforeDate=e,o&&o.disableBeforeDate(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.disableAfterDate=function(t,e){try{var i=this.getCellInfo(t);if("calendar"!=i.options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;var o=this.getInput(i);i.options.disableAfterDate=e,o&&o.disableAfterDate(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setMaxLength=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if("text"!=o&&"textarea"!=o&&"input"!=o&&"textImage"!=o&&"secret"!=o)return;"text"==o&&"float"==i.options.dataType?i.setFloatMaxLength(e):i.setMaxLength(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getMaxLength=function(t){try{var e=this.getCellInfo(t),i=e.options.inputType;if("text"!=i&&"textarea"!=i&&"input"!=i&&"textImage"!=i&&"secret"!=i)return;return e.options.maxLength}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.spanAll=function(t){try{"number"==typeof t?this.showDepth=t+"":(t=a.D.getBoolean(t),this.showDepth=1==t?"9999":"1"),this.initDrilldown(),this.rowIndex=-1,this.lastIndex=-1,this.lastTopRowIndex=null,this.drawData(0,0),this.setScrollYHeight({noDraw:!0}),this.displayNoResultMessage()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCellDisplayData=function(t,e){try{var i=(this._linkedDataList||this._dataList).getRealRowIndex(t);return this._getDisplayData(i,e)}catch(t){r.w.printStackTrace(t)}},S.prototype._getCellDisplayData=function(t,e,i){try{var o=this.getRealRowIndex(t);return this._getDisplayData(o,e,i)}catch(t){r.w.printStackTrace(t)}},S.prototype._getDisplayData=function(t,e,i){try{this.editEndBeforeGetData();e=this.getColumnID(e);var o=this.getColumnIndex(e),s=this.cellInfoHash[e];0==s.internal&&"custom"==s.options.inputType&&s.cellManagerHashByRowIndex[t]&&(s=s.cellManagerHashByRowIndex[t]);var n=this.dataList._getData(t,e),l=this.getDisplayRowIndex(t),h=this._getGroupbyDisplayRowIndex(l);if(s.options.customModelUnformatter){var d=a.D.getGlobalFunction(s.options.customModelUnformatter,this.scope_id);"function"==typeof d&&(n=d.call(this,n,h,o))}if(s.options.maskFormat&&(n=this.getInput(s[o]).maskFormatModelUnFormat(n)),s.useEscapeFormatter){var u=a.D.getGlobalFunction(s.options.escapeFormatter,this.scope_id);"function"==typeof u&&(n=u.call(this,n,h,o))}if(s.useCustomFormatter&&1!=this.options.keepBeforeDisplayData){var p="true"===s.getEscape()?s.getDisplayData(WebSquare.xml._encode(n+""),t):s.getDisplayData(n,t),c=a.D.getGlobalFunction(s.options.customFormatter,this.scope_id);"function"==typeof c&&(n=this.options.customFormatterRealRowIndex?c.call(this,n,p,t,o):c.call(this,n,p,h,o))}else 0==s.internal&&"custom"==s.options.inputType&&(s=s.cellManagerHashByRowIndex[t]?s.cellManagerHashByRowIndex[t]:s),n=s.getDisplayData(n,t,i);return null==n&&(n=""),n}catch(t){r.w.printStackTrace(t)}},S.prototype.initPasteDrilldown=function(){try{var t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""};"string"==typeof t.depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.pasteDrilldownInitialize(this,t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.initDrilldown=function(t){try{"string"==typeof(t={showDepth:this.showDepth,depthColumn:this.depthColumn,dataColumn:""}).depthColumn&&(null==this.bodyIdColIndexMap[t.depthColumn]?(t.dataColumn="dataList",t.depthColumn=this._dataList.bodyIdColIndexMap[t.depthColumn]):(t.dataColumn="gridview",t.depthColumn=this.bodyIdColIndexMap[t.depthColumn])),this.drilldown.initialize(this,t)}catch(t){
r.w.printStackTrace(t,null,this)}},S.prototype.getRealRowIndex=function(t){return this.dataList.getRealRowIndex(t)},S.prototype.toggle=function(t){if("number"!=typeof t)return!1;var e=t;if(this.options.drilldownRealRowIndexAll&&"number"!=typeof(e=this.getDisplayRowIndex(t)))return!1;this._toggle(e)},S.prototype._toggle=function(t){t=parseInt(t),this.drilldown.toggle(t);var e=this.options.drilldownToggleScrollFix?{keepScrollTop:!0}:null;this.lastTopRowIndex=null,this.setScrollYHeight(e),this.notifyRowChanged(t,e),this.options.autoFit&&this.autoFitFunc()},S.prototype.drillTo=function(t){try{var e=this.drilldown.drillTo(t),i=this.options.drilldownToggleScrollFix?{keepScrollTop:!0}:null;this.setScrollYHeight(i),this.notifyRowChanged(e,i),this.options.autoFit&&this.autoFitFunc()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getParentRowIndex=function(t){return t=parseInt(t),this.drilldown.getParentRowIndex(t)},S.prototype.getChildrenRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildrenRowArr(t)},S.prototype.getAncestorRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getAncestorRowArr(t)},S.prototype.getDescendantRowIndexArray=function(t){return t=parseInt(t),this.drilldown.getChildRowArr(t,!0)},S.prototype.getOpenStatus=function(t){var e=t=parseInt(t);return(!this.options.drilldownRealRowIndexAll||"number"==typeof(e=this.getDisplayRowIndex(t)))&&this.drilldown.isOpen(e)},S.prototype.getDataLength=function(){var t;if(this.successBinding)if(this.groupbyStatus.grouped){for(var e in this.customFilterStatusObj)if(this.customFilterStatusObj[e])return this._dataList.getDataLength();t=this.groupbyStatus.groupedRowIndexArr.length}else t=this._dataList.getDataLength();else t=0;return t},S.prototype.focusedRowMoveUp=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveUp(t)},S.prototype.focusedRowMoveDown=function(){var t=this._getFocusedRowIndex();this.dataList.rowMoveDown(t)},S.prototype.initStyleArr=function(t){t<=0&&(this.rowStyleArr=[],this.rowReadOnlyArr=[],this.rowDisabledArr=[]);var e=this.getTotalRow(),i=e*this.oneRowDataLength;t<=0?(this.rowStyleArr=new Array(e),this.rowReadOnlyArr=new Array(e),this.rowDisabledArr=new Array(e),this.rowStyleFixedArr=new Array(e),this.rowStyleDataArr=new Array(e),this.cellStyleArr=new Array(i),this.cellClassArr=new Array(i),this.cellReadOnlyArr=new Array(i),this.cellDisabledArr=new Array(i)):(this.rowStyleArr[e-1]=void 0,this.rowStyleFixedArr[e-1]=void 0,this.rowStyleDataArr[e-1]=void 0,this.rowReadOnlyArr[e-1]=void 0,this.rowDisabledArr[e-1]=void 0,this.cellStyleArr[i-1]=void 0,this.cellClassArr[i-1]=void 0,this.cellReadOnlyArr[i-1]=void 0,this.cellDisabledArr[i-1]=void 0)},S.prototype.modifyCheckedStatus=function(t,e){try{var i=this.getCheckedIndex(t);if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else u.k.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.modifyUncheckStatus=function(t,e){try{if("R"==(e=e.toUpperCase())||"U"==e||"V"==e||"D"==e||"C"==e){for(var i=this.getUnCheckedIndex(t),o=0;o<i.length;o++)this.dataList.modifyRowStatus(i[o],e),this._drawRowStatus(o-this.rowIndex,o),this.displayNoResultMessage();this.notifyStatusChanged({rowIndex:i})}else u.k.printLog("[Warning] Is not exist status Value!["+this.id+"]")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getVisibleColData=function(t){var e=[];t=this.getColumnIndex(t);for(var i=this.getColumnID(t),o=this.getDataLength(),s=0;s<o;s++)e.push(this.dataList._getCellData(s,i));return e},S.prototype.getCheckedIndex=function(t,e){try{var i,o=[],s=[],a=0,n=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==n.options.inputType||"radio"==n.options.inputType||"custom"==n.options.inputType){
i=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var l=n,h=0;h<i.length;h++){if(0==n.internal&&"custom"==n.options.inputType){var d=this.dataList.getRealRowIndex(h);if("checkbox"!=(l=n.cellManagerHashByRowIndex[d]?n.cellManagerHashByRowIndex[d]:n).options.inputType&&"radio"!=l.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(h))continue;if(e){s.push(h);var u=!(!this.isDrillDown||!this._dataList.options.depthColumn);this.___getEditReadOnly(h,t,u)||this._getEditDisabled(h,t,u)?a++:i[h]==l.options.trueValue&&o.push(h)}else i[h]==l.options.trueValue&&o.push(h)}}return e&&a!==s.length&&a+o.length==s.length?s:o}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getUnCheckedIndex=function(t){return this.getUncheckedIndex(t)},S.prototype.getUncheckedIndex=function(t){try{var e=[],i=this.cellInfoHash[this.getColumnID(t)];if("checkbox"==i.options.inputType||"radio"==i.options.inputType||"custom"==i.options.inputType){var o=[];o=this.isDrillDown&&this._dataList.options.depthColumn?this.dataList.getColData(t):this.getVisibleColData(t);for(var s=i,a=0;a<o.length;a++){if(0==i.internal&&"custom"==i.options.inputType){var n=this.dataList.getRealRowIndex(a);if("checkbox"!=(s=i.cellManagerHashByRowIndex[n]?i.cellManagerHashByRowIndex[n]:i).options.inputType&&"radio"!=s.options.inputType)continue}else if(this.groupbyStatus.grouped&&"object"==typeof this.dataList.getRealRowIndex(a))continue;o[a]!=s.options.trueValue&&e.push(a)}}return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getAllDisplayData=function(){try{var t=this._linkedDataList||this._dataList;if(t.getTotalRow()==t.getDataLength())return this.getAllVisibleData();this._endEdit();for(var e=this.getTotalRow(),i=this.getColumnCount(),o=[],s=0;s<e;s++)for(var a=0;a<i;a++)o.push(this._getDisplayData(s,a));return o}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getAllDisplayJSON=function(t){try{t||(t={emptyValue:"$$_blank_"});var e=this._linkedDataList||this._dataList;if(e.getTotalRow()==e.getDataLength())return this.getAllVisibleJSON(t);this._endEdit();for(var i=this.getTotalRow(),o=this.getColumnCount(),s=[],a=0;a<i;a++){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._getDisplayData(a,l,t);s.push(n)}return s}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getAllVisibleJSON=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),s=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a]){for(var n={},l=0;l<o;l++)n[this.tdIdList[l]]=this._grid._getCellDisplayData(a,l,t);s.push(n)}return s}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getAllDisplayXML=function(){try{var t=this._linkedDataList||this._dataList;return t.getTotalRow()==t.getDataLength()?this.getAllVisibleXML("displayData"):(this._endEdit(),this.getAllArrXML("displayData",this.id))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getAllVisibleXML=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=[],s=0;s<i;s++)e&&"number"!=typeof this.groupbyStatus.groupedRowIndexArr[s]||o.push(s);return this.getArrXML(o,t,e)}catch(t){r.w.printStackTrace(t)}},S.prototype.getAllVisibleData=function(t){try{this._endEdit();for(var e=this.options.groupbyDisplayRowIndex&&this.groupbyStatus.grouped,i=e?this.groupbyStatus.groupedRowIndexArr.length:this.getDataLength(),o=this.getColumnCount(),s=[],a=0;a<i;a++)if(!e||"number"==typeof this.groupbyStatus.groupedRowIndexArr[a])for(var n=0;n<o;n++)"displayData"===t?s.push(this._getCellDisplayData(a,n)):s.push(this.dataList.getCellData(a,n));return s}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.changeToRealRowIndexArr=function(t){try{
for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getCheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCheckedXML=function(t){try{this._endEdit();var e=this.getCheckedIndex(t);return this.getArrXML(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getUncheckedData=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this.dataList.getRowData(i[o]));return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getUncheckedJSON=function(t){try{this._endEdit();for(var e=[],i=this.getUncheckedIndex(t),o=0;o<i.length;o++)e.push(this._dataList.getRowJSON(i[o]));return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getUncheckedXML=function(t){try{this._endEdit();var e=this.getUncheckedIndex(t);return this.getArrXML(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCellChecked=function(t,e){try{var i=this.cellInfoHash[this.getColumnID(e)],o=i.id;if(0==i.internal&&"custom"==i.options.inputType){var s=this.dataList.getRealRowIndex(t);i=i.cellManagerHashByRowIndex[s]?i.cellManagerHashByRowIndex[s]:i}if("checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)return!1;var a=this.dataList._getCellData(t,o);return a=a==i.options.trueValue}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.hasChild=function(t){return this.drilldown.hasChild(t)},S.prototype.comparator=function(t,e){return parseInt(e)==parseInt(t)?0:parseInt(e)>parseInt(t)?1:-1},S.prototype.getExcelAllXML=function(t){try{var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=0;i<this.getDataLength();i++)for(var o=0;o<this.getTotalCol();o++)e.push(this.dataList._getCellData(i,this.getColumnID(o))),e.push('","');return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getExcelAllXMLDisplay=function(t){try{null==t&&(t=1);var e=new Array;e.push("<array><![CDATA["),e.push('["');for(var i=this.getDataLength(),o=this.getColumnCount(),s=0;s<i;s++)for(var a=0;a<o;a++){var n,l=this.getCellInfo(a);if("custom"==l.options.inputType){var h=this.dataList.getRealRowIndex(s);l.cellManagerHashByRowIndex[h]||(this.drawData(s),l=l.cellManagerHashByRowIndex[h]||l)}(n=l.useCustomFormatter||"custom"==l.options.inputType?this._getDisplayData(this.dataList.getRealRowIndex(s),a):1==t?l.getDisplayData(this.dataList._getCellData(s,this.getColumnID(a)),s):this.dataList._getCellData(s,this.getColumnID(a))+"").indexOf("javascript:")>-1&&(n=n.wq_replaceAll("javascript:","")),e.push(n),e.push('","')}return e[e.length-1]='"]',e.push("]]></array>"),e.join("")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getExcelAllXMLRaw=function(t){try{var e=this.dataArr.length,i=this.dataArr[0],o=this.dataArr[e-1];this.dataArr[0]='<array><![CDATA[["'+i,this.dataArr[e-1]=o+'"]]]></array>';var s=this.dataArr.join('","');return this.dataArr[0]=i,this.dataArr[e-1]=o,s}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.makeExcelData=function(t,e,i,o){try{var n=e.length,l=t+i.rowsByN;l=l<i.dataLength?l:i.dataLength;var h,d=this.oneRowDataLength,u=i.separator||",";if(i.convertIndex&&(h=i.convertIndex.split(",")),""==i.dataProvider&&""==i.splitProvider)if(0===i.type)for(var p=t;p<l;p++){if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(var c=0;c<d;c++){var g=!1;if(h)for(var f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelDisplayData(b,c,e,i,p)).length:(e=this._getExcelRealData(b,c,e,i)).length}}else if(1===i.type||2==i.type)for(p=t;p<l;p++){
if("number"==typeof(b=this.dataList.getRealRowIndex(p)))for(c=0;c<d;c++){g=!1;if(h)for(f=0;f<h.length;f++)if(h[f]==c.toString()){g=!0;break}n=g?(e=this._getExcelRealData(b,c,e,i)).length:(e=this._getExcelDisplayData(b,c,e,i,p)).length}}else l=i.dataLength,n=(e=this.dataList.getAllData()).length;var m=this;if(l<i.dataLength&&""==i.dataProvider&&""==i.splitProvider)if(!1!==i.massStorage)this.excelTime=setTimeout((function(){try{!0===i.showConfirm&&window.gridExceldownloadIframe.contentWindow.checkUpload(e.length/m.dataArr.length)}catch(t){}if(0!=i.multiexcel)return m.makeExcelData(l,e,i,o);m.makeExcelData(l,e,i,o)}),10);else{if(0!=i.multiexcel)return this.makeExcelData(l,e,i,o);this.makeExcelData(l,e,i,o)}else{var y;if(""==i.dataProvider&&""==i.splitProvider)if(e.length>=2){if(i.groupby&&this.groupbyStatus.grouped&&this.defaultColCnt>0){var b=1,w=this.oneRowDataLength,v=[];for(p=0;p<e.length;p++){if((p%w==0||0==p)&&(b=parseInt(p/w,10),this.options.rowNumVisible&&v.push(b+1),this.options.rowStatusVisible)){var I=this.getRowStatus(b);v.push(I)}v.push(e[p])}n=(e=v).length}if(n>0){var C=e[0],x=e[n-1];e[0]='<array><![CDATA[["'+C,e[n-1]=x+'"]]]></array>',y=e.join('"'+u+'"'),e[0]=C,e[n-1]=x}else y="<array><![CDATA[["+e+"]]]></array>"}else{y="<array><![CDATA[["+(1===e.length?'"'+e[0]+'"':"")+"]]]></array>"}else y="<array><![CDATA[[ ]]]></array>";if(!0===i.showConfirm)this.excelOptions=i,this.excelInfoArr=o,this.excelFinalStr=y,this.checkUpload();else{if(0!=i.multiexcel)return this.sendExcelData(i,o,y);this.sendExcelData(i,o,y)}}}catch(t){var _=s.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/excel/download/errorHandler/@value"),S=a.D.getGlobalFunction(_,this.scope_id);"function"==typeof S&&S.call(this,this.id),r.w.printStackTrace(t,null,this)}},S.prototype._getExcelRealData=function(t,e,i,o){try{var s=o.cellInfo,a=o.isExpCol,n=i;if(a[e])n.push(s[e].getExpressionValue(t));else{var l=this.dataList._getData(t,e);n.push(null!=l?l:"")}return n}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._getExcelDisplayData=function(t,e,i,o,s){try{var a,n=o.cellInfo,l=o.isSelectCol,h=o.isBasicCol,d=o.isExpCol,u=o.isCustomCol,p=o.isCustomModelCol,c=o.isCustomType,g=o.isEscapeFormatter,f=i;if(d[e]&&(a=n[e].getExpressionValue(t)),u[e]||p[e]||g[e]?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),n[e].options.useMonthYearFormat&&"calendar"===n[e].options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n[e].options.ioFormat,n[e].options.calendarValueType)),a=null!=a?a:""),h[e]||d[e])n[e].options.maskFormat&&(a=this.getInput(n[e]).maskFormatModelUnFormat(a)),a=n[e].formatter?n[e].formatter.format(a):a;else if(!l[e]||u[e]||p[e]){if(c[e]){_=null;var m,y=n[e].cellManagerHashByRowIndex[s];y?m=(n=y).options.inputType:(n=n[e],m="text");var b=n.useCustomFormatter,w=n.useCustomModelFormatter,v=n.useEscapeFormatter,I="select"===m||"checkcombobox"===m||"autoComplete"===m,C="expression"===m,x=!("checkbox"===m||"image"===m||"radio"===m||I||C||b||w||v);if(b||w||v?a=this._getDisplayData(t,e):(a=this.dataList._getData(t,e),n.options.useMonthYearFormat&&"calendar"===n.options.inputType&&(a=WebSquare.date.getIOFormatDate(a,n.options.ioFormat,n.options.calendarValueType)),a=null!=a?a:""),x||C)n.options.maskFormat&&(a=this.getInput(n).maskFormatModelUnFormat(a)),a=n.formatter?n.formatter.format(a):a;else if(I&&!b&&!w){_=null;null==(_=2==o.type?this.dataList._getData(t,e):n.getData(a,t))&&(_=""),a=_}}}else{var _=null;if(2==o.type)_=this.dataList._getData(t,e);else{var S=n[e].dataComp,D=t;if(S){var R=this.modelControl.getDataComp(S);R&&"linkedDataList"===R.initializeType&&(D=s)}_=n[e].getData(a,D)}null==_&&(_=""),a=_}return"string"==typeof a&&a.indexOf("javascript:")>-1&&(a=a.wq_replaceAll("javascript:","")),f.push(a),f}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._getStyleRowIndex=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t)
;return null==e?e=null:"number"!=typeof e&&(e=e.type+"_"+e.groupId),e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getRowStyleClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleArr[e]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setRowStyleClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleArr[i]=e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCellStyleClassName=function(t,e){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var i=this._getStyleRowIndex(t);return null==i?void 0:"number"==typeof i?this.cellStyleArr[i*this.oneRowDataLength+e]:this.cellStyleArr[i+"_"+e]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellStyleClassName=function(t,e,i){try{e=this.getColumnIndex(e);var o=this._getStyleRowIndex(t);if(null==o)return;"number"==typeof o?this.cellStyleArr[o*this.oneRowDataLength+e]=i:this.cellStyleArr[o+"_"+e]=i}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getCellClass=function(t,e){try{"number"!=typeof e&&(e=this.bodyIdColIndexMap[e]);var i=this._getStyleRowIndex(t);return null==i?void 0:"number"==typeof i?this.cellClassArr[i*this.oneRowDataLength+e]:this.cellClassArr[i+"_"+e]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellDefaultStyleClassName=function(t,e,i){try{e=this.getColumnIndex(e);var o=this.getCellStyleClassName(t,e,i);return null==o&&(this.cellStyleIndex++,o=this.id+"_cellstyle_"+this.cellStyleIndex+"_",this.setCellStyleClassName(t,e,o,i)),null==this.cellStyleValueObj[o]&&(this.cellStyleValueObj[o]={}),o}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellClass=function(t,e,i){try{e=this.getColumnIndex(e);var o,s=this._getStyleRowIndex(t);o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex;var a=this.data_td_list[o*this.oneRowDataLength+e];if(null==s)return;if("number"==typeof s){var n=this.tdCellClassArr[o*this.oneRowDataLength+e];n&&this.removeClass(a,n),this.cellClassArr[s*this.oneRowDataLength+e]=i}else this.cellClassArr[s+"_"+e]=i;a&&(this.tdCellClassArr[o*this.oneRowDataLength+e]=i,this.addClass(a,i))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.removeCellClass=function(t,e,i){try{e=this.getColumnIndex(e);var o,s=this._getStyleRowIndex(t);if(o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?this.getDisplayRowIndex(t)-this.rowIndex:t-this.rowIndex,null==s)return;"number"==typeof s?this.cellClassArr[s*this.oneRowDataLength+e]=void 0:this.cellClassArr[s+"_"+e]=void 0;var a=this.data_td_list[o*this.oneRowDataLength+e];a&&(i||(i=this.tdCellClassArr[o*this.oneRowDataLength+e]),this.tdCellClassArr[o*this.oneRowDataLength+e]=void 0,this.removeClass(a,i))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._removeAllTDCellClass=function(){try{for(var t=this.tdCellClassArr.length,e=0;e<t;e++){var i=this.tdCellClassArr[e],o=this.data_td_list[e];o&&i&&this.removeClass(o,i)}this.tdCellClassArr=[]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._setColumnClass=function(t,e){try{var i=this.getColumnIndex(t);if(this.columnClassObj[i]){var o=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim();this.columnClassObj[i]=o+" "+e}else this.columnClassObj[i]=e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._setColumnClass(t,i[o]);for(o=this.getColumnIndex(t);o<this.data_td_list.length;o+=this.oneRowDataLength){var s=this.data_td_list[o];s&&this.addClass(s,e)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._removeColumnClass=function(t,e){try{var i=this.getColumnIndex(t);this.columnClassObj[i]=this.columnClassObj[i].replace(new RegExp(e,"g"),"").wq_trim(),this.columnClassObj[i]||delete this.columnClassObj[i];for(var o=i;o<this.data_td_list.length;o+=this.oneRowDataLength){var s=this.data_td_list[o];s&&this.removeClass(s,e)}
}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.removeColumnClass=function(t,e){try{if("string"!=typeof e)return;for(var i=e.split(" "),o=0;o<i.length;o++)this._removeColumnClass(t,i[o])}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getColumnClass=function(t){try{var e=this.getColumnIndex(t);return this.columnClassObj[e]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._refreshColumnClass=function(){try{for(var t in this.columnClassObj)this.setColumnClass(this.columnClassObj[t])}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getRowStyleFixedClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleFixedArr[e]}catch(t){$l("getRowStyleFixedClassName :"+t.message),r.w.printStackTrace(t,null,this)}},S.prototype.setRowStyleFixedClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleFixedArr[i]=e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getRowStyleDataClassName=function(t){try{var e=this._getStyleRowIndex(t);return null==e?null:this.rowStyleDataArr[e]}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setRowStyleDataClassName=function(t,e){try{var i=this._getStyleRowIndex(t);if(null==i)return;this.rowStyleDataArr[i]=e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.refreshColumnItemset=function(t){try{var e=this.getCellInfo(t);if(e.resetMatchInfo=!0,e.options.embeddedInput){t=this.getColumnIndex(e.options.col_id);for(var i=0;i<this.drawedRowLength;i++){var o=this.data_td_list[t+i*this.oneRowDataLength];if(o){var s=this.dom[o.getAttribute("id")+"_select"];s&&s.refreshItemset()}}}else"select"==e.options.inputType?(e.hasRef&&(e.refHash=[]),e.select&&e.select.refreshItemset(),e.itemsetObj&&e.mainGrid.refresh()):"checkcombobox"==e.options.inputType&&(e.refreshItemArr(),e.checkcombobox)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.refreshRadioGroup=function(t){try{for(var e={},i=[],o=0;o<this.oneRowDataLength;o++){"radio"==(l=this.getCellInfo(o)).options.inputType&&l.options.groupName==t&&(l.options.groupRef&&(l.options.groupValue=WebSquare.ModelUtil.getInstanceValue(l.options.groupRef,null,this.scope_id)),e[l.options.groupValue]=l,i.push(l))}if(0==i.length)return;var s=this.getDataLength();for(o=0;o<s;o++){var a=e[this.dataList._getCellData(o,t)];if(a)this.dataList.__setCellData(o,a.id,a.options.trueValue);else{for(var n=0;n<i.length;n++){var l=i[n];this.dataList.__setCellData(o,l.id,l.options.defaultValue)}var h=this.getCellInfo(t);h&&this.dataList.__setCellData(o,t,h.options.defaultValue)}}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.resetRadioGroup=function(t,e){return this._resetRadioGroup.call(this,t,e,!0)},S.prototype._resetRadioGroup=function(t,e,i){try{for(var o=[],s=0;s<this.oneRowDataLength;s++){"radio"==(h=this.getCellInfo(s)).options.inputType&&h.options.groupName==e&&o.push(h)}if(0==o.length)return;if("number"==typeof t)var a=t,n=t+1;else a=0,n=this.getDataLength();for(s=a;s<n;s++){for(var l=0;l<o.length;l++){var h=o[l];this.dataList.__setCellData(s,h.id,h.options.defaultValue)}if(i){var d=this.getCellInfo(e);d&&this.dataList.__setCellData(s,e,d.options.defaultValue)}}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.xmlData2ArrData=function(t,e,i){try{if(null==t)return;if(9==t.nodeType)s=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode);else if(o=i&&i.baseNode?i.baseNode:this.options.baseNode,i&&i.isRepeatNode)s=(t=WebSquare.xml.parse(WebSquare.xml.serialize(t))).selectNodes("/"+i.repeatNode);else if(o.startsWith(t.tagName))var o=o.replace(t.tagName,"."),s=t.selectNodes(o+"/"+this.options.repeatNode);else t=WebSquare.xml.parse(WebSquare.xml.serialize(t)),s=1==e?t.selectNodes("/"+this.options.repeatNode):t.selectNodes("/"+this.options.baseNode+"/"+this.options.repeatNode)
;for(var n=[],l=this.options.valueNode,h=null==l||""==l,d=a.D.getTextNodeValue,u=s.length,p=this.tdIdList.length,c=[],g=[],f=[],m=0;m<p;m++){c[m]=this.getCellInfo(this.tdIdList[m]);var y=c[m].options;null!=y.importFormatter&&""!=y.importFormatter&&(g[m]=!0),null!=y.importExp&&""!=y.importExp&&(f[m]=!0)}for(m=0;m<u;m++){for(var b=m,w=s[m],v=n.length,I=0;I<p;I++){var C=s[m].selectSingleNode(this.tdIdList[I]);n[v+I]=null!=C?h?d(C):C.getAttribute(l):c[I].options.defaultValue}for(I=0;I<p;I++)if(g[I])try{var x=a.D.getGlobalFunction(c[I].options.importFormatter,this.scope_id);"function"==typeof x&&(n[v+I]=x.call(this,w,b))}catch(t){n[v+I]=c[I].options.defaultValue,r.w.printStackTrace(t,null,this)}for(I=0;I<p;I++)if(f[I])try{var _=new Function("_this","obfuscator_rowXml","return "+c[I].options.importExp)(this,w);n[v+I]=_}catch(t){n[v+I]=c[I].options.defaultValue,r.w.printStackTrace(t,null,this)}for(I=0;I<p;I++){if("radio"==c[I].options.inputType&&c[I].options.groupName&&this.cellInfoHash[c[I].options.groupName]){var S=c[I].options.trueValue,D=c[I].options.falseValue;switch(c[I].options.valueType){case"binary":S="1",D="0";break;case"boolean":S="true",D="false"}this.columnValue(w,c[I].options.groupName)==c[I].options.groupValue?n[v+I]=S:n[v+I]=D}this.options.xmlEncode&&null!=n[v+I]&&(n[v+I]=WebSquare.xml.decode(n[v+I]))}}return n}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.jsonData2ArrData=function(t){try{if(null==t)return;for(var e=[],i=t.length,o=this.cellIdList.length,s=[],n=0;n<o;n++)s[n]=this.getCellInfo(this.cellIdList[n]);for(n=0;n<i;n++)for(var l=n,h=t[n],d=e.length,u=0;u<o;u++)if(s[u].options.importFormatter)try{var p=a.D.getGlobalFunction(s[u].options.importFormatter,this.scope_id);"function"==typeof p&&(e[d+u]=p.call(this,h,l))}catch(t){e[d+u]=s[u].options.defaultValue,r.w.printStackTrace(t,null,this)}else if(s[u].options.importExp)try{var c=new Function("_this","obfuscator_rowXml","return "+s[u].options.importExp)(this,h);e[d+u]=c}catch(t){e[d+u]=s[u].options.defaultValue,r.w.printStackTrace(t,null,this)}else{var g=t[n][this.cellIdList[u]];e[d+u]=null!=g?g:s[u].options.defaultValue}return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.xpathValue=function(t,e){try{var i=WebSquare.xml.findNode(t,e);if(null==i)return"";if(1!=i.nodeType)return i.nodeValue;for(var o=i.firstChild;null!=o;o=o.nextSibling)if(3==o.nodeType)return o.nodeValue}catch(t){$l("xpath exeption"),r.w.printStackTrace(t,null,this)}return""},S.prototype.getAllArrXML=function(t){try{var e=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var i=0;i<this.tagNmArr.length;i++)if(null!=this.tagNmArr[i]&&""!=this.tagNmArr[i].wq_trim())if(e)s.push(o.createElement(this.tagNmArr[i])),s[i-1].appendChild(s[i]);else{var o=WebSquare.xml.parse("<"+this.tagNmArr[i]+"/>"),s=[];s.push(o.documentElement),e=!0}var n=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),l=null;for(i=0;i<this.getTotalRow();i++){var h=i;l=[];for(var d=null,u=0;u<n.length;u++)if(""!=n[u]){var p=o.createElement(n[u]);l.push(p),0==u?s[s.length-1].appendChild(p):l[u-1].appendChild(l[u])}(d=l[n.length-1]).setAttribute("status",this.dataList._getRowStatusValue(h)),d.setAttribute("statusValue",this.dataList._getRowStatus(h)),d.setAttribute("id",h);for(var c=this.getColumnCount(),g=new Array(c),f=0;f<c;f++){var m="";m="displayData"!=t?this._dataList._getData(h,f):this._getDisplayData(h,f),this.options.xmlEncode&&(m=WebSquare.xml.encode(m));var y=this.getColumnID(f),b=this.getCellInfo(f);if(""!=b.options.exportFormatter)try{var w=a.D.getGlobalFunction(b.options.exportFormatter,this.scope_id);"function"==typeof w&&w(d,m,h,y)}catch(t){r.w.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(g[f]=o.createElement(this.getColumnID(f)),""==this._dataList.options.valueAttribute){var v=o.createTextNode(m);g[f].appendChild(v)}else g[f].setAttribute(this._dataList.options.valueAttribute,m);d.appendChild(g[f])
}}}return o}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getArrXML=function(t,e,i){try{if(t instanceof Array){var o=!1;this.tagNmArr=this._dataList.options.baseNode.replace(/\[[^\]]+\]/g,"").split("/");for(var s=0;s<this.tagNmArr.length;s++)if(null!=this.tagNmArr[s]&&""!=this.tagNmArr[s].wq_trim())if(o)l.push(n.createElement(this.tagNmArr[s])),l[s-1].appendChild(l[s]);else{var n=WebSquare.xml.parse("<"+this.tagNmArr[s]+"/>"),l=[];l.push(n.documentElement),o=!0}var h=this._dataList.options.repeatNode.replace(/\[[^\]]+\]/g,"").split("/"),d=null;for(s=0;s<t.length;s++){var u=t[s];d=[];for(var p=null,c=0;c<h.length;c++)if(""!=h[c]){var g=n.createElement(h[c]);d.push(g),0==c?l[l.length-1].appendChild(g):d[c-1].appendChild(d[c])}(p=d[h.length-1]).setAttribute("status",this.dataList.getRowStatusValue(u)),p.setAttribute("statusValue",this.dataList.getRowStatus(u)),!0===i?p.setAttribute("id",this._getGroupbyDisplayRowIndex(u)):p.setAttribute("id",u);for(var f=this.getColumnCount(),m=new Array(f),y=0;y<f;y++){var b="";"displayData"!=e?null==(b=this.dataList._getCellData(u,y))&&(b=""):null==(b=this._getCellDisplayData(u,y))&&(b=""),this.options.xmlEncode&&(b=WebSquare.xml.encode(b));var w=this.getColumnID(y),v=this.getCellInfo(y);if(""!=v.options.exportFormatter)try{var I=a.D.getGlobalFunction(v.options.exportFormatter,this.scope_id);"function"==typeof I&&I(p,b,u,w)}catch(t){r.w.printStackTrace(t,null,this),$l("xmlDtaGetter - tdObj.exportFormatter error")}else{if(m[y]=n.createElement(this.getColumnID(y)),""==this._dataList.options.valueAttribute){var C=n.createTextNode(b);m[y].appendChild(C)}else m[y].setAttribute(this._dataList.options.valueAttribute,b);p.appendChild(m[y])}}}return n}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getDisplayRowIndex=function(t){try{return(this._linkedDataList||this._dataList).getFilteredRowIndex(t)}catch(t){r.w.printStackTrace(t)}},S.prototype.getOption=function(t){try{return this.options[t]}catch(t){r.w.printStackTrace(t)}},S.prototype.getDataList=function(){try{var t=this._linkedDataList||this._dataList;return t?t.id:null}catch(t){r.w.printStackTrace(t)}},S.prototype.getRowNumVisible=function(){try{return this.options.rowNumVisible}catch(t){r.w.printStackTrace(t)}},S.prototype.makeCustomFilter=function(t){try{null!=this.customFilter&&this.customFilter.remove(),this.customFilter=new WebSquare.uiplugin.floatingLayer(this.id+"_customFilter",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter",useModal:!0,headerLeftClass:"w2grid_customFilter_HL",headerRightClass:"w2grid_customFilter_HR",headerCenterClass:"w2grid_customFilter_HC",bodyLeftClass:"w2grid_customFilter_BL",bodyRightClass:"w2grid_customFilter_BR",bodyCenterClass:"w2grid_customFilter_BC",bodyLeftBottomClass:"w2grid_customFilter_FL",bodyRightBottomClass:"w2grid_customFilter_FR",bodyBottomClass:"w2grid_customFilter_FC",closeButtonClass:"w2grid_customFilter_btnClose",title:WebSquare.language.getMessage("Grid_filter_title")||"사용자 지정 필터",titleClass:"w2grid_customFilter_title"});var e=new WebSquare.uiplugin.textbox(this.id+"_text1_"+this.headerID,{style:"position:absolute; margin:10px;",className:"w2grid_customFilter_text",label:WebSquare.language.getMessage("Grid_filter_search_label")||"찾을 조건"});this.customFilter.addControl(e),this.selectboxItemSet=["=","<>",">",">=","<","<=",WebSquare.language.getMessage("Grid_filter_condition7")||"= (메타문자 사용)",WebSquare.language.getMessage("Grid_filter_condition1")||"시작문자",WebSquare.language.getMessage("Grid_filter_condition2")||"제외할 시작 문자",WebSquare.language.getMessage("Grid_filter_condition3")||"끝 문자",WebSquare.language.getMessage("Grid_filter_condition4")||"제외할 끝 문자",WebSquare.language.getMessage("Grid_filter_condition5")||"포함",WebSquare.language.getMessage("Grid_filter_condition6")||"포함하지 않음"],this._selectboxIgnoreOperatorItemSet=[">",">=","<","<="],this.customFilterItemCnt=0,this.groupList=[]
;var i=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute; width:100%; height:22px; margin-bottom:5px; background-color:transparent;"});this.customFilter.addControl(i),this.groupList.push(i);var o=this,s=new WebSquare.uiplugin.selectbox(i.id+"_selectbox_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",wheelRows:1,xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var t=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(t.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? 기호를 사용하여 한문자를 나타낼 수 있습니다."),e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* 기호를 사용하여 여러 문자를 나타낼 수 있습니다."),o.setChildrenPosition(),o.customFilterMetacharPos|=1):(o.customFilterMetacharPos&=-2,o.customFilterMetacharPos<=0&&(t.setLabel(""),e.setLabel(""),o.setChildrenPosition()))}}}]});i.addControl(s);var n=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",l=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",u=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",p=new WebSquare.uiplugin.autoComplete(i.id+"_autocomplete_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,wheelRows:1,submenuSize:n,displayMode:l,searchTarget:u,delimiter:h});if(p.__setSelectedIndex1=p.setSelectedIndex1,p.setSelectedIndex1=function(t,e){p.__setSelectedIndex1(t,e);var i=p.getValue(),s=this.parentControl.id;if(s)var r=a.D.getComponentById(s+"_selectbox_"+o.headerID);if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},i.addControl(p),"label"==l||"value delim label"==l||"label delim value"==l)for(var c=this.changeItemValue("label",this.targetColID,this.colDataList),g=0;g<this.colDataList.length;g++)p.addItem(c[g],this.colDataList[g]);else if(this.colDataList)for(g=0;g<this.colDataList.length;g++)p.addItem(this.colDataList[g],this.colDataList[g]);for(var f=this.headCellInfoHash[this.headerID].getAttribute("customFilterItemCnt")||2,m=0;m<f-1;m++)this.addCustomFilterItem(m);var y=new WebSquare.uiplugin.textbox(this.id+"_text2_"+this.headerID,{style:"position:absolute; margin-left:10px; margin-top:5px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(y);var b=new WebSquare.uiplugin.textbox(this.id+"_text3_"+this.headerID,{style:"position:absolute; margin:5px; margin-bottom:10px; margin-left:10px;",className:"w2grid_customFilter_text"});this.customFilter.addControl(b);var w=new WebSquare.uiplugin.group(this.id+"_buttonGroup_"+this.headerID,{style:"position:absolute;",className:"w2grid_customFilter_buttonGroup"});if(this.customFilter.addControl(w),this.options.showCustomFilterReset){var v=new WebSquare.uiplugin.textbox(this.id+"_btnReset_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",label:WebSquare.language.getMessage("Grid_filter_reset")||"초기화",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.groupbyStatus&&o.groupbyStatus.grouped&&o.options.groupbyFilterBox;for(var e=0;e<o.groupList.length;e++)for(var i=o.groupList[e].getChildren(),s=0;s<i.length;s++){var r=i[s];if(-1!=r.id.indexOf("_selectbox")){var a=o.itemValueObj[o.targetColID]["select"+e];r.setSelectedIndex(a||0)}else if(-1!=r.id.indexOf("_autocomplete")){
var n=o.itemValueObj[o.targetColID]["auto"+e];r.setValue(n||"")}else if(-1!=r.id.indexOf("_radio")){var l=o.itemValueObj[o.targetColID]["radio"+e];r.setSelectedIndex(l||0)}}}}}]});w.addControl(v),v.addEvent("onmousedown",(function(){v.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),v.addEvent("onmouseup",(function(){v.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),v.addEvent("onmouseout",(function(){v.toggleClass("w2grid_customFilter_button_selected")}))}var I=new WebSquare.uiplugin.textbox(this.id+"_btnConform_"+this.headerID,{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_confirm")||"확인",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.setCustomFilterExpression()}}},{name:"onkeydown",action:"script",param:{handler:function(t){13==(t.charCode?t.charCode:t.keyCode)&&(o.setCustomFilterExpression(),o.hideCustomFilterList())}}}]});w.addControl(I),I.addEvent("onmousedown",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!0})),I.addEvent("onmouseup",(function(){I.toggleClass("w2grid_customFilter_button_selected"),this.customFilterBtnSelected=!1})),I.addEvent("onmouseout",(function(){I.toggleClass("w2grid_customFilter_button_selected")}));var C=new WebSquare.uiplugin.textbox(this.id+"_btnCancel",{style:"position:absolute; border-width:1px;",className:"w2grid_customFilter_button",tabIndex:"0",label:WebSquare.language.getMessage("Grid_filter_cancel")||"취소",xmlEvents:[{name:"onclick",action:"script",param:{handler:function(t){o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide()}}},{name:"onkeydown",action:"script",param:{handler:function(t){var e=t.charCode?t.charCode:t.keyCode;9==e?(C.tabOrderMoveStart=!1,t.shiftKey||(C.tabOrderMoveStart=!0,d.B.preventDefault(t))):13==e&&(o.options.groupbyZone&&o.firstOpenCustomFilter[o.headerID]&&(o.firstOpenCustomFilter[o.headerID]=!1),o.customFilter.hide(),o.hideCustomFilterList())}}},{name:"onkeyup",action:"script",param:{handler:function(t){9==(t.charCode?t.charCode:t.keyCode)&&(t.shiftKey||C.tabOrderMoveStart&&(C.tabOrderMoveStart=!1,o.customFilter.render.getElementsByClassName("w2floatingLayer_close_button")[0].focus()))}}}]});w.addControl(C),C.addEvent("onmousedown",(function(){C.toggleClass("w2grid_customFilter_button_selected")})),C.addEvent("onmouseup",(function(){C.toggleClass("w2grid_customFilter_button_selected")})),C.addEvent("onmouseout",(function(){C.toggleClass("w2grid_customFilter_button_selected")})),this.customFilter.writeTo(WebSquare.getBody()),this.customFilter.activate(),this.customFilter.dom.closeButton.addEventListener("keydown",(function(t){9==(t.charCode?t.charCode:t.keyCode)&&t.shiftKey&&C.focus()})),this.setChildrenPosition(),this.setDefaultValue(t),C.render.style.left=w.render.offsetWidth-C.render.offsetWidth-10+"px",I.render.style.left=parseInt(C.render.style.left,10)-I.render.offsetWidth-5+"px",this.options.showCustomFilterReset&&(v.render.style.left=parseInt(I.render.style.left,10)-C.render.offsetWidth-17+"px"),this.customFilter.hide()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setDefaultValue=function(t){for(var e=[],i=0;i<this.groupList.length;i++)for(var o=this.groupList[i].getChildren(),s=0;s<o.length;s++){var r,a=o[s];if(-1!=a.id.indexOf("_selectbox")){r=a;for(var n=0;n<this.selectboxItemSet.length;n++)">"===this.selectboxItemSet[n]||">="===this.selectboxItemSet[n]||"<"===this.selectboxItemSet[n]||"<="===this.selectboxItemSet[n]?a.addItemArr(this.selectboxItemSet[n],this.selectboxItemSet[n],!1):a.addItemArr(this.selectboxItemSet[n],this.selectboxItemSet[n]);if(e[i]&&e[i].select){var l=e[i].select;a.setSelectedIndex(l||0)}else{var h=this.itemValueObj[this.targetColID]["select"+i];a.setSelectedIndex(h||0)}
}else if(-1!=a.id.indexOf("_autocomplete")){if(e[i]&&e[i].auto){var d=e[i].auto;a.setValue(d||"")}else{var u=this.itemValueObj[this.targetColID]["auto"+i];a.setValue(u||"")}var p=a.getValue();if(r){if(isNaN(p))for(n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}r=null}else if(-1!=a.id.indexOf("_radio"))if(a.addItem("OR","OR","0"),a.addItem("AND","AND","0"),e[i]&&e[i].radio){var c=e[i].radio;a.setSelectedIndex(c||0)}else{var g=this.itemValueObj[this.targetColID]["radio"+i];a.setSelectedIndex(g||0)}}},S.prototype.getUniqueValueOfArray=function(t){t.sort();for(var e=[],i=0;i<t.length;i++)(0===e.length||e[e.length-1]!==t[i]&&e[e.length-1]+""!=t[i]+"")&&e.push(t[i]);return e},S.prototype.setAutoCompleteItem=function(t,e){var i=[];if(this.options.useFilterSearch&&this.customFilterList&&this.customFilterList.filterHistory.column.length>0){var o=this.getCustomFilterListJSON({colID:t,headerID:e}),s=this.headerInfoHash[e],r=0;s&&s.options.hideCustomFilter&&(r=1);for(var n=2-r;n<o.length;n++)i.push(o[n].id2)}else i=this.dataList.getColData(t);for(var l in this.itemValueObj[this.targetColID])-1!=l.indexOf("auto")&&""!=this.itemValueObj[this.targetColID][l]&&i.push(this.itemValueObj[this.targetColID][l]);this.colDataList=this.getUniqueValueOfArray(i),this.colDataList.sort((function(t,e){var i=t-e;a.D.isIE("6 7")&&(i=(t+"").localeCompare(e+""));return i}))},S.prototype.showFilterOptions=function(t){this.options.useFilterList?(this.options.searchFilter,this.customFilterList&&this.customFilterScrollView?this.toggleCustomFilterList(t):this.createCustomFilterList(t)):this.showCustomFilter(t)},S.prototype.showCustomFilter=function(t){this.noevent=!0,!this.options.useFilterList||this.groupbyStatus.grouped?this._showCustomFilter(t):this.showFilterOptions(t)},S.prototype.showCustomFilter2=function(t){this.noevent=!0,this._showCustomFilter(t)},S.prototype._showCustomFilter=function(t){var e,i;(this.headerID=t,this.targetColID=this.getColIdByHeaderId(t),null==this.customFilter&&(this.itemValueObj={},this.customFilterStatusObj={}),this.itemValueObj[this.targetColID]||(this.itemValueObj[this.targetColID]={}),this.setAutoCompleteItem(this.targetColID,t),this.makeCustomFilter(this.targetColID,t),"BODY"==this.render.parentNode.tagName)?(e=this.render.offsetTop,i=this.render.offsetLeft):(e=WebSquare.style.getAbsoluteTop(this.render),i=WebSquare.style.getAbsoluteLeft(this.render),a.D.isIEAllVersion("5 6 7")||(e-=WebSquare.style.getAbsoluteTop(document.body)));var o=this.getHeaderPosition(t,"top"),s=this.getHeaderPosition(t,"left"),r=this.getHeaderSize(t,"width"),n=this.getHeaderSize(t,"height"),l=0,h=0;"number"==typeof window.innerWidth?(l=window.innerWidth,h=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(l=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(l=document.body.clientWidth,h=document.body.clientHeight);var d,u,p=parseInt(a.D.getStyleProperty(this.customFilter.render,"width"),10),c=parseInt(a.D.getStyleProperty(this.customFilter.render,"height"),10),g=0,f=0;a.D.isIE("6 7 8")?(d=document.documentElement.scrollTop,u=document.documentElement.scrollLeft):(d=window.pageYOffset,u=window.pageXOffset),g=i+s+r+p<=l+u?i+s+r:i+s-p,f=e+o+n+c<=h+d?e+o+n:e+this.render.offsetHeight-c,g<u&&(g=(l-p)/2+u,(f=e+this.render.offsetHeight)+c>h+d&&(f=e-c)),f<d&&(f=(h-c)/2+d),this.customFilter.render.style.left=g+"px",this.customFilter.render.style.top=f+"px",this.customFilter.show();var m=a.D.getComponentById(this.id+"_item_0_selectbox_"+this.headerID);m&&m.focus()},S.prototype.addCustomFilterItem=function(t){this.customFilterItemCnt++;var e=new WebSquare.uiplugin.group(this.id+"_item_"+this.customFilterItemCnt,{style:"position:absolute;",
className:"w2grid_customFilter_item"});this.customFilter.addControl(e),this.groupList.push(e);var i=new WebSquare.uiplugin.radio(e.id+"_radio",{style:"position:absolute; left:50px; height:20px;",className:"w2grid_customFilter_radio",selectedIndex:0,cols:2,rows:1});e.addControl(i);var o=this,s=new WebSquare.uiplugin.selectbox(e.id+"_selectbox",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_selectbox",textAlign:"left",chooseOption:!0,visibleColumn:"true",xmlEvents:[{name:"onchange",action:"script",param:{handler:function(){var e=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-2],i=o.customFilter.getChildren()[o.customFilter.getChildrenCount()-3];7==this.getSelectedIndex()?(e.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label1")||"? 기호를 사용하여 한문자를 나타낼 수 있습니다."),i.setLabel(WebSquare.language.getMessage("Grid_filter_info_Label2")||"* 기호를 사용하여 여러 문자를 나타낼 수 있습니다."),o.setChildrenPosition(),o.customFilterMetacharPos|=1<<t+1):(o.customFilterMetacharPos&=~(1<<t+1),o.customFilterMetacharPos<=0&&(e.setLabel(""),i.setLabel(""),o.setChildrenPosition()))}}}]});e.addControl(s);var r=this.headerInfoHash[this.headerID].options.filterSubmenuSize||"",n=this.getCellInfo(this.targetColID).options.filterDisplayMode||"label",l=this.getCellInfo(this.targetColID).options.filterSearchTarget||"label",h=this.getCellInfo(this.targetColID).options.delimiter||" ",d=new WebSquare.uiplugin.autoComplete(e.id+"_autocomplete",{style:"position:absolute; top:25px;",className:"w2grid_customFilter_autocomplete",noResult:"useData",ignoreBlankOnNoResult:!0,chooseOption:!0,caseSensitive:this.options.caseSensitive,submenuSize:r,displayMode:n,searchTarget:l,delimiter:h});if(d.__setSelectedIndex1=d.setSelectedIndex1,d.setSelectedIndex1=function(t,e){d.__setSelectedIndex1(t,e);var i=d.getValue(),s=this.parentControl.id;if(s)var r=a.D.getComponentById(s+"_selectbox");if(r){if(isNaN(i)){for(var n=0;n<r.itemArr.length;n++)void 0!==r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!0);for(var l=r.getValue(),h=0;h<o._selectboxIgnoreOperatorItemSet.length;h++)l===o._selectboxIgnoreOperatorItemSet[h]&&r.setSelectedIndex(0)}else for(n=0;n<r.itemArr.length;n++)!0===r.itemArr[n]._hidden&&(r.itemArr[n]._hidden=!1);r.setSelectOptions(r.itemArr)}},e.addControl(d),"label"==n||"value delim label"==n||"label delim value"==n)for(var u=this.changeItemValue("label",this.targetColID,this.colDataList),p=0;p<this.colDataList.length;p++)d.addItem(u[p],this.colDataList[p]);else if(this.colDataList)for(p=0;p<this.colDataList.length;p++)d.addItem(this.colDataList[p],this.colDataList[p])},S.prototype.setChildrenPosition=function(){for(var t=this.customFilter.getChildren(),e=1;e<=t.length;e++){var i=WebSquare.style.getStyle(t[e-1].render,"top");if(i="auto"===i?"0":i,e===t.length)break;var o=WebSquare.style.getStyle(t[e-1].render,"margin-bottom");o="auto"===o?"0":o,t[e].render.style.top=t[e-1].render.offsetHeight+5+parseInt(i||"0",10)+parseInt(o||"0",10)+"px"}var s=this.customFilter.dom.closeButton.parentNode.offsetHeight,r=t[e-1].render.offsetHeight+10+parseInt(i||"0",10);this.customFilter.setSize(this.customFilter.render.offsetWidth,s+r+6)},S.prototype.replacechar=function(t){return"^"==t||"$"==t||"."==t||"["==t||"]"==t||"{"==t||"}"==t||"+"==t||"("==t||")"==t||"|"==t||"*"==t||"?"==t||"\\"==t?"\\"+t:void 0},S.prototype.setCustomFilterExpression=function(){this.dataList.removeColumnFilter(this.targetColID,{noRefreshAfter:!0});for(var t=!0,e=[],i=0;i<this.groupList.length;i++){for(var o={},s=this.groupList[i].getChildren(),r=0;r<s.length;r++){var a=s[r];if(-1!=a.id.indexOf("_selectbox"))o.select=a.getSelectedIndex(),this.itemValueObj[this.targetColID]["select"+i]=a.getSelectedIndex(),t=t&&0==a.getSelectedIndex(),o.dataType=this.getDataType(this.targetColID);else if(-1!=a.id.indexOf("_autocomplete")){var n=this;o.auto=a.getValue()!=a.options.chooseOptionLabel?(a.getValue()+"").replace(/[\^\$\.\[\]\{\}\+\(\)\|\*\\\?]/g,(function(t){return n.replacechar(t)})):"",
this.itemValueObj[this.targetColID]["auto"+i]=a.getValue(),t=t&&a.getValue()==a.options.chooseOptionLabel}else-1!=a.id.indexOf("_radio")&&(o.radio=a.getSelectedIndex(),this.itemValueObj[this.targetColID]["radio"+i]=a.getSelectedIndex())}o.select&&e.push(o)}this.customFilterStatusObj[this.headerID]=!0;var l={type:"func",colIndex:this.targetColID,key:this.customFilterOperator,condition:"and",columnfilterchangeFire:!1,param:e},h=!1;if(this.customFilterList&&this.customFilterList.customFilterListFilterInfo){var u=this.customFilterList.customFilterListFilterInfo[this.targetColID];this.customFilterList.customFilterListFilterInfo[this.targetColID]=JSON.stringify(l,(function(t,e){return"function"==typeof e||"object"==typeof e&&e.constructor===RegExp?e.toString():e})),u!==this.customFilterList.customFilterListFilterInfo[this.targetColID]&&(h=!0,d.B.fireEvent(n._dataList,"onbeforecolumnfilterchange"))}this.dataList.setColumnFilter(l),h&&d.B.fireEvent(n._dataList,"onaftercolumnfilterchange");var p=this.getElementById(this.id+"_"+this.headerID+"_filter");t||0==e.length?WebSquare.style.removeClass(p,"w2grid_customFilter_filter"):WebSquare.style.addClass(p,"w2grid_customFilter_filter"),this.customFilter.hide()},S.prototype.customFilterOperator=function(t,e,i){for(var o=!0,s=0;s<e.length;s++){var r,a=!0,n=e[s].dataType,l=e[s].select,h=e[s].auto,d=e[s].auto.replace(".*","~~").replace(".","~"),u=d,p=t;if(l>=3&&l<=6)if("bigDecimal"===n){d=h.replace("\\.",".");var c=WebSquare.bigDecimal(d);"NaN"===c.big?!1:(u=c,p=WebSquare.bigDecimal(t))}else"number"!==n&&"float"!==n||(u=(d=h.replace("\\.",".")).toString().indexOf(".")>-1?parseFloat(d):parseInt(d,10));switch(e[s].select){case 1:(r=new RegExp(h,"g")).lastIndex=0,a=t==r.exec(t);break;case 2:(r=new RegExp(h,"g")).lastIndex=0,a=t!=r.exec(t);break;case 3:a="bigDecimal"===n?p.minus(u)>0:p>u;break;case 4:a="bigDecimal"===n?p.minus(u)>=0:p>=u;break;case 5:a="bigDecimal"===n?p.minus(u)<0:p<u;break;case 6:a="bigDecimal"===n?p.minus(u)<=0:p<=u;break;case 7:h=(h=h.replace(/\\\*/g,".*")).replace(/\\\?/g,".");var g=(r=new RegExp(h,"g")).exec(t);a=t==g||h==g;break;case 8:a=""==h?t==h:!!(r=new RegExp("^("+h+")","g")).test(t);break;case 9:a=!!(r=new RegExp("^[^("+h+")]","g")).test(t);break;case 10:a=""==h?t==h:!!(r=new RegExp("("+h+")$","g")).test(t);break;case 11:a=!!(r=new RegExp("[^("+h+")]$","g")).test(t);break;case 12:a=""==h?t==h:!!(r=new RegExp(h,"g")).test(t);break;case 13:a=""==h?t!=h:!!(r=new RegExp("^(?!.*"+h+").*","g")).test(t);break;default:a=t==h}if(1===e.length){o=a;break}0!==s?o=0==e[s].radio?o&&a:o||a:o=a}return o},S.prototype.syncWithSortStatus=function(){try{this.headerSortStatusArr=[];for(var t=this._linkedDataList||this._dataList,e=0;e<t.sortStatusArr.length;e++){var i=t.sortStatusArr[e];"number"==typeof this.getColumnIndex(i.colID)&&(this.headerSortStatusArr.push(i),this.headerSortStatusArr[i.colID]=i)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getFixedColumnLastIndex=function(t){try{if(!this.options.rowNumStatusFixed&&0===this.options.fixedColumn||!1===t)var e=this.options.fixedColumn;else e=this.options.fixedColumn+this.defaultColCnt;if(e<1)return 0;if(!this.options.fixedColumnWithHidden)for(var i=0,o=0;o<this.hiddenList.length;o++)if(this.hiddenList[o]||i++,i==e)return o+1;return e}catch(t){return r.w.printStackTrace(t,null,this),this.options.fixedColumn+this.defaultColCnt}},S.prototype.getFixedRightColumnLastIndex=function(){try{var t=this.colWidthList.length-this.options.fixedRightColumn,e=0;if(this.colWidthList.length!=t)for(var i=this.hiddenList.length-1;i>=0;i--)if(this.hiddenList[i])t--;else if(e++,this.options.fixedRightColumn==e)break;return t}catch(t){return r.w.printStackTrace(t,null,this),this.colWidthList.length-this.options.fixedRightColumn}},S.prototype.columnValue=function(t,e){try{return e=this.getColumnID(e),
null!=t.nodeType&&void 0!==t.selectSingleNode?null==this.options.valueNode||""==this.options.valueNode?a.D.getTextNodeValue(t.selectSingleNode(e)):t.selectSingleNode(e).getAttribute(this.options.valueNode):t[e]}catch(t){r.w.printStackTrace(t,null,this)}return""},S.prototype.rowIndexValue=function(t){return t},S.prototype.getColumnOption=function(t,e){try{var i="";if(this.successBinding){var o=this.cellInfoHash[t];if("dataType"==e)if(o){var s=o.options.dataType;i=s||this._dataList.getColumnOption(t,e)}else(i=this._dataList.getColumnOption(t,e))||(i="text");else i=o.options[e]||"";return i}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setColumnOption=function(t,e,i){try{this.successBinding&&this._dataList.setColumnOption(t,e,i)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getColumnDataListInfo=function(t){try{var e=this.getCellInfo(t);return"select"==e.options.inputType||"autoComplete"==e.options.inputType||"checkcombobox"==e.options.inputType?e.getColumnDataListInfo():null}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setInitStyle=function(t){if(WebSquare.initStyle[this.id]){for(var e,i=/([\w-]*)\s*:\s*([^;]*)/g,o={};e=i.exec(WebSquare.initStyle[this.id].style);)o[e[1]]=e[2].wq_trim();var s=o[t]?t:"";if(s){var r=s.replace(/-([a-z])/g,(function(t){return t[1].toUpperCase()})),a=o[s]?o[s]:o[s.toUpperCase()];document.getElementById(this.id).style[r]=a}else document.getElementById(this.id).style.cssText=WebSquare.initStyle[this.id].style,this.rowStyleArr=[],this.colStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.columnClassObj={},this._removeAllTDCellClass(),this.applyStyleOptions(this.getTotalRow());document.getElementById(this.id).className=WebSquare.initStyle[this.id].className}},S.prototype.refresh=function(t){try{this._dataList.broadcast({gridView:["notifyRefresh",[t]]})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.checkAdaptiveGridType=function(){try{if(this.options.groupbyZone){var t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return!1}if(!this.render)return!1;var e=this.htmlInfo.head.rowAttrArr.length,i=this.htmlInfo.body.rowAttrArr.length,o=0;if(this.hasSubtotal)for(var s=this.htmlInfo.subtotalArr,n=0;n<s.length;n++)o+=s[n].rowAttrArr.length;if(1==e&&1==i&&(this.adaptiveGridType=1),1==e&&2==i?this.adaptiveGridType=2:2==e&&1==i?this.adaptiveGridType=3:2==e&&2==i?this.adaptiveGridType=4:3==e&&1==i&&(this.adaptiveGridType=5),e>3||i>2||o>3){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return $l(t),!1}if(e+(i>o?i:o)>4){t=WebSquare.language.getMessage("Grid_warning5",this.id)||"["+this.id+"] adaptive를 지원하지 않는 Grid 입니다.";return $l(t),!1}return!(a.D.isIE(6)||a.D.isIE(7)||a.D.isIE(8)||a.D.isIE(9))}catch(t){r.w.printStackTrace(t)}},S.prototype.setAdaptiveGridBodyHeight=function(){try{for(var t=function(t){var e=this.getColumnIndex(t),i=parseInt(this.getAdaptiveColumnStyleValue(e,"height"),10);isNaN(i)||(this.orgBodyHeightObj[t]=this.getColumnStyleValue(e,"height"),this.setColumnStyle(t,"height",i+"px"))},e=this.htmlInfo.head.rowArr,i=0;i<e.length;i++)for(var o=e[i],s=0;s<o.length;s++){var a=o[s],n=parseInt(a.colSpan,10),l=a.id,h=this.headerToBodyRelation[l],d=this.getColumnIndex(h);if(!isNaN(n)&&n>1)for(var u=0;u<n;u++)t.call(this,this.getColumnID(d+u));else t.call(this,h)}}catch(t){r.w.printStackTrace(t)}},S.prototype.removeAdaptiveGridBodyHeight=function(){try{for(var t in this.orgBodyHeightObj)this.setColumnStyle(t,"height",this.orgBodyHeightObj[t])}catch(t){r.w.printStackTrace(t)}},S.prototype.setAdaptiveGridHeaderHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"),10),i=parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"),10)
;0===e&&null!=this.oldOptions.headerPaddingTop&&(e=parseInt(this.oldOptions.headerPaddingTop,10)),0===i&&null!=this.oldOptions.headerPaddingBottom&&(i=parseInt(this.oldOptions.headerPaddingBottom,10));for(var o=e+i,s=this.htmlInfo.head.rowArr,a=0;a<s.length;a++)for(var n=s[a],l=0;l<n.length;l++){var h=n[l],d=parseInt(h.colSpan,10),u=h.id,p=this.headerToBodyRelation[u],c=this.getColumnIndex(p),g=parseInt(this.getCellInfo(c).options.colSpan,10),f=0,m=0,y=this.headerInfoHash[u];if(y&&y.options&&"string"==typeof y.options.style)for(var b=y.options.style.split(";"),w=0;w<b.length;w++){if("height"==(C=b[w].split(":"))[0]){m=parseInt(C[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);if(null!=c)if(d>0){var v=d;for(w=c;w<c+d;w++)this.hiddenList[w]?v--:(f+=parseInt(this.getColumnStyleValue(w,"height"),10),f+=o);m!=(f-=o-(v-1))&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),v>0&&this.setHeaderStyle(u,"height",f+"px"))}else if(f=parseInt(this.getColumnStyleValue(c,"height"),10),g>1){f-=(o+1)*(g-1);var I=Math.round(f/g);for(w=l;w<l+g;w++){if(u=(h=n[w]).id,this.headerInfoHash[u])for(b=this.headerInfoHash[u].options.style.split(";"),w=0;w<b.length;w++){var C;if("height"==(C=b[w].split(":"))[0]){m=parseInt(C[1],10);break}}else m=parseInt(this.getHeaderCellStyleValue(u,"height"),10);w==l+g-1?(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",f+"px")):(this.orgHeaderHeightObj[u]=m+"px",this.setHeaderStyle(u,"height",I+"px"),f-=I)}}else m!=f&&(null==this.orgHeaderHeightObj[u]&&(this.orgHeaderHeightObj[u]=m+"px"),this.hiddenList[c]||this.setHeaderStyle(u,"height",f+"px"))}if(this.hasFooter){var x=this.htmlInfo.foot.rowArr;for(a=0;a<x.length;a++){var _=x[a];for(l=0;l<_.length;l++){var S=_[l],D=parseInt(S.colSpan),R=S.id,L=(c=l,f=0,parseInt(this.getFooterStyle(R,"height")));if(D>0){for(w=c;w<c+D;w++)f+=parseInt(this.getColumnStyleValue(w,"height")),f+=o;f-=o-(D-1)}else f=parseInt(this.getColumnStyleValue(c,"height"));L!=f&&(this.orgFooterHeightObj[R]=L+"px",this.setFooterStyle(R,"height",f+"px"))}}}}catch(t){r.w.printStackTrace(t)}},S.prototype.removeAdaptiveGridHeaderHeight=function(){try{for(var t in this.orgHeaderHeightObj)this.setHeaderStyle(t,"height",this.orgHeaderHeightObj[t]);for(var t in this.orgFooterHeightObj)this.setFooterStyle(t,"height",this.orgFooterHeightObj[t])}catch(t){r.w.printStackTrace(t)}},S.prototype.setAdaptiveGridSubtotalHeight=function(){try{var t=this.getHeaderID(0),e=parseInt(this.getHeaderCellStyleValue(t,"padding-top"))+parseInt(this.getHeaderCellStyleValue(t,"padding-bottom"));if(0==Object.keys(this.orgSubtotalHeightObj).length)for(var i=0;i<this.drawedSubtotal.length;i++)for(var o=0;o<this.drawedSubtotal[i].length;o++)for(var s=this.drawedSubtotal[i][o].childNodes,a=this.defaultColCnt;a<s.length;a++){var n=parseInt(s[a].getAttribute("colSpan")),l=s[a].getAttribute("id"),h=0,d=s[a].style.height;if(null!=n&&n>0){for(var u=a;u<a+n;u++)h+=parseInt(this.getColumnStyleValue(u-this.defaultColCnt,"height")),h+=e;h-=e-(n-1)}else h=d;d!=h&&(this.orgSubtotalHeightObj[l]=d,s[a].style.height=h+"px")}}catch(t){r.w.printStackTrace(t)}},S.prototype.removeAdaptiveGridSubtotalHeight=function(){try{for(var t in this.orgSubtotalHeightObj)for(var e=0;e<this.drawedSubtotal.length;e++)for(var i=0;i<this.drawedSubtotal[e].length;i++)for(var o=this.drawedSubtotal[e][i].childNodes,s=this.defaultColCnt;s<o.length;s++){o[s].getAttribute("id")==t&&(o[s].style.height=this.orgSubtotalHeightObj[t])}this.orgSubtotalHeightObj={}}catch(t){r.w.printStackTrace(t)}},S.prototype.setDrillDownDragDrop=function(t){try{this.drillDownDragDrop=a.D.getBoolean(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getDataListInfo=function(){try{if(this.successBinding){var t={};return t.id=this.options.dataList,t}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.focusNextTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){
var t=a.D.getNextTabbableComp(this.id);t&&t.focus()}}catch(t){r.w.printStackTrace(t)}},S.prototype.focusPreTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID){var t=a.D.getPreTabbableComp(this.id);t&&t.focus()}}catch(t){r.w.printStackTrace(t)}},S.prototype.getNextTabID=function(){try{var t=null;return null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(t=WebSquare.tabOrder[this.id].nextTabID),t}catch(t){r.w.printStackTrace(t)}},S.prototype.setNextTabID=function(t,e){try{null!=t&&a.D.setNextTabID(this.id,t,e)}catch(t){r.w.printStackTrace(t)}},S.prototype.getInputType=function(t){try{return this.getCellInfo(t).options.inputType}catch(t){r.w.printStackTrace(t)}},S.prototype.getDataType=function(t){try{return this.getCellInfo(t).options.dataType||this._dataList.getCellInfo(t).options.dataType}catch(t){r.w.printStackTrace(t)}},S.prototype.getFakeExpressionArr=function(){try{for(var t=[],e=[],i=0;i<this.dataList.getRowCount();i++)(t=this._dataList.getRowData(i)).push(""),e=e.concat(t);return e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setUseFilterList=function(t){try{this.options.useFilterList=a.D.getBoolean(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setUseFilter=function(t,e){try{var i=t,o=this.headerInfoHash[i];if(null==o&&(i=this.bodyToHeaderRelation[i],null==(o=this.headerInfoHash[i])))return!1;var s,n=o.options.useFilter,l=a.D.getBoolean(e);if(n===l)return!1;if(o.options.useFilter=l,!0===n)null!=(s=document.getElementById(this.id+"_"+i+"_filter"))&&(s.style.display="none");else if(null!=(s=document.getElementById(this.id+"_"+i+"_filter")))s.style.display="";else{var h=this.getHeaderLayer(i),d=h.innerHTML;h.innerHTML="<table style='width:100%;height:100%;'><tr><td style='width:100%;'>"+d+"</td><td><input type='button' id='"+this.id+"_"+i+"_filter' class='w2trigger w2grid_customFilter_open' onclick='"+this.id+'.showCustomFilter("'+i+"\");'/></td></tr></table>"}return!0}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getFixedRow=function(){var t=parseInt(this.options.fixedRow,10);return t=isNaN(t)?0:t},S.prototype.getLastFixedRow=function(){var t=parseInt(this.options.lastFixedRow,10);return t=isNaN(t)?0:t},S.prototype.isVirtualCursor=function(){try{if(1==this.options.senseReader&&"all"!=this.options.visibleRowNum)if(this.getLastFocusedCell().focusedRowIndex>this.lastIndex&&0==this.getElementById(this.id+"_scrollY_div").scrollTop)return!0;return!1}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeCell=function(t){try{if(null==t||null==t.rowIndex||null==t.colIndex)return void u.k.printLog("gridView mergeCell error : invalid argument ["+this.id+"]");null==t.rowSpan&&(t.rowSpan=1),null==t.colSpan&&(t.colSpan=1);var e=parseInt(t.rowIndex,10),i=parseInt(t.colIndex,10),o=parseInt(t.rowSpan,10),s=parseInt(t.colSpan,10);o>1||s>1?(this.cellMergeInfo[e+"_"+i]={rowSpan:o,colSpan:s},this.cellMergeRealInfo[e+"_"+i]=this.getRealRowIndex(e)):null!=this.cellMergeInfo[e+"_"+i]&&(delete this.cellMergeInfo[e+"_"+i],delete this.cellMergeRealInfo[e+"_"+i]);for(var n=this.dataList._getCellData(e,i,"3"),l=0;l<o;l++)for(var h=0;h<s;h++)0===l&&0===h||(this.dataList._setCellData(e+l,i+h,n),this.cellMergeInfo[e+l+"_"+(i+h)]&&delete this.cellMergeInfo[e+l+"_"+(i+h)]);this.dynamicMergeHTML(),this.options.oddEvenColorDisplay&&"native"===this.options.drawType&&a.D.setTimeout(this.redrawTable,{key:this.id+"_mergeCell",delay:100,caller:this})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeFocusedCell=function(){try{if(this.focusedCell.length>1){var t=this.focusedCell.length-1;this.mergeCell({rowIndex:this.focusedCell[0].focusedRowIndex,colIndex:this.focusedCell[0].focusedColIndex,rowSpan:this.focusedCell[t].focusedRowIndex-this.focusedCell[0].focusedRowIndex+1,colSpan:this.focusedCell[t].focusedColIndex-this.focusedCell[0].focusedColIndex+1})}}catch(t){r.w.printStackTrace(t,null,this)}},
S.prototype.mergeSplitFocusedCell=function(){try{for(var t=0;t<this.focusedCell.length;t++)this.mergeCell({rowIndex:this.focusedCell[t].focusedRowIndex,colIndex:this.focusedCell[t].focusedColIndex,rowSpan:1,colSpan:1})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeClear=function(t){try{void 0!==t&&null!=t||(t={}),this.cellMergeInfo={},this.cellMergeRealInfo={},this.options.mergeCells="never",this.options.mergeCellsFixedCols="never",this.options.mergeCellsFixedRows="never",!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeNotifyRowChanged=function(t,e){try{var i="removeRow"===t?-1:1,o={};for(var s in this.cellMergeInfo){var a=s.split("_"),n=parseInt(a[0],10),l=parseInt(a[1],10),h=this.cellMergeInfo[s];if(n<=e&&e<n+h.rowSpan)if(-1===i){if(h.rowSpan--,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}else if(n<e){var d=h.rowSpan-(e-n);if((d>1||1==d&&h.colSpan>1)&&(o[e+1+"_"+l]={rowSpan:d,colSpan:h.colSpan}),h.rowSpan-=d,h.rowSpan<=0||1==h.rowSpan&&h.colSpan<=1)continue}(n>e||n==e&&-1!==i)&&(n+=i),o[n+"_"+l]=h}this.cellMergeInfo=o}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeNotifyFilter=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols){var t={};for(var e in this.cellMergeRealInfo._hidden){var i=e.split("_"),o=parseInt(i[0],10),s=parseInt(i[1],10),a=this.getDisplayRowIndex(o);isNaN(a)||(t[a+"_"+s]=this.cellMergeRealInfo._hidden[e],delete this.cellMergeRealInfo._hidden[e],this.cellMergeRealInfo[a+"_"+s]=o)}for(var n in this.cellMergeInfo){var l=n.split("_"),h=(s=parseInt(l[1],10),this.cellMergeInfo[n]);o=this.cellMergeRealInfo[n],a=this.getDisplayRowIndex(o);isNaN(a)?(this.cellMergeRealInfo._hidden||(this.cellMergeRealInfo._hidden={}),this.cellMergeRealInfo._hidden[o+"_"+s]=h,delete this.cellMergeRealInfo[n]):(t[a+"_"+s]=h,delete this.cellMergeRealInfo[n],this.cellMergeRealInfo[a+"_"+s]=o)}this.cellMergeInfo=t}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByFree=function(t,e,i,o){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:i-t+1,colSpan:o-e+1})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.unmergeByFree=function(t,e){try{return this.mergeCell({rowIndex:t,colIndex:e,rowSpan:1,colSpan:1})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeCells=function(t,e){try{this._mergeCells(t,e,{type:"mergeCells"})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByCol=function(t){try{this._mergeCells("bycol",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByRow=function(t){try{this._mergeCells("byrow",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByColRec=function(t){try{this._mergeCells("bycolrec",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByRowRec=function(t){try{this._mergeCells("byrowrec",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByRestricCol=function(t){try{this._mergeCells("byrestriccol",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeByRestricRow=function(t){try{this._mergeCells("byrestricrow",t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeCells=function(t,e,i){try{var o=t.toLowerCase();switch(void 0!==i&&null!=i||(i={type:"mergeCells"}),this.options[i.type]=o,o){case"never":this.cellMergeInfo={},this.cellMergeRealInfo={},e&&!0===e.noDraw||this.dynamicMergeHTML();break;case"bycol":this._mergeByCol(e);break;case"byrow":this._mergeByRow(e);break;case"bycolrec":this._mergeByColRec(e);break;case"byrowrec":this._mergeByRowRec(e);break;case"byrestriccol":this._mergeByRestricCol(e);break;case"byrestricrow":this._mergeByRestricRow(e)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeRefresh=function(){try{if("never"===this.options.mergeCells&&"never"===this.options.mergeCellsFixedRows&&"never"===this.options.mergeCellsFixedCols)return;var t={noDraw:!0};this.cellMergeInfo={},
this.cellMergeRealInfo={},"never"!==this.options.mergeCells&&this.mergeCells(this.options.mergeCells,t),"never"!==this.options.mergeCellsFixedRows&&this.mergeCellsFixedRows(this.options.mergeCellsFixedRows,t),"never"!==this.options.mergeCellsFixedCols&&this.mergeCellsFixedCols(this.options.mergeCellsFixedCols,t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByCol=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,s=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={},h=this.getSubtotalRowList({returnType:"object"});!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var d={};!0===t.keepMerge&&(d=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,s=0,a=i);var u=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(s=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(s=0,a=this.options.fixedColumn):(s=0,a=i,u=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var p=s;p<a;p++){if(t.mergeCol){if(!1===t.mergeCol[p])continue}else if(!1===this.mergeColObj[p])continue;if(!(u&&p>=this.options.fixedColumn&&p<a-this.options.fixedRightColumn)&&!(this.htmlInfo.body.rowAttrArr.length>1&&1==this.colIndexInfo.body.colInfo.rowSpanArr[p]))for(var c=this.tdIdList[p],g=o;g<n;g++){var f=this.dataList._getCellData(g,c),m=1;if(!0===t.keepMerge&&(m=0),!0===t.upperColumn&&(l[g]=!0),t.mergeRow){if(!1===t.mergeRow[g])continue}else if(!1===this.mergeRowObj[g])continue;for(;m<n-g;){if(t.mergeRow){if(!1===t.mergeRow[g+m])break}else if(!1===this.mergeRowObj[g+m])break;if(g+m>n)break;if(f!=(0===m?f:this.dataList._getCellData(g+m,c)))break;if(!0===t.keepMerge&&!0===d[g+m+"_"+p])break;if(!0===t.upperColumn&&!0===l[g+m])break;if(!0===h[g+m])break;m++}m>1&&(this.cellMergeInfo[g+"_"+p]={rowSpan:m,colSpan:1},g=g+m-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByRow=function(t){try{void 0!==t&&null!=t||(t={});var e=this.getRowCount(),i=this.getColumnCount(),o=this.options.fixedRow,s=this.options.fixedColumn,a=i-this.options.fixedRightColumn,n=e,l={};!0!==t.keepMerge&&!0!==t.fixedRows&&!0!==t.fixedCols&&(this.cellMergeInfo={},this.cellMergeRealInfo={});var h={};!0===t.keepMerge&&(h=this.getMergedCells()),!0===t.fixedRows&&(o=0,n=this.options.fixedRow,s=0,a=i);var d=!1;!0===t.fixedCols&&(0==this.options.fixedColumn?(s=i-this.options.fixedRightColumn,a=i):0==this.options.fixedRightColumn?(s=0,a=this.options.fixedColumn):(s=0,a=i,d=!0),!1===t.fixedRows?(o=this.options.fixedRow,n=e):(o=0,n=e));for(var u=o;u<n;u++){if(t.mergeRow){if(!1===t.mergeRow[u])continue}else if(!1===this.mergeRowObj[u])continue;for(var p=s;p<a;p++)if(!(d&&p>=this.options.fixedColumn&&p<a-this.options.fixedRightColumn)){var c=this.dataList._getCellData(u,this.tdIdList[p]),g=1;if(!0===t.keepMerge&&(g=0),!0===t.upperRow&&(l[p]=!0),t.mergeCol){if(!1===t.mergeCol[p])continue}else if(!1===this.mergeColObj[p])continue;for(;g<a-p;){if(t.mergeCol){if(!1===t.mergeCol[p+g])break}else if(!1===this.mergeColObj[p+g])break;if(d){if(p+g>=this.options.fixedColumn&&p+g<a-this.options.fixedRightColumn)break}else if(p+g>a)break;if(c!=(0===g?c:this.dataList._getCellData(u,this.tdIdList[p+g])))break;if(!0===t.keepMerge&&!0===h[u+"_"+(p+g)])break;if(!0===t.upperRow&&!0===l[p+g])break;g++}g>1&&(this.cellMergeInfo[u+"_"+p]={rowSpan:1,colSpan:g},p=p+g-1)}}l=void 0,!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByColRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t),i=o.x.extend({},t);e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByCol(e),this._mergeByRow(i),this._mergeAdjacentCell("col"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByRowRec=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t),i=o.x.extend({},t)
;e.noDraw=!0,i.keepMerge=!0,i.noDraw=!0,this._mergeByRow(e),this._mergeByCol(i),this._mergeAdjacentCell("row"),!0!==t.noDraw&&this.dynamicMergeHTML()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeAdjacentCell=function(t){try{var e="row"===t?[0,1]:"col"===t?[1,0]:null;if(null==e)return;var i={},o={},s=this.getSubtotalRowList({returnType:"object"});for(var a in this.cellMergeInfo){var n=a.split("_"),l=parseInt(n[e[0]],10),h=parseInt(n[e[1]],10),d=0===e[0]?this.cellMergeInfo[a].colSpan:this.cellMergeInfo[a].rowSpan,u=0===e[0]?this.cellMergeInfo[a].rowSpan:this.cellMergeInfo[a].colSpan;null!=i[h+"_"+d]?(null==o[h+"_"+d]&&(o[h+"_"+d]=[i[h+"_"+d]]),o[h+"_"+d].push({row:l,rowSpan:u})):i[h+"_"+d]={row:l,rowSpan:u}}for(var a in o){var p=parseInt(a.split("_")[0]),c=0===e[0]?"rowSpan":"colSpan";o[a].sort((function(t,e){return t.row>e.row}));for(var g=o[a].length-1;g>=1;g--){var f=!0===s[o[a][g].row];if(o[a][g-1].row+o[a][g-1].rowSpan>=o[a][g].row&&!f)if((0===e[0]?this.dataList._getCellData(o[a][g-1].row,p):this.dataList.getCellData(p,o[a][g-1].row))===(0===e[0]?this.dataList._getCellData(o[a][g].row,p):this.dataList.getCellData(p,o[a][g].row))){o[a][g-1].rowSpan=o[a][g].row+o[a][g].rowSpan-o[a][g-1].row;var m=0===e[0]?o[a][g].row+"_"+p:p+"_"+o[a][g].row;delete this.cellMergeInfo[m];var y=0===e[0]?o[a][g-1].row+"_"+p:p+"_"+o[a][g-1].row;this.cellMergeInfo[y][c]=o[a][g-1].rowSpan}}}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByRestricCol=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t);e.upperColumn=!0,this._mergeByCol(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._mergeByRestricRow=function(t){try{void 0!==t&&null!=t||(t={});var e=o.x.extend({},t);e.upperRow=!0,this._mergeByRow(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeCellsFixedRows=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedRows){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedRows=!0,e.fixedCols=!1,this._mergeCells(t,e,{type:"mergeCellsFixedRows"})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeCellsFixedCols=function(t,e){try{if(void 0!==e&&null!=e||(e={}),"never"!==this.options.mergeCellsFixedCols){var i=this.options.mergeCells;this.mergeClear(e),"never"!==i&&this.mergeCells(i,{noDraw:!0})}e.fixedCols=!0,e.fixedRows=!1,this._mergeCells(t,e,{type:"mergeCellsFixedCols"})}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeCol=function(t,e){try{t=this.getColumnIndex(t);isNaN(t)||(this.mergeColObj[t]=e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.mergeRow=function(t,e){try{this.mergeRowObj[t]=e}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getMerged=function(t,e){try{if(this.cellMergeInfo[t+"_"+e])return!0;for(var i in this.cellMergeInfo){var o=i.split("_"),s=this.cellMergeInfo[i],a=parseInt(o[0],10),n=parseInt(o[1],10);if(a<=t&&n<=e&&a+s.rowSpan-1>=t&&n+s.colSpan-1>=e)return!0}}catch(t){r.w.printStackTrace(t,null,this)}return!1},S.prototype.getMergedInfo=function(t,e){try{var i={merged:!1};if(this.cellMergeInfo[t+"_"+e])i.merged=!0,i.startRowIndex=t,i.startColIndex=e;else for(var o in this.cellMergeInfo){var s=o.split("_"),a=this.cellMergeInfo[o],n=parseInt(s[0],10),l=parseInt(s[1],10);n<=t&&l<=e&&n+a.rowSpan-1>=t&&l+a.colSpan-1>=e&&(i.merged=!0,i.startRowIndex=n,i.startColIndex=l,i.endRowIndex=n+a.rowSpan-1,i.endColIndex=l+a.colSpan-1)}}catch(t){r.w.printStackTrace(t,null,this)}return i},S.prototype.getMergeAll=function(t,e){try{for(var i,o=[],s=[],a=t.split(","),n=0;n<a.length;n++)o[n]=parseInt(a[n],10);for(var l in!0===e&&this.hasSubtotal&&(i=this.getSubtotalRowList().sort((function(t,e){return t-e}))),this.cellMergeInfo){var h=l.split("_"),d=this.cellMergeInfo[l],u=parseInt(h[0],10),p=parseInt(h[1],10),c=d.rowSpan,g=d.colSpan,f=p+g-1,m=0,y=0,b=0,w=0;if(!0===e&&this.hasSubtotal){for(var v=0;v<i.length&&u>=i[v];v++)w++;u+=w}if(""!=t){o=o.sort()
;for(n=0;n<o.length;n++)p>(m=o[n])?b++:p<=m&&m<=f&&(p==m&&1==g?g=-1:y++);g-=y,p-=b}-1!=g&&(g>1||c>1)&&s.push({x:p,y:u,r:c,c:g})}return JSON.stringify(s)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getMergedCells=function(){try{var t={};for(var e in this.cellMergeInfo){var i=e.split("_"),o=this.cellMergeInfo[e],s=parseInt(i[0],10),a=parseInt(i[1],10),n=o.rowSpan||1,l=o.colSpan||1;if(l>1||n>1)for(var h=0;h<n;h++)for(var d=0;d<l;d++)t[s+h+"_"+(a+d)]=!0}return t}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.refreshGrid=function(t){try{var e=null,i=t.op;this.hiddenRowObj.length>0&&"setInstanceValue"!=i&&(e=JSON.stringify(this.hiddenRowObj),this.clearRowVisible());var o,s,a=t.xpath;if("setInstanceValue"==i){o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.options.repeatNode,null,this.scope_id);var n,l=(c=a.split("/"))[c.length-1],h=this.getColumnIndex(l);if(h>=0){n=this.getCellInfo(l),c.pop();var d=WebSquare.ModelUtil.findInstanceNode(c.join("/"),null,this.scope_id);s=this.getInstanceIndex(o,d);var u=this._dataList.getFilteredRowIndex(s);"radio"==n.options.inputType&&t.value+""==n.options.trueValue&&n.resetOthers(u,!0),u>=0?this._dataList.setCellData(u,h,t.value):this._dataList._setData(s,h,t.value)}}else if("setInstanceNode"==i){if(!(m=this.options.ref==t.replacexpath&&"replace"==t.type?this.xmlData2ArrData(t.replaceNode,!0):this.xmlData2ArrData(t.node,!0)).length)return;this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type?this.insertRow(null,{insertData:m}):"insertBeforeSibling"==t.type?(s=this.getInstanceIndex(o,t.node),this.insertRow(s,{insertData:m})):"replace"==t.type&&this._dataList.setData(m),this.insertRowByInstance=!1}else if("setInstanceChildNodes"==i){if(this.options.ref==t.replacexpath&&"replace"==t.type)m=this.xmlData2ArrData(t.replaceNode,!0);else t.baseNode&&t.baseNode!=this.options.baseNode&&(f=t.baseNode),m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if(!m.length&&"append"==t.type)return;var p=this.getTotalCol();if(this.insertRowByInstance=!0,o=WebSquare.ModelUtil.findInstanceNodes(this.options.ref+"/"+this.repeatNodeTagName[0],null,this.scope_id),"append"==t.type)for(;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});else"replace"==t.type&&this._dataList.setData(m);this.insertRowByInstance=!1}else if("setInstanceLastNodeChildNodes"==i||"copyLastNodeChildrenNodes"==i){if(!(m=this.xmlData2ArrData(t.node,!0,{repeatNode:t.repeatNode,isRepeatNode:!0})).length)return;this.insertRowByInstance=!0,"replace"!=t.type&&"replaceAll"!=t.type&&"append"!=t.type||this.setRowData(parseInt(t.changeIndex)-1,m,!0),this.insertRowByInstance=!1}else if("removeInstanceNode"==i)this.removeRowByInstance=!0,s=t.deleteIndex,this.removeRow(s),this.removeRowByInstance=!1;else if("removeInstanceNodeAll"==i)this.removeRowByInstance=!0,this.dataList.removeAll(),this.removeRowByInstance=!1;else if("copyChildrenNodes"==i){var c,g,f;t.copiedXPath&&(g=(c=t.copiedXPath.split("/"))[c.length-1]),t.baseNode&&g!=this.options.baseNode&&(f=g);var m=this.xmlData2ArrData(t.node,!0,{baseNode:f});if("replaceAll"==t.type)this.setData(m);else if("append"==t.type){var y;p=this.getTotalCol();for(this.insertRowByInstance=!0;m.length>0;)y=m.splice(0,p),this.insertRow(null,{insertData:y});this.insertRowByInstance=!1}}e&&"setInstanceValue"!=i&&(this.hiddenRowObj=JSON.parse(e),this._refreshRowVisible({lastIndex:this.lastIndex,noDraw:!0}),this.setScrollYHeight(),this._mergeRefresh(),this.applyStyleOptions(this.lastIndex))}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getInstanceIndex=function(t,e){try{if(!Array.prototype.indexOf||a.D.isIEAllVersion()&&parseInt(s.v.browserVersion(),10)>8){for(var i=t.length;i--;)if(t[i]===e)return i;return}return t.indexOf(e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._getArrayIndexOf=function(t,e){try{if(Array.prototype.indexOf)return t.indexOf(e)
;for(var i=0;i<t.length;i++)if(t[i]==e)return i;return}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setRef=function(t){try{if(t&&t.ref){this.options.ref=t.ref,t.baseNode&&(this.options.baseNode=t.baseNode),t.repeatNode&&(this.options.repeatNode=t.repeatNode);var e=null==t.aliasDataCollection?this.scope_id:t.aliasDataCollection,i=WebSquare.ModelUtil.findInstanceNode(this.options.ref,null,e);this.setXML(i,null,{ref:this.options.ref,aliasDataCollection:e})}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._setRef=function(t,e){try{this.filteredRepeatNode=!1,this.repeatNodeChildTagName=[],this.repeatNodeTagName=this.options.repeatNode.split("/"),this.filteredRepeatNodeTagName=[];this.options.ref;for(var i=0;i<this.repeatNodeTagName.length;i++){var o=this.repeatNodeTagName[i];i==this.repeatNodeTagName.length-1&&o.indexOf("[")>=0&&(o.indexOf("[@")>=0||(this.repeatNodeTagNameFilter=!0,o=o.split("[")[0])),1==this.repeatNodeTagNameFilter?this.filteredRepeatNodeTagName.push(o):this.filteredRepeatNodeTagName.push(this.repeatNodeTagName[i]),i!=this.repeatNodeTagName.length-1&&"/"+this.repeatNodeTagName[i]}for(var s=0;s<WebSquare.WebSquaredoc.instanceRefElement.length;s++){var a=WebSquare.WebSquaredoc.instanceRefElement[s].id;try{a==this.id&&WebSquare.WebSquaredoc.instanceRefElement.splice(s,1)}catch(t){}}var n=this.options.aliasDataCollection?this.options.aliasDataCollection:this.scope_id;for(var l in WebSquare.WebSquaredoc.instanceRefElement.push(new WebSquare.ModelUtil.createInstanceRefElement(this.options.ref,this.id,this.options.baseNode,this.repeatNodeTagName,this.cellIdList,n)),this.cellInfoHash)this.repeatNodeChildTagName.push(l)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setImageSrc=function(t,e){try{var i=this.getCellInfo(t),o=i.options.inputType;if(!e||"textImage"!=o)return;i.options.imageSrc=e,this.refreshColumn(t)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setSyncScroll=function(t,e){try{this.options.syncScroll=t,null!=e&&(this.options.syncScrollId=e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.resetExpressionFunc=function(){try{if(this.useExpression)for(var t=this.getTotalCol(),e=0;e<t;e++){var i=this.getCellInfo(e);if(i&&i.options&&"expression"==i.options.inputType)for(var o=this.drawedRowLength,s=0;s<o;s++)i.options.expressionFunc&&i.options.expressionFunc[s]&&i.options.expressionFunc[s].changeCount&&(i.options.expressionFunc[s]={})}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellDataType=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e),a=s.id;if(0!=s.internal||"custom"!=s.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[n]?s.cellManagerHashByRowIndex[n]:s,!0;var l=s.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(s);h.setValue(this._dataList.getCellData(o,a));var d=h.getValue();h.setDataType(i),s.options.dataType="float";var u=h.formatter.unformat(d),p=h.validator.validateString(u);h.setValueNM(p),d!==p&&this._dataList.setCellData(o,a,p)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellAllowChar=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e),a=s.id;if(0!=s.internal||"custom"!=s.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[n]?s.cellManagerHashByRowIndex[n]:s,!0;var l=s.options.inputType;if("text"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(s);if(h&&h.options&&("input"===h.options.pluginName||"textarea"===h.options.pluginName)){h.setValue(this._dataList.getCellData(o,a)),h.setAllowChar(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellDisplayFormat=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e)
;if(0!=s.internal||"custom"!=s.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[a]?s.cellManagerHashByRowIndex[a]:s,!0;var n=s.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;if(s.options.displayFormat=i,s.initFormatter(),s.options.embeddedInput){var l=this.data_td_list[e+(o-this.rowIndex)*this.oneRowDataLength];if(l){var h=this.getInput(s,l);h&&"function"==typeof h.setDisplayFormat&&h.setDisplayFormat(i)}}this.refreshCell(o,e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellDisplayFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e);if(0!=s.internal||"custom"!=s.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[a]?s.cellManagerHashByRowIndex[a]:s,!0;var n=s.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;s.options.displayFormatter=i,s.initFormatter(),this.refreshCell(o,e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellMaxLength=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e),a=s.id;if(0!=s.internal||"custom"!=s.options.inputType)return!1;var n=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[n]?s.cellManagerHashByRowIndex[n]:s,!0;var l=s.options.inputType;if("text"!=l&&"textarea"!=l&&"input"!=l&&"textImage"!=l&&"secret"!=l)return $l("cell의 inputType이 올바르지 않습니다."),!1;var h=this.getInput(s);h.setValue(this._dataList.getCellData(o,a)),"float"===s.options.dataType?s.setFloatMaxLength(i.toString()):s.setMaxLength(i);var d=h.getValue();this._dataList.setCellData(o,a,d)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellCustomFormatter=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e);if(0!=s.internal||"custom"!=s.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);s=s.cellManagerHashByRowIndex[a]?s.cellManagerHashByRowIndex[a]:s,!0;var n=s.options.inputType;if("text"!=n&&"textarea"!=n&&"input"!=n&&"textImage"!=n&&"secret"!=n)return $l("cell의 inputType이 올바르지 않습니다."),!1;s.options.customFormatter=i,s.initFormatter(),this.refreshCell(o,e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellDisableEdit=function(t,e,i){try{e=this.getColumnIndex(e);var o=t,s=this.getCellInfo(e);if("custom"!=s.options.inputType)return!1;var a=this.dataList.getRealRowIndex(o);if("autoComplete"!=(s=s.cellManagerHashByRowIndex[a]?s.cellManagerHashByRowIndex[a]:s).options.inputType)return $l("cell의 inputType이 올바르지 않습니다."),!1;s.options.disableEdit=i,s.autoComplete&&(s.autoComplete.options.disableEdit=i),this.refreshCell(o,e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setCellInputType=function(t,e,i){try{if(i&&i.inputType){e=this.getColumnID(e);if(this._linkedDataList){var o=this._linkedDataList.filteredRowIndexArr[t];"number"!=typeof(t=this._dataList.getFilteredRowIndex(o))&&(t=o)}var s={};for(var a in i)s[a]=i[a];this._setCellInputType(t,e,null,s)}}catch(t){r.w.printStackTrace(t)}},S.prototype._setCellInputType=function(t,e,i,o){try{null==i&&(i=""),null==this.editedCell||this.getCellOption(t,e,"embeddedInput")||this.editedCell.handleCancelEdit();var s=this._dataList.getTotalRow();this.groupbyStatus&&this.groupbyStatus.grouped&&(s=this._dataList.filteredRowIndexArr.length);var a,n=this._dataList.getTotalCol(),l=!0;a=this.options&&"grid"===this.options.pluginName&&this.isDrillDown&&this.options.drilldownRealRowIndex?t:this.dataList.getRealRowIndex(t);var h=this.getDisplayRowIndex(a);(isNaN(h)||h<0)&&(l=!1);var d=t,u=(e=this.getColumnID(e),this.getColumnIndex(e)),p=this._dataList.getColumnIndex(e);if(t>=0&&t<s&&p>=0&&p<n){var c=this.cellInfoHash[this.tdIdList[u]];if("custom"==c.options.inputType&&!c.options.embeddedInput){var g,f=t-(this.rowIndex>0?this.rowIndex:0),m=this.data_td_list[u+f*this.oneRowDataLength]
;if(m&&l)!1===(g=c.getCellManager({element:c.element,rowIndex:d,realRowIndex:a,options:o,dynamicInputType:!0}))?m.innerHTML="<nobr>"+o.value+"</nobr>":(c.clearStyle(g,m),null==o.value||!0===g.existGridViewItemsetNode?i=this.dataList._getCellData(d,e):(i=o.value,this.dataList.setCellData(d,e,i,null,!0,!0)),g.setInnerHTML(m,i,d,u));else(g=c.getCellManager({element:c.element,rowIndex:d,realRowIndex:a,options:o,dynamicInputType:!0}))&&(null!=g.customValue?(i=g.customValue,this.dataList.setCellData(d,e,i,null,!0,!0)):null==o.value||!0===g.existGridViewItemsetNode?i=this.dataList._getCellData(d,e):(i=o.value,this.dataList.setCellData(d,e,i,null,!0,!0)))}}}catch(t){r.w.printStackTrace(t)}},S.prototype.setDataDragDrop=function(t){try{if("boolean"==typeof t&&(this.options.dataDragDrop=t,t))if(1==this.isMobile){if(this.isHammerEnabled()){var e=Promise.resolve();"undefined"!=typeof Hammer&&null!=Hammer||(e=inquires("externalJS/hammer.min.js"));var i=this.uuid;e.then((function(t,e){var o=WebSquare.idCache[i];o._manager=new Hammer.Manager(o.getElementById(o.id+"_dataLayer")),o._manager.add(new Hammer.Press({time:o.options.hammerPressTime})),o._manager.on("press",o.event.bindAsEventListener(o,(function(t){o.handleDragEvent(t)}))),o._bindPressEvent=!0}))}}else!1===this._bindDrag&&(this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,this.handleDragEvent)),this._bindDrag=!0)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getDataDragDrop=function(){try{return this.options.dataDragDrop}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._fireOnviewchange=function(t,e,i,o){try{var s,a=this.getCellInfo(t),n=a.editRowIndex,l=this._dataList.getColumnIndex(a.id),h=this.getColumnIndex(a.id),u=this.getRealRowIndex(n),p=this._dataList.dataArr[u*this._dataList.getColumnCount()+l],c=a.comp&&a.comp.selectedIndex;if(o&&o.beforeFunc&&o.beforeFunc.apply(o.beforeFunc,o.beforeFuncArgs),e&&(s=a[e].apply(a,i)),o&&o.checkFunc&&!1===o.checkFunc(s))return!1;var g=this._dataList.dataArr[u*this._dataList.getColumnCount()+l];if(0===p&&(p="0"),0===g&&(g="0"),p!=g){var f={oldValue:p,newValue:g,rowIndex:n,colIndex:h};isNaN(c)||(f.oldSelectedIndex=c,f.newSelectedIndex=a.comp&&a.comp.selectedIndex),d.B.fireEvent(this,"onviewchange",f)}return!0}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._refreshInstance=function(t,e){try{if(!this.options.ref)return;e||WebSquare.ModelUtil.removeInstanceNodes({xpath:this.options.ref+"/"+this.repeatNodeTagName[0],scopeId:this.scope_id,gridNoRefresh:!0}),t||(t=this._dataList.dataArr);var i,o=t.length/this.oneRowDataLength,s=[],a=this.repeatNodeTagName[0],n=WebSquare.xml.parse("<"+a+"></"+a+">").documentElement,l=this._dataList.getBroadcast();this._dataList.setBroadcast(!1);for(var h=0;h<o;h++)if(this.repeatNodeChildTagName&&this.repeatNodeChildTagName.length>0){if(0==h){var d,u=n,p=a;this.repeatNodeTagName.length>1&&(p=this.repeatNodeTagName.slice(1,this.repeatNodeTagName.length).join("/"));for(var c=1;c<this.repeatNodeTagName.length;c++)u=WebSquare.xml.createNode(u,this.repeatNodeTagName[c],!1);i=this.repeatNodeTagName.length>1?WebSquare.xml.findNode(n,p):n;for(c=0;c<this.repeatNodeChildTagName.length;c++){if(d=WebSquare.xml.createNode(i,this.repeatNodeChildTagName[c],!1),s.push(d),f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){var g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}}else for(c=0;c<this.repeatNodeChildTagName.length;c++){var f;if(d=s[c],f=void 0===(f=t[h*this.oneRowDataLength+c])||null==f?"":f+"",this.options.valueNode.length)d.setAttribute(this.options.valueNode,f);else if(null==d.firstChild){g=d.ownerDocument.createTextNode(f);WebSquare.xml.appendChild(d,g)}else d.firstChild.nodeValue=f}WebSquare.ModelUtil.setInstanceNode(n,this.options.ref,null,"append",!1,this.scope_id)}this._dataList.setBroadcast(l)}catch(t){
r.w.printStackTrace(t,null,this)}},S.prototype.isHammerEnabled=function(){try{return(this.isMobile||a.D.isTouchDevice())&&this.options.hammerEnabled}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.endEdit=function(){try{this._endEdit()}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getColumnIdListMultiRow=function(){try{for(var t=[],e=this.colIndexes.bodyColInfo.colIndexMatch,i={},o=this.defaultColCnt;o<e.length;o++)for(var s=e[o],a=0;a<s.length;a++){null==t[a]&&(t[a]=[]);var n=this.getColumnID(s[a]-this.defaultColCnt);null==i[n]&&(t[a].push(n),i[n]=!0)}return t}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getLocationRowCol=function(t,e){try{var i,o,s=this.struct.body.rowAttrArr.length,a=this.getColumnOrder(),n=[];for(var l in a)n[a[l]]=parseInt(l,10);var h,d=this.cellMergeInfo;for(var u in d){var p=u.split("_"),c=parseInt(p[0]),g=parseInt(p[1]),f=d[u].rowSpan,m=d[u].colSpan;if(t>=c&&t<c+f&&e>=g&&e<g+m){i=f,o=m;break}}for(var y=0,b=e;b>=0;)h=b,b-=this.struct.body.rowArr[y++].length;return y--,o=o||parseInt(this.struct.body.rowArr[y][h].colSpan||1),i=i||parseInt(this.struct.body.rowArr[y][h].rowSpan||1),{rowIndex:t*s+y,colIndex:h=n[h=this.struct.body.rowArr[y][h]["@col"]],rowSize:i,colSize:o}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.getOriginalRowCol=function(t,e){try{for(var i=this.htmlInfo.body.rowAttrArr.length,o=(this.getColumnOrder(),!1),s=!0,a=t%i,n=1,l=1,h=[],d=[],u=0;u<i;u++){for(var p=[],c=0;c<this.htmlInfo.body.rowArr[u].length;c++)p.push({colSpan:parseInt(this.htmlInfo.body.rowArr[u][c].colSpan||1),rowSpan:parseInt(this.htmlInfo.body.rowArr[u][c].rowSpan||1),oriColIndex:parseInt(this.bodyIdColIndexMap[this.htmlInfo.body.rowArr[u][c].col_id])});h.push(p),d.push([])}for(u=0;u<i;u++){var g=0;for(c=0;c<h[u].length;c++){if(h[u][c].rowSpan>1)for(var f=1;f<h[u][c].rowSpan;f++)u+f<d.length&&d[u+f].push({oriRowAttrNum:u,rowIndex:u+f,oriColIndex:h[u][c].oriColIndex,colIndex:g,rowSpan:1,colSpan:h[u][c].colSpan,oriRowSpan:h[u][c].rowSpan});for(var m=0;m<d[u].length;m++)g==d[u][m].colIndex&&(h[u].splice(c,0,d[u][m]),d[u].splice(m,1));g+=h[u][c].colSpan}for(m=0;m<d[u].length;m++)g==d[u][m].colIndex&&(h[u].splice(c,0,d[u][m]),d[u].splice(m,1))}var y,b=h[a],w=0;for(c=0;c<b.length;c++){var v=parseInt(b[c].colSpan);if((w+=v)>e){e!==w-v&&(e=w-v,o=!0,s=!1),l=v,y=c;break}}n=b[y].rowSpan,void 0!==b[y].oriRowAttrNum&&(a+=b[y].oriRowAttrNum-b[y].rowIndex,n=b[y].oriRowSpan,o=!0),y=b[y].oriColIndex;var I=Math.floor(t/i),C=this.cellMergeInfo;for(var x in C){var _=x.split("_"),S=(p=parseInt(_[0]),parseInt(_[1])),D=C[x].rowSpan,R=C[x].colSpan;if(I>=p&&I<p+D&&y>=S&&y<S+R){if(I==p&&y==S){n=D,l=R;break}y!=S&&(s=!1),I=p,y=S,n=D,l=R,o=!0;break}}return{rowIndex:I,colIndex:y,rowSize:n,colSize:l,noLeftTop:o,leftCell:s}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setImeMode=function(t,e){try{var i=this.getCellInfo(t);"text"!=i.options.inputType&&"textImage"!=i.options.inputType&&"textArea"!=i.options.inputType&&"drilldown"!=i.options.inputType||(i.options.imeMode=e)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._isGridViewItemTable=function(){try{return!(!this.parentControl||!this.parentControl.options||"gridItemTable"!==this.parentControl.options.pluginName&&"gridViewItemTable"!==this.parentControl.options.pluginName)}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.searchData=function(t){try{void 0!==t&&null!=t||(t={}),this.clearSearchData({noRefresh:!0});var e=t.column;e=e?e.split(","):this.tdIdList.slice(0);for(var i=this.getRowCount(),o=[],s=[],a=0;a<i;a++){for(var n=!1,l=this.__getGroupbyGroupedRowIndex(a),h=this.getRealRowIndex(l),d=0;d<e.length;d++){var u=this.getColumnIndex(e[d]);this.getCellDisplayData(a,u).indexOf(t.data)>=0&&(n=!0,s.unshift([h,u]))}n&&o.push(h)}if(this.groupbyStatus.grouped){var p={};for(a=0;a<o.length;a++)p[o[a]+""]=!0;this.groupbyStatus.groupbyRowIndexArr=o.slice(0);var c=this.groupbyStatus.groupedRowIndexArr;this._beforeSearch={
groupbyRowIndexArr:o.slice(0),groupedRowIndexArr:c.slice(0)};var g=[];for(a=0;a<c.length;a++)if("object"==typeof c[a]){if(0===c[a].depth&&g.length>0&&"object"==typeof g[g.length-1])for(;g.length>0&&"object"==typeof g[g.length-1];)g.pop();g.push(c[a])}else!0===p[c[a]+""]&&g.push(c[a]);for(;g.length>0&&"object"==typeof g[g.length-1];)g.pop();this.groupbyStatus.groupedRowIndexArr=g}var f={type:"direct",key:o,filterId:this.id+"_searchData"};this.dataList.setFilter(f);for(a=0;a<s.length;a++){var m=this.getDisplayRowIndex(s[a][0]),y=this.__getGroupbyGroupedRowIndex(m);this.setFocusedCell(y,s[a][1],!1,{ctrled:!0})}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.clearSearchData=function(t){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;void 0!==t&&null!=t||(t={});var e={filterId:this.id+"_searchData",noRefresh:t.noRefresh};this.groupbyStatus.grouped&&this._beforeSearch&&(this.groupbyStatus.groupbyRowIndexArr=this._beforeSearch.groupbyRowIndexArr.slice(0),this.groupbyStatus.groupedRowIndexArr=this._beforeSearch.groupedRowIndexArr.slice(0)),this._beforeSearch=null,this.dataList.removeFilter(e),this.removeFocusedCell(),!0===t.clearValue&&this.groupbyZone_searchinput.setValue("")}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype._groupbyZoneSearch=function(){try{if(!this.options.groupbyZoneSearch||!this.groupbyZone_searchinput)return;var t=this.groupbyZone_searchinput.getValue();if(""===t)this.clearSearchData();else{var e={};e.data=t,this.searchData(e)}}catch(t){r.w.printStackTrace(t,null,this)}},S.prototype.setBlockSelect=function(t,e){try{if(!0!==e&&!1!==e)return;var i=this.getCellInfo(t);if(i&&i.options.blockSelect!==e){var o=this.getColumnIndex(t);i.options.blockSelect=e;for(var s=0;s<this.focusedCell.length;s++)if(this.focusedCell[s].focusedColIndex===o){var a=this.focusedCell[s];this._applyFocusedCellOut(a)}}}catch(t){r.w.printStackTrace(t,null,this)}};var D=function(){};D.prototype.getColumnReadOnly=function(t){var e=this.getCellInfo(t);return""!=e.options.readOnly?a.D.getBoolean(e.options.readOnly):""},D.prototype.setColumnReadOnly=function(t,e){try{var i=this.getCellInfo(t);""!=e&&(e=a.D.getBoolean(e));var o=i.options.readOnly;if(i.options.readOnly=e,o!==e){if(null!=this.editedCell){var s=parseInt(this.editedCell.editTd.getAttribute("tdindex"))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=s==t}else this.rollbackCommitFlag=!1;this.drawColumnData(t),this.applyStyleOptions(this.lastIndex)}}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getRowReadOnly=function(t,e){try{var i=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===e?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),o=this.rowReadOnlyArr[i];return 1!=o&&0!=o?"":o}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setRowReadOnly=function(t,e,i){try{var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),s=o||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));""!=e&&(e=a.D.getBoolean(e));var n=o||!0===i?this.getDisplayRowIndex(s):this._getGroupbyGroupedRowIndex(t),l=this.rowReadOnlyArr[s];this.rowReadOnlyArr[s]=e,l!==e&&(null!=this.editedCell&&this.editedCell.editRowIndex==s?this.rollbackCommitFlag=!0:this.rollbackCommitFlag=!1,n>=0&&(this.drawRowData(n-this.rowIndex,n,!0),this.applyRowStyleOptions(n)))}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getCellReadOnly=function(t,e,i){try{e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll)||!0===i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),s=this.cellReadOnlyArr[o*this.oneRowDataLength+e];return 1!=s&&0!=s?"":s}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setCellReadOnly=function(t,e,i){try{""!=i&&(i=a.D.getBoolean(i));e=this.getColumnIndex(e)
;var o=!(!this.isDrillDown||!this.options.drilldownRealRowIndexAll),s=o?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),n=o?this.getDisplayRowIndex(s):this._getGroupbyGroupedRowIndex(t),l=this.cellReadOnlyArr[s*this.oneRowDataLength+e];if(this.cellReadOnlyArr[s*this.oneRowDataLength+e]=i,l!==i){var h=this.rollbackCommitFlag;if(null!=this.editedCell&&this.editedCell.editRowIndex==s){var d=parseInt(this.editedCell.editTd.getAttribute("tdindex"))%this.realRowDataLength-(this.realRowDataLength-this.oneRowDataLength);this.rollbackCommitFlag=d==e}else this.rollbackCommitFlag=!1;n>=0&&(this.notifyCellChanged(n,e),this.rollbackCommitFlag=h,this.applyCellStyleOptions(n,e))}}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getColumnDisabled=function(t){var e=this.getCellInfo(t);return a.D.getBoolean(e.options.disabled)},D.prototype.setColumnDisabled=function(t,e){try{e=a.D.getBoolean(e);var i=this.getCellInfo(t),o=i.options.disabled;i.options.disabled=e,o!==e&&(this.drawColumnData(t),this.applyColumnStyleOptions(t))}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getRowDisabled=function(t){try{var e=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t));return a.D.getBoolean(this.rowDisabledArr[e])}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setRowDisabled=function(t,e){try{e=a.D.getBoolean(e);var i=!(!this.isDrillDown||!this._dataList.options.depthColumn),o=i?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),s=i?this.getDisplayRowIndex(o):this._getGroupbyGroupedRowIndex(t),n=this.rowDisabledArr[o];this.rowDisabledArr[o]=e,n!==e&&s>=0&&(this.drawRowData(s-this.rowIndex,s,!0),this.applyRowStyleOptions(s))}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getCellDisabled=function(t,e){try{e=this.getColumnIndex(e);var i=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),o=this.cellDisabledArr[i*this.oneRowDataLength+e];return 1!=o&&0!=o?"":o}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setCellDisabled=function(t,e,i){try{i=a.D.getBoolean(i);e=this.getColumnIndex(e);var o=!(!this.isDrillDown||!this._dataList.options.depthColumn),s=o?t:this.dataList.getRealRowIndex(this._getGroupbyGroupedRowIndex(t)),n=o?this.getDisplayRowIndex(s):this._getGroupbyGroupedRowIndex(t),l=this.cellDisabledArr[s*this.oneRowDataLength+e];this.cellDisabledArr[s*this.oneRowDataLength+e]=i,l!==i&&n>=0&&(this.notifyCellChanged(n,e),this.applyCellStyleOptions(n,e))}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setTDStyle=function(t,e,i,o,s){""!=this.options.readOnlyBackgroundColor&&this.___getEditReadOnly(e,i)&&(s="background-color:"+this.options.readOnlyBackgroundColor+";"+s),this._getEditDisabled(e,i)?(t.disabled=!0,""!=this.options.disabledBackgroundColor&&(s+=";background-color:"+this.options.disabledBackgroundColor),""!=this.options.disabledFontColor&&(s+=";color:"+this.options.disabledFontColor)):t.disabled=!1,t.style.cssText=o+";"+s},D.prototype.setStyleAll=function(t){try{var e=t.type,i=e.charAt(0).toUpperCase()+e.slice(1),o=t.target||"";"all"!==o&&"default"!==e&&"init"!==e||(o=""),"cell"!==e&&"disabledCell"!==e||(o="");var s=o?o.charAt(0).toUpperCase()+o.slice(1):"",a=t.styleName,n=t.styleValue,l=t.noRefresh,h=t.rowIndex;h=this._getGroupbyGroupedRowIndex(h);var d,p=t.colIndex;if("column"===e||"cell"===e||"default"===e||"init"===e){if(p=this.getColumnIndex(p),!this.getColumnID(p)&&!this.successBinding)return;if(!this.getColumnID(p)&&!this._dataList.getColumnID(p))return void u.k.printLog("[Warning] Invalid colIndex("+p+").["+this.id+"] set"+i+"Style"+s)}var c="ValueObj";"column"===e||"adaptiveColumn"===e||"default"===e||"init"===e?(d=p,i="Column"):"disabledCell"===e?(d=h+"_"+p,i="Cell",c="Obj"):null==(d=this["get"+i+"Style"+s+"ClassName"](h,p))&&(this[e+"Style"+s+"Index"]++,
d=this.id+"_"+e+"style"+o+"_"+this[e+"Style"+s+"Index"]+"_",null==p?this["set"+i+"Style"+s+"ClassName"](h,d):this["set"+i+"Style"+s+"ClassName"](h,p,d)),null==(t=this[e+"Style"+s+c][d])&&(t={}),t[a]=n;var g=[];for(var a in t){var f=t[a];"style"!=a&&""!=f&&g.push(a+":"+f)}if(t.style=g.join(";"),this[e+"Style"+s+c][d]=t,!0!==l)if(null==h)this["apply"+i+"StyleOptions"](p);else!(!this.isDrillDown||!this._dataList.options.depthColumn)&&(h=this.getDisplayRowIndex(h)),this["apply"+i+"StyleOptions"](h,p)}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setRowBackgroundColor=function(t,e){this.setRowStyle(t,"background-color",e)},D.prototype.setRowColor=function(t,e){this.setRowStyle(t,"color",e)},D.prototype.setRowStyle=function(t,e,i){this.setStyleAll({type:"row",rowIndex:t,styleName:e,styleValue:i})},D.prototype.getRowBackgroundColor=function(t){return this.getRowStyleValue(t,"background-color")},D.prototype.getRowColor=function(t){return this.getRowStyleValue(t,"color")},D.prototype.getRowStyleValue=function(t,e){t=this._getGroupbyGroupedRowIndex(t);var i=this.getRowStyleClassName(t);return null==i?"":this.rowStyleValueObj[i][e]||""},D.prototype._getRowStyleStr=function(t){return this.rowStyleValueObj[t].style},D.prototype.setColumnBackgroundColor=function(t,e){this.setColumnStyle(t,"background-color",e)},D.prototype.setColumnColor=function(t,e){this.setColumnStyle(t,"color",e)},D.prototype.setColumnStyle=function(t,e,i){this.setStyleAll({type:"column",colIndex:t,styleName:e,styleValue:i})},D.prototype.setDefaultStyle=function(t,e,i){this.setStyleAll({type:"default",colIndex:t,styleName:e,styleValue:i})},D.prototype._setInitStyle=function(t,e,i){this.setStyleAll({type:"init",colIndex:t,styleName:e,styleValue:i})},D.prototype.setAdaptiveColumnStyle=function(t,e,i){this.setStyleAll({type:"adaptiveColumn",colIndex:t,styleName:e,styleValue:i,noRefresh:!0})},D.prototype.getColumnBackgroundColor=function(t){return this.getColumnStyleValue(t,"background-color")},D.prototype.getColumnColor=function(t){return this.getColumnStyleValue(t,"color")},D.prototype.getColumnStyleValue=function(t,e){var i=this.columnStyleValueObj[t];return null==i?this.getDefaultStyleValue(t,e):i[e]||this.getDefaultStyleValue(t,e)},D.prototype._getColumnStyleStr=function(t){return this.columnStyleValueObj[t].style},D.prototype.getDefaultStyleValue=function(t,e){var i=this.defaultStyleValueObj[t];return null==i?"":i[e]||""},D.prototype._getInitStyleValue=function(t,e){var i=this.initStyleValueObj[t];return null==i?"":i[e]||""},D.prototype._getDefaultStyleStr=function(t){return this.defaultStyleValueObj[t].style},D.prototype.getAdaptiveColumnStyleValue=function(t,e){var i=this.adaptiveColumnStyleValueObj[t];return null==i?"":i[e]||""},D.prototype.setCellBackgroundColor=function(t,e,i){this.setCellStyle(t,e,"background-color",i)},D.prototype.setCellColor=function(t,e,i){this.setCellStyle(t,e,"color",i)},D.prototype.setCellStyle=function(t,e,i,o,s){var r=this.getColumnID(e);if(this.mergeCellBkStatus&&this.mergeCellBkStatus[r]){var a=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t);this.mergeCellBkStatus[r][a]=null,delete this.mergeCellBkStatus[r][a]}this.setStyleAll({type:"cell",rowIndex:t,colIndex:e,styleName:i,styleValue:o,noRefresh:s})},D.prototype._refreshCellStyle=function(t){var e=[],i=this.cellStyleValueObj[t];for(var o in i){var s=i[o];"style"!=o&&""!=s&&e.push(o+":"+s)}i.style=e.join(";"),this.cellStyleValueObj[t]=i},D.prototype.setDisabledCellStyle=function(t,e,i,o){e=this.getColumnIndex(e);this._getEditDisabled(t,e)&&this.setStyleAll({type:"disabledCell",rowIndex:t,colIndex:e,styleName:i,styleValue:o})},D.prototype.getCellBackgroundColor=function(t,e){return this.getCellStyleValue(t,e,"background-color")},D.prototype.getCellColor=function(t,e){return this.getCellStyleValue(t,e,"color")},D.prototype.getCellStyleValue=function(t,e,i,o){try{t=this._getGroupbyGroupedRowIndex(t)
;var s=this.getCellStyleClassName(t,e);return null==s?(!0!==o&&u.k.printLog("[Warning] Is not exist cell!["+this.id+"]"),""):this.cellStyleValueObj[s][i]||""}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype._getCellStyleStr=function(t){return this.cellStyleValueObj[t].style},D.prototype.setHeaderCellStyle=function(t,e,i){try{var o=this.getHeaderLayer(t);WebSquare.style.setStyle(o,e,i)}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setHeaderBackgroundColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"background-color",e),this.headerCellStyleValueObj[t]={"background-color":e}}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.setHeaderColor=function(t,e){try{var i=this.getHeaderLayer(t);WebSquare.style.setStyle(i,"color",e)}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getHeaderCellStyleValue=function(t,e){try{var i=this.getHeaderLayer(t);return WebSquare.style.getStyle(i,e)}catch(t){r.w.printStackTrace(t,null,this)}},D.prototype.getHeaderBackgroundColor=function(t){return this.getHeaderCellStyleValue(t,"background-color")},D.prototype.getHeaderColor=function(t){return this.getHeaderCellStyleValue(t,"color")},D.prototype._setMergeCellBackground=function(t,e,i){var o=!(!this.isDrillDown||!this._dataList.options.depthColumn)?t:this.dataList.getRealRowIndex(t),s=this.getColumnID(e),r=this.getColumnIndex(e);if(this.options.groupbyZone&&(this.mergeCellBkStatus||(this.mergeCellBkStatus={}),this.mergeCellBkStatus[s]||(this.mergeCellBkStatus[s]={}),null==this.mergeCellBkStatus[s][o])){var a=this.getCellStyleValue(t,s,"background-color",!0)||this.getColumnStyleValue(r,"background-color");this.mergeCellBkStatus[s][o]=a}var n=this.setCellDefaultStyleClassName(o,r,!0);this.cellStyleValueObj[n]["background-color"]=i,this._refreshCellStyle(n)},D.prototype._clearMergeCellBackground=function(){if(this.mergeCellBkStatus){for(var t in this.mergeCellBkStatus)for(var e in this.mergeCellBkStatus[t]){var i=parseInt(e,10),o=this.mergeCellBkStatus[t][e],s=this.setCellDefaultStyleClassName(i,t,!0);this.cellStyleValueObj[s]["background-color"]=o,this._refreshCellStyle(s),o||delete this.cellStyleValueObj[s]["background-color"]}delete this.mergeCellBkStatus}};var R=function(t){this.statusArr=[],this.mainGrid=null,this.options=null,this.mode=null};R.prototype.initialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(u.k.printLog("경고 : drilldown에서는 filter기능을 사용할 수 없습니다. 개별 filter를 자동으로 전부 해제합니다.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=0;r<s;r++){var a=t._linkedDataList.initialRowIndexArr[r];this.statusArr[a]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(a,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(a,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(a),this.statusArr[a]=!0)}}else{t._dataList.filteredRowIndexArr=[],this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),a=0;a<s;a++){this.statusArr[a]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(a,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(a,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._dataList.filteredRowIndexArr.push(a),this.statusArr[a]=!0)}}},R.prototype.getDepth=function(t){
return"dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(t,this.mainGrid._dataList.getColumnID(this.options.depthColumn))):parseInt(this.mainGrid.dataList._getData(t,this.mainGrid.getColumnID(this.options.depthColumn)))},R.prototype.isOpen=function(t){var e=this.getDepth(this.mainGrid.getRealRowIndex(t)),i=0;i="linkedDataList"===this.mode?this.mainGrid._linkedDataList.filteredRowIndexArr[t+1]:this.mainGrid._dataList.filteredRowIndexArr[t+1];var o=this.getDepth(i);return!isNaN(e)&&!isNaN(o)&&e<o},R.prototype.hasChild=function(t){if("linkedDataList"===this.mode){var e=this.mainGrid._linkedDataList.filteredRowIndexArr[t],i=this.mainGrid._linkedDataList.getLinkedRowIndex(t),o=this.mainGrid._linkedDataList.initialRowIndexArr[i+1],s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));var r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)}o=(e=this.mainGrid.getRealRowIndex(t))+1,s=this.mainGrid.getColumnID(this.options.depthColumn);"dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(this.options.depthColumn));r=parseInt(this.mainGrid.dataList._getData(e,s)),a=parseInt(this.mainGrid.dataList._getData(o,s));return r<(a=isNaN(a)?0:a)},R.prototype.getOriginalRowIndex=function(t){return this.openRowIndexArr[t]},R.prototype.getDisplayRowIndex=function(t){if("linkedDataList"===this.mode){if(this.mainGrid._linkedDataList.filteredRowIndexArr)for(var e=0;e<this.mainGrid._linkedDataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid._linkedDataList.filteredRowIndexArr[e])return e}else if(this.mainGrid._dataList.filteredRowIndexArr)for(e=0;e<this.mainGrid._dataList.filteredRowIndexArr.length;e++)if(parseInt(t,10)===this.mainGrid.getRealRowIndex(e))return e;return t},R.prototype.getChildRowArr=function(t,e){var i=t,o=this.getDepth(t),s=this.mainGrid.getTotalRow(),r=[],a=this.options.depthColumn,n=this.mainGrid.getColumnID(a);if("dataList"==this.options.dataColumn&&(n=this.mainGrid._dataList.getColumnID(a)),"linkedDataList"===this.mode)for(var l=i+1;l<s;l++){var h=this.mainGrid._linkedDataList.initialRowIndexArr[l];if(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),this.mainGrid.dataList._getData(h,n)<=o)break}else for(h=i+1;h<s&&(this.mainGrid.dataList._getData(h,n)==o+1&&r.push(h),e&&this.mainGrid.dataList._getData(h,n)>o+1&&r.push(h),!(this.mainGrid.dataList._getData(h,n)<=o));h++);return r},R.prototype.pasteDrilldownInitialize=function(t,e){if(this.mainGrid=t,t._linkedDataList?this.mode="linkedDataList":this.mode="dataList","linkedDataList"===this.mode){this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{}),t._linkedDataList.initialRowIndexArr.length!==t._linkedDataList.filteredRowIndexArr.length&&(u.k.printLog("경고 : drilldown에서는 filter기능을 사용할 수 없습니다. 개별 filter를 자동으로 전부 해제합니다.["+this.id+"]"),t._linkedDataList.clearFilter()),t._linkedDataList.filteredRowIndexArr=[];for(var i=this.options.depthColumn,s=t._linkedDataList.initialRowIndexArr.length,r=0;r<s;r++){var a=t._linkedDataList.initialRowIndexArr[r];this.statusArr[a]=!1;("dataList"==this.options.dataColumn?parseInt(this.mainGrid.dataList._getData(a,this.mainGrid._dataList.getColumnID(i))):parseInt(this.mainGrid.dataList._getData(a,this.mainGrid.getColumnID(i))))<=parseInt(this.options.showDepth,10)&&(this.mainGrid._linkedDataList.filteredRowIndexArr.push(a),this.statusArr[a]=!0)}}else{this.statusArr=[],this.options=o.x.extend({showDepth:-1,depthColumn:-1},e||{});for(i=this.options.depthColumn,s=this.mainGrid.getTotalRow(),a=0;a<s;a++)this.statusArr[a]=!0}},R.prototype.getChildrenRowArr=function(t){var e=[];if(this.mainGrid){var i=this.mainGrid.getTotalRow(),o=this.options.depthColumn,s=this.mainGrid.getColumnID(o)
;if("dataList"==this.options.dataColumn&&(s=this.mainGrid._dataList.getColumnID(o)),"linkedDataList"===this.mode){var r=this.mainGrid._linkedDataList.initialRowIndexArr[t+1],a=parseInt(this.mainGrid.dataList._getData(this.mainGrid._linkedDataList.initialRowIndexArr[t],s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);var n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(var h=t+2;h<i;h++){r=this.mainGrid._linkedDataList.initialRowIndexArr[h];if(this.mainGrid.dataList._getData(r,s)<a+1)break;this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}else{r=t+1,a=parseInt(this.mainGrid.dataList._getData(t,s),10);if(r<i&&this.mainGrid.dataList._getData(r,s)>a){e.push(r);n=parseInt(this.mainGrid.dataList._getData(r,s),10),l=!0}if(l)for(r=t+2;r<i&&!(this.mainGrid.dataList._getData(r,s)<a+1);r++)this.mainGrid.dataList._getData(r,s)<n+1&&(e.push(r),n=parseInt(this.mainGrid.dataList._getData(r,s),10))}}return e},R.prototype.getParentRowIndex=function(t){if(this.mainGrid){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=parseInt(this.mainGrid.dataList._getData(t,i));if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t-1;r>=0;r--)if(this.mainGrid.dataList._getData(r,i)<o)return r}return-1},R.prototype.makeOpenRowIndexArr=function(){if("linkedDataList"===this.mode){this.mainGrid._linkedDataList.filteredRowIndexArr=[];for(var t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._linkedDataList.filteredRowIndexArr.push(t)}else{this.mainGrid._dataList.filteredRowIndexArr=[];for(t=0;t<this.statusArr.length;t++)1==this.statusArr[t]&&this.mainGrid._dataList.filteredRowIndexArr.push(t)}},R.prototype.toggle=function(t){var e=this.isOpen(t),i=[];t="linkedDataList"===this.mode?this.mainGrid._linkedDataList.getLinkedRealRowIndex(t):this.mainGrid.getRealRowIndex(t),i=e?this.getChildRowArr(t,!0):this.getChildrenRowArr(t);for(var o=0;o<i.length;o++)this.statusArr[i[o]]=!e;this.makeOpenRowIndexArr(),d.B.fireEvent(this.mainGrid,"ontoggleclick",e,t)},R.prototype.getAncestorRowArr=function(t){if("number"!=typeof t)return!1;for(var e=[],i=t;i>=0;)e.push(i),i=this.getParentRowIndex(i);return e.shift(),e},R.prototype.drillTo=function(t){if("number"!=typeof t)return!1;var e=this.getAncestorRowArr(t);e.unshift(t);for(var i=0;i<e.length;i++){var o=e[i];if(this.statusArr[o]=!0,0!=i)for(var s=this.getChildrenRowArr(o),r=0;r<s.length;r++)this.statusArr[s[r]]=!0}return this.makeOpenRowIndexArr(),this.getDisplayRowIndex(e[e.length-1])},R.prototype.isLastChild=function(t){var e=this.options.depthColumn,i=this.mainGrid.getColumnID(e);"dataList"==this.options.dataColumn&&(i=this.mainGrid._dataList.getColumnID(e));var o=this.mainGrid.dataList._getData(t,i);if("linkedDataList"===this.mode)for(var s=this.mainGrid._linkedDataList.getLinkedRealRowIndex(t)-1;s>=0;s--){var r=this.mainGrid._linkedDataList.initialRowIndexArr[s];if(this.mainGrid.dataList._getData(r,i)<o)return r}else for(r=t+1;r<this.mainGrid.getTotalRow();r++){if(this.mainGrid.dataList._getData(r,i)==o)return!1;if(this.mainGrid.dataList._getData(r,i)<o)return!0}return!0},R.prototype.getRecursiveRowIndex=function(t){try{for(var e=[],i=this.getChildrenRowArr(t),o=0;o<i.length;o++){var s=i[o];e.push(s),e=e.concat(this.getRecursiveRowIndex(s))}return e}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.getRecursiveRowCount=function(t){try{for(var e=0,i=this.getChildrenRowArr(t),o=0;o<i.length;o++)e+=this.getRecursiveRowCount(i[o]),e++;return e}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.appendChild=function(t,e){try{if(e){var i=t+this.getRecursiveRowCount(t);return this.mainGrid._toggle(this.getDisplayRowIndex(t)),
this.mainGrid.dataList.setRowData(i+1,e)}$l("data is null. check data.["+this.id+"]")}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.moveNode=function(t,e){try{var i;if(t<e){if(!this.bodyDrop)i=e-(this.getRecursiveRowCount(t)+1)}else(t>e||t==e)&&(i=e);var o=this.detachNode(t),s=this.appendNode(i,o);return"number"!=typeof i&&(i=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1)),this.bodyDrop=!1,{detachedData:o,insertedData:s,insertedRowIndex:i}}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.appendNode=function(t,e){try{var i,o,s,a=this.mainGrid._dataList.getColumnCount(),n=e.length/a,l=this.mainGrid._dataList.getColumnID(this.options.depthColumn);if(this.options.depthColumn=parseInt(this.options.depthColumn,10),this.bodyDrop){this.bodyDrop=!1;var h=this,d=function(t){var e=h.getParentRowIndex(t);return e=e>-1?d(e):t},u=this.mainGrid.getRealRowIndex(this.mainGrid.getRowCount()-1),p=this.getDisplayRowIndex(d(u));i=parseInt(this.mainGrid.dataList.getCellData(p,l),10),o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10),t=u+this.getRecursiveRowCount(u)+1,s=i-o}else{p=this.getDisplayRowIndex(t-1);s=(i=parseInt(this.mainGrid.dataList.getCellData(p,l),10))-(o=parseInt(e[a*(n-1)+parseInt(this.options.depthColumn)],10))+1}for(var c=[],g=0;g<n;g++)for(var f=0;f<a;f++){var m=e[a*g+f];f==this.options.depthColumn&&(m-=0,m+=s),c.push(m)}this.mainGrid.dataList._insertData(t,c,-1);var y=this.getDisplayRowIndex(t);return this.isOpen(y)&&this.mainGrid._toggle(y),c}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.detachNode=function(t){try{for(var e=[],i=this.mainGrid.dataList.removeRow(t,{skipNotify:!0}),o=0;o<i.length;o++)e=e.concat(i[o]);return e}catch(t){r.w.printStackTrace(t,null,this)}},R.prototype.insertNextSibling=function(t,e){try{this.options.depthColumn=parseInt(this.options.depthColumn,10);var i=this.mainGrid.dataList.getColumnCount(),o=e.length/this.mainGrid.dataList.getColumnCount(),s=this.mainGrid.getDisplayRowIndex(t),a=parseInt(this.mainGrid.dataList.getCellData(s,this.options.depthColumn),10)-parseInt(e[i*(o-1)+parseInt(this.options.depthColumn)],10),n=[];t+=this.getRecursiveRowCount(t)+1;for(var l=0;l<o;l++)for(var h=0;h<i;h++){var d=e[i*l+h];h==this.options.depthColumn&&(d-=0,d+=a),n.push(d)}if(this.mainGrid.dataList._insertData(t,n,-1),this.mainGrid.options.closeDrillDownSibling)for(l=0;l<o;l++){var u=this.getDisplayRowIndex(t+l);this.isOpen(u)&&this.mainGrid._toggle(u)}return n}catch(t){r.w.printStackTrace(t,null,this)}};var L=i(9310),T=function(t){this._linkedDataList._grid=t};T.prototype.getLinkedRowIndex=function(t){return this._linkedDataList.getLinkedRowIndex(t)},T.prototype.getRealRowIndex=function(t){return this._linkedDataList.filteredRowIndexArr[t]},T.prototype.getFilteredRowIndex=function(t){return this._linkedDataList.getFilteredRowIndex(t)},T.prototype.getTotalRow=function(){try{return this._linkedDataList.initialRowIndexArr.length}catch(t){r.w.printStackTrace(t)}},T.prototype.getTotalCol=function(){try{return this._linkedDataList._dataList.getTotalCol()}catch(t){r.w.printStackTrace(t)}},T.prototype.getRowCount=function(){try{return this._linkedDataList.getDataLength()}catch(t){r.w.printStackTrace(t)}},T.prototype.getCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getCellData(i,e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getOriginalCellData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getOriginalCellData(i,e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getDataLength=function(){return this._linkedDataList.filteredRowIndexArr.length},T.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var o=e[i];t+=parseInt(o.colSpan,10)||1}return t}catch(t){r.w.printStackTrace(t,null,this)}},T.prototype.getRowPosition=function(){try{
return this._linkedDataList._dataList.getRowPosition()}catch(t){r.w.printStackTrace(t,null,this)}},T.prototype.getColData=function(t){try{for(var e=[],i=0;i<this._linkedDataList.initialRowIndexArr.length;i++)e.push(this._linkedDataList.getCellData(i,t));return e}catch(t){r.w.printStackTrace(t)}},T.prototype.getRowData=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getRowData(e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getDataRow=function(t){try{var e=this._linkedDataList.getRealRowIndex(t);return this._linkedDataList._dataList.getDataRow(e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getMatchedData=function(t,e,i,o,s){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getMatchedIndex(t,e,i,o,s),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){r.w.printStackTrace(t)}},T.prototype.getUnmatchedData=function(t,e,i,o,s){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var a=[],n=this._linkedDataList.getUnmatchedIndex(t,e,i,o,s),l=0;l<n.length;l++)a.push(this._linkedDataList.getRowData(n[l]));return a}catch(t){r.w.printStackTrace(t)}},T.prototype.getMatchedColumnData=function(t,e,i,o,s,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getMatchedIndex(t,e,o,s,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){r.w.printStackTrace(t)}},T.prototype.getUnmatchedColumnData=function(t,e,i,o,s,a){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var n=[],l=this._linkedDataList.getUnmatchedIndex(t,e,o,s,a),h=0;h<l.length;h++)n.push(this._linkedDataList.getCellData(l[h],i));return n}catch(t){r.w.printStackTrace(t)}},T.prototype.getFilteredColData=function(t){for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++)e.push(this._linkedDataList.getCellData(this._linkedDataList.filteredRowIndexArr[i],t));return e},T.prototype.getMatchedIndex=function(t,e,i,o,s){try{i=void 0===i||null==i||i,0!=(i=a.D.getBoolean(i))&&(i=!0);var n=this._linkedDataList._dataList.getColumnIndex(t),l=this._linkedDataList.getFilteredColData(n),h=[];"number"!=typeof o&&(o=0),"number"!=typeof s&&(s=l.length),s>l.length&&(s=l.length);for(var d=o;d<s;d++){var u=l[d],p=this._linkedDataList.getRealRowIndex(d);1==i?u===e&&h.push(p):u.indexOf(e)>-1&&h.push(p)}return h}catch(t){r.w.printStackTrace(t)}},T.prototype.getUnmatchedIndex=function(t,e,i,o,s){try{0!=i&&(i=!0);var a=this._linkedDataList._dataList.getColumnIndex(t),n=this._linkedDataList.getFilteredColData(a),l=[];"number"!=typeof o&&(o=0),"number"!=typeof s&&(s=n.length),s>n.length&&(s=n.length);for(var h=o;h<s;h++){var d=n[h],u=this._linkedDataList.getRealRowIndex(h);1==i?d!==e&&l.push(u):d.indexOf(e)<=-1&&l.push(u)}return l}catch(t){r.w.printStackTrace(t)}},T.prototype.getRangeData=function(t,e){try{var i=[];if(t>e){var o=e;e=t,t=o}t<0&&(t=0),e>this._linkedDataList.getDataLength()&&(e=this._linkedDataList.getDataLength());for(var s=t;s<e;s++){var a=this._linkedDataList.getRealRowIndex(s);i=i.concat(this._linkedDataList.getRowData(a))}return i}catch(t){r.w.printStackTrace(t)}},T.prototype.getAllData=function(){try{return this._linkedDataList._dataList.getAllFilteredData()}catch(t){r.w.printStackTrace(t)}},T.prototype.getAllFilteredData=function(){this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=0;e<this._linkedDataList.getDataLength();e++)t=t.concat(this._linkedDataList.getRowData(e));return t},T.prototype.getColumnDistinctDataArray=function(t){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var e=[],i=[];"string"==typeof t&&(t=this._linkedDataList._dataList.bodyIdColIndexMap[t]);for(var o=this._linkedDataList._dataList.getCellInfo(t),s=this._linkedDataList.getColData(t),a=0;a<s.length;a++){i[s[a]]=1}for(var n in i)e.push(n);return"text"==o.options.dataType?e.sort():e.sort(this._linkedDataList.comparator),e}catch(t){
r.w.printStackTrace(t)}},T.prototype.getRangeXML=function(t,e){try{return this._linkedDataList.getRangeXML(t,e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getMatchedXML=function(t,e,i,o,s){try{return this._linkedDataList.getMatchedXML(t,e,i,o,s)}catch(t){r.w.printStackTrace(t)}},T.prototype.getUnmatchedXML=function(t,e,i,o,s){try{return this._linkedDataList.getUnmatchedXML(t,e,i,o,s)}catch(t){r.w.printStackTrace(t)}},T.prototype.getRowXML=function(t){try{return this._linkedDataList.getRowXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getAllXML=function(t){try{return this._linkedDataList.getAllXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getAllFilteredXML=function(t){return this._linkedDataList.getAllFilteredXML(t)},T.prototype.getRowJSON=function(t,e){try{return this._linkedDataList.getRowJSON(t,e)}catch(t){r.w.printStackTrace(t)}},T.prototype.getAllJSON=function(t){try{return this._linkedDataList.getAllJSON(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getRangeJSON=function(t,e,i){try{return this._linkedDataList.getRangeJSON(t,e,i)}catch(t){r.w.printStackTrace(t)}},T.prototype.getMatchedJSON=function(t,e,i,o,s){try{return this._linkedDataList.getMatchedJSON(t,e,i,o,s)}catch(t){r.w.printStackTrace(t)}},T.prototype.getUnmatchedJSON=function(t,e,i,o,s){try{return this._linkedDataList.getUnmatchedJSON(t,e,i,o,s)}catch(t){r.w.printStackTrace(t)}},T.prototype.getFusionChartData=function(t,e,i){return this._linkedDataList.getFusionChartData(t,e,i)},T.prototype.getRowStatusValue=function(t){try{return this._linkedDataList.getRowStatusValue(t)}catch(t){r.w.printStackTrace(t,null,this)}},T.prototype.getRowStatus=function(t){try{return this._linkedDataList.getRowStatus(t)}catch(t){r.w.printStackTrace(t,null,this)}},T.prototype.getRowIndexByStatus=function(t){try{for(var e=[],i=0;i<this._linkedDataList.getDataLength();i++){var o=this._linkedDataList.getRealRowIndex(i);t.indexOf(this._linkedDataList._dataList.getRowStatus(o))>-1&&e.push(o)}return e}catch(t){r.w.printStackTrace(t)}},T.prototype.getInsertedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("C")}catch(t){r.w.printStackTrace(t)}},T.prototype.getUpdatedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("U")}catch(t){r.w.printStackTrace(t)}},T.prototype.getDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("DV")}catch(t){r.w.printStackTrace(t)}},T.prototype.getOnlyDeletedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("D")}catch(t){r.w.printStackTrace(t)}},T.prototype.getVoidIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("V")}catch(t){r.w.printStackTrace(t)}},T.prototype.getModifiedIndex=function(){try{return this._linkedDataList.getRowIndexByStatus("CUD")}catch(t){r.w.printStackTrace(t)}},T.prototype.getInsertedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getInsertedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getInsertedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getInsertedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getInsertedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getDeletedIndex()
;return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getVoidData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getVoidXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getVoidIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getVoidJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getVoidIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getOnlyDeletedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getOnlyDeletedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getOnlyDeletedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getOnlyDeletedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getOnlyDeletedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getUpdatedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getUpdatedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getUpdatedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getUpdatedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getUpdatedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getModifiedData=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowData(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.getModifiedXML=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});var t=this._linkedDataList.getModifiedIndex();return this._linkedDataList._dataList.getArrXML(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.getModifiedJSON=function(){try{this._linkedDataList.broadcast({gridView:["_endEdit"]});for(var t=[],e=this._linkedDataList.getModifiedIndex(),i=0;i<e.length;i++)t.push(this._linkedDataList.getRowJSON(e[i]));return t}catch(t){r.w.printStackTrace(t)}},T.prototype.setColumnFilter=function(t,e,i,o){return"object"!=typeof t||a.D.isString(t)||(t.internal=!0),this._linkedDataList.setColumnFilter(t,e,i,o)},T.prototype.removeColumnFilter=function(t){return this._linkedDataList.removeColumnFilter(t,{internal:!0})},T.prototype.clearSortFilter=function(){return this._linkedDataList.clearSortFilter()},T.prototype.removeColumnFilterAll=function(){return this._linkedDataList.removeColumnFilterAll()},T.prototype.setFilter=function(t){return t&&(t.internal=!0),this._linkedDataList.setFilter(t)},T.prototype.removeFilter=function(t,e){return t&&(t.internal=!0),this._linkedDataList.removeFilter(t,e)},
T.prototype.clearFilter=function(){return this._linkedDataList.clearFilter()},T.prototype.sort=function(t,e){return this._linkedDataList.sort(t,e)},T.prototype.clearSort=function(){return this._linkedDataList.clearSort()},T.prototype.multisort=function(t){return this._linkedDataList.multisort(t)},T.prototype.getRowArray=function(t){try{return this._linkedDataList.getRowArray(t)}catch(t){r.w.printStackTrace(t)}},T.prototype.removeRow=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);return this._grid._dataList.removeRow(i,e)}catch(t){r.w.printStackTrace(t)}},T.prototype.removeRows=function(t){try{for(var e=[],i=0;i<t.length;i++)e.push(this._linkedDataList.getRealRowIndex(t[i]));return this._grid._dataList.removeRows(e)}catch(t){r.w.printStackTrace(t)}},T.prototype.setRowData=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowData(o,e,i)}catch(t){r.w.printStackTrace(t)}},T.prototype.setRowXML=function(t,e,i){try{var o=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.setRowXML(o,e,i)}catch(t){r.w.printStackTrace(t)}},T.prototype.insertData=function(t,e){try{var i=this._linkedDataList.getRealRowIndex(t);this._grid._dataList.insertData(i,e)}catch(t){r.w.printStackTrace(t)}};var k=i(4582),A=function(t,e,i){this.options={},o.x.extend(this.options,WebSquare.uiplugin.cellInfo.prototype.defaultOptions);var r=t?t.getAttribute("escape"):"",n=a.D.getEscape(r);this.options.escape=n||this.options.escape,this.internal=!1,(i||"TD"==t.getTagName().toUpperCase())&&(this.internal=!0),this.mainGrid=e,this.mainGridId="G_"+this.mainGrid.id+"__",t&&this.setOptions(t),null!=this.mainGrid.scope_obj&&(this.options._scope_obj_uuid=this.mainGrid.scope_obj.uuid,this.scope_id=this.mainGrid.scope_obj.id),""!=this.options.value&&""==this.options.defaultValue&&(this.options.defaultValue=this.options.value),""==this.options.value&&""!=this.options.defaultValue&&(this.options.value=this.options.defaultValue),this.colID=this.options.col_id,this.id=this.options.col_id,this.options.id=this.options.col_id,this.setController(),this.initFormatter(t),this.initializeCellInfo(t,i),this.expressionStr=null,this.style="",this.heightGap=0;var l=s.v.browserVersion();if(s.v.browserCheck.ie&&"8"!=l&&(this.heightGap=2),""!=this.options.importExp&&(this.options.importExp=this.options.importExp.replace(/[cC][oO][lL][\s]*[(]/g,"_this.columnValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[xX][pP][aA][tT][hH][\s]*[(]/g,"_this.xpathValue(obfuscator_rowXml, "),this.options.importExp=this.options.importExp.replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.rowIndexValue(obfuscator_i")),0==this.options.colSpan&&(this.options.colSpan=1),0==this.options.rowSpan&&(this.options.rowSpan=1),t){var h=!this.options.groupName||!this.options.groupValue,d=this.options.inputType;if(h&&("button"!=d&&"image"!=d)&&this.mainGrid.successBinding){var u=e._dataList.getCellInfo(this.id);!(!u||!u.element&&u.id!==this.id)||(this.options.readOnly=!0)}}"radio"==this.options.inputType&&this.options.groupName&&(this.mainGrid.radioGroupRepChk[this.options.groupName]=!0),"$blank"==this.options.NaNFormat&&(this.options.NaNFormat=""),this.changedCellHeight=0,this.dynamicAttrInfo={},"custom"==this.options.inputType&&(this.mainGrid.hasCustomInputType=!0),"expression"===this.options.inputType&&"true"!==this.options.expressionSort&&(this.mainGrid.expressionHeaderInfo[this.mainGrid.bodyToHeaderRelation[this.id]]=!0)};A.prototype.defaultOptions={id:"",col_id:"",colIndex:"",colSpan:0,rowSpan:0,defaultValue:"",value:"",inputType:"text",useFilter:!1,blockSelect:!1,dataType:"",valueType:"binary",viewType:"",trueValue:null,falseValue:null,editType:"",applyFormat:"display",displayFormat:"",displayFormatter:"",chooseOptionLabel:"-선택-",chooseOptionValue:"",chooseOption:!1,allOption:!1,title:"",voidNull:!1,adjustMaxLength:!1,useMaxLength:!1,depthColumn:"",showDepth:0,importExp:"",importFormatter:"",expression:"",
colMerge:!1,colMergeEdit:!1,upperColumn:"",readOnly:"",imageWidth:"",imageHeight:"",imageClickFunction:"",imageSrc:"",imageSrcDisabled:"",imageSrcReadOnly:"",useImageClick:!1,alt:"",calendarValueType:"yearMonthDate",disabled:"",textAlign:"",exportFormatter:"",imeMode:"",selectSetter:"",ignoreStatus:!1,dateValidCheck:"",embeddedInput:"",groupName:"",escape:"false"!==s.v.getConfiguration("/WebSquare/escape/@value"),setRecursive:!1,showReadOnly:!1,customFormatter:"",escapeFormatter:"",depthType:"nbsp",moveFocusByChoice:"",directItemChoice:"",directOpen:!1,focusOutOnCheckHeaderClick:!0,usePartialCheck:!0,partialCheckNextClick:"",footerDiv:!1,displayRowIndex:!1,NaNFormat:"NaN",disabledClass:"",hiddenClass:"",displayMode:"0",delimiter:"\t",skipKeyMoveEditMode:!1,checkboxLabel:"",checkboxLabelPosition:"right",checkboxLabelColumn:"",checkboxLabelFormatter:"",radioLabel:"",radioLabelPosition:"right",radioLabelColumn:"",radioLabelFormatter:"",checkAlways:!1,fixColumnWidth:!1,sortLabel:!1,useIOFormatLength:!1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",tooltipTime:1,minWidth:20,eventPriority:"onviewchange",customModelFormatter:"",customModelUnformatter:"",useMonthYearFormat:!1,editModeEventIcon:"",keepCellClass:!1,inputReadOnly:!1,keyMoveListSync:!1,tableRender:"",copyOption:"",invalidMessageFunc:"",dateValidSetCustom:!1,checkcomboboxUseDrag:!1,checkcomboboxUseEdit:!1,checkcomboboxRangeSeparator:"",checkcomboboxValidateOnInput:!1,checkcomboboxVisibleRowNum:0,checkcomboboxVisibleColNum:1,checkcomboboxVisibleColMax:1,placeholder:"",refInitSync:!1,eventPropagation:!1,noDisabledOnReadOnly:!1},A.prototype.setOptions=function(t){var e=this.mainGrid.options.pluginName,i=t.getAttribute("calendarValueType")||this.options.calendarValueType,r=t.getAttribute("inputType")||"text";this.configOptions=o.x.extend({},s.v.getConfig(e+"/column[@inputType='"+r+"']"));var n=t.getAttribute("dataType")||"text";this.configOptions2=o.x.extend({},s.v.getConfig(e+"/column[@dataType='"+n+"']")),"calendar"==r&&"grid"==e?this.configOptions.displayFormat=s.v.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat[@valueType="'+i+'"]/@value')||s.v.getConfiguration('/WebSquare/grid/column[@inputType="calendar"]/displayFormat/@value'):"calendar"==r&&"gridView"==e&&(this.configOptions.displayFormat=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+i+'"]/@value')||s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat/@value')||s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/displayFormat[@valueType="'+i+'"]/@defaultValue')),"textarea"===r&&(this.configOptions.keepCellClass=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/keepCellClass/@value')),this.options=o.x.extendKeepingType(o.x.extendKeepingType(this.options,this.configOptions2),this.configOptions);var l=[];for(var h in this.options)l[h.toLowerCase()]=h;var d=WebSquare.Parser.parseAttribute(t);for(var u in d){var p=d[u];"class"==u?this.options.className=p:""!=String(p).wq_trim()&&(l[u]&&(u=l[u]),"boolean"==typeof this.options[u]?p=a.D.getBoolean(p):"number"==typeof this.options[u]&&(p=a.D.getNumber(p)),this.options[u]=p)}if(!(n=this.options.dataType)&&this.mainGrid.successBinding&&(n=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"==n&&!this.options.displayFormat){if(this.options.displayFormatFunc){var c=a.D.getGlobalFunction(this.options.displayFormatFunc,this.scope_id);"function"==typeof c&&(this.options.displayFormat=c.call(this,this.options.calendarValueType))}this.options.displayFormat||(this.options.displayFormat=s.v.getConfiguration("/WebSquare/"+e+"/dataType/date/@displayFormat"))}if("date"==n&&this.options.calendarDisplayFormatFunc&&!this.options.calendarDisplayFormat){
var g=a.D.getGlobalFunction(this.options.calendarDisplayFormatFunc,this.scope_id);"function"==typeof g&&(this.options.calendarDisplayFormat=g.call(this,this.options.calendarValueType))}if("time"!=n||this.options.displayFormat||(this.options.displayFormat="HH:mm"),this.mainGrid.options.senseReader&&"false"!==this.options.embeddedInput)switch(this.options.inputType||"text"){case"secret":case"text":"none"==this.mainGrid.options.focusMode&&"false"!=this.options.readOnly&&(this.options.readOnly=!0);case"select":case"checkbox":case"radio":case"calendar":this.options.embeddedInput=!0}else this.options.embeddedInput=a.D.getBoolean(this.options.embeddedInput);if("textarea"==this.options.inputType&&(this.options.showReadOnly=!0),this.element=t,"expression"==this.options.inputType){var f=this.options.expression;""!=f&&(f=f.replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(")).match("rowStatus")&&this.mainGrid.rowStatusColIDArr.push(this.options.col_id)}this.options.editModeEventIcon||(this.options.editModeEventIcon=this.mainGrid.options.editModeEventIcon);!0!=={onclick:!0,ondblclick:!0}[this.options.editModeEventIcon]&&(this.options.editModeEventIcon="onclick"),this.options.copyOption||(this.options.copyOption=this.mainGrid.options.copyOption)},A.prototype.setController=function(){switch(this.options.inputType){case"text":o.x.extend(this,WebSquare.uiplugin.cellInfo.text.prototype);break;case"link":o.x.extend(this,WebSquare.uiplugin.cellInfo.link.prototype);break;case"checkbox":o.x.extend(this,WebSquare.uiplugin.cellInfo.checkbox.prototype);break;case"button":o.x.extend(this,WebSquare.uiplugin.cellInfo.button.prototype);break;case"image":o.x.extend(this,WebSquare.uiplugin.cellInfo.image.prototype);break;case"radio":o.x.extend(this,WebSquare.uiplugin.cellInfo.radio.prototype);break;case"select":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.select.prototype);break;case"calendar":o.x.extend(this,WebSquare.uiplugin.cellInfo.calendar.prototype);break;case"textarea":o.x.extend(this,WebSquare.uiplugin.cellInfo.textarea.prototype);break;case"expression":o.x.extend(this,WebSquare.uiplugin.cellInfo.expression.prototype);break;case"drilldown":o.x.extend(this,WebSquare.uiplugin.cellInfo.text.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.drilldown.prototype);break;case"textImage":o.x.extend(this,WebSquare.uiplugin.cellInfo.textImage.prototype);break;case"checkcombobox":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.checkcombobox.prototype);break;case"autoComplete":o.x.extend(this,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(this,WebSquare.uiplugin.cellInfo.autoComplete.prototype);break;case"spinner":o.x.extend(this,WebSquare.uiplugin.cellInfo.spinner.prototype);break;case"custom":o.x.extend(this,WebSquare.uiplugin.cellInfo.custom.prototype);break;case"user":o.x.extend(this,WebSquare.uiplugin.cellInfo.user.prototype);break;default:o.x.extend(this,WebSquare.uiplugin.cellInfo.text.prototype)}},A.prototype.setInnerHTML=function(t,e,i,o,s){t.innerHTML="<nobr>"+this.getDisplayData(e)+"</nobr>"},A.prototype.setEditMode=function(t,e){this.mainGrid.editedCell=null,this.mainGrid.editMode=!1},A.prototype.initFormatter=function(t){try{var e=this.options.dataType;if(!e&&this.mainGrid.successBinding&&(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),!e&&this.options.expression){var i=this.options.expression;(i=(i=(i=(i=(i=(i=(i=i.replace(/[sS][uU][mM][\s]*[(]/g,"NUMBER(")).replace(/[aA][vV][gG][\s]*[(]/g,"NUMBER(")).replace(/[mM][aA][xX][\s]*[(]/g,"NUMBER(")).replace(/[mM][iI][nN][\s]*[(]/g,"NUMBER(")).replace(/rowStatus[\s]*[(]/gi,"NUMBER(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"STRING(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"STRING(")).indexOf("NUMBER(")>-1?e="number":i.indexOf("STRING(")>-1&&(e="text")}var o,a,n,l=e
;if("number"!==e&&"bigDecimal"!==e&&"float"!==e&&"euro"!=e&&"rupee"!=e&&"tenge"!=e||"\t"===this.options.delimiter&&(this.options.delimiter=""),"text"==this.options.inputType&&!this.options.displayFormat)if("euro"==e||"rupee"==e||"tenge"==e)"euro"==e?(o=this.mainGrid.options.euroMask||s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/euroMask/@value')||"",a=".",n=","):"rupee"==e?(o=this.mainGrid.options.rupeeMask||s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/rupeeMask/@value')||"",a=",",n="."):"tenge"==e&&(o=this.mainGrid.options.tengeMask||s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/tengeMask/@value')||"",a=" ",n="-"),this.options.displayFormat=o,this.options.delimiter||(this.options.delimiter=a),this.options.decimalDelimiter||(this.options.decimalDelimiter=n),this.options.customModelFormatter||(this.options.customModelFormatter=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelFormatter/@value')||""),this.options.customModelUnformatter||(this.options.customModelUnformatter=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="text"]/dataType[@valueType="'+e+'"]/customModelUnformatter/@value')||""),l="float";"date"!=l||"calendar"!=this.options.inputType||this.options.ioFormat||(this.options.ioFormat=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="calendar"]/ioFormat[@valueType="'+this.options.calendarValueType+'"]/@defaultValue'),this.options.ioFormat||("yearMonthDate"==this.options.calendarValueType?this.options.ioFormat="yyyyMMdd":"yearMonth"==this.options.calendarValueType?this.options.ioFormat="yyyyMM":"yearMonthDateTime"==this.options.calendarValueType?this.options.ioFormat="yyyyMMddHHmm":"yearMonthDateTimeSec"==this.options.calendarValueType&&(this.options.ioFormat="yyyyMMddHHmmSS"))),"default"==this.options.maskFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("numberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("textMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):"reverse"==this.options.maskFormat?"number"==this.options.dataType||"bigDecimal"==this.options.dataType?this.formatter=WebSquare.format.createFormatter("reverseNumberMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id):(this.formatter=WebSquare.format.createFormatter("reverseTextMask",this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.scope_id,this.id),this.formatter.setAllowChar(this.options.allowChar)):this.formatter="float"===l||"bigDecimal"===l?WebSquare.format.createFormatter(l,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,this.options.delimiter,this.options.decimalDelimiter,this.mainGrid.scope_id,this.mainGrid.id):WebSquare.format.createFormatter(l,this.options.displayFormat,this.options.displayFormatter,this.options.ioFormat,null,null,this.mainGrid.scope_id,this.mainGrid.id),this.emptyFormatter=WebSquare.format.createFormatter(l,"",null,null,null,null,this.mainGrid.scope_id,this.mainGrid.id)}catch(t){r.w.printStackTrace(t)}},A.prototype.getDisplayData=function(t){return this.formatter&&(t=this.formatter.format(t)),
"secret"==this.options.inputType&&(t=t.replace(/./gi,"●")),t},A.prototype.initializeCellInfo=function(){},A.prototype.handleEndEdit=function(t,e,i){try{if(t=t||{},i=i||{},this.options.embeddedInput)return!0;if(this.mainGrid.rollbackCommitFlag=!1,this.mainGrid.editedCell&&0==this.mainGrid.editMode&&(this.mainGrid.editMode=!0),this.mainGrid.editMode){var o=this.mainGrid.editedCell;if(o._getEditedValue){var a=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),n=this.editRowIndex,l=this.mainGrid._getGroupbyDisplayRowIndex(n),h=o._getEditedValue();if((u=d.B.fireEvent(this.mainGrid,"oneditend",l,a,h,t))+""=="false")return this.mainGrid.getInput(this).focus(),d.B.stopEvent(t),!1}if(!o.validate())return d.B.stopEvent(t),!1;if(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,!i.otherClick){c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),this._handleEndEdit(t,e,i));var u=this._afterEndEdit(o,c);return o=null,u}var p=null,c=null;null!=this.editTd&&(c=this.mainGrid.dataList.getCellData(this.editRowIndex,o.options.id),p=this._handleEndEdit(t,e,i)),s.v.setTimer((function(t,e){null!=this.editTd&&this._handleEndEdit_focus(e),this._afterEndEdit(t,c),t=null,e=null}),{key:this.id+"_handleClickEventDocument",caller:this,args:[o,p]}),p=null,o=null}}catch(t){r.w.printStackTrace(t,null,this)}},A.prototype._afterEndEdit=function(t,e){var i,o=this.mainGrid.dataList._getCellData(this.editRowIndex,t.options.id),s=this.editRowIndex,r=t.options.id,a=s,n=this.mainGrid.getColumnIndex(r);if(this.editTd&&(i=this.editTd.getAttribute("colMerged")),"0"==i&&!t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped){var l=function(t,i,o,s){for(var r=t;t+1<this.mainGrid.getDataLength();){t+=1;var a=this.mainGrid.upperGroupingTest(t,i),n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}for(t=r;t-1>=0;){a=this.mainGrid.upperGroupingTest(t,i);t-=1;n=this.mainGrid.dataList._getCellData(t,i);if(!a){l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}if(n!=e){var h,l=this.mainGrid.tdIdList.length;(h=this.mainGrid.data_td_list[(t-this.mainGrid.rowIndex)*l+o])&&this.setInnerHTML(h,n,t,this.id);break}this.mainGrid.dataList.__setCellData(t,i,s)}i=this.mainGrid.getColumnIndex(i);this.mainGrid.applyColumnStyleOptions(i)};l.call(this,s,r,n,o);var h=this.mainGrid.upperToLowerColumnRelation[r];if(h)for(var u=0;u<h.length;u++){var p=h[u],c=this.mainGrid.dataList._getCellData(s,p),g=this.mainGrid.getColumnIndex(p),f=this.mainGrid.getCellInfo(p);l.call(f,s,p,g,c)}}t.options.colMergeEdit&&!this.mainGrid.groupbyStatus.grouped&&this.mainGrid.setColMergeCellData(a-this.mainGrid.rowIndex,a,n);var m=this.mainGrid.dataList._getCellData(a,n),y=a+"_"+n;if(null!=this.mainGrid.cellMergeInfo[y]){var b=this.mainGrid.cellMergeInfo[y].rowSpan,w=this.mainGrid.cellMergeInfo[y].colSpan;for(u=0;u<b;u++)for(var v=0;v<w;v++)0===u&&0===v||this.mainGrid.dataList.__setCellData(a+u,n+v,m)}Math.abs(this.changedCellHeight)>3&&this.mainGrid.notifyRowChanged(a);var I=this.mainGrid._getGroupbyDisplayRowIndex(a),C=d.B.fireEvent(this.mainGrid,"onafteredit",I,n,m,this.mainGrid.lastEvent);return this.mainGrid.lastEvent=null,C=0!=C,this.mainGrid.rollbackCommitFlag=!0,C},A.prototype.handleScrollY=function(t){return this.validate()?this.handleEndEdit(t):this.handleCancelEdit(t)},A.prototype.validate=function(){return!0},A.prototype._handleEndEdit=function(t,e,i){var o=this._handleEndEdit_common(t);if((i=i||{}).otherClick)return o;this._handleEndEdit_focus(o,e,i.focuseChanged)},A.prototype._handleEndEdit_common=function(t,e){return null},
A.prototype._handleEndEdit_focus=function(t){return null},A.prototype.handleCancelEdit=function(t){this.options.embeddedInput||(this.mainGrid.editedCell=null,this.mainGrid.editMode=!1,this._handleCancelEdit(t))},A.prototype._handleCancelEdit=function(t){},A.prototype.removeCellData=function(t,e){},A.prototype.doDefaultAction=function(t){},A.prototype.setMergedCol=function(t,e,i,o){var s=t,r=new Array;for(r[t]=!0;t<this.mainGrid.getDataLength();){if(t+=1,!(a=this.mainGrid.upperGroupingTest(t,e)))break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}for(t=s;t>0;){var a=this.mainGrid.upperGroupingTest(t,e);if(t-=1,!a)break;if(this.mainGrid.dataList._getCellData(t,e)!=i)break;this.mainGrid.dataList.__setCellData(t,e,o),r[t]=!0}e=this.mainGrid.getColumnIndex(e);return this.mainGrid.applyColumnStyleOptions(e),r},A.prototype.getEscape=function(){return""!=this.options.escape?this.options.escape:this.mainGrid.options.escape},A.prototype.getColumnIndex=function(t){return t||(t=this.colID),this.mainGrid.getColumnIndex(t)},A.prototype.setMaxLength=function(t){try{this.options.maxlength=this.options.maxLength=t,this.mainGrid.getInput(this).setMaxLength(t)}catch(t){r.w.printStackTrace(t,null,this)}},A.prototype.setFloatMaxLength=function(t){try{this.options.maxlength=this.options.maxLength="-1",this.mainGrid.getInput(this).setFloatMaxLength(t)}catch(t){r.w.printStackTrace(t,null,this)}},A.prototype.refreshCell=function(){},A.prototype._checkFastScroll=function(t,e,i,o){try{var s="string"!=typeof t||!1===this.mainGrid._regDetectDOM.test(t);return e&&null!=e.textContent&&this.mainGrid.hasClass(e,i)&&s&&!0===o}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl=function(){},A.itemsetControl.prototype.initializeCellInfo=function(t){try{if(this.internal&&this.initializeInfo?this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.initializeInfo.rowIndex+"_"+this.colID+"_"+this.id:this.compID=this.mainGridId+"_"+this.options.inputType+"_"+this.colID,"select"===this.options.inputType&&""!=this.options.selectSetter)this.selectSetted=!1,this.resetMatchInfo=!0;else{var e,i="";if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var s=(i=a.D.isIE("6 7")&&this.internal&&t._element.outerHTML?WebSquare.xml.nodeWellFormed(t._element.outerHTML):WebSquare.xml.serialize(t._element)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"",n=this.options.inputType;i=(i=i.wq_replaceAll("<w2:column","<w2:"+n+s)).wq_replaceAll("</w2:column","</w2:"+n);var l=WebSquare.xml.parse(i,!0);this.xml=new WebSquare.Elem(l.documentElement)}o.x.extend(this,k.E.prototype),this.hasRef=!1,"checkcombobox"!==this.options.inputType&&(this.selectedIndex=void 0===this.options.selectedIndex?-1:parseInt(this.options.selectedIndex,10)),this.options.selectedData="false"!=this.options.selectedData&&!1!==this.options.selectedData,"select"===this.options.inputType?e="SelectBox":"autoComplete"===this.options.inputType?e="AutoComplete":"checkcombobox"===this.options.inputType&&(e="CheckCombobox"),e&&(this.options.chooseOptionLabel="-선택-"===this.options.chooseOptionLabel?WebSquare.language.getMessage(e+"_choose"):this.options.chooseOptionLabel),this.internal?this.itemsetObj=this.initializeInfo.itemSet?this.initializeInfo.itemSet:{nodeset:"",label:"",value:""}:this.itemsetObj=WebSquare.WebSquareparser.parseItemset(this.xml),this.resetMatchInfo=!0;var h=this.itemsetObj.nodeset.wq_replaceAll(" ","");if(this.internal&&"gridViewItemset"==this.options.itemTableType?this.existGridViewItemsetNode=!0:this.existGridViewItemsetNode=WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:gridViewItemset")[0],""!=this.itemsetObj.nodeset&&h.indexOf("ref(")>=0){this.hasRef=!0;var d=this.itemsetObj.nodeset;this.refStr='"'+this.refReplace(d)+'"';for(var u=d.match(/ref\('([^']*)'\)/g),p=0;p<u.length;p++){var c=u[p].slice(5,-2),g=this.mainGrid.getCellInfo(c);g.refArr||(g.refArr=[]),
g.refArr.push(this.colID)}if(this.refHash=[],this.refItemArr=[],"select"===this.options.inputType&&this.options.embeddedInput)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset","")}else if(""!=this.itemsetObj.nodeset&&h.indexOf("data:")>=0){var f=this.itemsetObj.nodeset.replace("data:","").split(".");this.dataComp=f[0]}else this.matchInfo=this.setMatchInfo()}this.refArr||(this.refArr=[]),this._initializeCellInfo()}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.getItemText=function(t){try{var e="";if(t>-1&&t<this.itemArr.length){switch(e=this.itemArr[t].label,this.options.displayMode){case"0":case"1":case"2":case"3":break;case"value delim label":this.options.displayMode="1";break;case"label delim value":this.options.displayMode="2";break;case"value":this.options.displayMode="3";break;default:this.options.displayMode="0"}switch(this.options.displayMode){case"0":break;case"1":e=this.itemArr[t].value+this.options.delimiter+e;break;case"2":e=e+this.options.delimiter+this.itemArr[t].value;break;case"3":e=this.itemArr[t].value}}return e}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.setColumnNodeSet=function(t,e,i,o){try{if(this.internal)this.itemsetObj.nodeset=t,this.itemsetObj.label=e,this.itemsetObj.value=i;else{if("json"===this.xml._elementType){var a=[];a.push({N:"w2:label",T:1,A:{ref:e}}),a.push({N:"w2:value",T:1,A:{ref:i}});var n=WebSquare.Elem.api.getElementsByTagName(this.xml,"itemset",s.v._XML_NAMESPACE.W2)[0];n?(n._element.A.nodeset=t,n._element.E=a):this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:itemset",A:{nodeset:t},E:a}]}]}else{var l=WebSquare.xml.findNode(this.xml,"*['choices'=local-name()]['"+s.v._XML_NAMESPACE.W2+"'=namespace-uri()]");for(null==l&&(l=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,l));l&&l.firstChild;)l.removeChild(l.firstChild);var h="<w2:itemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+t+"'><w2:label ref='"+e+"'></w2:label><w2:value ref='"+i+"'></w2:value></w2:itemset>",d=WebSquare.xml.parse(h,!0).documentElement;WebSquare.xml.appendChild(l,d)}this.itemArr=[],this.initializeCellInfo(this.xml)}var u=this.options.inputType;if(1==this.options.embeddedInput){var p=this.mainGrid.tdIdList.length,c=this.mainGrid.getColumnIndex(this.options.id);if(isNaN(o))for(var g=this.mainGrid.getRowCount(),f=this.mainGrid.rowIndex;f<g;f++){(m=this.mainGrid.data_td_list[(f-this.mainGrid.rowIndex)*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}else{var m,y=o-this.mainGrid.rowIndex;if(y>=0)(m=this.mainGrid.data_td_list[y*p+c])&&this.mainGrid.getInput(this,m).setNodeSet(t,e,i)}}else this[u]&&this[u].setNodeSet(t,e,i);t.indexOf("data:")>=0&&(this.dataComp=t.slice("data:".length))}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.setColumnGridItemset=function(t){try{if("select"!==this.options.inputType&&"autoComplete"!==this.options.inputType)return;var e=t.nodeset,i=t.label,o=t.value;if(this.internal)this.itemsetObj.nodeset=e,this.itemsetObj.label=i,this.itemsetObj.value=o;else{if("json"===this.xml._elementType){var a=[],n={};for(var l in t)"object"!=typeof t[l]&&"function"!=typeof t[l]&&null!=t[l]&&(n[l]=t[l]);for(var h=0;h<t.item.length;h++)a.push({N:"w2:item",T:1,A:t.item[h]});var d=WebSquare.Elem.api.getElementsByTagName(this.xml,"gridViewItemset",s.v._XML_NAMESPACE.W2)[0];if(d){for(var l in n)d._element.A[l]=n[l];d._element.E=a}else this.xml._element.E=[{T:1,N:"w2:choices",E:[{T:1,N:"w2:gridViewItemset",A:n,E:a}]}]}else{var u=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",s.v._XML_NAMESPACE.W2);for(null==u&&(u=WebSquare.xml.createNode(this.xml,"w2:choices"),WebSquare.xml.appendChild(this.xml,u));u&&u.firstChild;)u.removeChild(u.firstChild);if(s.v.isXML(t))WebSquare.xml.appendChild(u,t);else{
var p="<w2:gridViewItemset xmlns:w2='http://www.inswave.com/websquare' nodeset='"+e+"'></w2:gridViewItemset>",c=WebSquare.xml.parse(p,!0),g=c.documentElement;for(var f in t)if("item"===f)for(h=0;h<t.item.length;h++){var m=WebSquare.xml.createElement(c,"w2:item"),y=t.item[h];for(var b in y)m.setAttribute(b,y[b]);WebSquare.xml.appendChild(g,m)}else"nodeset"!==f&&g.setAttribute(f,t[f]);WebSquare.xml.appendChild(u,g)}}this.initializeCellInfo(this.xml)}if("select"===this.options.inputType&&1==this.options.embeddedInput){var w=this.mainGrid.tdIdList.length,v=this.mainGrid.getColumnIndex(this.options.id),I=this.mainGrid.getRowCount();for(h=0;h<I;h++)this.mainGrid.getInput(this,this.mainGrid.data_td_list[h*w+v]).setGridItemset(t)}this[this.options.inputType]&&this[this.options.inputType].setGridItemset(t),e.indexOf("data:")>=0&&(this.dataComp=e.slice("data:".length))}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.getColumnDataListInfo=function(){try{if(this[this.options.inputType])return this[this.options.inputType].getDataListInfo();var t=WebSquare.Elem.api.getElementsByTagName(this.xml,"choices",s.v._XML_NAMESPACE.W2)[0];if(t){var e=WebSquare.WebSquareparser.parseItemset(t),i={};return e&&""!==e.nodeset?(e.nodeset.match("data:")?(i.nodeset=e.nodeset.slice(0),i.id=i.nodeset.wq_replaceAll("data:",""),i.value=e.value,i.label=e.label):(i.nodeset=e.nodeset.slice(0),i.value=e.value,i.label=e.label),i):null}return null}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.getDisplayData=function(t,e,i){var o=this.getData(t,e,i);return null==o&&(o=""),i&&i.emptyValue&&o===i.emptyValue?o="":o!=t&&""==o&&(o=t),o},A.itemsetControl.prototype.setMatchInfo=function(t){if(this.modelControl=new WebSquare.modelControl(this.colID,this.options.model,this.options.ref,this.options.bind,this.options._scope_obj_uuid),this.existGridViewItemsetNode?this.initializeGridViewItemArr(this.xml):this.initializeItemArr(this.xml),0==this.itemArr.length?this.resetMatchInfo=!0:this.resetMatchInfo=!1,"0"!=this.options.displayMode)for(var e=0;e<this.itemArr.length;e++)this.itemArr[e].label=this.getItemText(e);var i={};if(1==this.options.allOption){var o=WebSquare.language.getMessage("Grid_all")||"-전체-";this.itemArr=[{label:o,value:WebSquare.allValue}].concat(this.itemArr)}if(1==this.options.chooseOption&&"checkcombobox"!==this.options.inputType){var s=this.options.chooseOptionLabel;"$blank"==s&&(s=""),this.itemArr=[{label:s,value:this.options.chooseOptionValue}].concat(this.itemArr)}this.hasRef&&(this.refItemArr[this.itemsetObj.nodeset]=this.itemArr);var r=this.options.inputType.toUpperCase();for(e=0;e<this.itemArr.length;e++){var a=this.itemArr[e];i[r+"_"+a.value]=a.label}return i},A.itemsetControl.prototype.getMatchInfo=function(t){var e=[];return"select"===this.options.inputType&&""!=this.options.selectSetter?e=this.matchInfo:this.hasRef?e=this.getRefMatchInfo(t):this.hasRef||(this.resetMatchInfo&&(this.matchInfo=this.setMatchInfo(t)),e=this.matchInfo),e},A.itemsetControl.prototype.getRefMatchInfo=function(t){this.targetRowIndex=t;var e=new Function("_this","return "+this.refStr)(this);if(null==this.refHash[e]||this.resetMatchInfo){this.itemsetObj.nodeset=e,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",e);var i=this.setMatchInfo(t);return this.refHash[e]=i,i}return this.refHash[e]},A.itemsetControl.prototype.getRefItemArr=function(t){this.getRefMatchInfo(t);var e=new Function("_this","return "+this.refStr)(this);return this.refItemArr[e]},A.itemsetControl.prototype.getRefValue=function(t){return'"'+this.mainGrid.dataList._getCellData(this.targetRowIndex,t)+'"'},A.itemsetControl.prototype.refReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"\"+_this.getRefValue('$1')+\"");return e!=t?this.refReplace(e):e}catch(t){r.w.printStackTrace(t,null,this)}},A.itemsetControl.prototype.refXmlReplace=function(t){try{var e=t.replace(/ref\('([^']*)'\)/,"'+_this.getRefValue('$1')+'")
;return e!=t?this.refXmlReplace(e):e}catch(t){r.w.printStackTrace(t,null,this)}},A.text=function(){},A.text.prototype.setInnerHTML=function(t,e,i,o,n){var l=this.mainGrid._getGroupbyDisplayRowIndex(i);if(!this.options.embeddedInput||this.mainGrid._getEditDisabled(i,o)||this.mainGrid.___getEditReadOnly(i,o)){if(this.mainGrid.options.titleFormatter)try{var h;if("function"!=typeof this.mainGrid.options.titleFormatter){var d=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof d&&(this.mainGrid.options.titleFormatter=d,h=d.call(this,i,o,e))}else h=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",h)}catch(t){r.w.printStackTrace(t,null,this)}else if(this.options.title)t.setAttribute("title",this.options.title);else if(this.mainGrid.options.titleAuto){var u=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";""!==e?t.setAttribute("title",u+" "+e):t.setAttribute("title",u+WebSquare.language.getMessage("Grid_text"))}var p=null;if(this.options.escapeFormatter)try{"function"==typeof this.options.escapeFormatter?p=this.options.escapeFormatter:"function"==typeof(p=a.D.getGlobalFunction(this.options.escapeFormatter,this.scope_id))&&(this.options.escapeFormatter=p)}catch(t){p=null}M=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?M=this.options.customFormatter:"function"==typeof(M=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=M)}catch(t){M=null}var c=null;if(this.options.customModelUnformatter)try{"function"==typeof this.options.customModelUnformatter?c=this.options.customModelUnformatter:"function"==typeof(c=a.D.getGlobalFunction(this.options.customModelUnformatter,this.scope_id))&&(this.options.customModelUnformatter=c)}catch(t){c=null}var g=e;c&&this.options.customModelUnformatter?(this.useCustomModelFormatter=!0,g=c.call(this.mainGrid,e,l,o)):this.useCustomModelFormatter=!1,this.options.maskFormat&&(g=this.mainGrid.getInput(this,t,e).maskFormatModelUnFormat(g)),"function"==typeof p?(this.useEscapeFormatter=!0,g=p.call(this.mainGrid,e,l,o)):this.useEscapeFormatter=!1;var f=""!==this.options.escape?this.options.escape:this.mainGrid.options.escape;(f=a.D.getBoolean(f))&&(g=this.useCustomModelFormatter?WebSquare.xml._encode(g+""):WebSquare.xml._encode(e+""));O=g,N=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&N&&(O=this.formatter.format(g)),"secret"==this.options.inputType&&(O=O.replace(/./gi,"●")),"function"==typeof M?(this.useCustomFormatter=!0,B=M.call(this.mainGrid,e,O,l,o)):(this.useCustomFormatter=!1,B=O),this.mainGrid.options.plainText&&!1===this.useCustomFormatter&&!this.options.displayFormatter&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=B;else{var m=this.mainGrid.___getEditReadOnly(i,o),y=this.mainGrid._getEditDisabled(i,o),b=" class='w2grid_input";this.mainGrid.options.checkEditableInputClass&&(m||y)&&(b=" class='"),"secret"==this.options.inputType&&s.v.browserCheck.ieAllVersion&&(b+=" w2grid_secret"),m&&(b+=" w2grid_input_readonly"),y&&(b+=" w2grid_input_disabled"),b+="'";var w=t.firstChild,v=this._checkFastScroll(B,w,"w2grid_input",n&&!0===n.scroll);if(w&&(!y&&w.className.indexOf("w2grid_input_disabled")>-1||y&&-1===w.className.indexOf("w2grid_input_disabled")||!m&&w.className.indexOf("w2grid_input_readonly")>-1||m&&-1===w.className.indexOf("w2grid_input_readonly"))&&(v=!1),v&&f){var I="string"==typeof B?WebSquare.xml.__decode(B):B;w.textContent=I}else{var C=!1,x=t.firstChild;f&&x&&"NOBR"===x.tagName&&" class='"+x.getAttribute("class")+"'"===b&&1===x.attributes.length&&(C=!0),C?t.firstChild.innerHTML=B:t.innerHTML="<nobr"+b+">"+B+"</nobr>"}this.mainGrid.hasClass(t,"w2grid_input_table")||(t.className="w2grid_input_table "+t.className)}}else{var _=this.mainGrid.getInput(this,t,e);null==_.render.parentNode&&(t.innerHTML="",t.appendChild(_.render)),_.blur(),
_.render.setAttribute("rowindex",i);var S=!1;if(this.mainGrid.options.autoResizeEmbeddedInput){var D=!1;this.mainGrid.__bResizeObj&&(D=this.mainGrid.__bResizeObj.width!==this.mainGrid.resizeObj.width||this.mainGrid.__bResizeObj.height!==this.mainGrid.resizeObj.height),this.mainGrid.__bResizeObj={width:this.mainGrid.resizeObj.width,height:this.mainGrid.resizeObj.height},S=!0!==_._autoResizeEmbeddedInput&&!1===D}if(!0===S){var R=0,L=0,T=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",T=!0),null==_.render.parentNode&&(t.innerHTML="",t.appendChild(_.render)),this.mainGrid.embeddedStyleObj||(this.mainGrid.embeddedStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10),inputTop:parseInt(WebSquare.style.getStyle(_.render,"padding-top"),10),inputBottom:parseInt(WebSquare.style.getStyle(_.render,"padding-bottom"),10),inputLeft:parseInt(WebSquare.style.getStyle(_.render,"padding-left"),10),inputRight:parseInt(WebSquare.style.getStyle(_.render,"padding-right"),10)});var k=parseInt(WebSquare.style.getStyle(_.render,"border-top-width"),10),A=parseInt(WebSquare.style.getStyle(_.render,"border-bottom-width"),10),F=parseInt(WebSquare.style.getStyle(_.render,"border-left-width"),10),E=parseInt(WebSquare.style.getStyle(_.render,"border-right-width"),10);R=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),R-=this.mainGrid.embeddedStyleObj.top+this.mainGrid.embeddedStyleObj.bottom,R-=k+A,this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),L=this.mainGrid.embeddedWidthObj[o].width,L-=this.mainGrid.embeddedStyleObj.left+this.mainGrid.embeddedStyleObj.right,L-=F+E,L-=this.mainGrid.embeddedStyleObj.inputLeft+this.mainGrid.embeddedStyleObj.inputRight,T?t.parentNode.style.display="none":(a.D.isIE("6 7")||a.D.isSpartan())&&(R-=2),a.D.isOpera()&&(R+=2),_.setSize(L-2,R-(this.mainGrid.embeddedStyleObj.inputTop+this.mainGrid.embeddedStyleObj.inputBottom)),_.setStyle("lineHeight",R+"px"),_._autoResizeEmbeddedInput=!0}else null==_.render.parentNode&&(t.innerHTML="",t.appendChild(_.render));"all"==this.options.applyFormat||this.options.displayFormat||this.options.displayFormatter||(e=this.getDisplayData(e));var M=null;if(this.options.customFormatter)try{"function"==typeof this.options.customFormatter?M=this.options.customFormatter:"function"==typeof(M=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=M)}catch(t){M=null}var O=e,N=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;if(this.formatter&&N&&(O=this.formatter.format(O)),_.setValue(e),"function"==typeof M){this.useCustomFormatter=!0;var B=M.call(this.mainGrid,e,O,l,o);_.render.value=B}this.options.textAlign?_.setStyle("text-align",this.options.textAlign):_.setStyle("text-align",""),t.removeAttribute("tabIndex"),t.removeAttribute("title")}},A.text.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);this.comp=i,this.options.maskFormat||(i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat);var o=this.mainGrid.dataList._getCellData(e,this.colID);if("all"===this.options.applyFormat&&this.options.displayFormat&&"text"!=this.options.dataType&&"date"!=this.options.dataType&&"time"!=this.options.dataType){var s=this.options.decimalDelimeter||".",n=o.split(s);n[1]&&0==parseInt(n[1])&&(o=n[0])}i.setValue(o),document.activeElement!=i.render&&i.focus(),
"native"!==this.mainGrid.options.drawType&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType?i.select():"focus"==i.options.editType&&(a.D.isIEAllVersion()||a.D.isFF()||a.D.isSpartan())&&WebSquare.text.setCaretPos(i.render,i.render.value.length)}catch(t){r.w.printStackTrace(t,null,this)}},A.text.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.D.isFF()?t={top:-1,left:0,width:0,height:0}:a.D.isOpera()?t={top:0,left:0,width:0,height:1}:a.D.isIEAllVersion("9 10 11")?t={top:-1,left:-1,width:0,height:0}:a.D.isSpartan()&&(t={top:0,left:-1,width:0,height:0}),"native"===this.mainGrid.options.drawType){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}this.mainGrid.hasClass("w2grid_adaptive_crosstab")&&(s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,l.render.style.lineHeight=n+"px");l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.D.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign},A.text.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},A.text.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);return this.setEditData(e),e}catch(t){r.w.printStackTrace(t,null,this)}},A.text.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t.hide()},A.text.prototype._getEditedValue=function(t){return"bigDecimal"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")?WebSquare.bigDecimal(this.mainGrid.getInput(this).getValue()).toString():this.mainGrid.getInput(this).getValue()},A.text.prototype._handleCancelEdit=function(t){try{var e,i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide(),e=window.getSelection?window.getSelection():document.selection;var o=document.createRange();o.selectNodeContents(this.editTd),e.removeAllRanges(),e.addRange(o),e.collapseToStart()}catch(t){r.w.printStackTrace(t,null,this)}},A.text.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.text.prototype.setEditData=function(t){try{var e=t.getValue();if("number"==(o=this.mainGrid.getColumnOption(this.id,"dataType"))||"float"==o){var i=e.wq_trim();"."!==i&&"-"!==i&&"+"!==i||(e="")}e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var o=this.mainGrid.getColumnOption(this.options.col_id,"dataType");this.mainGrid.options.numberCasting&&"number"==o&&""!=e&&(e=Number(e));var s={};s[this.mainGrid.id]=!0;var n=a.D.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof n){this.useCustomModelFormatter=!0;var l=this.getDisplayData(e);e=n.call(this.mainGrid,e,l,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;if(e=this.maskFormatModelFormat(e),"float"===o&&e[e.length-1]===t.options.decimalDelimiter){var h=e.split(t.options.decimalDelimiter);e=h[0]}
this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,s)}catch(t){r.w.printStackTrace(t,null,this)}},A.text.prototype.maskFormatModelFormat=function(t){try{if(!t)return t;var e="";if(this.options.maskFormat)if(this.options.maskFormatModelExcludeChar)for(var i=this.options.maskFormatModelExcludeChar.split(""),o=0;o<t.length;o++){for(var s=!1,a=0;a<i.length;a++)if(t[o]==i[a]){s=!0;break}s||(e+=t[o])}else e=t;else e=t;return e}catch(t){r.w.printStackTrace(t,null,this)}},A.link=function(){},A.link.prototype.setInnerHTML=function(t,e,i,o,s){var n=-1,l="tabIndex='"+n+"'";"none"==this.mainGrid.options.focusMode?n=0:1==this.mainGrid.options.keyMoveEditMode&&(l="");var h,d,u=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id),p=this.getDisplayData(e);if("function"==typeof u?(this.useCustomFormatter=!0,h=u.call(this.mainGrid,e,p,i,o)):(this.useCustomFormatter=!1,h=p),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var c=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof c&&(this.mainGrid.options.titleFormatter=c,d=c.call(this,i,o,e))}else d=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){r.w.printStackTrace(t,null,this)}var g="";(d?g=" title='"+d+"'":this.options.title&&(g=" title='"+this.options.title+"'"),g)||this.mainGrid.options.titleAuto&&(g=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+WebSquare.language.getMessage("Grid_link")+"'");var f=this.options.voidNull?"javascript:void(null);":"";t.innerHTML=h||g?"<nobr><a href='"+f+"' onclick='event.returnValue=false; return false;'"+l+" "+g+">"+h+"</a></nobr>":"<nobr></nobr>"},A.link.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.mainGrid.getColumnIndex(e.getAttribute("col_id"))}else{var r=this.mainGrid.getLastFocusedCell();i=r.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.focusedColIndex}this.mainGrid._getEditDisabled(i,s)||this.mainGrid.___getEditReadOnly(i,s)||d.B.fireEvent(this.mainGrid,"oncellclick",o,s,this.options.id)},A.checkbox=function(){},A.checkbox.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":this.setBooleanValue("true","false");break;case"other":"$blank"==this.options.trueValue&&(this.options.trueValue=""),"$blank"==this.options.falseValue&&(this.options.falseValue=""),this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.embeddedInput&&(this.mainGrid.options.preventMultipleClick=!1),this.options.checkboxLabelColumn)for(var e=this.options.checkboxLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},A.checkbox.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},A.checkbox.prototype.setInnerHTML=function(t,e,i){var o,s=e+""==this.options.trueValue;if(o=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute("col_id")):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute("col_id")),this.options.embeddedInput){var n=this.mainGrid.getInput(this,t,s);n.setAttribute("rowindex",i),n.checked=s,n.disabled=o}else{var l,h;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var p=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof p&&(this.mainGrid.options.titleFormatter=p,h=this.mainGrid.getColumnIndex(this.options.id),l=p.call(this,i,h,e))}else l=this.mainGrid.options.titleFormatter.call(this,i,h,e)}catch(t){r.w.printStackTrace(t,null,this)}var c=l||this.options.title||""
;if(c)c=" title='"+c+"'";else if(this.mainGrid.options.titleAuto){var g=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";c=s?" title='"+g+WebSquare.language.getMessage("Grid_title")+"'":" title='"+g+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var f="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",m=s?" checked":"",y=o?" disabled='true'":"",b=this.options.visibleFunc,w="";if(this.options.checkboxLabel||this.options.checkboxLabelColumn||this.options.checkboxLabelFormatter){var v=this.mainGridId+"_checkbox_"+this.id,I=v+"_"+i,C=this.options.checkboxLabel||"";if(this.options.checkboxLabelColumn){for(var x=this.options.checkboxLabelColumn.split(","),_="",S=this.options.checkboxLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",D=0;D<x.length;D++)D===x.length-1?_+=this.mainGrid._getCellDisplayData(i,x[D]):_+=this.mainGrid._getCellDisplayData(i,x[D])+S;C=C?_+S+C:_}if(this.options.checkboxLabelFormatter)try{var R=a.D.getGlobalFunction(this.options.checkboxLabelFormatter,this.scope_id);"function"==typeof R&&(C=R.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),C))}catch(t){u.k.printLog(this.mainGrid.id+"_"+this.id+" checkboxLabelFormatter error : "+t.message)}C&&this.mainGrid.options.titleAuto&&!this.options.title&&(c=c.substring(0,c.length-1)+" "+C+"'"),w="<INPUT type='checkbox' "+c+f+m+y+" id='"+I+"' name='"+v+"'/>";var L="<label class='w2checkbox_label ' for='"+I+"'>"+C+"</label>";"left"===this.options.checkboxLabelPosition?w=L+w:w+=L}else w="<INPUT type='checkbox' "+c+f+m+y+" />";if(b){var T,k=a.D.getGlobalFunction(b,this.scope_id);"function"==typeof k&&(T=k(i)),t.innerHTML=T?w:""}else t.innerHTML=w;if(this.options.noDisabledOnReadOnly)(A=t.getElementsByTagName("input")[0])&&(d.B.addListener(A,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&d.B.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(A,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(A,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventMultipleClick){var A=t.getElementsByTagName("input")[0],F=t.getElementsByTagName("label")[0];this.labelClicked=!1,A&&d.B.addListener(A,"onclick",function(t,e,i){return function(o){t.options.eventPropagation||d.B.stopPropagation(o),e[2]=o.detail,i.apply(t,e,o)}}(this,[i,t],(function(t,e,i){i=this.labelClicked?0:1,this.labelClicked=!1;var o,s,r,a,n,l,u,p=null!=this.mainGrid.editedCell;p&&(o=this.mainGrid.editedCell.editRowIndex,s=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),u=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),r=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),a=this.mainGrid._grid.getRealRowIndex(o),n=this.mainGrid._dataList.dataArr[a*this.mainGrid._dataList.getColumnCount()+s],l=u.comp&&u.comp.selectedIndex);var c,g,f,m=e.getElementsByTagName("input")[0];if(m&&(c=m.checked,g=this.options.falseValue,c&&(g=this.options.trueValue),""!=(f=this.mainGrid.dataList._getCellData(t,this.colID))||c||(g=f)),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):this.mainGrid._addFocus(e)),this.handleClick(e,t,!0),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),t=this.mainGrid._getGroupbyDisplayRowIndex(t),m&&f!=g){var y={oldValue:f,newValue:g,rowIndex:t,colIndex:this.mainGrid.getColumnIndex(this.options.id)};d.B.fireEvent(this.mainGrid,"onviewchange",y)}
if(this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,h)&&d.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:c}),p){var b=this.mainGrid._dataList.dataArr[a*this.mainGrid._dataList.getColumnCount()+s];if(n!=b){var w={oldValue:n,newValue:b,rowIndex:o,colIndex:r};isNaN(l)||(w.oldSelectedIndex=l,w.newSelectedIndex=u&&u.comp&&u.comp.selectedIndex),d.B.fireEvent(this.mainGrid,"onviewchange",w)}}}))),F&&d.B.addListener(F,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},A.checkbox.prototype.getDisplayData=function(t){return t},A.checkbox.prototype.handleClick=function(t,e,i){if(this.mainGrid.__getEditReadOnly(t,e)||this.mainGrid._getEditDisabled(e,t.getAttribute("col_id"))||!this.options.embeddedInput&&this.mainGrid.options.preventMultipleClick&&!i&&!this.mainGrid.options.checkOnCellClick)return!0;null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var o=t.getElementsByTagName("input")[0];if(o){var s=this.options.id,r=o.checked,a=this.options.falseValue;r&&(a=this.options.trueValue);var n=this.mainGrid.dataList._getCellData(e,this.colID);""!=n||r||(a=n);var l=null;if((l={})[this.mainGrid.id]=!0,this.mainGrid._isGridViewItemTable()||this.mainGrid.dataList.__setCellData(e,this.colID,a,null,null,null,l),"0"==t.getAttribute("colMerged")&&this.setMergedCol(e,s,n,a),n!=a&&!i){var h={oldValue:n,newValue:a,rowIndex:e,colIndex:this.mainGrid.getColumnIndex(this.options.id)};d.B.fireEvent(this.mainGrid,"onviewchange",h)}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}return!0},A.checkbox.prototype.checkHeader=function(){try{return this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID])}catch(t){r.w.printStackTrace(t,null,this)}},A.checkbox.prototype.doDefaultAction=function(t){if(!this.options.embeddedInput){var e=d.B.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(e.focus();e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID}else i=this.mainGrid.getLastFocusedCell().focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.colID;var r=!1;if(!this.mainGrid._getEditDisabled(i,s)&&!this.mainGrid.___getEditReadOnly(i,s)){var a,n,l=e.getElementsByTagName("input")[0];l&&(l.checked?(a=this.options.falseValue,l.checked=!1):(a=this.options.trueValue,l.checked=!0),n=this.mainGrid.dataList._getCellData(i,s)),this.handleClick(e,i,!0),a!=n&&d.B.fireEvent(this.mainGrid,"onviewchange",{oldValue:n,newValue:a,rowIndex:o,colIndex:this.mainGrid.getColumnIndex(s)}),r=!0}this.mainGrid.checkHeader(this.mainGrid.bodyToHeaderRelation[this.colID]),this.mainGrid.options.preventMultipleClick&&r&&d.B.fireEvent(this.mainGrid,"oncellclick",i,s,this.options.id)}},A.checkbox.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){r.w.printStackTrace(t,null,this)}},A.button=function(){},A.button.prototype.setInnerHTML=function(t,e,i){this.mainGrid._getEditDisabled(i,t.getAttribute("col_id"));var o=-1,s=" tabIndex='"+o+"' ";"none"==this.mainGrid.options.focusMode?o=0:1==this.mainGrid.options.keyMoveEditMode&&(s="");var n,l=this.mainGrid.getColumnIndex(t.getAttribute("col_id"));if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var h=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof h&&(this.mainGrid.options.titleFormatter=h,n=h.call(this,i,l,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,l,e)}catch(t){
r.w.printStackTrace(t,null,this)}var u=n||this.options.title||"";u?u=" title='"+u+"'":this.mainGrid.options.titleAuto&&(u=" title='"+(this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"")+WebSquare.language.getMessage("Grid_button")+"'");if(t.innerHTML="<button type='button' style='width:100%;height:100%' "+s+u+">"+this.getDisplayData(e)+"</button>",1==this.internal){var p=t.childNodes[0];if(0==p.clientHeight){var c=t.clientHeight-2;WebSquare.style.setSize(p,"height",c)}}var g,f,m;l=this.mainGrid.getColumnIndex(t.getAttribute("col_id"));this._listener=(g=this,f=[i,l,t],m=function(t,e,i,o){this.mainGrid._getEditDisabled(e,i)||this.mainGrid.___getEditReadOnly(e,i)||(null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit(),this.options.blockSelect||this.mainGrid.__setFocusedCell(t,o,{editMode:"none"==this.options.focusMode})),this.mainGrid._getEditDisabled(e,i)||d.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(e),i,this.options.id)},function(t){m.apply(g,[t||window.event].concat(f))}),d.B.addListener(t.getElementsByTagName("button")[0],"onclick",this._listener)},A.button.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.mainGrid.getColumnIndex(e.getAttribute("col_id"))}else{var r=this.mainGrid.getLastFocusedCell();i=r.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.focusedColIndex}this.mainGrid._getEditDisabled(i,s)||this.mainGrid.___getEditReadOnly(i,s)||d.B.fireEvent(this.mainGrid,"oncellclick",o,s,this.options.id)},A.image=function(){},A.image.prototype.setInnerHTML=function(t,e,i,o,s){var n="";""!=this.options.imageWidth&&(n+=";width:"+parseInt(this.options.imageWidth)+"px"),""!=this.options.imageHeight&&(n+=";height:"+parseInt(this.options.imageHeight)+"px"),t.removeAttribute("alt");var l="";""!=this.options.alt&&(l="alt='"+this.options.alt+"' ");var h=this.mainGrid._getEditDisabled(i,t.getAttribute("col_id")),u="";h&&(u=" disabled='true' "),null==e||""==e?e=this.options.imageSrc?this.options.imageSrc.startsWith("javascript:void")?this.options.imageSrc:this.mainGrid.getImageURL(this.options.imageSrc):"":"string"!=typeof e||e.startsWith("javascript:void")||(e=this.mainGrid.getImageURL(e));var p="";try{this.options.onerror&&(p=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){r.w.printStackTrace(t,null,this)}var c,g=this.options.imageTabIndex?" tabIndex='"+this.options.imageTabIndex+"'":"";if(this.mainGrid.options.senseReader&&this.mainGrid.options.focusImage?t.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(h?" w2grid_image_disabled":"")+"' style='"+n+"' "+l+u+p+g+"tabIndex='0' />":t.innerHTML="<IMG src='"+e+"' class='w2grid_image"+(h?" w2grid_image_disabled":"")+"' style='"+n+"' "+l+u+p+g+" />",this.options.imageClickFunction&&(c=this.mainGrid._getEditDisabled(i,o)),this.options.imageClickFunction&&(this.options.useImageClick||0==c)){var f=t.firstChild,m=function(t,e,i){return function(o){d.B.stopPropagation(o),t._setFocusedCell(e,i),t.fireImageClick(e,i)}}(this.mainGrid,i,this.colID);d.B.addListener(f,"onclick",m)}if(this.mainGrid.options.titleFormatter)try{var y;o=this.mainGrid.getColumnIndex(t.getAttribute("col_id"));if("function"!=typeof this.mainGrid.options.titleFormatter){var b=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof b&&(this.mainGrid.options.titleFormatter=b,y=b.call(this,i,o,e))}else y=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",y)}catch(t){r.w.printStackTrace(t,null,this)}},A.image.prototype.getDisplayData=function(t){return t},A.radio=function(){},A.radio.prototype.initializeCellInfo=function(t){switch(this.options.valueType){case"binary":this.setBooleanValue("1","0");break;case"boolean":
this.setBooleanValue("true","false");break;case"other":this.setBooleanValue(this.options.trueValue,this.options.falseValue)}if(this.options.groupRef&&(this.options.groupValue=WebSquare.ModelUtil.getInstanceValue(this.options.groupRef,null,this.scope_id)),this.options.radioLabelColumn)for(var e=this.options.radioLabelColumn.split(","),i=0;i<e.length;i++){var o=e[i];this.mainGrid.getColumnIndex(o)&&this.mainGrid.setLabelColumnAssociation(e[i],this.id)}},A.radio.prototype.setBooleanValue=function(t,e){this.options.trueValue=t+"",this.options.falseValue=e+""},A.radio.prototype.setInnerHTML=function(t,e,i){var o,s,n,l,h=this.mainGridId+"_radio_"+(this.options.groupName?this.options.groupName+"_"+i:this.colID),p=e+""==this.options.trueValue;if(o=this.options.noDisabledOnReadOnly?this.mainGrid._getEditDisabled(i,t.getAttribute("col_id")):this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,t.getAttribute("col_id")),this.options.embeddedInput){var c=this.mainGrid.getInput(this,t,p);c.setAttribute("rowindex",i),c.checked=!1,c.name=h,c.checked=p,c.disabled=o}else{var g,f;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var m=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof m&&(this.mainGrid.options.titleFormatter=m,f=this.mainGrid.getColumnIndex(this.options.id),g=m.call(this,i,f,e))}else g=this.mainGrid.options.titleFormatter.call(this,i,f,e)}catch(t){r.w.printStackTrace(t,null,this)}var y=g||this.options.title||"";if(y)y=" title='"+y+"'";else if(this.mainGrid.options.titleAuto){var b=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||"";y=p?" title='"+b+WebSquare.language.getMessage("Grid_title")+"'":" title='"+b+WebSquare.language.getMessage("Grid_title_not_choose")+"'"}var w="none"==this.mainGrid.options.focusMode?"":" tabIndex='-1'",v=p?" checked":"",I=o?" disabled='true'":"",C="";if(this.options.radioLabel||this.options.radioLabelColumn||this.options.radioLabelFormatter){var x=this.mainGridId+"_radio_"+this.id+"_"+i,_=this.options.radioLabel||"";if(this.options.radioLabelColumn){for(var S=this.options.radioLabelColumn.split(","),D="",R=this.options.radioLabelDelimiter||this.mainGrid.options.labelDelimiter||" ",L=0;L<S.length;L++)L===S.length-1?D+=this.mainGrid._getCellDisplayData(i,S[L]):D+=this.mainGrid._getCellDisplayData(i,S[L])+R;_=_?D+R+_:D}if(this.options.radioLabelFormatter)try{var T=a.D.getGlobalFunction(this.options.radioLabelFormatter,this.scope_id);"function"==typeof T&&(_=T.call(this.mainGrid,i,this.mainGrid.getColumnIndex(this.colID),_))}catch(t){u.k.printLog(this.mainGrid.id+"_"+this.id+" radioLabelFormatter error : "+t.message)}_&&this.mainGrid.options.titleAuto&&!this.options.title&&(y=y.substring(0,y.length-1)+" "+_+"'"),C="<INPUT type='radio' "+y+w+v+I+" id='"+x+"' name='"+h+"'/>";var k="<label class='w2radio_label ' for='"+x+"'>"+_+"</label>";"left"===this.options.radioLabelPosition?C=k+C:C+=k}else C="<INPUT type='radio' name='"+h+"'"+y+w+v+I+" />";if(t.innerHTML=C,this.options.noDisabledOnReadOnly)(A=t.getElementsByTagName("input")[0])&&(d.B.addListener(A,"onclick",function(t,e,i){return function(o){t.options.noDisabledOnReadOnly&&t.mainGrid._getEditReadOnly(e,i)&&d.B.preventDefault(o)}}(this,i,this.getColumnIndex(this.options.id))),this.mainGrid._getEditReadOnly(i,this.options.id)?this.mainGrid.addClass(A,this.mainGrid.options.readOnlyClass+"_nodisabled"):this.mainGrid.removeClass(A,this.mainGrid.options.readOnlyClass+"_nodisabled"));if(this.mainGrid.options.preventDuplicateFocusedCell&&this.mainGrid.options.preventMultipleClick){var A=t.getElementsByTagName("input")[0],F=t.getElementsByTagName("label")[0];this.labelClicked=!1,A&&d.B.addListener(A,"onclick",(s=this,n=[i,t],l=function(t,e,i){i=this.labelClicked?0:1,this.labelClicked=!1;var o,s,r,a,n,l,h,u=null!=this.mainGrid.editedCell;if(u&&(o=this.mainGrid.editedCell.editRowIndex,
s=this.mainGrid._dataList.getColumnIndex(this.mainGrid.editedCell.id),h=this.mainGrid.getCellInfo(this.mainGrid.editedCell.id),r=this.mainGrid.getColumnIndex(this.mainGrid.editedCell.id),a=this.mainGrid._grid.getRealRowIndex(o),n=this.mainGrid._dataList.dataArr[a*this.mainGrid._dataList.getColumnCount()+s],l=h.comp&&h.comp.selectedIndex),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&this.mainGrid._addFocus(e):this.mainGrid._addFocus(e)),this.handleClick(e,t),this.options.blockSelect||(this.mainGrid.options.preventDuplicateFocusedCell&&"linear"===this.mainGrid.options.focusFlow?1==i&&(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode})):(this.mainGrid.focusedCell.pop(),this.mainGrid.__setFocusedCell({},e,{editMode:"none"==this.options.focusMode}))),this.mainGrid.options.preventMultipleClick&&!this.mainGrid._getEditDisabled(t,f)&&d.B.fireEvent(this.mainGrid,"oncellclick",this.mainGrid._getGroupbyDisplayRowIndex(t),this.mainGrid.getColumnIndex(this.options.id),this.options.id,{checked:p}),u){var c=this.mainGrid._dataList.dataArr[a*this.mainGrid._dataList.getColumnCount()+s];if(n!=c){var g={oldValue:n,newValue:c,rowIndex:o,colIndex:r};isNaN(l)||(g.oldSelectedIndex=l,g.newSelectedIndex=h&&h.comp&&h.comp.selectedIndex),d.B.fireEvent(this.mainGrid,"onviewchange",g)}}},function(t){s.options.eventPropagation||d.B.stopPropagation(t),n[2]=t.detail,l.apply(s,n,t)})),F&&d.B.addListener(F,"onclick",function(t,e,i){return function(o){i.apply(t,e,o)}}(this,[i,t],(function(t,e){this.labelClicked=!0})))}}},A.radio.prototype.getDisplayData=function(t){return t},A.radio.prototype.handleClick=function(t,e){var i=t.getElementsByTagName("input")[0];if(!i)return!0;if(this.options.noDisabledOnReadOnly&&this.mainGrid._getEditReadOnly(e,this.colID))return!0;this.mainGrid.options.preventDuplicateFocusedCell&&null!=this.mainGrid.editedCell&&this.mainGrid.editedCell.handleEndEdit();var o=this.mainGrid.dataList._getCellData(e,this.colID),s=o;if(o==this.options.trueValue)return!0;if(i.checked&&(s=this.options.trueValue,this.resetOthers(e),this.options.groupName&&this.mainGrid.radioGroupRepChk[this.options.groupName]&&this.mainGrid.dataList.__setCellData(e,this.options.groupName,this.options.groupValue)),this.mainGrid.dataList.__setCellData(e,this.colID,s),"0"!=t.getAttribute("colMerged")||this.mainGrid.groupbyStatus.grouped||this.setMergedCol(e,this.colID,o,s),o!=s){var r={oldValue:o,newValue:s,colIndex:this.mainGrid.getColumnIndex(this.options.id),rowIndex:e};d.B.fireEvent(this.mainGrid,"onviewchange",r)}return!0},A.radio.prototype.resetOthers=function(t){if(this.options.groupName)for(var e=this.mainGrid.getColumnCount(),i=0;i<e;i++){var o=this.mainGrid.getCellInfo(i);"custom"==o.options.inputType&&(o=o.cellManagerHashByRowIndex[this.mainGrid.dataList.getRealRowIndex(t)]),o!=this&&"radio"==o.options.inputType&&o.options.groupName==this.options.groupName&&this.mainGrid.dataList.__setCellData(t,i,o.options.falseValue)}else if(this.mainGrid.isDrillDown&&this.mainGrid._dataList.options.depthColumn)for(var s=0;s<this.mainGrid.getTotalRow();s++)this.mainGrid._dataList.getCellData(s,this.colID)+""==this.options.trueValue&&this.mainGrid._dataList.setCellData(s,this.colID,this.options.falseValue);else for(s=0;s<this.mainGrid.getDataLength();s++)this.mainGrid.dataList._getCellData(s,this.colID)+""==this.options.trueValue&&this.mainGrid.dataList.__setCellData(s,this.colID,this.options.falseValue)},A.radio.prototype.doDefaultAction=function(t){var e=d.B.getTarget(t);if("none"==this.mainGrid.options.focusMode){for(;e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid.getColumnIndex(e.getAttribute("col_id"))}else{var s=this.mainGrid.getLastFocusedCell();i=s.focusedRowIndex,o=s.focusedColIndex}if(!this.mainGrid._getEditDisabled(i,o)&&!this.mainGrid.___getEditReadOnly(i,o)){
var r=this.mainGrid.dataList._getCellData(i,this.colID);("INPUT"==e.tagName.toUpperCase()?e:e.getElementsByTagName("input")[0]).checked=r==this.options.trueValue?this.options.falseValue:this.options.trueValue,this.handleClick(e,i)}},A.radio.prototype.refreshCell=function(){try{if(!this.options.refInitSync||"other"!==this.options.valueType)return;for(var t=this.mainGrid._dataList.getRowCount(),e=0;e<t;e++){this.mainGrid._dataList.getCellData(e,this.colID)!=this.options.trueValue&&this.mainGrid._dataList.setCellData(e,this.colID,this.options.falseValue)}}catch(t){r.w.printStackTrace(t,null,this)}},A.select=function(){},A.select.prototype._initializeCellInfo=function(){try{this.col_index=this.mainGrid.getColumnIndex(this.colID),"auto"===this.options.renderType&&a.D.isMobile()&&!0!==this.options.embeddedInput&&(this.options.embeddedInput=!0)}catch(t){r.w.printStackTrace(t,null,this)}},A.select.prototype._createComponent=function(t){try{if(this.comp)return;var e=this;if(this.xml.setAttribute("class",this.mainGridId+"_select_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("chooseOptionValue",this.options.chooseOptionValue),this.xml.setAttribute("allOption",this.options.allOption+""),this.xml.setAttribute("tableRender",this.options.tableRender),this.xml.setAttribute("submenuSize",this.options.submenuSize?this.options.submenuSize:"auto"),this.xml.setAttribute("direction","auto"),this.xml.setAttribute("style",this.style),this.setFirst=!0,this.hasRef&&!this.useLinkedDataList)WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.setFirst=!1,this.configOptions.chooseOption=this.options.chooseOption,this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel,this.configOptions.labelWidthAuto=!1,this.configOptions.displayMode=this.options.displayMode,this.configOptions.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay,this.configOptions.itemTooltipFormatter=this.options.itemTooltipFormatter,this.options.itemTooltipFormatter&&(this.configOptions._rowIndex=t,this.configOptions._colIndex=this.mainGrid.getColumnIndex(this.colID)),this.configOptions.tooltipTime=this.options.tooltipTime,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.configOptions.tableRender=this.options.tableRender,this.internal&&(this.options.visibleRowNum&&(this.configOptions.visibleRowNum=this.options.visibleRowNum),this.options.textAlign&&(this.configOptions.textAlign=this.options.textAlign),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions));var i=this.internal?this.mainGridId+"_selectbox_"+t+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;this.internal&&this.options.emptyItem&&(this.configOptions.emptyItem=this.options.emptyItem),this.select=new WebSquare.uiplugin.selectbox(i,this.configOptions,this.xml),this.mainGrid.dom[this.select.id]=this.select,this.comp=this.select,this.select.setSelectedIndex1=function(t,i){void 0!==i&&null!=i||(i={});var o=this.selectedIndex,s=this.getValue(),r=e.mainGrid.getColumnIndex(e.mainGrid.editedCell.id);if(this.setSelectedIndex(t),"oneditend"===e.options.eventPriority){if(!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit()),o!=this.selectedIndex){var a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r};d.B.fireEvent(e.mainGrid,"onviewchange",n)}}else{if(o!=this.selectedIndex){a=e.editRowIndex,n={oldValue:s,newValue:this.getValue(),oldSelectedIndex:o,
newSelectedIndex:this.selectedIndex,rowIndex:a,colIndex:r};d.B.fireEvent(e.mainGrid,"onviewchange",n)}!0!==i.skipClose&&(this.closeSubLayer(),e.handleEndEdit())}},this.existGridViewItemsetNode&&(this.select._setSubLayer=this.select.setSubLayer,this.select.setSubLayer=function(t){this._setSubLayer(t),this.itemTable.addKeyDownEventListener((function(t){switch(t.keyCode){case 27:e.handleCancelEdit(t)}}))}),this.select.__openSubLayer=this.select.openSubLayer,this.select.openSubLayer=function(){this.__openSubLayer()},this.select.__closeSubLayer=this.select.closeSubLayer,this.select.closeSubLayer=function(t){this.__closeSubLayer(t),e.mainGrid._setFocusedCell()},this.select._handleClickEvent=this.select.handleClickEvent,this.select.handleClickEvent=function(t){this._handleClickEvent(t),d.B.stopEvent(t),e.handleEndEdit()},this.select._refreshItemset=this.select.refreshItemset,this.select.refreshItemset=function(t){e.resetMatchInfo=!0,!0!==this.refreshStopItemTable&&this._refreshItemset(t)}}catch(t){r.w.printStackTrace(t,null,this)}},A.select.prototype.createSelectbox=function(t,e){this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this._createComponent(e),t.innerHTML=this.select.toHTML();try{!this.select.modelControl.isBinded()&&-1===this.select.selectedIndex&&this.select.getItemCount()>0&&!this.select.options.chooseOption&&this.select.options.allOption}catch(t){}if(this.select.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),""!=this.options.selectSetter)for(var i=0;i<this.itemArr.length;i++)this.select.addItem(this.itemArr[i].value,this.itemArr[i].label);this._setSize(t),this.select.render.style.border="1px solid "+this.mainGrid.options.selectedCellColor},A.select.prototype._setSize=function(t){try{var e={top:0,left:0,bottom:0,right:0};if(a.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(e.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),e.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),e.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),e.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else{var i=WebSquare.style.getComputedStyle(t);i&&(i.padding||i.paddingTop||i.paddingBottom||i.paddingLeft||i.paddingRight)&&(e.left=parseInt(i.paddingLeft,10),e.right=parseInt(i.paddingRight,10),e.top=parseInt(i.paddingTop,10),e.bottom=parseInt(i.paddingBottom,10))}this.select.setSize(t.clientWidth-(2+e.left+e.right),t.clientHeight-(2+e.top+e.bottom))}catch(t){r.w.printStackTrace(t,null,this)}},A.select.prototype.createItemTable=function(t,e){var i=this;this.existGridViewItemsetNode&&this.select._openOtherLayer(),this.select.setSubLayer();var o=this.select.itemTable;this.existGridViewItemsetNode||(o.addClickEventListener((function(t,e){i.select.setSelectedIndex1(e);var o=i.mainGrid.getLastFocusedCell();if(i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell(),i.options.moveEditModeByChoice){var s=i.options.moveEditModeByChoice;switch(s){case"down":i.mainGrid.moveVertical({},s,true);break;case"right":i.mainGrid.moveHorizontal({byApi:!0},s,true)}}})),o.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:if("ul"==this.options.tableRender){var e=this.getSelectedIndex();e=parseInt(e),this.endReached&&(this.endReached=!1,i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid._setFocusedCell())}else{this.fireClick(t);var o=i.mainGrid.getLastFocusedCell();i.editRowIndex==o.focusedRowIndex&&i.col_index==o.focusedColIndex&&i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode)}break;case 13:o=i.mainGrid.getLastFocusedCell()
;i.editRowIndex!=o.focusedRowIndex||i.col_index!=o.focusedColIndex||i.options.moveEditModeByChoice||(i.mainGrid.options.fastEditMode?"none"==i.mainGrid.options.enterKeyMove||("right"==i.mainGrid.options.enterKeyMove?i.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",i.mainGrid.options.keyMoveEditMode):i.mainGrid.moveVertical(t,t.shiftKey?"up":"down",i.mainGrid.options.keyMoveEditMode)):i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell());break;case 27:i.mainGrid.editedCell.handleCancelEdit(t),i.mainGrid.isVirtualCursor()||i.mainGrid._setFocusedCell()}}))),a.D.isOpera()&&o.event.addListener(o.render,"onkeypress",(function(t){9!=t.keyCode&&27!=t.keyCode||d.B.preventDefault(t)})),this.mainGrid._moveKeyEdit(o.uuid,"keyDownFunc",{itemTable:!0}),WebSquare.WebSquaredoc.itemsetElement.length>0&&WebSquare.WebSquaredoc.itemsetElement[WebSquare.WebSquaredoc.itemsetElement.length-1].id==this.mainGridId+"_selectbox_"+this.colID&&WebSquare.WebSquaredoc.itemsetElement.pop()},A.select.prototype.setInnerHTML=function(t,e,i,o,s){var n=this.mainGrid._getGroupbyDisplayRowIndex(i);if(this.options.embeddedInput){var l=this.mainGrid.getInput(this,t,e);if(l.render.setAttribute("rowindex",i),""==this.options.selectSetter||this.dataComp||(this.initSelectSetter(),l.itemArr=this.itemArr,l.setSelectOptions()),this.hasRef&&!this.dataComp){var h=this.mainGrid.getElemRowIndex(t);l.itemArr=this.getRefItemArr(h),l.setSelectOptions()}if(this.dataComp){var u=this.mainGrid.modelControl.getDataComp(this.dataComp);if("linkedDataList"===u.initializeType&&null!=u.conditionInfo&&u.conditionInfo.filterInfo.useRef){var p=u.conditionInfo.targetInfo,c={};for(var g in p){var f=this.mainGrid.modelControl.getDataComp(g);if(f&&null!=f.initializeType&&"dataMap"!==f.initializeType){var m=f.getRowPosition();m!=i&&(c[g]=m,"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[i]:f.rowPosition=i)}}for(var y in l.stopRefreshItemTable(!0),u.syncWithParent(),l.stopRefreshItemTable(!1),c){var b=this.mainGrid.modelControl.getDataComp(y);"linkedDataList"===b.initializeType?b._dataList.rowPosition=b.filteredRowIndexArr[c[y]]:b.rowPosition=c[y]}for(var w=u.getAllJSON(),v=[],I=0;I<w.length;I++)v.push({label:w[I][this.itemsetObj.label],value:w[I][this.itemsetObj.value]});l.setNodeSet("",this.itemsetObj.label,this.itemsetObj.value),l.itemArr=v,l.setSelectOptions()}}if(l.setValue(e),!l.setValueNM(e)&&!this.dataComp){var C={};C[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(l.render.getAttribute("rowindex"),o,l.getValue(),null,null,null,C)}if("function"==typeof(S=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id))){this.useCustomFormatter=!0;var x=S.call(this.mainGrid,e,D,n,o);l.dom.label.innerHTML=x}var _=!1;this.mainGrid._getEditDisabled(i,o)?(l.setDisabled(!0),_=!0):l.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?(l.setReadOnly(!0),_=!0):l.setReadOnly(!1),l.dom.select.disabled=!!_,t.removeAttribute("tabIndex")}else{this.initSelectSetter();var S;h=i;if(null==e&&(e=""),"function"==typeof(S=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id))){this.useCustomFormatter=!0;var D=this.getDisplayData(e,h);x=S.call(this.mainGrid,e,D,n,o)}else this.useCustomFormatter=!1,x=this.getData(e,h);var R,L=this.internal?this.mainGridId+"_selectbox_"+i+"_"+this.colID+"_"+this.id:this.mainGridId+"_selectbox_"+this.colID;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var T=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof T&&(this.mainGrid.options.titleFormatter=T,R=T.call(this,i,o,e))}else R=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){r.w.printStackTrace(t,null,this)}var k,A=R||this.options.title||"";if(A)t.setAttribute("title",A);else if(this.mainGrid.options.titleAuto){var F=this.mainGrid.getHeaderValue(this.mainGrid.bodyToHeaderRelation[this.id])||""
;A=""!==e?" title='"+F+" "+e+"'":" title='"+F+WebSquare.language.getMessage("Grid_select")+"'"}if(a.D.isSafari()&&-1!=navigator.userAgent.indexOf("Windows"))if(this.mainGrid.options.plainText&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=x;else t.innerHTML="",(k=document.createElement("nobr")).style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:100%;","ul"==this.options.tableRender?k.innerHTML="<a href='#"+L+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+A+">"+x+"</a>":k.textContent=x,t.appendChild(k);else if(this.mainGrid.options.plainText&&t.firstChild&&t.firstChild.firstChild)t.firstChild.firstChild.data=x;else if("icon"==this.options.viewType)t.innerHTML="",(k=document.createElement("nobr")).style.cssText="overflow : hidden; text-overflow:ellipsis; display:block; width:auto;","ul"==this.options.tableRender?k.innerHTML="<a href='#"+L+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+A+">"+x+"</a>":k.innerHTML=x,t.appendChild(k);else if("ul"==this.options.tableRender)t.innerHTML="<nobr style='overflow : hidden; text-overflow:ellipsis; display:block; width:auto;'><a href='#"+L+"_itemTable' onclick='event.returnValue=false; return false;' class='w2selectbox_ul_table_main'"+A+">"+x+"</a></nobr>";else{var E=t.firstChild,M="w2grid_select";if(this._checkFastScroll(x,E,M,s&&!0===s.scroll)){var O="string"==typeof x?WebSquare.xml.__decode(x):x;E.textContent=O}else t.innerHTML="<nobr class='w2grid_select'>"+x+"</nobr>"}var N=this.mainGrid.dataList.getRealRowIndex(i),B=this.mainGrid.getCellOption(N,o,"viewType"),G=this.mainGrid.getColumnOption(this.options.col_id,"dataType");if("icon"==B||""==B&&"own"==G?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute("editModeEvent",this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute("editModeEvent","onclick"):"ondblclick"==this.options.editModeEvent?t.setAttribute("editModeEvent","ondblclick"):"onsecondclick"==this.options.editModeEvent?t.setAttribute("editModeEvent","onsecondclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_select"),t.setAttribute("editModeEvent","")),"ul"==this.options.tableRender){var H=this;this.mainGrid.event.addListener(t,"onfocus",this.mainGrid.event.bindAsEventListener(this.mainGrid,(function(t){var e=d.B.getTarget(t);H.mainGrid.lastEvent=t;var o=H.mainGrid.getLastFocusedCell();if((0!=o.focusedColIndex||0!=o.focusedRowIndex)&&(!a.D.isIEAllVersion()||!o.focusedRowIndex||o.focusedRowIndex==i)&&(o.focusedTd==e||H.mainGrid.focusedByApi||H.mainGrid._setFocusedCell(i,e.getAttribute("col_id")),H.mainGrid.focusedByApi=!1,e.childNodes[0]&&e.childNodes[0].childNodes[0])){var s=e.childNodes[0].childNodes[0];"A"==s.tagName&&s.focus()}})))}}},A.select.prototype.setColumnChooseOption=function(t,e){this.options.chooseOption=!0,this.options.chooseOptionValue=t,this.options.chooseOptionLabel=e,this.select&&this.select.changeChooseOption(t,e)},A.select.prototype.showChooseOption=function(t){this.options.chooseOption=t,this.matchInfo=this.setMatchInfo(),this.select&&t?this.select.showChooseOption(t):this.select&&!t&&(this.select.showChooseOption(t),this.select.itemArr.length>1&&0!=this.select.selectedIndex?this.select.selectedIndex-=1:this.select.selectedIndex=0,this.editTd.innerHTML="<nobr>"+this.getData(this.select.getValue(),this.select.selectedIndex)+"</nobr>")},A.select.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice("data:".length))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u)
;if(p&&null!=p.initializeType&&"dataMap"!==p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in this.select&&this.select.stopRefreshItemTable(!0),o.syncWithParent(),this.select&&this.select.stopRefreshItemTable(!1),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var w=m.getTotalRow();y=[];for(var v=0;v<w;v++)y.push(v)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}var I=!1;if("linkedDataList"===o.initializeType&&this.select){var C=this.select.getItemCount(),x=this.select.itemArr;0===C?I=!0:1!=C||x[0].label!==this.select._getChooseOptionLabel()&&x[0].label!==this.select.defaultAllOptionLabel?2==C&&x[0].label===this.select._getChooseOptionLabel()&&x[1].label===this.select.defaultAllOptionLabel&&(I=!0):I=!0}if((!this.select||I)&&null!=m)try{var _,S;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)_=this.itemsetObj.label,S=this.itemsetObj.value;else{var D=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",s.v._XML_NAMESPACE.W2),R=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",s.v._XML_NAMESPACE.W2);D.length>0&&R.length>0&&(_=WebSquare.Elem.api.getAttribute(D[0],"ref"),S=WebSquare.Elem.api.getAttribute(R[0],"ref"))}var L=null!=_?m.bodyIdColIndexMap[_]:m.bodyIdColIndexMap[this.itemsetObj.label],T=null!=S?m.bodyIdColIndexMap[S]:m.bodyIdColIndexMap[this.itemsetObj.value];for(v=0;v<y.length;v++){var k=y[v]*m.cellIdList.length;if(t==m.dataArr[k+T])return a=m.dataArr[k+L],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a}if(this.selectedIndex>=0&&this.selectedIndex<b.length&&!this.options.chooseOption){a=m.dataArr[b[this.selectedIndex]*m.cellIdList.length+L],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var A=this.mainGrid._dataList.cellIdList.length,F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID],E=m.dataArr[y[this.selectedIndex]*m.cellIdList.length+T];this.mainGrid._dataList.dataArr[k*A+F]=E}else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-전체-"}else if(this.options.chooseOption)t==this.options.chooseOptionValue&&(a=this.options.chooseOptionLabel);else if(this.options.selectedData)if(""==t)a="";else{k=0;k=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];A=this.mainGrid._dataList.cellIdList.length,F=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[k*A+F]="",a=""}else a=t;return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a}catch(e){return r.w.printStackTrace(e,null,this),t}var M=!1;for(v=0;v<this.select.itemArr.length;v++)if(this.select.itemArr[v].value==t){M=!0,a=this.select.itemArr[v].label;break}
if(!M&&o.options&&o.options.validateAllItemsetData)for(v=0;v<this.select.allItemArr.length;v++)if(this.select.allItemArr[v].value==t){M=!0,a=this.select.allItemArr[v].label;break}if(!M)if(""!=t||-1==this.selectedIndex||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-전체-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=t);else this.select.itemArr.length>0?(a=this.select.itemArr[this.selectedIndex].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)):a=t}else{var O=this.getMatchInfo(e);""!=t||-1==this.selectedIndex||this.options.chooseOption?a=O["SELECT_"+t]:(this.mainGrid.dataList.__setCellData(e,t),a=O["SELECT_"+this.itemArr[this.selectedIndex].label])}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a}catch(t){r.w.printStackTrace(t,null,this)}},A.select.prototype.initSelectSetter=function(){if(0==this.selectSetted&&""!=this.options.selectSetter&&!this.dataComp){this.selectSetted=!0;var t=[];try{this.options.selectSetter=this.options.selectSetter.wq_trim(),this.options.selectSetter.indexOf("(")<0&&(this.options.selectSetter+="()"),t=new Function("return "+this.options.selectSetter)()}catch(t){r.w.printStackTrace(t)}this.itemArr=t,this.matchInfo=[];for(var e=0;e<t.length;e++){var i=t[e];null==i.value&&(i.value=""),this.matchInfo["SELECT_"+i.value]=i.label}}},A.select.prototype.setEditMode=function(t,e){if(!this.options.embeddedInput){if(this.dataComp){var i=this.mainGrid.modelControl.getDataComp(this.dataComp);i&&"linkedDataList"===i.initializeType&&null!=i.conditionInfo&&i.conditionInfo.filterInfo.useRef&&i.syncWithParent()}if(!0!==this._init?(this.createSelectbox(t,e),this._init=!0):(t.innerHTML="",this.mainGrid.cellMergeInfo&&this._setSize(t),t.appendChild(this.select.render),this.options.itemTooltipFormatter&&(this.select.options._rowIndex=e)),this.mainGrid.directItemChoiceKeyObj.select){this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID));var o=this.select.findItemStartedWithKeyChar(this.mainGrid.directItemChoiceKeyObj.select);if(this.mainGrid.dataList.__setCellData(e,this.colID,this.select.getValue()),this.mainGrid.directItemChoiceKeyObj.select=null,this.options.moveFocusByChoice&&o&&this.moveFocus(this.editRowIndex,this.colID),o)return;this.mainGrid.editedCell=this.mainGrid.getCellInfo(t),t.innerHTML="",t.appendChild(this.select.render)}if(this.select.itemTable||this.mainGrid.directItemChoiceKeyObj.select||(this.existGridViewItemsetNode&&(this.editTd=t),this.createItemTable(t,e)),this.hasRef&&!this.dataComp){var s=this.mainGrid.getElemRowIndex(t);this.select.itemArr=this.getRefItemArr(s),this.select.itemTable.show(),this.select.setSelectOptions()}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.select.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),0==this.select.getItemCount()&&(this.select.selectedIndex=-1,this.select.dom.label.innerHTML=""),this.existGridViewItemsetNode&&this.select.gridViewOptions.width)this.select.openSubLayer();else{var r=t.clientWidth-2,n={top:0,left:0,bottom:0,right:0};if(a.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(n.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),n.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),n.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),n.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(n.left=parseInt(u.paddingLeft,10),n.right=parseInt(u.paddingRight,10),n.top=parseInt(u.paddingTop,10),
n.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+n.left+n.right),t.clientHeight-(2+n.top+n.bottom)),this.select.itemTable.setStyle("width",t.clientWidth-4+"px"),this.select.openSubLayer();var l=this.mainGrid.render.offsetWidth,h=this.select.itemTable.render.offsetWidth,d=this.select.itemTable.render.firstChild.offsetWidth;if(h-2>r&&(r=h-2),this.select.itemTable.render.clientHeight>=this.select.itemTable.render.scrollHeight||this.select.getItemCount()<=this.select.options.visibleRowNum)this.select.itemTable.render.firstChild.style.width=r+"px",l>h&&d<h&&this.select.itemTable.render.firstChild.firstChild&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=r&&this.select.itemTable.setStyle("width",r+"px");else{this.select.itemTable.render.firstChild.style.width=r-17+"px";var u;n={top:0,left:0,bottom:0,right:0};if(a.D.isIEAllVersion("6 7 8"))WebSquare.style.getComputedStyle(t,"padding")&&(n.left=parseInt(WebSquare.style.getComputedStyle(t,"padding-left"),10),n.right=parseInt(WebSquare.style.getComputedStyle(t,"padding-right"),10),n.top=parseInt(WebSquare.style.getComputedStyle(t,"padding-top"),10),n.bottom=parseInt(WebSquare.style.getComputedStyle(t,"padding-bottom"),10));else(u=WebSquare.style.getComputedStyle(t))&&(u.padding||u.paddingTop||u.paddingBottom||u.paddingLeft||u.paddingRight)&&(n.left=parseInt(u.paddingLeft,10),n.right=parseInt(u.paddingRight,10),n.top=parseInt(u.paddingTop,10),n.bottom=parseInt(u.paddingBottom,10));this.select.setSize(t.clientWidth-(2+n.left+n.right),t.clientHeight-(2+n.top+n.bottom)),l>h&&d+17<=h-2&&this.select.itemTable.render.firstChild.firstChild.offsetWidth<=r&&this.select.itemTable.setStyle("width",r+"px")}}t.style.textOverflow="ellipsis"}},A.select.prototype._handleEndEdit_common=function(t){try{this.select.closeSubLayer();var e=this.select.getValue();try{this.select.render.parentNode&&this.editTd.removeChild(this.select.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.select.prototype._handleEndEdit_focus=function(){this.options.moveFocusByChoice&&this.moveFocus(this.editRowIndex,this.colID)},A.select.prototype._getEditedValue=function(t){return this.select.getValue()},A.select.prototype._handleCancelEdit=function(t){this.select.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.editTd.removeChild(this.select.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID))},A.select.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.select.prototype.moveFocus=function(t,e){if(this.options.moveFocusByChoice)switch(this.options.moveFocusByChoice){case"down":this.mainGrid._setFocusedCell(t+1,e,!1);break;case"right":var i=this.mainGrid.getColumnIndex(e)+1;this.mainGrid._setFocusedCell(t,i,!1)}},A.select.prototype.refreshCell=function(){try{if(!this.options.selectedData)return;if(!this.dataComp)return;var t=this.mainGrid.modelControl.getDataComp(this.dataComp);if(!t)return;var e,i=null,o=null;if("linkedDataList"===t.initializeType?(i=t._dataList,o=t.initialRowIndexArr):"dataList"===t.initializeType&&(o=(i=t).filteredRowIndexArr),null==i)return;if(this.internal)this.itemsetObj.label,e=this.itemsetObj.value;else{var a=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",s.v._XML_NAMESPACE.W2),n=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",s.v._XML_NAMESPACE.W2);a.length>0&&n.length>0&&(WebSquare.Elem.api.getAttribute(a[0],"ref"),e=WebSquare.Elem.api.getAttribute(n[0],"ref"))}var l,h=null!=e?i.bodyIdColIndexMap[e]:i.bodyIdColIndexMap[this.itemsetObj.value]
;l=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var d=this.mainGrid._dataList.cellIdList.length,u=this.mainGrid._dataList.bodyIdColIndexMap[this.id],p=0;p<l.length;p++){var c=l[p];if("object"!=typeof c){var g=this.mainGrid._dataList.dataArr[c*d+u];if(!(this.options.allOption&&g==WebSquare.allValue||this.options.chooseOption&&g==this.options.chooseOptionValue||!(""!==g||this.selectedIndex>=0))){var f=!1;if("linkedDataList"===t.initializeType&&null!=t.conditionInfo&&t.conditionInfo.filterInfo.useRef){var m=t.conditionInfo.targetInfo,y={};for(var b in m){var w=this.mainGrid.modelControl.getDataComp(b);if(null!=w.initializeType&&"dataMap"!=w.initializeType){var v=w.getRowPosition();v!=p&&(y[b]=v,"linkedDataList"===w.initializeType?w._dataList.rowPosition=w.filteredRowIndexArr[p]:w.rowPosition=p)}}var I=t.getBroadcast();for(var C in t.setBroadcast(!1),t.syncWithParent(),t.setBroadcast(I),y){var x=this.mainGrid.modelControl.getDataComp(C);"linkedDataList"===x.initializeType?x._dataList.rowPosition=x.filteredRowIndexArr[y[C]]:x.rowPosition=y[C]}o=t.initialRowIndexArr}for(var _=0;_<o.length;_++)if(g==i.dataArr[o[_]*i.cellIdList.length+h]){f=!0;break}if(!f){var S="";this.selectedIndex>=0&&this.selectedIndex<o.length&&!this.options.chooseOption&&(S=i.dataArr[o[this.selectedIndex]*i.cellIdList.length+h]),this.mainGrid._dataList.dataArr[c*d+u]=S}}}}}catch(t){r.w.printStackTrace(t,null,this)}},A.checkcombobox=function(){},A.checkcombobox.prototype._initializeCellInfo=function(){try{this.separator=this.options.separator||" "}catch(t){r.w.printStackTrace(t,null,this)}},A.checkcombobox.prototype.setInnerHTML=function(t,e,i,o,s){null==e&&(e=""),t.innerHTML="<nobr>"+this.getData(e,i)+"</nobr>";var n,l=this.mainGrid.dataList.getRealRowIndex(i),h=this.mainGrid.getCellOption(l,o,"viewType"),d=this.mainGrid.getColumnOption(this.options.col_id,"dataType");if("icon"==h||""==h&&"own"==d?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute("editModeEvent",this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute("editModeEvent","onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_checkcombobox"),t.setAttribute("editModeEvent","")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var u=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof u&&(this.mainGrid.options.titleFormatter=u,n=u.call(this,i,o,e))}else n=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",n)}catch(t){r.w.printStackTrace(t,null,this)}},A.checkcombobox.prototype.getData=function(t,e,i){try{var o="";t=t.split(this.separator);var a,n,l=[],h=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var d=this.itemsetObj.nodeset;d.indexOf("data:")>=0&&(h=d.slice("data:".length))}if(h&&(n=this.mainGrid.modelControl.getDataComp(h)),h&&n){if("linkedDataList"===n.initializeType&&null!=n.conditionInfo&&n.conditionInfo.filterInfo.useRef){var u=n.conditionInfo.targetInfo,p={};for(var c in u){var g=this.mainGrid.modelControl.getDataComp(c);if(null!=g.initializeType&&"dataMap"!=g.initializeType){var f=g.getRowPosition();f!=e&&(p[c]=f,"linkedDataList"===g.initializeType?g._dataList.rowPosition=g.filteredRowIndexArr[e]:g.rowPosition=e)}}var m=n.getBroadcast();for(var y in n.setBroadcast(!1),n.syncWithParent(),n.setBroadcast(m),p){var b=this.mainGrid.modelControl.getDataComp(y);"linkedDataList"===b.initializeType?b._dataList.rowPosition=b.filteredRowIndexArr[p[y]]:b.rowPosition=p[y]}}var w=null,v=null;if("linkedDataList"===n.initializeType?(w=n._dataList,v=n.initialRowIndexArr):"dataList"===n.initializeType&&(v=(w=n).filteredRowIndexArr),!this.checkcombobox&&null!=w)try{var I,C;o=""
;if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)I=this.itemsetObj.label,C=this.itemsetObj.value;else{var x=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",s.v._XML_NAMESPACE.W2),_=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",s.v._XML_NAMESPACE.W2);0!=x.length&&0!=_.length&&(I=WebSquare.Elem.api.getAttribute(x[0],"ref"),C=WebSquare.Elem.api.getAttribute(_[0],"ref"))}for(var S=w.bodyIdColIndexMap[I],D=w.bodyIdColIndexMap[C],R=0;R<v.length;R++)for(var L=v[R]*w.cellIdList.length,T=0;T<t.length;T++)t[T]==w.dataArr[L+D]&&(o=w.dataArr[L+S],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?o=t[T]+this.options.delimiter+o:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?o=o+this.options.delimiter+t[T]:"value"!==this.options.displayMode&&3!=this.options.displayMode||(o=t[T]),i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),l.push(o));if(l.length>0)return l.join(this.separator);if(this.options.allOption&&t==WebSquare.allValue)o=WebSquare.language.getMessage("Grid_all")||"-전체-";else if(this.options.chooseOption&&t==this.options.chooseOptionValue)o=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)o="";else{L=0;L=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var k=this.mainGrid._dataList.cellIdList.length,A=this.mainGrid._dataList.bodyIdColIndexMap[this.id];this.mainGrid._dataList.dataArr[L*k+A]="",o=""}else o=t;return i&&i.emptyValue&&(""===o||"$blank"==o)?o=i.emptyValue:void 0!==o&&"$blank"!=o||(o=""),o}catch(e){return r.w.printStackTrace(e,null,this),t}var F=!1;a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(l.push(this.checkcombobox.itemArr[R].label),a[R+"_"]=!0,F=!0);if(!F){if(""==l&&1==this.options.chooseOption){if(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(M=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(o=M);o=WebSquare.xml.decode(o).replace("&nbsp;"," ")}else this.options.selectedData||(o=t);l.push(o),a=null}o=l.join(this.separator)}else{var E=this.getMatchInfo(e);for(F=!1,R=0;R<t.length;R++)void 0!==(o=E["CHECKCOMBOBOX_"+t[R]])&&(l.push(o),F=!0);if(F){if(this.options.checkcomboboxRangeSeparator&&this.checkcombobox){a={};for(R=0;R<this.checkcombobox.itemArr.length;R++)for(T=0;T<t.length;T++)this.checkcombobox.itemArr[R].value==t[T]&&(a[R+"_"]=!0)}}else{if(""==l&&1==this.options.chooseOption){var M;if(o=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef)(M=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef))&&(o=M);o=WebSquare.xml.decode(o).replace("&nbsp;"," ")}else this.options.selectedData||(o=t);l.push(o)}o=l.join(this.separator)}if(i&&i.emptyValue&&(""===o||"$blank"==o))o=i.emptyValue;else if(void 0===o||"$blank"==o)return"";return this.options.checkcomboboxRangeSeparator&&this.checkcombobox&&a?this.checkcombobox._getRangeText(this.checkcombobox.itemArr,this.checkcombobox.itemArr.length,this.separator,a):o}catch(t){r.w.printStackTrace(t,null,this)}},A.checkcombobox.prototype._createComponent=function(t){try{if(this.comp)return;this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_checkcombobox_"+this.colID),this.xml.setAttribute("chooseOption",this.options.chooseOption+""),this.xml.setAttribute("chooseOptionLabel",this.options.chooseOptionLabel),this.xml.setAttribute("allOption",this.options.allOption+""),"column"===this.options.submenuSize?this.xml.setAttribute("submenuSize","column"):this.xml.setAttribute("submenuSize","auto"),this.xml.setAttribute("style",this.style),
this.xml.setAttribute("disabled",this.mainGrid.getDisabled("cell",this.mainGrid._getGroupbyDisplayRowIndex(t),this.colID)),this.xml.setAttribute("useDrag",this.options.checkcomboboxUseDrag),this.xml.setAttribute("useEdit",this.options.checkcomboboxUseEdit),this.xml.setAttribute("rangeSeparator",this.options.checkcomboboxRangeSeparator),this.xml.setAttribute("validateOnInput",this.options.checkcomboboxValidateOnInput),this.options.checkcomboboxVisibleRowNum>1&&this.xml.setAttribute("visibleRowNum",this.options.checkcomboboxVisibleRowNum),this.options.checkcomboboxVisibleColNum>1&&this.xml.setAttribute("visibleColNum",this.options.checkcomboboxVisibleColNum),this.options.checkcomboboxVisibleColMax>1&&this.xml.setAttribute("visibleColMax",this.options.checkcomboboxVisibleColMax),this.configOptions.separator=this.separator,this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.internal&&(this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions)),this.checkcombobox=new WebSquare.uiplugin.checkcombobox(this.mainGridId+"_checkcombobox_"+this.id,this.configOptions,this.xml),this.comp=this.checkcombobox;var e=this;this.checkcombobox.__closeSubLayer=this.checkcombobox.closeSubLayer,this.checkcombobox.closeSubLayer=function(){this.__closeSubLayer(),e.handleEndEdit()},this.checkcombobox.toggle=function(){if(this.isOpen){var i=this.getValue(),o=this.getInfoArray();this.__closeSubLayer();var s=this.getValue(),r=e.mainGrid.getColumnIndex(e.options.id);if(i!=s){var a={oldInfo:o,newInfo:this.getInfoArray(),oldValue:i,newValue:s,rowIndex:t,colIndex:r};d.B.fireEvent(e.mainGrid,"onviewchange",a)}e.handleEndEdit()}else this.openSubLayer()},this.checkcombobox._parent_uuid=this.mainGrid.uuid}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.checkcombobox.prototype.setEditMode=function(t,e){try{if(!0!==this._init){if(this._createComponent(e),t.innerHTML=this.checkcombobox.toHTML(),this.checkcombobox.activate(),this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setNodeSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setSubLayer(),!this.existGridViewItemsetNode){var i=this.checkcombobox.itemTable,o=this;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:o.checkcombobox.closeSubLayer(),o.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",o.mainGrid.options.keyMoveEditMode);break;case 13:o.mainGrid.options.fastEditMode?"none"==o.mainGrid.options.enterKeyMove||("right"==o.mainGrid.options.enterKeyMove?o.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",o.mainGrid.options.keyMoveEditMode):o.mainGrid.moveVertical(t,t.shiftKey?"up":"down",o.mainGrid.options.keyMoveEditMode)):o.checkcombobox.closeSubLayer();break;case 27:o.mainGrid.editedCell.handleCancelEdit(t)}})),this.mainGrid._moveKeyEdit(i.uuid,"keyDownFunc",{itemTable:!0})}this._init=!0}else t.innerHTML="",this.mainGrid.cellMergeInfo&&this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),t.appendChild(this.checkcombobox.render);if(this.hasRef&&!this.dataComp){var s=this.mainGrid.getElemRowIndex(t);this.checkcombobox.itemArr=this.getRefItemArr(s),this.checkcombobox.setSelectOptions()}this.existGridViewItemsetNode?(this.checkcombobox.openSubLayer(),this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID))):(this.checkcombobox.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.checkcombobox.openSubLayer()),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,
this.parentColumnInfo.editTd=t);var a=this.checkcombobox.itemTable.render.firstChild.clientWidth;a<t.clientWidth-2&&(a=t.clientWidth-2),a<this.checkcombobox.itemTable.render.offsetWidth-2&&(a=this.checkcombobox.itemTable.render.offsetWidth-2),this.checkcombobox.setSize(t.clientWidth-2,t.clientHeight-2),this.checkcombobox.setItemTable(),t.style.textOverflow="ellipsis"}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.checkcombobox.prototype._handleEndEdit_common=function(t){try{this.checkcombobox.__closeSubLayer&&this.checkcombobox.__closeSubLayer();var e=this.checkcombobox.getValue();try{this.editTd.removeChild(this.checkcombobox.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i)}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.checkcombobox.prototype._handleEndEdit_focus=function(){this.mainGrid._setFocusedCell()},A.checkcombobox.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.checkcombobox.prototype._handleCancelEdit=function(t){this.checkcombobox.__closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},A.checkcombobox.prototype._getEditedValue=function(t){return this.checkcombobox.getValue()},A.checkcombobox.prototype.refreshItemArr=function(t){var e=WebSquare.WebSquareparser.parseChoices(this.xml,"");if(e.length>0?this.itemArr=e:this.itemArr=this.modelControl.getItemsetData(),1==this.options.allOption){var i=WebSquare.language.getMessage("Grid_all")||"-전체-";this.itemArr=[{label:i,value:WebSquare.allValue}].concat(this.itemArr)}},A.autoComplete=function(){},A.autoComplete.prototype.setInnerHTML=function(t,e,i,o,s){var n;null==e&&(e="");var l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id);if("function"==typeof h){this.useCustomFormatter=!0;var u=this.getDisplayData(e,i);n=h.call(this.mainGrid,e,u,l,o)}else{this.useCustomFormatter=!1,n=this.getData(e,i);var p=this.options.displayFormat||this.options.displayFormatter||this.options.ioFormat;n&&this.formatter&&p&&(n=this.formatter.format(n))}var c=this.mainGrid.dataList.getRealRowIndex(i),g=this.mainGrid.getCellOption(c,o,"viewType");if("icon"==g&&"true"==this.options.viewTypeIconImage){t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td col_id='"+this.colID+"' rowIndex='"+i+"' colIndex='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>","<nobr>"+n+"</nobr>","</td>","<td col_id='"+this.colID+"' rowIndex='"+i+"'  colIndex='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_autoComplete_div_img' />","</td>","</table>"].join("");var f=this,m=t,y=t.getElementsByTagName("div")[0];d.B.addListener(y,"onclick",(function(t){f.mainGrid._getEditDisabled(i,o)||f.mainGrid.___getEditReadOnly(i,o)||(f.autoCompleteImageClicked=!0,f.options.directOpen&&(f.mainGrid.__setFocusedCell(t,m),f.mainGrid.setEditMode(m)))}))}else{t.innerHTML="<nobr>"+n+"</nobr>";var b,w=this.mainGrid.getColumnOption(this.options.col_id,"dataType");if("icon"==g||""==g&&"own"==w?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute("editModeEvent",this.options.editModeEventIcon)):"onclick"==this.options.editModeEvent?t.setAttribute("editModeEvent","onclick"):(this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_autoComplete"),t.setAttribute("editModeEvent","")),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var v=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id)
;"function"==typeof v&&(this.mainGrid.options.titleFormatter=v,b=v.call(this,i,o,e))}else b=this.mainGrid.options.titleFormatter.call(this,i,o,n);t.setAttribute("title",b)}catch(t){r.w.printStackTrace(t,null,this)}}},A.autoComplete.prototype._initializeCellInfo=function(t){try{"useData"==this.options.noResult&&(this.useDataInfo={})}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.autoComplete.prototype.getData=function(t,e,i){try{var o,a="",n=this.dataComp;if(this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType){var l=this.itemsetObj.nodeset;l.indexOf("data:")>=0&&(n=l.slice("data:".length))}if(n&&(o=this.mainGrid.modelControl.getDataComp(n)),n&&o){if("linkedDataList"===o.initializeType&&null!=o.conditionInfo&&o.conditionInfo.filterInfo.useRef){var h=o.conditionInfo.targetInfo,d={};for(var u in h){var p=this.mainGrid.modelControl.getDataComp(u);if(null!=p.initializeType&&"dataMap"!=p.initializeType){var c=p.getRowPosition();c!=e&&(d[u]=c,"linkedDataList"===p.initializeType?p._dataList.rowPosition=p.filteredRowIndexArr[e]:p.rowPosition=e)}}for(var g in o.syncWithParent(),d){var f=this.mainGrid.modelControl.getDataComp(g);"linkedDataList"===f.initializeType?f._dataList.rowPosition=f.filteredRowIndexArr[d[g]]:f.rowPosition=d[g]}}var m=null,y=null,b=null;if("linkedDataList"===o.initializeType)m=o._dataList,y=o.initialRowIndexArr,b=o.initialRowIndexArr;else if("dataList"===o.initializeType){if(m=o,o.options&&o.options.validateAllItemsetData){var w=m.getTotalRow();y=[];for(var v=0;v<w;v++)y.push(v)}else y=m.filteredRowIndexArr;b=m.filteredRowIndexArr}if(!this.autoComplete&&null!=m)try{var I,C;a="";if(this.internal||this.existGridViewItemsetNode||"gridViewItemset"===this.options.itemTableType)I=this.itemsetObj.label,C=this.itemsetObj.value;else{var x=WebSquare.Elem.api.getElementsByTagName(this.xml,"label",s.v._XML_NAMESPACE.W2),_=WebSquare.Elem.api.getElementsByTagName(this.xml,"value",s.v._XML_NAMESPACE.W2);x.length>0&&_.length>0&&(I=WebSquare.Elem.api.getAttribute(x[0],"ref"),C=WebSquare.Elem.api.getAttribute(_[0],"ref"))}var S=null!=I?m.bodyIdColIndexMap[I]:m.bodyIdColIndexMap[this.itemsetObj.label],D=null!=C?m.bodyIdColIndexMap[C]:m.bodyIdColIndexMap[this.itemsetObj.value];for(v=0;v<y.length;v++){var R=y[v]*m.cellIdList.length;if(t==m.dataArr[R+D])return a=m.dataArr[R+S],"value delim label"===this.options.displayMode||1==this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||2==this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&3!=this.options.displayMode||(a=t),i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a}if(this.selectedIndex>=0&&this.selectedIndex<b.length&&!this.options.chooseOption)a=m.dataArr[b[this.selectedIndex]*m.cellIdList.length+S],"value delim label"===this.options.displayMode||"1"===this.options.displayMode?a=t+this.options.delimiter+a:"label delim value"===this.options.displayMode||"2"===this.options.displayMode?a=a+this.options.delimiter+t:"value"!==this.options.displayMode&&"3"!==this.options.displayMode||(a=t);else if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-전체-"}else if(this.options.chooseOption&&t==this.options.chooseOptionValue)a=this.options.chooseOptionLabel;else if(this.options.selectedData)if(""==t)a="";else{R=0;R=this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr[e]:this.mainGrid._dataList.filteredRowIndexArr[e];var L=this.mainGrid._dataList.cellIdList.length,T=this.mainGrid._dataList.bodyIdColIndexMap[this.colID];this.mainGrid._dataList.dataArr[R*L+T]="",a=""}else a=t;return i&&i.emptyValue&&(""===a||"$blank"==a)?a=i.emptyValue:void 0!==a&&"$blank"!=a||(a=""),a}catch(e){return r.w.printStackTrace(e,null,this),t}var k=!1;for(v=0;v<this.autoComplete.itemArr.length;v++)if(this.autoComplete.itemArr[v].value==t){k=!0,a=this.autoComplete.itemArr[v].label;break}
if(!k&&o.options&&o.options.validateAllItemsetData)for(v=0;v<this.autoComplete.allItemArr.length;v++)if(this.autoComplete.allItemArr[v].value==t){k=!0,a=this.autoComplete.allItemArr[v].label;break}if(!k)if(""!=t||-1==this.selectedIndex||this.options.chooseOption)if(this.options.allOption&&t==WebSquare.allValue){a=WebSquare.language.getMessage("Grid_all")||"-전체-"}else this.options.chooseOption&&t==this.options.chooseOptionValue?a=this.options.chooseOptionLabel:this.options.selectedData||(a=t);else a=this.autoComplete.itemArr[this.selectedIndex].label,this.mainGrid.dataList.__setCellData(e,this.colID,a)}else{var A=this.getMatchInfo(e);"useData"==this.options.noResult&&(this.useDataInfo["AUTOCOMPLETE_"+t]||(this.useDataInfo["AUTOCOMPLETE_"+t]=t),A["AUTOCOMPLETE_"+t]||(this.matchInfo["AUTOCOMPLETE_"+t]=t,this.itemArr=[{label:t,value:""}].concat(this.itemArr))),a=A["AUTOCOMPLETE_"+t]}if(i&&i.emptyValue&&(""===a||"$blank"==a))a=i.emptyValue;else if(void 0===a||"$blank"==a)return"";return a}catch(t){r.w.printStackTrace(t,null,this)}return t},A.autoComplete.prototype._createComponent=function(t){try{if(this.comp)return;if(this.options.disableEdit?this.style="position:relative;left:0px;top:0px;":this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_autoComplete_"+this.colID),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.interactionMode&&(this.configOptions.interactionMode=this.options.interactionMode),this.options.submission&&(this.configOptions.submission=this.options.submission),this.options.sortOption&&(this.configOptions.sortOption=this.options.sortOption),this.options.displayMode&&(this.configOptions.displayMode=this.options.displayMode),this.options.search&&(this.configOptions.search=this.options.search),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.submenuSize&&(this.configOptions.submenuSize=this.options.submenuSize),this.options.searchTarget&&(this.configOptions.searchTarget=this.options.searchTarget),this.options.useKeywordHighlight&&(this.configOptions.useKeywordHighlight=this.options.useKeywordHighlight),this.options.allOption&&(this.configOptions.allOption=this.options.allOption),this.options.chooseOptionLabel&&(this.configOptions.chooseOptionLabel=this.options.chooseOptionLabel),this.options.noResult&&(this.configOptions.noResult=this.options.noResult),this.options.disableEdit&&(this.configOptions.disableEdit=this.options.disableEdit),a.D.isIEAllVersion()&&this.xml.removeAttribute("readOnly"),this.internal&&(this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.itemTableType&&(this.configOptions.itemTableType=this.options.itemTableType),this.options.itemSet&&(this.configOptions.itemSet=this.options.itemSet),this.options.item&&(this.configOptions.item=this.options.item),this.options.gridViewOptions&&(this.configOptions.gridViewOptions=this.options.gridViewOptions),this.options.caseSensitive&&(this.configOptions.caseSensitive=this.options.caseSensitive)),this.existGridViewItemsetNode&&!this.configOptions.submenuSize&&(this.configOptions.submenuSize="auto"),this.hasRef)this.targetRowIndex=t,WebSquare.Elem.api.getElementsByTagName(this.xml,"w2:itemset")[0].setAttribute("nodeset",new Function("_this","return "+this.refStr)(this));this.configOptions._scope_obj_uuid=this.options._scope_obj_uuid,this.autoComplete=new WebSquare.uiplugin.autoComplete(this.mainGridId+"_autoComplete_"+t+"_"+this.colID+"_"+this.id,this.configOptions,this.xml),this.autoComplete.options.disabled=!1,this.comp=this.autoComplete,this.internal&&"gridViewItemset"!==this.options.itemTableType&&this.comp.setItemSet(this.initializeInfo.itemSet.nodeset,this.initializeInfo.itemSet.label,this.initializeInfo.itemSet.value);var e=this
;this.autoComplete._handleClickEvent=this.autoComplete.handleClickEvent,this.autoComplete.handleClickEvent=function(t){this._handleClickEvent(t),d.B.stopEvent(t)},this.existGridViewItemsetNode?(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit()}))}):(this.autoComplete._setSubLayer=this.autoComplete.setSubLayer,this.autoComplete.setSubLayer=function(t){this._setSubLayer(t);var i=this.itemTable;i.addKeyDownEventListener((function(t){switch(t.keyCode){case 9:this.fireClick(t),e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode);break;case 13:e.mainGrid.options.fastEditMode&&("none"==e.mainGrid.options.enterKeyMove||("right"==e.mainGrid.options.enterKeyMove?e.mainGrid.moveHorizontal(t,t.shiftKey?"left":"right",e.mainGrid.options.keyMoveEditMode):e.mainGrid.moveVertical(t,t.shiftKey?"up":"down",e.mainGrid.options.keyMoveEditMode)));break;case 27:e.handleCancelEdit(t)}})),i.addClickEventListener((function(t,i){e.autoComplete.dom.input.value=e.autoComplete.viewArr[i].label,e.autoComplete.selectedText=e.autoComplete.viewArr[i].orgLabel,e.autoComplete.selectedValue=e.autoComplete.viewArr[i].value;var o=e.autoComplete.selectedText+"|"+e.autoComplete.selectedValue;i=e.autoComplete.findinItemArr(o,"all");e.autoComplete.setSelectedIndex1(i),e.autoComplete.editmode=!1,e.handleEndEdit(),e.options.directOpen&&e.mainGrid._setFocusedCell()})),e.mainGrid._moveKeyEdit(i.uuid,"keyDownFunc",{itemTable:!0})}),this.autoComplete.showEditMode=function(t){try{t?(this.dom.label.style.display="none",this.dom.label.style.visibility="hidden",this.dom.input.style.display="block",this.dom.input.style.visibility="visible"):(this.dom.input.style.display="none",this.dom.input.style.visibility="hidden",this.dom.label.style.display="block",this.dom.label.style.visibility="visible")}catch(t){}},this.autoComplete._inputKeyDown=this.autoComplete.inputKeyDown,this.autoComplete.inputKeyDown=function(t,i){27==t.keyCode||(e.autoComplete._inputKeyDown(t,i),13===t.keyCode&&e.options.directOpen&&d.B.stopPropagation(t))},this.mainGrid._moveKeyEdit(this.autoComplete.uuid,"_inputKeyDown",{skipVertical:!0}),this.autoComplete.setSelectedIndex1=function(t){var i=this.selectedIndex,o=this.getValue();if(this.setSelectedIndex(t),i!=this.selectedIndex){var s=e.mainGrid.getColumnIndex(e.options.id),r=e.editRowIndex,a={oldValue:o,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex,rowIndex:r,colIndex:s};d.B.fireEvent(e.mainGrid,"onviewchange",a)}this.closeSubLayer(),e.editTd&&e.handleEndEdit(),e.existGridViewItemsetNode&&e.options.directOpen&&e.mainGrid._setFocusedCell()},this.autoComplete._refreshItemset=this.autoComplete.refreshItemset,this.autoComplete.refreshItemset=function(t){"gridViewItemset"!==this.options.itemTableType&&(e.matchInfo=e.setMatchInfo()),this._refreshItemset(t)},this.autoComplete.options.handleOtherClick=!1}catch(t){r.w.printStackTrace(t,null,this)}},A.autoComplete.prototype.setEditMode=function(t,e){try{if(!0!==this._init?(this._createComponent(e),t.innerHTML=this.autoComplete.toHTML(),this.autoComplete.activate(),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this._init=!0,
this.options.placeholder&&this.autoComplete.dom.input.setAttribute("placeholder",this.options.placeholder)):(t.innerHTML="",this.mainGrid.cellMergeInfo&&this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),t.appendChild(this.autoComplete.render)),this.autoComplete.setSize(t.clientWidth-2+"px",t.clientHeight-2+"px"),this.hasRef){var i=this.mainGrid.getElemRowIndex(t);this.autoComplete.itemArr=this.getRefItemArr(i)}if(this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.autoComplete.itemArr.length>0||this.autoComplete.allItemArr.length>0){var o=this.mainGrid.dataList._getCellData(e,this.colID);if(this.autoComplete.setValue(o),!0===this.autoComplete.options.disableEdit||!0===this.autoCompleteImageClicked){if(this.autoCompleteImageClicked&&this.options.directOpen)if(this.autoComplete.viewArr=[],this.existGridViewItemsetNode);else for(var s=0;s<this.autoComplete.itemArr.length;s++)this.autoComplete.viewArr.push({label:this.autoComplete.itemArr[s].label,value:this.autoComplete.itemArr[s].value,orgLabel:this.autoComplete.itemArr[s].orgLabel,index:s,_hidden:this.autoComplete.itemArr[s]._hidden});this.autoComplete.openSubLayer(),this.autoCompleteImageClicked=!1}else this.autoComplete.setInputFocus()}else this.autoComplete.options.disableEdit||this.autoComplete.setInputFocus(),this.autoComplete.dom.input.value="";0==this.autoComplete.getItemCount()&&(this.autoComplete.selectedIndex=-1,this.autoComplete.dom.label.innerHTML="")}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.autoComplete.prototype.setColumnDisableEdit=function(t){try{this.options.disableEdit=!0,this.autoComplete&&this.autoComplete.disableEdit(t)}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.autoComplete.prototype._handleEndEdit_common=function(t){try{this.autoComplete.endEdit({noEvent:!0}),this.autoComplete.closeSubLayer();var e=this.autoComplete.getValue();try{this.editTd.removeChild(this.autoComplete.render)}catch(t){return}this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i={};i[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,i),this.options.directOpen&&(this.autoComplete.editmode=!1)}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.autoComplete.prototype._handleEndEdit_focus=function(t,e,i){!1===i&&this.mainGrid._setFocusedCell()},A.autoComplete.prototype._handleCancelEdit=function(t){this.autoComplete.closeSubLayer();var e=this.mainGrid.dataList._getCellData(this.mainGrid.getRealRowIndex(this.editRowIndex),this.colID);this.editTd.removeChild(this.autoComplete.render),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid._setFocusedCell()},A.autoComplete.prototype._getEditedValue=function(t){return this.autoComplete.getValue()},A.autoComplete.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.calendar=function(){},A.calendar.prototype.initializeCellInfo=function(t){try{this.options.useIOFormatLength&&this.refreshDataArr()}catch(t){r.w.printStackTrace(t,null,this)}},A.calendar.prototype.setInnerHTML=function(t,e,i,o,s){if(this.options.embeddedInput){var n=this.mainGrid.getInput(this,t,e);null==n.render.parentNode&&(t.innerHTML="",t.appendChild(n.render));var l=0,h=0,u=!1;"none"==t.parentNode.style.display&&(t.parentNode.style.display="",u=!0),this.mainGrid.embeddedCalendarStyleObj||(this.mainGrid.embeddedCalendarStyleObj={top:parseInt(WebSquare.style.getStyle(t,"padding-top"),10),bottom:parseInt(WebSquare.style.getStyle(t,"padding-bottom"),10),left:parseInt(WebSquare.style.getStyle(t,"padding-left"),10),right:parseInt(WebSquare.style.getStyle(t,"padding-right"),10)}),l=t.offsetHeight-parseInt(WebSquare.style.getStyle(t,"border-top-width"),10)-parseInt(WebSquare.style.getStyle(t,"border-bottom-width"),10),l-=this.mainGrid.embeddedCalendarStyleObj.top+this.mainGrid.embeddedCalendarStyleObj.bottom,
this.mainGrid.embeddedWidthObj[o]&&!this.mainGrid.embeddedWidthObj[o].isChanged||(this.mainGrid.embeddedWidthObj[o]={isChanged:!1,width:t.clientWidth}),h=this.mainGrid.embeddedWidthObj[o].width,h-=this.mainGrid.embeddedCalendarStyleObj.left+this.mainGrid.embeddedCalendarStyleObj.right,u?t.parentNode.style.display="none":a.D.isIE("6 7")&&(l-=2),n.setSize(h-2,l),n.render.setAttribute("rowindex",i),"all"==this.options.applyFormat||this.options.displayFormat||(e=this.getDisplayData(e)),n._setValue(e,{skipValidate:!0}),this.mainGrid.__getEditReadOnly(t,i)||this.mainGrid._getEditDisabled(i,o)?n.setDisabled(!0):n.setDisabled(!1),t.removeAttribute("tabIndex")}else{this.options.useMonthYearFormat&&(e=WebSquare.date.getIOFormatDate(e,this.options.ioFormat,this.options.calendarValueType));var p=this.getDisplayData(e),c=this.mainGrid._dataList.filteredRowIndexArr[i],g=this.mainGrid.getCellOption(c,o,"viewType");if("icon"==g&&"true"==this.options.viewTypeIconImage){t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td col_id='"+this.colID+"' rowIndex='"+i+"' colIndex='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_table' style='width:90%; overflow:hidden; text-overflow:ellipsis;'>","<nobr>"+p+"</nobr>","</td>","<td col_id='"+this.colID+"' rowIndex='"+i+"'  colIndex='"+o+"' class='"+this.mainGrid.options.bodyTdClass+"_calendar_img'>","<div class='"+this.mainGrid.options.bodyTdClass+"_calendar_div_img' />","</td>","</table>"].join("");var f=this,m=t.getElementsByTagName("div")[0];d.B.addListener(m,"onclick",(function(t){f.mainGrid._getEditDisabled(i,o)||f.mainGrid.___getEditReadOnly(i,o)||(f.calendarImageClicked=!0)}))}else t.innerHTML="<nobr>"+p+"</nobr>","icon"==g||""==g&&"own"==this.options.dataType?(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_calendar"),t.setAttribute("editModeEvent",this.options.editModeEventIcon)):this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar")}var y;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var b=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof b&&(this.mainGrid.options.titleFormatter=b,y=b.call(this,i,o,e))}else y=this.mainGrid.options.titleFormatter.call(this,i,o,e)}catch(t){r.w.printStackTrace(t,null,this)}var w=y||this.options.title||"";w&&t.setAttribute("title",w)},A.calendar.prototype.setEditMode=function(t,e){try{if(this.options.embeddedInput)return;if("true"==this.options.viewTypeIconImage){var i=t.getElementsByTagName("div")[0];this.mainGrid.removeClass(i,this.mainGrid.options.bodyTdClass+"_calendar_div_img")}else this.mainGrid.removeClass(t,this.mainGrid.options.bodyTdClass+"_calendar");this.editTd=t,this.editRowIndex=e,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var o=this.mainGrid.getInput(this);this.comp=o;for(var s=t.firstChild;null!=s;s=s.nextSibling)if("NOBR"==s.nodeName.toUpperCase()){WebSquare.style.setStyle(s,"visibility","hidden");break}if(1==o.options.renderDiv||"true"==o.options.renderDiv){var a=document.getElementById(this.mainGridId+this.id),n=t.offsetWidth-6,l=t.offsetHeight,h=document.getElementById(this.mainGridId+this.id+"_div_input"),d=n-18-5,u=l-3,p=document.getElementById(this.mainGridId+this.id+"_input"),c=d-(parseInt(WebSquare.style.getStyle(p,"border-right-width"),10)+parseInt(WebSquare.style.getStyle(p,"border-left-width"),10)+parseInt(WebSquare.style.getStyle(p,"padding-right"),10)+parseInt(WebSquare.style.getStyle(p,"padding-left"),10)),g=u-2,f=document.getElementById(this.mainGridId+this.id+"_img"),m=u/2-f.offsetHeight/2;if(1==this.options.useAnchor||"true"==this.options.useAnchor){var y=document.getElementById(this.mainGridId+this.id+"_a");WebSquare.style.setStyle(y,"top",m+"px")}else WebSquare.style.setStyle(f,"top",m+"px");WebSquare.style.setStyle(a,"width",Math.max(n,0)+"px"),
WebSquare.style.setStyle(h,"width",Math.max(d,0)+"px"),WebSquare.style.setStyle(p,"width",Math.max(c,0)+"px"),WebSquare.style.setStyle(a,"height",Math.max(l-3,0)+"px"),WebSquare.style.setStyle(h,"height",Math.max(u,0)+"px"),WebSquare.style.setStyle(p,"height",Math.max(g,0)+"px")}var b=this.mainGrid.dataList._getCellData(e,this.colID);this.options.useMonthYearFormat&&(b=WebSquare.date.getIOFormatDate(b,this.options.ioFormat,this.options.calendarValueType)),o._setValue(b,{noFormat:!0,skipValidate:!0}),"icon"==this.options.viewType&&"true"==this.options.viewTypeIconImage&&1==this.calendarImageClicked?(this.calendarImageClicked=!1,o.toggle()):o.focus(),"native"!==this.mainGrid.options.drawType&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==o.options.editType&&o.select()}catch(t){r.w.printStackTrace(t,null,this)}},A.calendar.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};if(a.D.isIE(8)?t={top:1,left:0,width:0,height:0}:a.D.isFF()?t={top:0,left:-1,width:0,height:0}:a.D.isChrome()||a.D.isSafari()?t={top:1,left:0,width:0,height:0}:a.D.isOpera()&&(t={top:1,left:0,width:0,height:1}),"native"===this.mainGrid.options.drawType){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}var i=this.editTd,o=i.offsetTop+t.top,s=i.offsetLeft+1+t.left,n=i.clientWidth-5+t.width,l=i.clientHeight-3+t.height,h=l-1;if(this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var u=this.mainGrid.getInput(this);u.show(),u.render.style.top=o+"px",u.render.style.left=s+"px",u.render.style.width=n+"px",u.render.style.height=l+"px",u.render.firstChild.style.height=l+"px",u.dom.input.style.height=h+"px",u.dom.input.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign,a.D.isIE()&&(u.dom.input.style.lineHeight=l+"px")}catch(t){r.w.printStackTrace(t,null,this)}},A.calendar.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},A.calendar.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);e.hideCalendar();var i=e.getValue();i=e.validator.validateString(i),this.options.useIOFormatLength||(i=e.sub_validator.validateString(i)),this.options.useMonthYearFormat&&(i=WebSquare.date.getIOUnFormatDate(i,e.options.ioFormat,e.options.calendarValueType)),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};return o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){r.w.printStackTrace(t,null,this)}},A.calendar.prototype._handleEndEdit_focus=function(t,e){!0!==e&&t.hide()},A.calendar.prototype.validate=function(t){var e=this.mainGrid.getInput(this);if(e.validate())return!0;if(""==e.getValue())return!0;if(this.mainGrid.getInput(this).blur(),this.options.dateValidSet&&this.options.dateValidSetCustom);else if("false"!==this.options.displaymessage){var i=WebSquare.language.getMessage("IC_invalidCalendarSelect")||"날짜 형식이 잘못 되었습니다.";alert(i)}return this.mainGrid.getInput(this).focus(),!1},A.calendar.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},A.calendar.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){r.w.printStackTrace(t,null,this)}},A.calendar.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.calendar.prototype.refreshDataArr=function(){
try{var t;t=this.mainGrid.groupbyStatus.grouped?this.mainGrid.groupbyStatus.groupbyRowIndexArr:this.mainGrid._linkedDataList?this.mainGrid._linkedDataList.filteredRowIndexArr:this.mainGrid._dataList.filteredRowIndexArr;for(var e=this.mainGrid._dataList.cellIdList.length,i=this.mainGrid._dataList.bodyIdColIndexMap[this.id],o=this.mainGrid.getInput(this),s=0;s<t.length;s++){var a=t[s],n=this.mainGrid._dataList.dataArr[a*e+i],l=o.sub_validator.validateString(n);this.mainGrid._dataList.dataArr[a*e+i]=l}}catch(t){r.w.printStackTrace(t,null,this)}},A.expression=function(){},A.expression.prototype.initializeCellInfo=function(){var t=this.options.expression;if(this.mainGrid.useExpression=!0,this.expIdArr=[],""!=t){var e=t.match(/(sum|avg|max|min|display|rowindex|rowstatus)[\s]*[(][\S\s]*?[)]/gi);if(null!=e){t="";for(var i=0;i<e.length;i++)t+=e[i],i<e.length-1&&(t+="+")}t=(t=(t=(t=(t=(t=(t=(t=t.replace(/[sS][uU][mM][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[aA][vV][gG][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][aA][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[mM][iI][nN][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"_this.getCalcExpressionTarget(")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"_this.getExpressionTarget(")).replace(/rowStatus[\s]*[(]/gi,"_this.getExpressionTarget(")}try{new Function("_this",t)(this)}catch(t){}},A.expression.prototype.getExpressionTarget=function(){for(var t=0;t<arguments.length;t++)null==this.expIdArr[arguments[t]]&&(this.expIdArr[arguments[t]]=arguments[t],this.mainGrid.setExpressionAssociation(arguments[t],this.colID));return 1},A.expression.prototype.getCalcExpressionTarget=function(t){var e=t.wq_replaceAll("(",",").wq_replaceAll(")",",").wq_replaceAll("+",",").wq_replaceAll("-",",").wq_replaceAll("*",",").wq_replaceAll("/",",").wq_replaceAll("%",",").wq_replaceAll(" ","");e=e.split(",");for(var i=0;i<e.length;i++)""!==e[i]&&null==this.expIdArr[e[i]]&&(this.expIdArr[e[i]]=e[i],this.mainGrid.setExpressionAssociation(e[i],this.colID));return 1},A.expression.prototype.setInnerHTML=function(t,e,i,o,s){try{var n,l=this.mainGrid.dataList.getRealRowIndex(i),h=this.mainGrid._getGroupbyDisplayRowIndex(i),d=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id),u=this.getDisplayData(null,l);"function"==typeof d?(this.useCustomFormatter=!0,n=d.call(this.mainGrid,e,u,h,o)):(this.useCustomFormatter=!1,n=u);var p=t.innerHTML.replace(/\r(\n)?/,"\n"),c="<nobr>"+n+"</nobr>";p!==c&&(t.innerHTML=c.replace("NaN",this.options.NaNFormat),this.mainGrid.drawFooter(this.colID))}catch(t){r.w.printStackTrace(t,null,this)}},A.expression.prototype.getDisplayData=function(t,e,i){return t=this.getExpressionValue(e),this.formatter&&!i?this.formatter.format(t):t},A.expression.prototype.getExpressionValue=function(t){if(this.rowIndex=t,!this.options.expressionFunc){var e=this.options.expression;""!=e&&(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/[sS][uU][mM][\s]*[(]/g,"this.colsum(rowIndex,")).replace(/[aA][vV][gG][\s]*[(]/g,"this.colavg(rowIndex,")).replace(/[mM][aA][xX][\s]*[(]/g,"this.colmax(rowIndex,")).replace(/[mM][iI][nN][\s]*[(]/g,"this.colmin(rowIndex,")).replace(/[cC][aA][lL][cC][\s]*[(]/g,"this.colcalc(rowIndex,")).replace(/[dD][iI][sS][pP][lL][aA][yY][\s]*[(]/g,"this.display(rowIndex,")).replace(/[rR][oO][wW][iI][nN][dD][eE][xX][\s]*[(]/g,"this.getRowIndex(rowIndex")).replace(/rowStatus[\s]*[(]/gi,"this.rowStatus(rowIndex"),e=a.D.scopingFuncBody(e,this.scope_id)),this.options.expressionFunc=Function("rowIndex",e),this.options.expressionFunc.changeCount=0}var i=this.mainGrid.changeCount,o="";return this.options.expressionFunc[t]&&i==this.options.expressionFunc[t].changeCount?o=this.options.expressionFunc[t].oldValue:(this.options.expressionFunc[t]||(this.options.expressionFunc[t]={}),this.options.expressionFunc[t].changeCount=i,o=this.options.expressionFunc.call(this,t),
this.options.expressionFunc[t].oldValue=o),o},A.expression.prototype.colsum=function(){for(var t=arguments[0],e=0,i=1;i<arguments.length;i++){var o=this.mainGrid.getColumnIndex(arguments[i]),s=this.options.dataType;"gridView"==this.mainGrid.options.pluginName&&(s=this.mainGrid._dataList.getCellInfo(this.options.col_id).options.dataType),"bigDecimal"===s?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,o)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,o))||0}return e},A.expression.prototype.colavg=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);"bigDecimal"===i?e=WebSquare.bigDecimal(e).plus(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0:e+=parseFloat(this.mainGrid.dataList._getData(t,s))||0}return"bigDecimal"===i?e=WebSquare.bigDecimal(e).divide(WebSquare.bigDecimal(arguments.length-1)).toString():e/=arguments.length-1,e},A.expression.prototype.colmax=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)))||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;r>e&&(e=r)}}return e},A.expression.prototype.colmin=function(){for(var t=arguments[0],e=0,i=this.mainGrid.getColumnOption(this.options.col_id,"dataType"),o=1;o<arguments.length;o++){var s=this.mainGrid.getColumnIndex(arguments[o]);if("bigDecimal"===i)e="0"===WebSquare.bigDecimal(e).toString()?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)):WebSquare.bigDecimal(e),e=WebSquare.bigDecimal(e).compare(WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,s)),!0)||0;else{var r=parseFloat(this.mainGrid.dataList._getData(t,s))||0;(1==o||r<e)&&(e=r)}}return e},A.expression.prototype.colcalc=function(t,e){function i(t,e){t[t.length]=e}function o(t){var e=t[t.length-1];return delete t[t.length-1],t.length--,e}function s(t){return!a(t)&&"("!=t&&")"!=t}function a(t){return"+"==t||"-"==t||"*"==t||"/"==t||"^"==t||"%"==t}function n(t){return t[t.length-1]}function l(t){return 0==t.length}function h(t){return"^"==t?5:"*"==t||"/"==t||"%"==t?4:"+"==t||"-"==t?3:"("==t?2:")"==t?1:void 0}function d(t,e,i){var o;try{return"+"==i&&(o=t.plus(e)),"-"==i&&(o=t.minus(e)),"*"==i&&(o=t.times(e)),"/"==i&&(o=t.divide(e)),"^"==i&&(o=t.pow(e)),"%"==i&&(o=t.mod(e)),o}catch(t){r.w.printStackTrace(t)}}var u=function(t,e,r){e=new Array;var d=new Array,u=0;t=function(t){for(var e=t.split(""),i="",o=new Array,r=0,n=0;n<e.length;n++)s(e[n])&&null==e[n].match(/\s/)&&(i+=e[n]),(a(e[n])||")"==e[n]||"("==e[n])&&(""!=i&&(o[r]=i,r++),i="",o[r]=e[n],r++),n==e.length-1&&""!=i&&(o[r]=i);return o}(t);for(var p=0;p<t.length;p++){if(s(t[p])&&(e[u]=t[p],u++),a(t[p])){if("^"!=t[p])for(;!l(d)&&h(t[p])<=h(n(d));)e[u]=n(d),o(d),u++;else for(;!l(d)&&h(t[p])<h(n(d));)e[u]=n(d),o(d),u++;i(d,t[p])}if("("==t[p]&&i(d,t[p]),")"==t[p]){for(;"("!=n(d);)e[u]=o(d),u++;o(d)}}for(;!l(d);)"("==n(d)?o(d):e[e.length]=o(d);var c="";for(p=0;p<e.length;p++)c+=e[p];return 0==r?c:e}(e);for(var p in u){var c=this.mainGrid.getColumnIndex(u[p]);u[p]=null!=c?WebSquare.bigDecimal(this.mainGrid.dataList._getData(t,c)):u[p]}return function(t){for(var e,r,a=new Array,l=0;l<t.length;l++)if(s(t[l]))i(a,t[l]);else{(e=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(e=WebSquare.bigDecimal(e)),o(a),(r=new Function("return "+n(a))()).constructor!=WebSquare.bigDecimalObj&&(r=WebSquare.bigDecimal(r));var h=d(r,e,t[l]);o(a),i(a,h)}return n(a)}(u)},A.expression.prototype.display=function(){var t=arguments[0],e=this.mainGrid.getColumnIndex(arguments[1]),i=this.mainGrid.dataList._getData(t,e);return i},A.expression.prototype.getRowIndex=function(){var t=arguments[0]
;return this.mainGrid.getDisplayRowIndex(t)},A.expression.prototype.rowStatus=function(){var t=arguments[0],e=this.mainGrid.dataList.getRowStatusValue(t);switch(e){case 0:return"R";case 1:return"U";case 2:return"C";case 3:return"D";case 4:return"V"}},A.textarea=function(){},A.textarea.prototype.initializeCellInfo=function(t){if(t){var e=t.getAttribute("showReadOnly");if(e)this.options.showReadOnly=a.D.getBoolean(e);else{var i=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+'/column[@inputType="textarea"]/showReadOnly/@value')||"true";this.options.showReadOnly=a.D.getBoolean(i)}}},A.textarea.prototype.setInnerHTML=function(t,e,i,o,s){if(this.options.embeddedInput){var n=this.mainGrid.getInput(this,t);n.show(),t.innerHTML="",t.appendChild(n.render),n.render.setAttribute("rowindex",i),n.render.style.top="0",n.render.style.left="0",n.render.style.width="100%",n.render.style.height="100%",n.render.style.imeMode=this.options.imeMode,this.options.placeholder&&(n.render.placeholder=this.options.placeholder),n.setValue(this.mainGrid.dataList._getCellData(i,this.id)),this.mainGrid._getEditDisabled(i,o)?n.setDisabled(!0):n.setDisabled(!1),this.mainGrid.__getEditReadOnly(t,i)?n.setReadOnly(!0):n.setReadOnly(!1)}else{var l=t.clientWidth-8+"",h=this.getDisplayData(e),d=this.mainGrid._getGroupbyDisplayRowIndex(i),u=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id),p=h,c=this.options.textAlign?"text-align:"+this.options.textAlign+";":"",g="pre-wrap";a.D.isIEAllVersion("6 7")&&(g="normal");var f="all"===t.getAttribute("displayType")?"word-break:break-all;white-space:"+g+";":"";"function"==typeof u?(this.useCustomFormatter=!0,p=u.call(this.mainGrid,e,h,d,o)):this.useCustomFormatter=!1,t.innerHTML="<div class='w2grid_textarea' style='"+c+" width:"+l+"px; "+f+"' >"+(this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(p+"")):this.getDisplayData(p))+"</div>"}var m;if(this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var y=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof y&&(this.mainGrid.options.titleFormatter=y,m=y.call(this,i,o,e))}else m=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",m)}catch(t){r.w.printStackTrace(t,null,this)}if("all"===t.getAttribute("displayType")&&"all"===this.mainGrid.options.visibleRowNum&&"native"!==this.mainGrid.options.drawType){var b=document.getElementById(this.mainGrid.id+"_body_table").offsetHeight;this.mainGrid.dataLayerHeight!=b&&this.mainGrid.setSize(null,b)}},A.textarea.prototype.setEditMode=function(t,e){this.options.embeddedInput||this._setEditMode(t,e)},A.textarea.prototype._setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var i=this.mainGrid.getInput(this);i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),this.options.disabled||i.focus(),"native"!==this.mainGrid.options.drawType&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),this.options.disabled||"select"!=this.options.editType&&"select"!=this.mainGrid.options.editType||i.select()}catch(t){r.w.printStackTrace(t,null,this)}},A.textarea.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0};a.D.isIE(8)?t={top:-1,left:-1,width:0,height:0}:a.D.isFF()?t={top:-2,left:0,width:0,height:0}:a.D.isOpera()?t={top:0,left:0,width:0,height:1}:a.D.isChrome()&&(t={top:0,left:0,width:0,height:0});var e=this.editTd;if("native"===this.mainGrid.options.drawType){var i=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=i.scrollTop,t.left-=i.scrollLeft}var o=e.offsetTop+1+t.top,s=e.offsetLeft+1+t.left,n=e.clientWidth>150?e.clientWidth-5+t.width:150,l=e.clientHeight>60?e.clientHeight-2+t.height:60;if(this.mainGrid.options.groupbyZone){var h=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight
;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(h=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=h}if(this.mainGrid.gridWidth<s+n){var d=(e.clientWidth>150?0:5+t.width)-2;s-=s+n-(e.offsetLeft+e.clientWidth)+d}var u=this.mainGrid.scrollX_right;if(this.mainGrid.render.offsetHeight-u.offsetHeight<o+l){var p=e.clientHeight>60?0:2-t.top;(o-=o+l-(e.offsetTop+e.clientHeight)+p)<0&&(o=1+t.top),l>this.mainGrid.render.offsetHeight&&(l=this.mainGrid.render.offsetHeight-6+t.height)}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))s-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft;var c=this.mainGrid.getInput(this);this.comp=c,c.show(),c.render.style.top=o+"px",c.render.style.left=s+"px",c.render.style.width=n+"px",c.render.style.height=l+"px",c.render.style.imeMode=this.options.imeMode}catch(t){r.w.printStackTrace(t,null,this)}},A.textarea.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},A.textarea.prototype.showReadonly=function(t,e){var i=this.mainGrid.getInput(this),o=t.getAttribute("col_id");(this.options.disabled||this.mainGrid._getEditDisabled(e,o))&&i.setDisabled(!0),(this.options.readOnly||this.mainGrid.___getEditReadOnly(e,o))&&i.setReadOnly(!0),this._setEditMode(t,e),this.mainGrid.editedCell=this},A.textarea.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();"number"==this.mainGrid.getColumnOption(this.options.col_id,"dataType")&&""!=i&&(i=Number(i));var o=this.editTd.offsetHeight;this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var s=this.editTd.offsetHeight;this.changedCellHeight=s-o;var a={};return a[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,a),e}catch(t){r.w.printStackTrace(t,null,this)}},A.textarea.prototype._handleEndEdit_focus=function(t){t.hide(),t.setDisabled(!1),t.setReadOnly(!1)},A.textarea.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},A.textarea.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getInput(this);i.hide(),i.setDisabled(!1),i.setReadOnly(!1)}catch(t){r.w.printStackTrace(t,null,this)}},A.textarea.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.drilldown=function(){},A.drilldown.prototype.setInnerHTML=function(t,e,i){var o=i,s=100,r=this.options.depthColumn;if("linkedDataList"===this.mode){if(null!=this.mainGrid._linkedDataList.filteredRowIndexArr&&this.mainGrid._linkedDataList.filteredRowIndexArr.length>0){o=this.mainGrid._linkedDataList.filteredRowIndexArr[i];var n=this.mainGrid._linkedDataList.filteredRowIndexArr.length-1;s=o<this.mainGrid._linkedDataList.filteredRowIndexArr[n]?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null}}else null!=this.mainGrid._dataList.filteredRowIndexArr&&this.mainGrid._dataList.filteredRowIndexArr.length>0&&(s=(o=this.mainGrid.dataList.getRealRowIndex(i))<this.mainGrid.dataList.getRealRowIndex(this.mainGrid.getDataLength()-1)?parseInt(this.mainGrid.dataList._getCellData(i+1,r),10):null);for(var l=parseInt(this.mainGrid.dataList._getCellData(i,r),10),h="",d=o,u=1;u<l;u++)"div"==this.options.depthType?h+="<div class='w2grid_depthBlank'></div>":"line"==this.options.depthType?(h="<div class='w2grid_depth"+(1===u?this.mainGrid.drilldown.isLastChild(d)?"_line_L":"_line_T":this.mainGrid.drilldown.isLastChild(d)?"Blank":"_line_I")+"'></div>"+h,d=this.mainGrid.drilldown.getParentRowIndex(d)):"none"==this.options.depthType?h+="":h+="&nbsp;&nbsp;";var p=0,c="w2grid_plus";null!=s&&l<s?(p=1,c="w2grid_minus"):this.mainGrid.hasChild(i)||(p=2,c="w2grid_leaf"),1==l&&(c+=" w2grid_root");var g=""
;g=a.D.isMobile()?"<span class='"+c+"' style='display:inline-block;' openStatus='"+p+"' ontouchstart='this.clicked=true'></span>":"<span class='"+c+"' style='display:inline-block;' openStatus='"+p+"' onclick='this.clicked=true'></span>";var f="<div class='w2grid_depthBlank";"1"==l&&(f+=" w2grid_depthBlank_root"),2===p&&(f+=" w2grid_depthBlank_leaf"),f+="'>";var m=this.options.escape+""=="true"?this.getDisplayData(WebSquare.xml._encode(e+"")):this.getDisplayData(e);"div"==this.options.depthType?(g=f+g+"</div>",t.innerHTML="<nobr class='w2grid_drilldown_nobr'>"+h+g+m+"</nobr>"):"line"==this.options.depthType?(g=f+g+"</div>",t.innerHTML=h+g+"<nobr class='w2grid_drilldown_nobr'>"+m+"</nobr>"):(this.options.depthType,t.innerHTML="<nobr>"+h+g+m+"</nobr>")},A.drilldown.prototype.handleClick=function(t,e){var i=t.getElementsByTagName("span")[0];return 1==i.clicked&&(i.clicked=!1,"2"!=i.getAttribute("openStatus")&&this.mainGrid._toggle(e),!0)},A.drilldown.prototype.setEditMode=function(t,e){try{this.editRowIndex=e,this.editTd=t,this.setPosition();var i=this.mainGrid.getInput(this);i.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,i.options.applyFormat=this.options.applyFormat,i.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),document.activeElement!=i.render&&i.focus(),"native"!==this.mainGrid.options.drawType&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==i.options.editType&&i.select()}catch(t){r.w.printStackTrace(t,null,this)}},A.drilldown.prototype.setPosition=function(){var t={top:0,left:0,width:0,height:0};if(a.D.isFF()?t={top:-1,left:-1,width:0,height:0}:a.D.isOpera()?t={top:0,left:0,width:0,height:1}:a.D.isIE(9)&&(t={top:-1,left:-1,width:0,height:0}),"native"===this.mainGrid.options.drawType){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}var i=this.editTd,o=i.offsetTop+1+t.top,s=i.offsetLeft+1+t.left,r=i.clientWidth-6+t.width,n=i.clientHeight-2+t.height,l=this.mainGrid.getInput(this);if(""!=this.options.imeMode)l.render.style.imeMode=this.options.imeMode;else{var h=this.mainGrid.getColumnOption(this.options.col_id,"dataType");l.render.style.imeMode="number"==h?"disabled":""}if(l.show(),this.mainGrid.options.groupbyZone){var d=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(d=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),o+=d}l.render.style.top=o+"px",l.render.style.left=s+"px",l.render.style.width=r+"px",l.render.style.height=n+"px",a.D.isIE()&&(l.render.style.lineHeight=n+"px"),l.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign},A.drilldown.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},A.drilldown.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this);return this.setEditData(e),e}catch(t){r.w.printStackTrace(t,null,this)}},A.drilldown.prototype._handleEndEdit_focus=function(t,e){!this.mainGrid.isMobile&&e||t.hide()},A.drilldown.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},A.drilldown.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID)),this.mainGrid.getInput(this).hide()}catch(t){r.w.printStackTrace(t,null,this)}},A.drilldown.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.drilldown.prototype.setEditData=function(t){try{var e=t.getValue();e=t.validator.validateString(e),t.setValueNM(e,!0),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.getColumnIndex(this.colID));var i=this.mainGrid.getColumnOption(this.options.col_id,"dataType")
;this.mainGrid.options.numberCasting&&"number"==i&&""!=e&&(e=Number(e));var o={};o[this.mainGrid.id]=!0,this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,e,null,null,null,o)}catch(t){r.w.printStackTrace(t,null,this)}},A.textImage=function(){},A.textImage.prototype.setInnerHTML=function(t,e,i,o,s){var n=this.mainGrid.getElemRowIndex(t),l=this.mainGrid.dataList.getRealRowIndex(n),h=this.mainGrid._getGroupbyDisplayRowIndex(i),u=this.mainGrid.getColumnIndex(this.colID),p=this.mainGrid.getCellOption(l,u,"viewType"),c=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"",g=this.mainGrid.getColumnID(o),f=!1,m=!1;this.mainGrid._getEditDisabled(i,g)?(f=!0,this.options.imageSrcDisabled&&(c=this.mainGrid.getImageURL(this.options.imageSrcDisabled))):this.mainGrid.___getEditReadOnly(i,g)&&(m=!0,this.options.imageSrcReadOnly&&(c=this.mainGrid.getImageURL(this.options.imageSrcReadOnly)));var y=e,b=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id),w=a.D.getGlobalFunction(this.options.customModelUnformatter,this.scope_id);"function"==typeof w&&(y=w.call(this.mainGrid,e,h,o));var v,I,C=this.getDisplayData(y);if("function"==typeof b?(this.useCustomFormatter=!0,v=b.call(this.mainGrid,e,C,h,o)):(this.useCustomFormatter=!1,v=C),this.mainGrid.options.titleFormatter)try{if("function"!=typeof this.mainGrid.options.titleFormatter){var x=a.D.getGlobalFunction(this.mainGrid.options.titleFormatter,this.scope_id);"function"==typeof x&&(this.mainGrid.options.titleFormatter=x,I=x.call(this,i,o,e))}else I=this.mainGrid.options.titleFormatter.call(this,i,o,e);t.setAttribute("title",I)}catch(t){r.w.printStackTrace(t,null,this)}if("icon"==p||""==p&&"own"==this.options.dataType){var _="";try{this.options.onerror&&(_=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){r.w.printStackTrace(t,null,this)}var S="w2grid_textImage_image";f?S+=" w2grid_textImage_disabled":m&&(S+=" w2grid_textImage_readonly");var D=t.getAttribute("tdIndex");t.removeAttribute("alt");var R="";""!=this.options.alt&&(R=" alt='"+this.options.alt+"' "),t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px; width:100%; table-layout:fixed;'>","<td col_id='"+this.colID+"' rowIndex='"+i+"' colIndex='"+o+"' tdIndex='"+D+"' class='w2grid_textImage' style='overflow:hidden; text-overflow:ellipsis;'>","<nobr>"+v+"</nobr>","</td>","<td col_id='"+this.colID+"' rowIndex='"+i+"'  colIndex='"+o+"' class='"+S+"' style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'>","<img src='"+c+"' "+_+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","'"+R+" />","</td>","</table>"].join("");var L=this,T=t.getElementsByTagName("img")[0];d.B.addListener(T,"onclick",(function(t){d.B.stopPropagation(t);var s=L.mainGrid._getEditDisabled(i,o);if(L.options.useImageClick||0==s){if(L.mainGrid.editedCell){var r=L.mainGrid._getGroupbyDisplayRowIndex(L.mainGrid.editedCell.editRowIndex),n=L.mainGrid.editedCell.colID,u=L.mainGrid._dataList.getCellData(r,n);L.mainGrid.editedCell.handleEndEdit();var p=L.mainGrid._dataList.getCellData(r,n);p!=u&&d.B.fireEvent(L.mainGrid,"onviewchange",{oldValue:u,newValue:p,rowIndex:r,colIndex:L.mainGrid.getColumnIndex(n)})}var c=L.getDisplayData(e),g=a.D.getGlobalFunction(L.options.imageClickFunction,L.scope_id);d.B.fireEvent(L.mainGrid,"ontextimageclick",i,o),L.mainGrid._setFocusedCell(i,o),"function"==typeof g&&(L.options.displayRowIndex?g.call(L.mainGrid,h,L.colID,c):g.call(L.mainGrid,l,L.colID,c))}}))}else t.innerHTML="<nobr>"+v+"</nobr>"},A.textImage.prototype.setEditMode=function(t,e){try{var i="";try{this.options.onerror&&(i=' onerror="('+this.options.onerror+').call(this,event);" ')}catch(t){r.w.printStackTrace(t,null,this)}
var o=this.options.imageSrc?this.mainGrid.getImageURL(this.options.imageSrc):"";t.innerHTML=["<table style='border-collapse:collapse; border-spacing:0px;'><td></td><td>","<img src='"+o+"' "+i+"style='",""!=this.options.imageWidth?"width:"+parseInt(this.options.imageWidth)+"px;":"",""!=this.options.imageHeight?"height:"+parseInt(this.options.imageHeight)+"px;":"","' />","</td></table>"].join("");var s=t.getElementsByTagName("td")[1].firstChild,n=this.mainGrid.getElemRowIndex(t),l=this.mainGrid.getColumnIndex(this.colID),h=this.mainGrid._dataList.filteredRowIndexArr[n],u=this;d.B.addListener(s,"onclick",(function(t){if(d.B.stopPropagation(t),u.mainGrid.editedCell){var i=u.mainGrid._getGroupbyDisplayRowIndex(u.mainGrid.editedCell.editRowIndex),o=u.mainGrid.editedCell.colID,s=u.mainGrid._dataList.getCellData(i,o);u.mainGrid.editedCell.handleEndEdit();var r=u.mainGrid._dataList.getCellData(i,o);r!=s&&d.B.fireEvent(u.mainGrid,"onviewchange",{oldValue:s,newValue:r,rowIndex:i,colIndex:u.mainGrid.getColumnIndex(o)})}var n=u.mainGrid.getInput(u).getValue(),p=a.D.getGlobalFunction(u.options.imageClickFunction,u.scope_id);d.B.fireEvent(u.mainGrid,"ontextimageclick",e,l),"function"==typeof p&&(u.options.displayRowIndex?p.call(u.mainGrid,e,u.colID,n):p.call(u.mainGrid,h,u.colID,n))})),this.editRowIndex=e,this.editTd=t,this.internal&&(this.parentColumnInfo.editRowIndex=e,this.parentColumnInfo.editTd=t),this.setPosition();var p=this.mainGrid.getInput(this);this.comp=p,p.formatter="all"==this.options.applyFormat?this.formatter:this.emptyFormatter,p.options.applyFormat=this.options.applyFormat,p.setValue(this.mainGrid.dataList._getCellData(e,this.colID)),p.focus(),"native"!==this.mainGrid.options.drawType&&(this.mainGrid.render.scrollLeft=0,this.mainGrid.render.scrollTop=0),"select"==p.options.editType?p.select():"focus"==p.options.editType&&(a.D.isIE()||a.D.isFF())&&WebSquare.text.setCaretPos(p.render,p.render.value.length)}catch(t){r.w.printStackTrace(t,null,this)}},A.textImage.prototype.setPosition=function(){try{var t={top:0,left:0,width:0,height:0,tdWidth:0};if(a.D.isFF()?t={top:-1,left:-1,width:0,height:0,tdWidth:0}:a.D.isOpera()&&(t={top:0,left:0,width:0,height:1,tdWidth:0}),"native"===this.mainGrid.options.drawType){var e=document.getElementById(this.mainGrid.id+"_dataLayer");t.top-=e.scrollTop,t.left-=e.scrollLeft}var i=this.editTd,o=i.getElementsByTagName("td"),s=o[1].firstChild,n=i.clientWidth-s.offsetWidth-1+t.tdWidth,l=i.offsetTop+1+t.top,h=i.offsetLeft+1+t.left,d=i.clientWidth-s.offsetWidth-6+t.width,u=i.clientHeight-2+t.height;if(this.mainGrid.options.groupbyZone){var p=this.mainGrid.groupbyZoneStatus.groupbyZoneRender.offsetHeight;this.mainGrid.options.groupbyFilterBox&&"top"===this.mainGrid.options.groupbyFilterBoxLocation&&(p=parseInt(this.mainGrid.options.groupbyZoneHeight,10)+document.getElementById(this.mainGrid.id+"_groupbyFilterBox_div").offsetHeight),l+=p}o[0].style.width=n+"px";var c=this.mainGrid.getInput(this);if(""!=this.options.imeMode)c.render.style.imeMode=this.options.imeMode;else{var g=this.mainGrid.getColumnOption(this.options.col_id,"dataType");c.render.style.imeMode="number"==g?"disabled":""}if(this.mainGrid.hasClass("w2grid_adaptive_crosstab"))l-=document.getElementById(this.mainGrid.id+"_body_tbody").scrollLeft,c.render.style.lineHeight=u+"px";c.show(),c.render.style.top=l+"px",c.render.style.left=h+"px",c.render.style.width=d+"px",c.render.style.height=u+"px",c.render.style.lineHeight=u+"px",c.render.style.textAlign=""==i.style.textAlign?"center":i.style.textAlign}catch(t){r.w.printStackTrace(t,null,this)}},A.textImage.prototype.removeCellData=function(t,e){this.mainGrid.dataList.__setCellData(t,e,"")},A.textImage.prototype._handleEndEdit_common=function(t){try{var e=this.mainGrid.getInput(this),i=e.getValue();i=e.validator.validateString(i),this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID));var o={};o[this.mainGrid.id]=!0
;var s=a.D.getGlobalFunction(this.options.customModelFormatter,this.scope_id);if("function"==typeof s){this.useCustomModelFormatter=!0;var n=this.getDisplayData(i);i=s.call(this.mainGrid,i,n,this.editRowIndex,this.getColumnIndex(this.colID))}else this.useCustomModelFormatter=!1;return this.mainGrid.dataList.__setCellData(this.editRowIndex,this.colID,i,null,null,null,o),e}catch(t){r.w.printStackTrace(t,null,this)}},A.textImage.prototype._handleEndEdit_focus=function(t){t.setDisabled(!1),t.setReadOnly(!1),t.hide()},A.textImage.prototype._getEditedValue=function(t){return this.mainGrid.getInput(this).getValue()},A.textImage.prototype._handleCancelEdit=function(t){try{var e=this.mainGrid.getInput(this),i=this.mainGrid.dataList._getCellData(this.editRowIndex,this.colID);this.setInnerHTML(this.editTd,i,this.editRowIndex,this.getColumnIndex(this.colID)),e.hide()}catch(t){r.w.printStackTrace(t,null,this)}},A.textImage.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.textImage.prototype.showReadonly=function(t,e){this.setEditMode(t,e);var i=this.mainGrid.getInput(this);i.setDisabled(!0),i.setReadOnly(!0),this.mainGrid.editedCell=this},A.prototype.setDataListCellRefresh=function(t){try{if(t){this.initFormatter(t);var e=this.options.dataType;e||(e=this.mainGrid._dataList.getColumnOption(this.options.col_id,"dataType")),"date"!=e||this.options.displayFormat||(this.options.displayFormat=s.v.getConfiguration("/WebSquare/"+this.mainGrid.options.pluginName+"/dataType/date/@displayFormat")),"time"!=e||this.options.displayFormat||(this.options.displayFormat="HH:mm");var i=!this.options.groupName||!this.options.groupValue,o=this.options.inputType;if(i&&("button"!=o&&"image"!=o)){var a=this.mainGrid._dataList.getCellInfo(this.colID),n=!(!a||!a.element&&a.id!==this.id);this.options.readOnly=!n||t.getAttribute("readOnly")}}}catch(t){r.w.printStackTrace(t,null,this)}},A.spinner=function(){},A.spinner.prototype.initializeCellInfo=function(t){try{if(!this.xml)if("json"===t._elementType)t._element.N="w2:"+this.options.inputType,this.xml=t;else{var e="",i=(e=a.D.isIE("6 7")&&this.internal?WebSquare.xml.nodeWellFormed(t.outerHTML):WebSquare.xml.serialize(t)).indexOf("xmlns:w2")<0?' xmlns:w2="http://www.inswave.com/websquare"':"";e=(e=e.wq_replaceAll("<w2:column","<w2:spinner"+i)).wq_replaceAll("</w2:column","</w2:spinner");var o=WebSquare.xml.parse(e,!0);this.xml=o.documentElement}}catch(t){r.w.printStackTrace(t,null,this)}},A.spinner.prototype.setInnerHTML=function(t,e,i,o,s){null==e&&(e=""),this.spinner&&this.spinner.render&&t.firstChild==this.spinner.render&&t.removeChild(this.spinner.render),t.innerHTML="<nobr>"+this.getDisplayData(e,i)+"</nobr>";var r=this.mainGrid.dataList.getRealRowIndex(i),a=this.mainGrid.getCellOption(r,o,"viewType"),n=this.mainGrid.getColumnOption(this.options.col_id,"dataType");("icon"==a||""==a&&"own"==n)&&(this.mainGrid.addClass(t,this.mainGrid.options.bodyTdClass+"_spinner"),t.setAttribute("editModeEvent",this.options.editModeEventIcon))},A.spinner.prototype.setEditMode=function(t,e){try{if(""==this.style){this.style="position:relative;left:0px;top:0px;background-color:#ffffff;",this.xml.setAttribute("class",this.mainGridId+"_spinner_"+this.id),this.xml.setAttribute("style",this.style),this.configOptions={},this.options.dataType&&(this.configOptions.dataType=this.options.dataType),this.options.buttonSize&&(this.configOptions.buttonSize=this.options.buttonSize),this.options.dateIncrementType&&(this.configOptions.dateIncrementType=this.options.dateIncrementType),this.options.displayFormat&&(this.configOptions.displayFormat=this.options.displayFormat),this.options.displayFormatter&&(this.configOptions.displayFormatter=this.options.displayFormatter),this.options.increment&&(this.configOptions.increment=this.options.increment),this.options.min&&(this.configOptions.min=this.options.min),this.options.max&&(this.configOptions.max=this.options.max),
this.options.editType&&(this.configOptions.editType=this.options.editType);var i=t.getAttribute("tdindex");this.mainGrid._getEditDisabled(e,i)?this.configOptions.disabled=!0:this.configOptions.disabled=!1,this.configOptions.xmlEvents=[{name:"ondblclick",action:"script",param:{handler:function(t){d.B.stopPropagation(t)}}}],this.spinner=new WebSquare.uiplugin.spinner(this.mainGridId+"_spinner_"+this.id,this.configOptions,this.xml),this.spinner.isGridCellComponent=!0;var o=this;this.spinner._handleClickEvent=this.spinner.handleClickEvent,this.spinner.handleClickEvent=function(t){var e=o.mainGrid.getElemRowIndex(this.render.parentElement),i=o.mainGrid._getGroupbyDisplayRowIndex(e),s=this.render.parentElement.getAttribute("tdindex");if(this.options.customFormatter){try{var r=null,n={};if("function"==typeof(r=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id)))for(var l in n=r(i,s))this.options.hasOwnProperty(l)&&(this.options[l]=n[l])}catch(t){r=null}this._handleClickEvent(t)}else this._handleClickEvent(t);d.B.stopEvent(t)},this.spinner._inputKeyDown=this.spinner.inputKeyDown,this.spinner.inputKeyDown=function(t,e){27==t.keyCode||o.spinner._inputKeyDown(t,e)},t.innerHTML=this.spinner.toHTML(),this.spinner.activate(),this.spinner.setSize(t.clientWidth-2,t.clientHeight-2)}else t.innerHTML="",t.appendChild(this.spinner.render),this.spinner.show();this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),this.editColIndex=this.mainGrid.getColumnIndex(this.id),this.editRowIndex=e,this.editTd=t,this.spinner.setValue(this.mainGrid.dataList._getCellData(e,this.id)),"select"!=this.options.editType&&"focus"!=this.options.editType||this.spinner.focus()}catch(t){r.w.printStackTrace(t,null,this.mainGrid)}},A.spinner.prototype._handleEndEdit_common=function(t){try{var e=this.spinner.getValue();if("number"==this.spinner.options.dataType){Number(e);this.options.customFormatter?(this.spinner.options.maxValue&&(this.maxValue=Number(this.spinner.options.maxValue)),this.spinner.options.minValue&&(this.minValue=Number(this.spinner.options.minValue)),!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)):!isNaN(this.maxValue)&&e>this.maxValue?e=this.maxValue+"":!isNaN(this.minValue)&&this.minValue>e&&(e=this.minValue)}else this.spinner.options.dataType;this.mainGrid.dataList.__setCellData(this.editRowIndex,this.id,e),this.setInnerHTML(this.editTd,e,this.editRowIndex,this.id),this.spinner.hide()}catch(t){r.w.printStackTrace(t,null,this)}},A.spinner.prototype._handleCancelEdit=function(t){},A.spinner.prototype._handleEndEdit_focus=function(){try{return null}catch(t){r.w.printStackTrace(t,null,this)}},A.spinner.prototype.doDefaultAction=function(t){t.ctrlKey||this.mainGrid.setEditHtml(t)},A.custom=function(){},A.custom.prototype.initializeCellInfo=function(t,e){try{!e&&t&&"function"==typeof t.getTagName&&"w2:column"==t.getTagName()&&(1==this.mainGrid.options.setCellInputTypeCustom?(this.parseTypeGetter(),this.cellManagerHashByRowIndex=[],this.cellManagerIDByRowIndex=[]):(this.parseTypeGetter(),this.cellManagerHashByID={},this.cellManagerHashByRowIndex={},this.cellManagerIDByRowIndex={}))}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.initializeCellManager=function(t,e){try{var i=e.inputType?e.inputType:e.tagName;if(t.id=e.id,t.colID=this.id,t._position={colIndex:this.mainGrid.getColumnIndex(this.colID),colID:this.id,realRowIndex:e.realRowIndex,displayRowIndex:e.displayRowIndex},t.parentColumnInfo=this,t.options.inputType=i,t.initializeInputType=this.getTagName(i),t.initializeInfo=e,"gridViewItemset"===e.itemTableType&&!e.itemSet)for(var o in t.initializeInfo.itemSet={nodeset:e.nodeset,label:e.label,value:e.value},t.options.itemSet=t.initializeInfo.itemSet,t.options.item=e.item,t.options.gridViewOptions={},t.options.itemTableType="gridViewItemset",
e)t.options.gridViewOptions[o]=e[o];for(var o in e.options)t.options[o]=e.options[o];t.initFormatter()}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.getMapping=function(t,e){try{switch(t){case"text":return o.x.extend(e,WebSquare.uiplugin.cellInfo.text.prototype),!0;case"link":return o.x.extend(e,WebSquare.uiplugin.cellInfo.link.prototype),!0;case"checkbox":return o.x.extend(e,WebSquare.uiplugin.cellInfo.checkbox.prototype),!0;case"button":return o.x.extend(e,WebSquare.uiplugin.cellInfo.button.prototype),!0;case"image":return o.x.extend(e,WebSquare.uiplugin.cellInfo.image.prototype),!0;case"radio":return o.x.extend(e,WebSquare.uiplugin.cellInfo.radio.prototype),!0;case"select":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.select.prototype),!0;case"calendar":return o.x.extend(e,WebSquare.uiplugin.cellInfo.calendar.prototype),!0;case"textarea":return o.x.extend(e,WebSquare.uiplugin.cellInfo.textarea.prototype),!0;case"expression":return o.x.extend(e,WebSquare.uiplugin.cellInfo.expression.prototype),!0;case"textImage":return o.x.extend(e,WebSquare.uiplugin.cellInfo.textImage.prototype),!0;case"checkcombobox":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.checkcombobox.prototype),!0;case"autoComplete":return o.x.extend(e,WebSquare.uiplugin.cellInfo.itemsetControl.prototype),o.x.extend(e,WebSquare.uiplugin.cellInfo.autoComplete.prototype),!0;default:return o.x.extend(e,WebSquare.uiplugin.cellInfo.text.prototype),!0}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.getTagName=function(t){try{switch(t){case"text":return"input";case"link":return"anchor";case"button":return"trigger";case"select":return"selectbox";default:return t}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.parseTypeGetter=function(){try{this.options.typeGetter?(this.typeGetter=a.D.getGlobalFunction(this.options.typeGetter,this.scope_id),this.isValidTypeGetter=!0):(this.isValidTypeGetter=!1,0==this.options.setCellInputTypeCustom&&$l("Custom type 그리드 생성 중 오류가 발생하였습니다. typeGetter 속성이 정의되어 있지 않습니다.  gridView ["+this.mainGrid.id+"] column:["+this.id+"]"))}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.updateCellManagerHash=function(t,e,i,o){try{this.isValidTypeGetter?(this.cellManagerHashByID[t]=i,this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t):(this.cellManagerHashByRowIndex[e]=i,this.cellManagerIDByRowIndex[e]=t),o&&i.itemsetObj&&o.nodeset!==i.itemsetObj.nodeset&&i.setColumnNodeSet(o.nodeset,o.label,o.value)}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.createCellManager=function(t,e){try{var i=e.id,o=e.realRowIndex,s=new WebSquare.uiplugin.cellInfo(t,this.mainGrid,!0);if(this.mainGrid.options.senseReader&&"false"!==s.options.embeddedInput&&(s.options.embeddedInput=!0),this.getMapping(e.inputType,s)){if(this.initializeCellManager(s,e),s.initializeCellInfo(t,e.options),s.isLocked=!0,this.updateCellManagerHash(i,o,s),!0===s.options.embeddedInput){var a=e.itemSet;a&&"function"==typeof s.setColumnNodeSet&&s.setColumnNodeSet(a.nodeset,a.label,a.value,o)}return this.cellManagerHashByRowIndex[o]}var n=this.options.id,l=this.mainGrid.getColumnIndex(n);return $l("Custom type 그리드 생성 중 오류가 발생하였습니다. gridView ["+this.mainGrid.id+"] column:["+this.id+"] inputType:["+e.inputType+"] realRowIndex:["+o+"] colIndex["+l+"]"),!1}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.getCellManager=function(t){try{var e=t.managerID,i=t.element,o=t.rowIndex,s=t.realRowIndex,a=this.options.id,n=this.mainGrid.getColumnIndex(a),l=this.mainGrid.dataList.getCellData(o,n),h={colID:a,colIndex:n,rowIndex:o,displayRowIndex:t.rowIndex,realRowIndex:t.realRowIndex,value:l};try{var d,u;if(1!=this.mainGrid.options.setCellInputTypeCustom||this.isValidTypeGetter){if(this.cellManagerHashByID[e])return this.cellManagerHashByID[e];if(this.isValidTypeGetter){
u=this.typeGetter(h);p=this.cellManagerIDByRowIndex[s];if(!u||p!==u.id){c=this.mainGrid.id+"_"+p;g=this.mainGrid.dom[c],f=null;null!=g&&(f=WebSquare.idCache[g.uuid]),f&&"function"==typeof f.remove&&f.remove(),delete this.mainGrid.dom[c],this.cellManagerHashByID[p]=null,this.cellManagerHashByRowIndex[s]=null}}else this.parseTypeGetter(),this.isValidTypeGetter&&(u=this.typeGetter(h))}else if(1==t.dynamicInputType){if((u=t.options).id="dynamic_"+u.inputType+"_"+o+"_"+n,this.cellManagerHashByRowIndex[s]){var p=this.cellManagerIDByRowIndex[s],c=this.mainGridId+p,g=this.mainGrid.dom[c],f=null;null!=g&&(f=WebSquare.idCache[g.uuid]),f&&"function"==typeof f.remove&&f.remove(),delete this.mainGrid.dom[c],this.cellManagerIDByRowIndex[s]=null,this.cellManagerHashByRowIndex[s]=null}}else if(this.cellManagerHashByRowIndex[s]&&!t.dynamicInputType)return this.cellManagerHashByRowIndex[s];return u?(u.isUDC||((d=1==this.mainGrid.options.setCellInputTypeCustom?this.cellManagerHashByRowIndex[s]:this.cellManagerHashByID[u.id])?(this.updateCellManagerHash(u.id,s,d,u.itemSet),d.isLocked):(u.realRowIndex=s,u.rowIndex=o,u.displayRowIndex=o,d=this.createCellManager(i,u))),1!=this.mainGrid.options.setCellInputTypeCustom&&(d.customValue=u.value)):d=this.createCellManager(i,{id:this.colID+"_"+s+"__default",inputType:"text",realRowIndex:s}),d}catch(t){return $l("Custom type 그리드 생성 중 오류가 발생하였습니다. gridView ["+this.mainGrid.id+"] column:["+this.id+"] realRowIndex:["+s+"] colIndex["+n+"]"),!1}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.setInnerHTML=function(t,e,i,o,s){try{var a=this.mainGrid.getRealRowIndex(i),n=this.getCellManager({element:this.element,rowIndex:i,realRowIndex:a});if(!1===n)t.innerHTML="<nobr>"+e+"</nobr>";else{this.clearStyle(n,t);!0===this.isValidTypeGetter&&n.options.class&&this.mainGrid.addClass(t,n.options.class),n.setInnerHTML(t,e,i,o),null!=n.customValue&&(e=n.customValue,this.mainGrid.dataList.__setCellData(i,this.colID,e)),this.useCustomFormatter=n.useCustomFormatter,this.useCustomModelFormatter=n.useCustomModelFormatter,this.useEscapeFormatter=n.useEscapeFormatter}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.setEditMode=function(t,e){try{if(!this.internal){var i=this.mainGrid.getRealRowIndex(e),o=this.cellManagerHashByRowIndex[i];o&&o.setEditMode(t,e)}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.setPosition=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];e&&e.setPosition()}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype._handleEndEdit_common=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];if(i)return i._handleEndEdit_common(t)}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype._handleEndEdit_focus=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex)||this.editRowIndex,i=this.cellManagerHashByRowIndex[e];i&&i._handleEndEdit_focus(t)}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype._handleCancelEdit=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i._handleCancelEdit()}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.doDefaultAction=function(t){try{if(!this.internal){var e=this.mainGrid.getRealRowIndex(this.editRowIndex),i=this.cellManagerHashByRowIndex[e];i&&i.doDefaultAction()}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.clearStyle=function(t,e){try{"calendar"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_calendar")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_calendar"),e.setAttribute("editModeEvent","")),
"select"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_select")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_select"),e.setAttribute("editModeEvent","")),"autoComplete"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_autoComplete"),e.setAttribute("editModeEvent","")),"checkcombobox"!=t.initializeInputType&&this.mainGrid.hasClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox")&&(WebSquare.style.removeClass(e,this.mainGrid.options.bodyTdClass+"_checkcombobox"),e.setAttribute("editModeEvent",""))}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.validate=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];if(!e)return!0;switch(e.options.inputType){case"calendar":return e.validate();default:return!0}}}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype._getEditedValue=function(){try{if(!this.internal){var t=this.mainGrid.getRealRowIndex(this.editRowIndex),e=this.cellManagerHashByRowIndex[t];if(e&&e._getEditedValue)return e._getEditedValue()}return""}catch(t){r.w.printStackTrace(t,null,this)}},A.custom.prototype.refreshCellManagerHash=function(){try{for(var t=this.mainGrid.getRowCount(),e=0;e<t;e++)this.getCellManager({element:this.element,rowIndex:e,realRowIndex:this.mainGrid.getRealRowIndex(e)})}catch(t){r.w.printStackTrace(t,null,this)}},A.user=function(){},A.user.prototype.setInnerHTML=function(t,e,i,o,s){var r,n=a.D.getGlobalFunction(this.options.customFormatter,this.scope_id),l=this.mainGrid._getGroupbyDisplayRowIndex(i),h=this.getDisplayData(e);"function"==typeof n?(this.useCustomFormatter=!0,r=n.call(this.mainGrid,e,h,l,o)):(this.useCustomFormatter=!1,r=h),t.innerHTML="<nobr>"+r+"</nobr>"},A.user.prototype.doDefaultAction=function(t){if("none"==this.mainGrid.options.focusMode){for(var e=d.B.getTarget(t);e&&"TD"!=e.tagName;)e=e.parentNode;if(!e)return;var i=this.mainGrid.getElemRowIndex(e),o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=this.mainGrid.getColumnIndex(e.getAttribute("col_id"))}else{var r=this.mainGrid.getLastFocusedCell();i=r.focusedRowIndex,o=this.mainGrid._getGroupbyDisplayRowIndex(i),s=r.focusedColIndex}this.mainGrid._getEditDisabled(i,s)||this.mainGrid.___getEditReadOnly(i,s)||d.B.fireEvent(this.mainGrid,"oncellclick",o,s,this.options.id)};var F=function(t,e,i){n.s.call(this,t,e,i)};o.x.extend(F.prototype,n.s.prototype),F.prototype.defaultOptions={useConfig:!0,pluginType:"uiplugin.gridView",pluginName:"gridView",serializable:!0,userEvents:["oncellclick","oncelldblclick","onrightbuttonclick","ontextimageclick","ondateselect","oneditdblclick","oncellindexchange","onrowindexchange","oncolumnindexchange","onfilereadend","onscrollend","onscrollstart","onbeforeedit","oneditend","oneditkeydown","onafteredit","onscrolly","onscrollx","onsort","onbeforesort","onheaderclick","onheaderrightbuttonclick","onheaderdblclick","onfooterclick","onsubtotalclick","onsubtotaldblclick","onbodymouseover","onbodymouseout","ongroupby","ontoggleclick","onclick","onblankclick","onkeydown","onkeyup","onviewchange","onbeforepaste","onafterpaste","oncolumnwidthchange","onbeforecolumnmove","onaftercolumnmove","onaftercolumnresize","ondatadragstart","ondatadragover","ondatadrop","oncontextopen","oncontextclick","oneditkeyup"],rowNumVisible:!1,rowNumRowSpan:!0,rowNumHeaderValue:"",rowNumLocaleRef:"",rowNumBackgroundColor:"",rowNumStatusResize:!1,rowStatusVisible:!1,rowStatusRowSpan:!0,rowStatusColSpan:!1,rowStatusHeaderValue:"",rowStatusLocaleRef:"",overflowX:"auto",overflowY:"auto",fixedColumn:0,fixedColumnWithHidden:!0,fixedColumnNoBGColor:!1,fixedColumnScrollHidden:!1,fixedColumnNoMove:!1,rowNumStatusFixed:!0,fixedRightColumn:0,fixedRow:0,lastFixedRow:0,lastFixedRowStartIndex:0,resize:!0,rowResize:!1,baseNode:"vector",repeatNode:"data/INFO",valueNode:"",
focusMode:"cell",selectedCellColor:"#FCA73C",selectedRowColor:"#FCA73C",oddEvenColorDisplay:!1,oddRowBackgroundColor:"#EFF7FF",evenRowBackgroundColor:"#FFFFFF",rowMouseOver:!1,rowMouseOverColor:"#ffff80",selectedCellOverColor:"",selectedRowOverColor:"",editModeEvent:"ondblclick",editModeEventIcon:"onclick",keyMoveEditMode:!1,enterKeyMove:"down",sortable:!1,sortHeaderDiv:!1,sortOrderReverse:!1,noSortInit:!1,showSortableImage:!1,preventMultisort:!1,useCtrlOnMultisort:!0,useCtrlKey:!0,sortedImagePosition:"",sortedIconPosition:"",sortEvent:"ondblclick",headerTooltipDisplay:!1,rowStatusTooltipDisplay:!1,tabKeyMove:"right",tooltipDisplay:!1,tooltipDisplayTime:0,tooltipClass:"",tooltipStyle:"",tooltipHide:"click",tooltipShowAlways:!1,tooltipShowAlwaysColumns:"",tooltipHeaderShowAlways:!1,tooltipFormatter:"",tooltipFormatterHeader:"",tooltipPositionX:"20",tooltipPositionY:"3+cellHeight",tooltipDisplayColumn:"",tooltipHeader:!1,showImageTooltip:!1,captionTitle:"",captionAuto:!1,noResultMessageVisibleAlways:!1,noResultMessageVisible:!1,noResultMessageExclude:"",noResultMessage:"",noResultMessageClass:"",noResultMessageStyle:"",hiddenClass:"",readOnly:"",readOnlyPriority:"",readOnlyBackgroundColor:"",readOnlyBackgroundImg:"",readOnlyBackgroundImgCSS:"",readOnlyTabIgnore:!1,ignoreNonEditableCell:!1,ignoreNonEditableCellTabEnter:!1,disabledPriority:"",disabledBackgroundColor:"",disabledFontColor:"",summary:"",footerCaption:"",footerCaptionAuto:!1,footerSummary:"",footerSummaryAuto:!1,drawLimitTime:70,drawLimitRow:4,loadCount:0,autoFit:"",autoFitMinWidth:"",autoFitFixYScroll:!1,fastScroll:"",lazyDrawHiddenColumn:!1,defaultCellHeight:-1,defaultHeaderCellHeight:-1,hideHeader:!1,dataDragDrop:!1,dataDragDropOther:!1,dataDragDropSelf:!1,dataDragDropStatus:!1,dataDragSelect:!1,dataDragSelectAutoScroll:!1,dataDragSelectAutoScrollDPI:5,dataDragSelectAutoScrollPeriod:70,dataDragSelectAutoScrollDelay:50,dataDragSelectAutoScrollLevel:1300,dragDisplayColumn:"",dragStartFunction:"",dragEndFunction:"",headFiller:!1,focusMove:"true",focusFlow:"default",scrollMsg:"",visibleRowNum:"",visibleRowNumFix:!1,fixHeight:!1,fastEditMode:!1,iScrollMoveEffectTime:500,iScrollSlideTime:800,iScrollSlidePeriod:100,rollbackCommit:!0,numberCasting:!1,backgroundColorMode:"lazy",senseReader:!1,senseReaderLinkFocus:!1,useStartEndDiv:!0,showLastRow:!1,autoScope:!1,autoResizeEmbeddedInput:!1,servletPopup:!1,excelUploadPopupURL:"",advancedExcelUploadPopupURL:"",advancedExcelMultiUploadPopupURL:"",advancedExcelDownloadPopupURL:"",excelUploadURL:"",excelDownloadURL:"",csvDownloadURL:"",csvUploadPopupURL:"",csvUploadURL:"",advancedExcelUploadURL:"",advancedExcelDownloadURL:"",drilldownRealRowIndex:!0,drilldownRealRowIndexAll:!1,drilldownToggleScrollFix:!1,escape:!0,fixPrint:!1,xmlEncode:!1,wheelRows:3,wheelStop:!1,scrollByColumn:!1,scrollByColumnAdaptive:!1,rowNumWidth:"",rowStatusWidth:"",keepDefaultColumnWidth:!1,columnMove:!1,columnMoveWithFooter:!1,columnOrder:"",copyAmount:"",copyOption:"",copyType:"default",pasteOption:"",rowCopy:!1,customPasteFormatter:"",checkReadOnlyOnPaste:!1,checkDisabledOnPaste:!1,checkReadOnlyOnCut:!0,checkDisabledOnCut:!0,checkBlankRowOnPaste:!1,checkEditableInputClass:!1,checkOnCellClick:!1,setDefaultValueOnPaste:!1,preventAddRowOnPaste:!1,preventCopy:!1,preventPaste:!1,groupbyZone:!1,groupbyZoneSearch:!1,groupbyListVisibleRowNum:10,groupbyZoneMessage:"",groupbyZoneHeight:"50",groupbyMaxCount:-1,groupbyDisplayRowIndex:!1,plainText:!1,excludeDeletedRows:!1,excludeModifiedRows:!1,initFixedHeightByRowNum:-1,moveKeyEditMode:!1,moveKeyEditModeAll:!1,keepBeforeDisplayData:!1,touchScrollDelta:5,dataList:"",useFilterSearch:!1,useFilterList:!1,useFilterListSync:!1,useFilterListFormat:!1,filterListRowHeight:20,filterListVisibleRowNum:0,filterListWidth:0,caseSensitive:!1,displayValueOnUseFilterList:!1,customFilterListVisibleRowNum:10,showAllFilterList:!1,useFilterEmptyMsg:"",filterDisplayMode:"label",filterSearchTarget:"label",filterShowAlways:!1,
duplicateColumnId:!1,filterFocusMode:"",focusOnSetData:!1,focusDefaultColumn:!1,focusAutoRemove:!1,scrollFix:!1,scrollRowHeight:!1,applyAllColumnStyle:!1,disabledScrollHidden:!1,hammerEnabled:!1,hammerPressTime:351,dynamic:!1,ignoreCellClick:!1,ignoreToggleOnDisabled:!1,adaptive:"",autoFitFilterList:!1,summaryAuto:!1,summaryOnlyAuto:!1,arrowMove:!1,filterBoxvisibleRowNum:4,groupbyFilterBox:!1,groupbyFilterBoxLocation:"bottom",groupbyFilterBoxLabelSize:3,customFilterBox:!1,fixAdaptive:!1,groupbyFilterBoxFormatter:"",showSortableUseFilter:!1,customFormatterRealRowIndex:!1,oddEvenColorMerged:!1,showCustomFilterReset:!1,setCellInputTypeCustom:!1,initStyle:!1,mergeCol:"",mergeRow:"",mergeCells:"never",noImageTooltip:!1,mergeCellsFixedCols:"never",mergeCellsFixedRows:"never",rowNumStatusUniqueId:!1,checkHeaderOnly:!1,checkAllType:"include",useDefaultStyle:!1,foldAll:!1,contextMenu:!1,useHeaderContextMenu:!1,contextMenuRowHeight:20,contextMenuAltClick:!1,titleAuto:!1,syncScroll:!1,disabledClass:"w2grid_default_disabled",readOnlyClass:"w2grid_default_readonly",selectByLabel:!1,syncWithScrollTrack:!1,aliasDataCollection:"",editInputClass:"",directEdit:!1,numberMask:"",euroMask:"",rupeeMask:"",tengeMask:"",useMaxLength:!1,noSelect:!1,scrollFocus:!1,postMsg:!1,useXHR:!1,preventDuplicateFocusedCell:!1,alwaysTriggerScrollStart:!1,CellClickFixScrollX:!1,drawType:"virtual",mergeRefreshAlways:!0,subtotalStyleFormatter:"",useImageClick:!1},F.prototype.initialize=function(t){if(this.initializeType="gridView",isNaN(parseInt(this.options.visibleRowNum,10))||(this.options.initFixedHeightByRowNum=-1),this.options.initFixedHeightByRowNum>0&&""===this.options.visibleRowNum&&(this.options.visibleRowNum=this.options.initFixedHeightByRowNum),this.firstEmbeddedInputResize=!0,"none"===this.options.autoFit&&(this.options.autoFit=""),"native"===this.options.drawType&&(this.options.visibleRowNum="all"),"native"===this.options.copyType&&(this.options.noSelect=!1),t){for(var e=!1,i=!1,s=t.getChildNodes(),r=0;r<s.length;r++)"w2:header"!=s[r].getTagName()?"w2:gBody"!=s[r].getTagName()||(e=!0):i=!0;if(!e||!i)return this.uncompleted=!0,void(this.options.dynamic||$l(" gridView error : cannot find <w2:header> or <w2:gBody>.["+this.id+"]"))}if(this.options.dataList=this.options.dataList.wq_replaceAll("data:",""),this._dataList=null,this.options.dataList&&(this._dataList=this.modelControl.getDataComp(this.options.dataList,{type:"aliasDataCollection"})),this._dataList)switch(this._grid=this,this._dataList.addChild(this),this._dataList=WebSquare.DataCollection.api.getObj(this._dataList),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.x.extend(this,WebSquare.uiplugin.linkedMappingController.prototype),o.x.extend(this.dataList,WebSquare.uiplugin.linkedMappingController.prototype),this.dataList._linkedDataList=this._linkedDataList):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}else $l(" gridView error : invalid dataList("+this.options.dataList+").["+this.id+"]"),this.successBinding=!1,this._dataList={};this.skipPreActivate=!0;var a=this.options.dataList;null!=this.scope_obj&&(a=this.scope_obj.id+"_"+this.options.dataList),WebSquare.DataCollection.api.addRelation(this.id,a,!1),this.skipPreActivate=!1,this.myhelper=new WebSquare.korHelper,this._initialize()},F.prototype._initialize=function(t){this.focusedCellInfo={},this.extraData={grid:{},row:[],col:[],cell:[]},this.drilldown=new WebSquare.uiplugin.drilldown,"false"!=this.options.focusMove&&"horizontal"!=this.options.focusMove||(this.options.enterKeyMove="none"),this.options.groupbyFilterBox&&(this.groupbyFilterBox_select=null,this.groupbyFilterBox_history=[]),this.date=new Date,this.isDrillDown=!1,this.depthColumn="",
this.showDepth="",this.removed=!1,this.useExpression=!1,this.colWidthList=[],this.gridWidth=0,this.resizeStarted=!1,this.headerHeight=0,this.footerHeight=0,this.hgap=[],this.autofitColumn=!1,this.autofitColumnIndexArr=[],this.autofitColumnWidthArr=[],this.autofitDone=!1,this.resizeStatus="init",this.scrollWidthSize=18,this.scrollLayerWidthSize=18,this.hiddenList=[],this.headerFocus=!1,this.headerObjArr=[],this.tmpSelectbox=null,this.noevent=!1,this.rowIndex=-1,this.lastIndex=-1,this.oelIndex=-1,this.initializeDrawController(),this.drawedRowLength=0,this.maxRowLength=0,this.drawSizeChanged=!1,this.drawSizeAdded=!1,this.isExistTextarea=!1,this.bodyHeight=0,this.scrollEvent=!0,this.isColMerge=!1,this.isColMergeAnd=!1,this.upperToLowerColumnRelation={},this.hasSubtotal=!1,this.startRowNumber=0,this.dataRowList=[],this.subtotalRowHash={},this.subtotalDataArr={},this.subtotalObj={},this.drawSetTimeoutKey=[],this.overElem=null,this.outElem=null,this.hasFooter=!1,this.footerDataObj=null,this.drawFooterStatus=!0,this.bScrollTop=-1,this.bScrollY=0,this.drawedTime=0,this.defaultColCnt=0,this.options.rowNumVisible&&this.defaultColCnt++,this.options.rowStatusVisible&&this.defaultColCnt++,this.loadCheck=[],this.beforeDataLength=-1,this.beforeMaxRowLength=-1,this.checkScrollStart=!0,this.editEnd=!1,this.lastOverSrc=null,this.headerInfoHash={},this.headerInfoHash2={},this.cellInfoHash={},this.cellInfoHash2={},this.expressionAssArr=[],this.labelColumnAssArr=[],this.rowStyleValueObj={},this.columnStyleValueObj={},this.cellStyleValueObj={},this.defaultStyleValueObj={},this.initStyleValueObj={},this.adaptiveColumnStyleValueObj={},this.rowStyleFixedValueObj={},this.rowStyleDataValueObj={},this.columnStyleFixedValueObj={},this.columnStyleDataValueObj={},this.disabledCellStyleObj={},this.headerCellStyleValueObj={},this.headerCellClassObj={},this.rowStyleIndex=0,this.cellStyleIndex=0,this.rowStyleFixedIndex=0,this.rowStyleDataIndex=0,this.rowStyleArr=[],this.cellStyleArr=[],this.cellClassArr=[],this.tdCellClassArr=[],this.columnClassObj={},this.rowStyleFixedArr=[],this.rowStyleDataArr=[],this.columnStyleFixedArr=[],this.columnStyleDataArr=[],this.rowReadOnlyArr=[],this.cellReadOnlyArr=[],this.rowDisabledArr=[],this.cellDisabledArr=[],this.focusedCell=[],this.focusedRow=[],this.headerToBodyRelation={},this.bodyToHeaderRelation={},this.passiveColSpanRelation={},this.colMoveBolockedHeaderObj={},this.backupHeaderHTML={},this.expressionHeaderInfo={},this.columnOrder=[],this.isIE6=a.D.isIE("6"),"BackCompat"==document.compatMode&&(this.isIE6=!0),this.isIE7=a.D.isIE("7"),this.isIE6or7=this.isIE6||this.isIE7,this.isMobile=a.D.isMobile(),this.isWebKit=/webkit/.test(navigator.userAgent.toLowerCase()),this.tmpCnt=0,this.initFlag=!1,this.options.rowNumBackgroundColor=this.options.rowNumBackgroundColor.wq_trim(),this.options.selectedCellColor=this.options.selectedCellColor.wq_trim(),this.options.selectedRowColor=this.options.selectedRowColor.wq_trim(),this.options.oddRowBackgroundColor=this.options.oddRowBackgroundColor.wq_trim(),this.options.evenRowBackgroundColor=this.options.evenRowBackgroundColor.wq_trim(),this.options.rowMouseOverColor=this.options.rowMouseOverColor.wq_trim(),this.options.readOnlyBackgroundColor=this.options.readOnlyBackgroundColor.wq_trim(),this.options.disabledBackgroundColor=this.options.disabledBackgroundColor.wq_trim(),this.options.disabledFontColor=this.options.disabledFontColor.wq_trim(),a.D.getBoolean(this.options.focusOnSetData)&&(this.options.focusOnSetData=!0),this.options.senseReader&&(this.options.focusFlow="linear","all"===this.options.visibleRowNum&&(this.options.showLastRow=!0),this.element&&"false"!=this.element.getAttribute("autoScope")&&(this.options.autoScope=!0),this.senseReaderMode=!0),this.embeddedWidthObj={},this.options.sortable&&this.options.sortHeaderDiv&&(this.options.showSortableImage=!0,this.options.sortEvent="onclick"),this.radioGroupRepChk={},
this.options.excelUploadPopupURL=this.options.excelUploadPopupURL||this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/fileUpload.jsp"),{baseServletURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/fileUpload.html"),{baseURI:!0}),this.options.advancedExcelUploadPopupURL=this.options.advancedExcelUploadPopupURL||this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/advancedfileUpload.jsp"),{baseServletURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedfileUpload.html"),{baseURI:!0}),this.options.advancedExcelMultiUploadPopupURL=this.options.advancedExcelMultiUploadPopupURL||this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/advancedMultiUpload.html"),{baseURI:!0}),this.options.advancedExcelDownloadPopupURL=this.options.advancedExcelDownloadPopupURL||this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/download/advancedfileDownload.html"),{baseURI:!0}),this.options.excelUploadURL=this.options.excelUploadURL||WebSquare.baseServletURI+"excelToGrid.wq",this.options.excelDownloadURL=this.options.excelDownloadURL||WebSquare.baseServletURI+"xmlToExcel.wq",this.options.csvDownloadURL=this.options.csvDownloadURL||WebSquare.baseServletURI+"xmlToCSV.wq",this.options.csvUploadURL=this.options.csvUploadURL||WebSquare.baseServletURI+"csvToXML.wq",this.options.csvUploadPopupURL=this.options.csvUploadPopupURL||this.options.servletPopup?this.getURL(WebSquare.BootLoader.inquiresPath("engine/servlet/csvfileUpload.jsp"),{baseServletURI:!0}):this.getURL(WebSquare.BootLoader.inquiresPath("uiplugin/grid/upload/csvfileUpload.html"),{baseURI:!0}),this.options.advancedExcelUploadURL=this.options.advancedExcelUploadURL||WebSquare.baseServletURI+"excelToGrid2.wq",this.options.advancedExcelDownloadURL=this.options.advancedExcelDownloadURL||WebSquare.baseServletURI+"xmlToExcel2.wq",this.groupbyStatus={},this.groupbyZoneStatus={},this.groupbyDisplayOptions={},this.directItemChoiceKeyObj={},this.rowStatusColIDArr=[],this.cellIdList=[],this.firstOpenCustomFilter={},this.customFilterStatusObj={},this.beforeEditedCellInfo=null,this.hiddenAdaptiveList=[],this.adaptiveEmbeddedInputIdList=[],this.hideThresholdObj={},this.orgBodyHeightObj={},this.orgHeaderHeightObj={},this.orgFooterHeightObj={},this.orgSubtotalHeightObj={},this.oldOptions={},this.adaptiveGridType=0,this.tooltipPositionParse=!1,this.oneRowScrollHeight=20,this._manager=null,this.beforeEditedCellInfo=null,this.options.noResultMessage=this.options.noResultMessage||WebSquare.language.getMessage("Grid_noResultMessage")||"조회 결과가 없습니다.",this.options.scrollMsg=this.options.scrollMsg||WebSquare.language.getMessage("Grid_scrollMsg")||"화면 갱신 중 입니다...",this.cellMergeInfo={},this.cellMergeRealInfo={},this.tdMergeInfo={},this.mergeColObj={},this.mergeRowObj={},this.hiddenRowObj={length:0,extraRow:0,row:{},init:!1},this.hiddenCellObj={length:0,init:!1},!0===this.options.moveKeyEditModeAll&&(this.options.moveKeyEditMode=!0),this.filterEmptyStr=this.options.useFilterEmptyMsg||WebSquare.language.getMessage("GRID_useFilterEmptyMsg"),this.useFilterEmptyValueInfo={"":!0};var e=this.options.useFilterEmptyValue?this.options.useFilterEmptyValue.split(","):[];e.push("");for(var i=0;i<e.length;i++)e[i]=e[i].trim(),this.useFilterEmptyValueInfo[e[i]]=!0;this._regDetectDOM=new RegExp("<[^<]+>","i"),this._regRemoveDOM=new RegExp("<[/]{0,1}[^></]+[/]{0,1}>","g"),this._bindDrag=!1,this._subtotalDisplayFormat=""},F.prototype.setPreAction=function(){try{var t=this.render.offsetWidth,e=this.render.offsetHeight;if(this.startedDisplayNone)return this.initFlag=!0,this.initializeHead(),this.initializeFooter(),this.drawFooter(),void this.drawHeader();this.resizeObj={width:t,height:e,scrollLeft:0,scrollTop:0,clientWidth:this.render.clientWidth};var i=this.getElementById(this.id+"_head_table").getElementsByTagName("tr"),o=i[i.length-1],s=this.getElementById(this.id+"_body_table")
;this.gridLastTrBottomFix=s.offsetHeight-o.offsetTop-o.offsetHeight,this.setTableLayout(),this._handleScrollX(),this.setCellInfo(),this.setDataListCellInfo(),1==this.isDrillDown&&this.initDrilldown(),!0!==this.options.preventCopy&&!0!==this.options.noSelect||this.addClass("w2noselect")}catch(t){r.w.printStackTrace(t,null,this)}},F.prototype.setAction=function(){try{if(this.initializeEvent(),this.options.columnOrder&&this.setColumnOrder(this.options.columnOrder),this.options.mergeCol){for(var t=this.getColumnCount(),e=0;e<t;e++)this.mergeColObj[e]=!1;var i=this.options.mergeCol.split(",");for(e=0;e<i.length;e++){var o=i[e];isNaN(o)||(o=Number(o)),this.mergeCol(i[e],!0)}}var s=this.uuid;if(this.options.groupbyZone){this.groupbyZoneStatus.groupbyZoneRender=this.dom[this.id+"_groupbyZone_div"];var n=null!=this.options.groupbyZoneHeight.match("%"),l=parseInt(this.options.groupbyZoneHeight),h=l+"px";this.groupbyZoneStatus.groupbyZoneRender.style.height=h,n&&(this.groupbyZoneStatus.groupbyZoneRender.style.height=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px");var d=WebSquare.style.getStyle(this.groupbyZoneStatus.groupbyZoneRender,"border-left-width").replace("px","");if(this.groupbyZoneStatus.groupbyZoneBorder=2*d,this.groupbyZoneStatus.groupbyZoneRender.style.width=this.resizeObj.clientWidth-this.groupbyZoneStatus.groupbyZoneBorder+"px",this.dom[this.id+"_main_div"]&&(this.dom[this.id+"_main_div"].style.top=this.groupbyZoneStatus.groupbyZoneRender.offsetHeight+"px"),this.isIE6)try{this.dom[this.id+"_main_div"].style.height=this.dom[this.id+"_main_div"].offsetHeight-this.groupbyZoneStatus.groupbyZoneRender.offsetHeight}catch(t){}if(this.dom[this.id+"_scrollY_div"].style.top="0px",this.options.groupbyZoneMessage){var u=document.createElement("div");u.innerHTML+=this.options.groupbyZoneMessage,u.className+=" w2grid_groupbyZone_message ",this.groupbyZoneStatus.groupbyZoneRender.appendChild(u),u.style.marginTop=-u.offsetHeight/2+"px",u.style.marginLeft=-u.offsetWidth/2+"px",this.groupbyZoneStatus.groupbyZoneMessageRender=u}if(this.options.groupbyZoneSearch){var p=document.getElementById(this.id+"_groupbyZone_search");this.groupbyZone_searchinput=new WebSquare.uiplugin.input(this.id+"_groupbyZone_searchinput",{className:"w2grid_groupbyZone_searchinput"}),requires("uiplugin.trigger"),this.groupbyZone_searchbtn=new WebSquare.uiplugin.trigger(this.id+"_groupbyZone_searchbtn",{className:"w2grid_groupbyZone_searchbtn"}),this.addControl(this.groupbyZone_searchinput),this.addControl(this.groupbyZone_searchbtn),p.innerHTML=this.groupbyZone_searchinput.toHTML()+this.groupbyZone_searchbtn.toHTML(),this.groupbyZone_searchbtn.activate(),this.groupbyZone_searchinput.activate();var c=this.groupbyZone_searchinput.uuid;this.groupbyZone_searchbtn.bind("onclick",(function(){WebSquare.idCache[c].show()}));var g=this.id;this.groupbyZone_searchinput.bind("onkeydown",(function(t){event.stopPropagation(t),a.D.setTimeout((function(){var t=WebSquare.idCache[s];t._groupbyZoneSearch(),t.groupbyZone_searchinput.focus()}),{key:g+"_groupbyZone_search",delay:50})})),this.groupbyZone_searchinput.hide()}}if(this.options.groupbyZone&&this.options.groupbyFilterBox){var f=this.getElementById(this.id+"_groupbyFilterBox_select");this.groupbyFilterBox_select=new WebSquare.uiplugin.selectbox(this.id+"_groupbyFilterBox_select",{className:"w2grid_groupbyFilterBox_select",labelWidthAuto:!1,readOnly:!0,direction:"top"===this.options.groupbyFilterBoxLocation?"down":"up",visibleRowNum:this.options.filterBoxvisibleRowNum}),this.addControl(this.groupbyFilterBox_select),f.innerHTML=this.groupbyFilterBox_select.toHTML(),this.groupbyFilterBox_select.activate(),this.groupbyFilterBox_select.bind("onclick",(function(t){this.handleClickEvent()})),this.groupbyFilterBox_select.bind("onchange",(function(){WebSquare.idCache[s].applyFilterHistory()}));var m=this.getElementById(this.id+"_groupbyFilterBox_div")
;"bottom"===this.options.groupbyFilterBoxLocation?this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+m.offsetHeight+"px":"top"===this.options.groupbyFilterBoxLocation&&(this.dom[this.id+"_main_div"].style.top=l+m.offsetHeight+"px",this.dom[this.id+"_main_div"].style.bottom=this.scrollLayerWidthSize+"px",this.groupbyZoneStatus.groupbyZoneRender.style.top=m.offsetHeight+"px");var y=this.getElementById(this.id+"_groupbyFilterBox_main"),b=this.getElementById(this.id+"_groupbyFilterBox_buttons");y.style.paddingLeft=b.offsetWidth+"px";var w=this.getElementById(this.id+"_groupbyFilterBox_apply"),v=this.getElementById(this.id+"_groupbyFilterBox_delete");w.onclick=function(){var t=WebSquare.idCache[s];this.checked?t.applyFilterHistory():t.groupbyStatus.grouped?t.clearGroupby():t._dataList.clearFilter()},v.onclick=function(){WebSquare.idCache[s].clearFilterHistory()},this.handlerResize_drawInitializer()}for(e=0;e<this.oneRowDataLength;e++){var I=this.getColumnID(e),C=this.getCellInfo(e);if(""!=this.options.hiddenClass||""!=C.options.hiddenClass){var x=this.options.hiddenClass;""!=C.options.hiddenClass&&(x=C.options.hiddenClass);var _=this._getRealColIndex("body",I)+this.defaultColCnt,S=null!=this.bodyToHeaderRelation[I]?this.getHeaderLayer(this.bodyToHeaderRelation[I]):null;this.hiddenList[_]?null==S||this.hasClass(S,x)||this.addClass(S,x):null!=S&&this.hasClass(S,x)&&this.removeClass(S,x)}}!this.startedDisplayNone&&this.getRowCount&&this.getRowCount()>0&&this.notifyDataChanged({refreshScroll:!0}),!this.startedDisplayNone&&this.options.focusOnSetData&&this._setFocusedCell(0,0),this.successBinding&&this._dataList&&this._dataList.options.initRowPosition&&this._dataList.broadcast({linkedDataList:["notifyRowPositionChanged"]});var D=WebSquare.BootLoader.fullViewed||!1,R=a.D.fullViewed||!1;if(D||R||!this.startedDisplayNone&&this.checkAdaptiveGridType()&&(""==this.options.adaptive&&0==Object.keys(this.hideThresholdObj).length||(this.oldOptions.headerColBorder="",this.oldOptions.bodyColBorder="",this.setAdaptive(),this.event.addListener(window,"onresize",this.event.bindAsEventListener(this,this.setAdaptive)))),1==this.options.summaryAuto){var L=this.getHeaderValueList(),T="",k="";for(e=0;e<L.length;e++)T.length>0&&(k=","),T=T+k+L[e];this.setSummary(T)}if(this.changeCount=0,a.D.getBoolean(this.options.captionAuto)){for(L=this.getHeaderValueList(),T="",k="",e=0;e<L.length;e++)T.length>0&&(k=","),T=T+k+L[e];this.options.captionTitle?this.setCaption(this.options.captionTitle+WebSquare.language.getMessage("Grid_caption2")+T+WebSquare.language.getMessage("Grid_caption")):this.setCaption(T+WebSquare.language.getMessage("Grid_caption"))}if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var A=document.getElementById(this.id).style.cssText,F=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:A,className:F}}this.startedDisplayNone||this._setVisibleRowNumFix(),this.options.noResultMessageVisibleAlways&&this.displayNoResultMessage()}catch(t){r.w.printStackTrace(t,null,this)}},F.prototype.setDataList=function(){try{if(!this.successBinding&&(this._dataList=this.modelControl.getDataComp(this.options.dataList),this._dataList)){switch(this._grid=this,this._dataList.addChild(this),this.successBinding=!0,this._dataList.initializeType){case"linkedDataList":this._linkedDataList=this._dataList,this._dataList=this._linkedDataList._dataList,this._dataList?(this.dataList=new WebSquare.uiplugin.mappingController(this),o.x.extend(this,WebSquare.uiplugin.linkedMappingController.prototype)):(this.successBinding=!1,this._dataList={});break;case"dataList":this.dataList=new WebSquare.uiplugin.mappingController(this),this.dataList.mappingCommonAPI()}for(var t=0;t<this.oneRowDataLength;t++)this.getCellInfo(t).setDataListCellRefresh(this.getCellInfo(t).element);this.render&&this.notifyDataChanged({refreshScroll:!0})}}catch(t){r.w.printStackTrace(t,null,this)}},
F.prototype.resetDataList=function(){try{this.successBinding=!1,this.setDataList()}catch(t){r.w.printStackTrace(t,null,this)}},F.prototype.serialize=function(){return this.focusedCell},F.prototype.restore=function(t){try{for(var e=0,i=t.length;e<i;e++)this._setFocusedCell(t[e].focusedRowIndex,t[e].focusedColIndex,null,{useShiftKey:!0})}catch(t){return r.w.printStackTrace(t),!1}return!0},o.x.extend(F.prototype,l.prototype),o.x.extend(F.prototype,p.prototype),o.x.extend(F.prototype,c.prototype),o.x.extend(F.prototype,g.prototype),o.x.extend(F.prototype,f.prototype),o.x.extend(F.prototype,m.prototype),o.x.extend(F.prototype,y.prototype),o.x.extend(F.prototype,b.prototype),o.x.extend(F.prototype,w.prototype),o.x.extend(F.prototype,I.prototype),o.x.extend(F.prototype,C.prototype),o.x.extend(F.prototype,x.prototype),o.x.extend(F.prototype,S.prototype),o.x.extend(F.prototype,D.prototype)},9310:(t,e,i)=>{"use strict";i.d(e,{v:()=>n});i(5405);var o=i(5130),s=i(6146),r=i(209),a=i(6342),n=function(t){this._grid=t};n.prototype.getRealRowIndex=function(t){try{var e;if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var i in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[i])return this._grid._dataList.getRealRowIndex(t);e=this._grid.groupbyStatus.groupedRowIndexArr[t]}else e=this._grid._dataList.getRealRowIndex(t);return e}catch(t){o.w.printStackTrace(t)}},n.prototype.getTotalRow=function(){try{return this._grid._dataList.getTotalRow()}catch(t){o.w.printStackTrace(t)}},n.prototype.getTotalCol=function(){try{return this._grid.oneRowDataLength}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowCount=function(){try{return this._grid._dataList.getDataLength()}catch(t){o.w.printStackTrace(t)}},n.prototype._getData=function(t,e){try{e=this._grid.getColumnID(e);var i=this._grid.cellInfoHash[e]||{options:{}};if((1!=this._grid.options.moveKeyEditModeAll||"checkbox"!=i.options.inputType&&"radio"!=i.options.inputType)&&this._grid.editEndBeforeGetData(),i&&"expression"==i.options.inputType)return i.getExpressionValue(t);var s=this._grid._dataList._getData(t,e);return null==s&&(s=""),s}catch(t){o.w.printStackTrace(t)}},n.prototype.getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);return"2"==(i=null==i||void 0===i?"0":i+"")?this._getCellData(t,e,i):this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?this._getCellData(t,e,"0"===i?3:i):this._getCellData(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype._getCellData=function(t,e,i){try{e=this._grid.getColumnID(e);if("2"==(i=null==i||void 0===i?"0":i+""))return this._grid._getCellDisplayData(t,e);var s=this._grid.getRealRowIndex(t);return"3"!=i&&null!=s&&(t=s),this._getData(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getOriginalCellData=function(t,e){try{e=this._grid.getColumnID(e);return this._grid._dataList.getOriginalCellData(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getColCnt=function(){try{for(var t=0,e=this._grid.htmlInfo?this._grid.htmlInfo.head.rowArr[0]:this._grid.struct.head.rowArr[0],i=0;i<e.length;i++){var s=e[i];t+=parseInt(s.colSpan,10)||1}return t}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.getColData=function(t,e){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColData(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowData=function(t,e){try{for(var i=[],s=0;s<this._grid.getColumnCount();s++)"displayData"!=e?i.push(this.getCellData(t,s)):i.push(this._grid._getCellDisplayData(t,s));return i}catch(t){o.w.printStackTrace(t)}},n.prototype._getRowData=function(t,e){try{for(var i=[],s=0;s<this._grid.getColumnCount();s++)"displayData"!=e?i.push(this._getData(t,s)):i.push(this._grid._getDisplayData(t,s));return i}catch(t){o.w.printStackTrace(t)}},n.prototype.getDataRow=function(t){try{return this._grid._dataList.getDataRow(t)}catch(t){o.w.printStackTrace(t)}},
n.prototype.getMatchedData=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedData(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedData=function(t,e,i,s,r){try{return this._grid._dataList.getUnmatchedData(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getMatchedColumnData=function(t,e,i,s,r,a){try{return this._grid._dataList.getMatchedColumnData(t,e,i,s,r,a)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedColumnData=function(t,e,i,s,r,a){try{return this._grid._dataList.getUnmatchedColumnData(t,e,i,s,r,a)}catch(t){o.w.printStackTrace(t)}},n.prototype.getMatchedIndex=function(t,e,i,s,r){try{return this._grid._dataList.getMatchedIndex(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedIndex=function(t,e,i,s,r){try{return this._grid._dataList.getUnmatchedIndex(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRangeData=function(t,e,i){try{var s=[];if(t>e){var r=e;e=t,t=r}t<0&&(t=0),e>this._grid.getDataLength()&&(e=this._grid.getDataLength());for(var a=t;a<e;a++)s=s.concat(this.getRowData(a,i));return s}catch(t){o.w.printStackTrace(t)}},n.prototype.getAllData=function(){try{return this._grid._dataList.getAllData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getColumnDistinctDataArray=function(t){try{t=this._grid.getColumnID(t);return this._grid._dataList.getColumnDistinctDataArray(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRangeXML=function(t,e){try{return this._grid._dataList.getRangeXML(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getMatchedXML=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedXML(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedXML=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedXML(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowXML=function(t){try{return this._grid._dataList.getRowXML(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getAllXML=function(){try{return this._grid._dataList.getAllXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowJSON=function(t){try{return this._grid._dataList.getRowJSON(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getAllJSON=function(){try{return this._grid._dataList.getAllJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRangeJSON=function(t,e){try{return this._grid._dataList.getRangeJSON(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getMatchedJSON=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedJSON(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedJSON=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedJSON(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowArray=function(t){try{return this._grid._dataList.getRowArray(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getAllArray=function(){try{return this._grid._dataList.getAllArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRangeArray=function(t,e){try{return this._grid._dataList.getRangeArray(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.getMatchedArray=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getMatchedArray(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.getUnmatchedArray=function(t,e,i,s,r){try{t=this._grid.getColumnID(t);return this._grid._dataList.getUnmatchedArray(t,e,i,s,r)}catch(t){o.w.printStackTrace(t)}},n.prototype.setCellData=function(t,e,i,s,r,a,n,l){try{e=this._grid.getColumnID(e);if(this._grid._linkedDataList){var h=this._grid._linkedDataList.filteredRowIndexArr[t];"number"!=typeof(t=this._grid._dataList.getFilteredRowIndex(h))&&(t=h)}this._setCellData(t,e,i,null,s,r,a,n,l)}catch(t){o.w.printStackTrace(t)}},n.prototype._setCellData=function(t,e,i,r,a,n,l,h,d){try{null==i&&(i=""),
null==this._grid.editedCell||this._grid.getCellOption(t,e,"embeddedInput")||this._grid.editedCell.handleCancelEdit();var u,p=this._grid._dataList.getTotalRow(),c=this._grid._dataList.getTotalCol();u=this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList?t:this._grid.getRealRowIndex(t);var g=t,f="",m=(e=this._grid.getColumnID(e),this._grid.getColumnIndex(e)),y=this._grid._dataList.getColumnIndex(e),b=this._grid.groupbyStatus.grouped?u:t;if(this._grid.isDrillDown&&this._grid._dataList.options.depthColumn?f=this.getCellData(u,e,"3"):b>=0&&b<p&&y>=0&&y<c&&(f=this.getCellData(t,e)),b>=0&&b<p&&y>=0&&y<c){var w=this._grid.cellInfoHash[this._grid.tdIdList[m]]||{options:{}},v=w.options.inputType||"text";if(("text"==v||"textImage"==v||"drilldown"==v)&&"all"==w.options.applyFormat&&!w.options.embeddedInput){var I=this._grid.getInput(w);f=w.formatter.format(f),f=I.validator.validateString(f)}var C=this._grid.getColumnOption(w.options.col_id,"dataType");if("bigDecimal"==C&&"string"==typeof i?i=WebSquare.bigDecimal(i).toString():"bigDecimal"==C&&($l("If dataType is bigDecimal, data must be entered to String.["+this.id+"]"),i=WebSquare.bigDecimal(i).toString()),i.toString().replace(/\r(\n)?/,"\n")!==f.toString().replace(/\r(\n)?/,"\n")){var x=t;if(this._grid.isDrillDown&&this._grid._dataList.options.depthColumn&&(x=u),this._grid.groupbyStatus.grouped?this._grid._dataList._setCellData({filteredRowIndex:u,colID:e,value:i,direction:a,skipBroadCast:n,noEvent:l,excludeId:h,realRowIndex:!0,notifyRowIndex:t,skipInstance:d}):this._grid._dataList._setCellData(x,e,i,a,n,l,h,d),null==this._grid._dataList.getColumnID(e)&&this._grid.notifyCellChanged(g,m),s.B.fireEvent(this._grid,"onchange",t,m,i,f),"radio"==w.options.inputType&&w.options.groupName&&w.options.trueValue==i&&(w.resetOthers(t),this._grid.radioGroupRepChk[w.options.groupName]&&this.setCellData(t,w.options.groupName,w.options.groupValue)),this._grid.radioGroupRepChk[w.options.id]){for(var _=this._grid.getColumnCount(),S=0;S<_;S++){var D=this._grid.cellInfoHash[this._grid.tdIdList[S]]||{options:{}};if("radio"==D.options.inputType&&D.options.groupName==w.options.id&&D.options.groupValue==i){this.setCellData(t,S,D.options.trueValue,a,n,l,h,d);break}}S==_&&this._grid._resetRadioGroup(t,w.id,!1)}if(this._grid.isDrillDown)if(this._grid.drilldown.options.depthColumn==m)this._grid.notifyDataChanged({keepTop:!0}),0==this._grid.getDataLength()&&this._grid.removeFocusedCell(),this._grid.setScrollYHeight();else if("checkbox"==w.options.inputType&&w.options.setRecursive)for(var R=this._grid.drilldown.getChildRowArr(t,!0),L=0;L<R.length;L++)this._getData(R[L],m)!=i&&this._setCellData(R[L],m,i,r,a,n,l,h,d)}else null==this._grid.editedCell||r||this._grid.notifyCellChanged(g,m)}}catch(t){o.w.printStackTrace(t)}},n.prototype.__setCellData=function(t,e,i,s,r,a,n){try{var l;e=this._grid.getColumnID(e);this._grid._linkedDataList?(l=this._grid._linkedDataList.filteredRowIndexArr[t],"number"!=typeof(t=this._grid._dataList.getFilteredRowIndex(l))&&(t=l)):l=this._grid.dataList.getRealRowIndex(t),this._grid.options&&"grid"===this._grid.options.pluginName&&this._grid.isDrillDown&&this._grid.options.drilldownRealRowIndex&&!this._grid._linkedDataList&&(t=l),this._setCellData(t,e,i,null,s,r,a,n)}catch(t){o.w.printStackTrace(t)}},n.prototype.setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList.setOriginalCellData(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype._setOriginalCellData=function(t,e,i){try{e=this._grid.getColumnID(e);this._grid._dataList._setOriginalCellData(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.setColumnDefaultValue=function(t,e){try{t=this._grid.getColumnID(t);this._grid._dataList.setColumnDefaultValue(t,e)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.setRowData=function(t,e,i){try{this._grid._dataList.setRowData(t,e,i)}catch(t){
o.w.printStackTrace(t)}},n.prototype.setDataFile=function(t,e){try{t=this._grid._dataList.toArray(t);for(var i,s=[],r=0;r<this._grid.oneRowDataLength;r++){"expression"==(n=this._grid.getCellInfo(r)).options.inputType&&s.push(r)}i=t.length/this._grid.oneRowDataLength;for(r=0;r<s.length;r++)for(var a=0;a<i;a++){t[u=a*this._grid.oneRowDataLength+parseInt(s[r],10)]=""}for(r=0;r<this._grid.oneRowDataLength;r++){var n,l=(n=this._grid.getCellInfo(r)).options.dataType;if("select"==n.options.inputType){var h=[];for(a=0;a<n.itemArr.length;a++){h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){t[u=a*this._grid.oneRowDataLength+r]=h[t[u]]}}else if("checkcombobox"==n.options.inputType){for(h=[],a=0;a<n.itemArr.length;a++){var d;h[(d=n.itemArr[a]).label]=d.value}for(a=0;a<i;a++){for(var u=a*this._grid.oneRowDataLength+r,p=[],c=t[u].split(n.separator),g=0;g<c.length;g++)p.push(h[c[g]]);t[u]=p.join(n.separator)}}if(""!=n.options.displayFormat)for(a=0;a<i;a++){var f,m=t[u=a*this._grid.oneRowDataLength+r],y=n.options.displayFormat;f="number"==l||"bigDecimal"==l?WebSquare.text.unformatCurrency(y,m):"date"==l?WebSquare.text.unformatDate(y,m):"time"==l?WebSquare.text.unformatTime(y,m):WebSquare.text.unformatText(y,m),t[u]=f}}this._grid._dataList.setData(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.setData=function(t,e,i){try{this._grid._dataList.setData(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.insertData=function(t,e){try{this._grid._dataList.insertData(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype._insertData=function(t,e,i){try{this._grid._dataList._insertData(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.getDataLength=function(){try{var t;if(this._grid.successBinding)if(this._grid.groupbyStatus&&this._grid.groupbyStatus.grouped){for(var e in this._grid.customFilterStatusObj)if(this._grid.customFilterStatusObj[e])return this._grid._dataList.getDataLength();t=this._grid.groupbyStatus.groupedRowIndexArr.length}else t=this._grid._dataList.getDataLength();else t=0;return t}catch(t){o.w.printStackTrace(t)}},n.prototype.setRowXML=function(t,e,i){try{this._grid._dataList.setRowXML(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.setXML=function(t,e,i){try{if("grid"==this._grid.initializeType&&i&&i.ref&&(this._grid.options.ref=i.ref,this._grid._dataList.options.ref=i.ref,i.baseNode&&(this._grid.options.baseNode=i.baseNode,this._grid._dataList.options.baseNode=i.baseNode),i.repeatNode&&(this._grid.options.repeatNode=i.repeatNode,this._grid._dataList.options.repeatNode=i.repeatNode),i.aliasDataCollection&&(this._grid.options.aliasDataCollection=i.aliasDataCollection,this._grid._dataList.options.aliasDataCollection=i.aliasDataCollection),this._grid._setRef(),this._grid._dataList.repeatNodeTagName=this.repeatNodeTagName),null==t)return void a.k.printLog("[WebSquare.uiplugin.mappingController.setXML] XML is null["+this.id+"]");var s=this._grid.xmlData2ArrData(t);if(void 0===s)return void a.k.printLog("[WebSquare.uiplugin.mappingController.setXML] DataArray which converted from XML is undefined.["+this.id+"]");this.setData(s,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.insertXML=function(t,e){try{this._grid._dataList.insertXML(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.setJSON=function(t,e){try{if(null==t)return void a.k.printLog("[WebSquare.uiplugin.mappingController.setJSON] JSON is null["+this.id+"]");var i=this._grid.jsonData2ArrData(t);if(void 0===i)return void a.k.printLog("[WebSquare.uiplugin.mappingController.setJSON] DataArray which converted from JSON is undefined.["+this.id+"]");this.setData(i,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.setRowJSON=function(t,e,i){try{this._grid._dataList.setRowJSON(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.insertJSON=function(t,e){try{this._grid._dataList.insertJSON(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.rowMoveUp=function(t){try{this._grid._dataList.rowMoveUp(t)}catch(t){o.w.printStackTrace(t,null,this)}},
n.prototype.rowMoveDown=function(t){try{this._grid._dataList.rowMoveDown(t)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.insertRow=function(t,e){try{e=e||{};return this._grid.options.insertIntoSortedRow&&(e.insertIntoSortedRow=this.options.insertIntoSortedRow),"grid"==this.initializeType&&this.options.ref&&1==this.repeatNodeTagNameFilter&&(t=null),this._grid._dataList.insertRow(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.removeRow=function(t,e){try{return this._grid._dataList.removeRow(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.removeRows=function(t){try{return this._grid._dataList.removeRows(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.removeAll=function(){try{return this._grid._dataList.removeAll()}catch(t){o.w.printStackTrace(t)}},n.prototype.removeRange=function(t,e){try{return this._grid._dataList.removeRange(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype.reform=function(){try{this._grid._dataList.reform()}catch(t){o.w.printStackTrace(t)}},n.prototype.undoRow=function(t){try{this._grid._dataList.undoRow(t)}catch(t){o.w.printStackTrace(t)}},n.prototype._undoRow=function(t){try{this._grid._dataList._undoRow(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.undoAll=function(){try{this._grid._dataList.undoAll()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowStatusValue=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatusValue(e)}catch(t){o.w.printStackTrace(t)}},n.prototype._getRowStatusValue=function(t){try{return this._grid._dataList._getRowStatusValue(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowStatus=function(t){try{var e=this._grid._getGroupbyDisplayRowIndex(t);return this._grid._dataList.getRowStatus(e)}catch(t){o.w.printStackTrace(t)}},n.prototype._getRowStatus=function(t){try{return this._grid._dataList._getRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getRowIndexByStatus=function(t){try{return this._grid._dataList.getRowIndexByStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.getInsertedIndex=function(){try{return this.getRowIndexByStatus("C")}catch(t){o.w.printStackTrace(t)}},n.prototype.getUpdatedIndex=function(){try{return this.getRowIndexByStatus("U")}catch(t){o.w.printStackTrace(t)}},n.prototype.getDeletedIndex=function(){try{return this.getRowIndexByStatus("DV")}catch(t){o.w.printStackTrace(t)}},n.prototype.getOnlyDeletedIndex=function(){try{return this.getRowIndexByStatus("D")}catch(t){o.w.printStackTrace(t)}},n.prototype.getVoidIndex=function(){try{return this.getRowIndexByStatus("V")}catch(t){o.w.printStackTrace(t)}},n.prototype.getModifiedIndex=function(){try{return this.getRowIndexByStatus("CUD")}catch(t){o.w.printStackTrace(t)}},n.prototype.getInsertedData=function(){try{return this._grid._dataList.getInsertedData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getInsertedXML=function(){try{return this._grid._dataList.getInsertedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getInsertedJSON=function(){try{return this._grid._dataList.getInsertedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getInsertedArray=function(){try{return this._grid._dataList.getInsertedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getDeletedData=function(){try{return this._grid._dataList.getDeletedData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getDeletedXML=function(){try{return this._grid._dataList.getDeletedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getDeletedJSON=function(){try{return this._grid._dataList.getDeletedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getDeletedArray=function(){try{return this._grid._dataList.getDeletedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRemovedXML=function(){try{return this._grid._dataList.getRemovedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRemovedJSON=function(){try{return this._grid._dataList.getRemovedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getRemovedArray=function(){try{
return this._grid._dataList.getRemovedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getVoidData=function(){try{return this._grid._dataList.getVoidData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getVoidXML=function(){try{return this._grid._dataList.getVoidXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getVoidJSON=function(){try{return this._grid._dataList.getVoidJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getVoidArray=function(){try{return this._grid._dataList.getVoidArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getOnlyDeletedData=function(){try{return this._grid._dataList.getOnlyDeletedData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getOnlyDeletedXML=function(){try{return this._grid._dataList.getOnlyDeletedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getOnlyDeletedJSON=function(){try{return this._grid._dataList.getOnlyDeletedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getOnlyDeletedArray=function(){try{return this._grid._dataList.getOnlyDeletedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getUpdatedData=function(){try{return this._grid._dataList.getUpdatedData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getUpdatedXML=function(){try{return this._grid._dataList.getUpdatedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getUpdatedJSON=function(){try{return this._grid._dataList.getUpdatedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getUpdatedArray=function(){try{return this._grid._dataList.getUpdatedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype.getModifiedData=function(){try{return this._grid._dataList.getModifiedData()}catch(t){o.w.printStackTrace(t)}},n.prototype.getModifiedXML=function(){try{return this._grid._dataList.getModifiedXML()}catch(t){o.w.printStackTrace(t)}},n.prototype.getModifiedJSON=function(){try{return this._grid._dataList.getModifiedJSON()}catch(t){o.w.printStackTrace(t)}},n.prototype.getModifiedArray=function(){try{return this._grid._dataList.getModifiedArray()}catch(t){o.w.printStackTrace(t)}},n.prototype._setRowStatus=function(t,e){try{return this._grid._dataList._setRowStatus(t,e)}catch(t){o.w.printStackTrace(t)}},n.prototype._initRowStatus=function(t){try{this._grid._dataList._initRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.initRowStatus=function(t){try{this._grid._dataList.initRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype._createRowStatus=function(t){try{this._grid._dataList._createRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype._updateRowStatus=function(t){try{this._grid._dataList._updateRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.removeRowStatus=function(t){try{return this._grid._dataList.removeRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.deleteRow=function(t){try{this._grid._dataList.deleteRow(t)}catch(t){o.w.printStackTrace(t)}},n.prototype._deleteRowStatus=function(t){try{this._grid._dataList._deleteRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.undeleteRow=function(t){try{this._grid._dataList.undeleteRow(t)}catch(t){o.w.printStackTrace(t)}},n.prototype._undeleteRowStatus=function(t){try{this._grid._dataList._undeleteRowStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.modifyAllStatus=function(t){try{this._grid._dataList.modifyAllStatus(t)}catch(t){o.w.printStackTrace(t)}},n.prototype.modifyRangeStatus=function(t,e,i){try{var r=[],a=this.getDataLength()+1;if(0<=t&&e<a)for(var n=t;n<e;n++){var l=this.getRealRowIndex(n),h=this._setRowStatus(l,i);i!=h&&r.push({rowIndex:n,newRowStatus:i,oldRowStatus:h})}s.B.fireEvent(this,"onrowstatuschange",r),this.broadcast({gridView:["notifyModifyRangeStatus",[t,e,i]]})}catch(t){o.w.printStackTrace(t)}},n.prototype.modifyMatchedStatus=function(t,e,i){try{this._grid._dataList.modifyMatchedStatus(t,e,i)}catch(t){o.w.printStackTrace(t)}},n.prototype.modifyRowStatus=function(t,e){try{this._grid._dataList.modifyRowStatus(t,e)}catch(t){o.w.printStackTrace(t)}},
n.prototype.setColumnFilter=function(t,e,i,s){try{"object"!=typeof t||r.D.isString(t)||(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.setColumnFilter(t,e,i,s):this._grid._dataList.setColumnFilter(t,e,i,s)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.removeColumnFilter=function(t){try{t=this._grid.getColumnID(t);this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilter(t,{internal:!0}):this._grid._dataList.removeColumnFilter(t,{internal:!0})}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.clearSortFilter=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSortFilter():this._grid._dataList.clearSortFilter()}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.removeColumnFilterAll=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.removeColumnFilterAll():this._grid._dataList.removeColumnFilterAll()}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.setFilter=function(t){try{if(this._grid._linkedDataList)t.internal=!0,this._grid._linkedDataList.setFilter(t);else{if(t){var e=this._grid.getColumnID(t.sortIndex);if((a=this._grid.cellInfoHash[e]||{options:{}})&&"expression"==a.options.inputType&&(t.isExpression=!0,t.cellInfo=a,"gridView"==this._grid.initializeType&&isNaN(this._grid._dataList.getColumnIndex(t.sortIndex))&&(t.fakeExpressionArr=this._grid.getFakeExpressionArr())),e){var i=e.split(" "),s=[];t.isCustomCol=[],t.sortLabel=[];for(var r=0;r<i.length;r++){var a=this._grid.cellInfoHash[i[r]],n=!1;if("custom"!=a.options.inputType||a.internal||(n=!0),n)if(t.isCustomCol.push(!0),t.customSortItemsetIdObj=[],a.options.sortLabel){for(var l=this.getTotalRow(),h={},d={},u=0;u<l;u++){var p=a.cellManagerHashByRowIndex[u]?a.cellManagerHashByRowIndex[u]:a;if("select"==p.options.inputType||"autoComplete"==p.options.inputType){var c=p.dataComp;if(c&&!h[c])"linkedDataList"==(g=this._grid.modelControl.getDataComp(c)).initializeType?h[c]=g._dataList.getAllJSON():h[c]=g.getAllJSON();d[u]=c,t.customSortItemsetIdObj[u]={label:p.itemsetObj.label,value:p.itemsetObj.value}}else d[u]=""}t.customCellDataListInfo=d,t.customDataListInfoHash=h,t.sortLabel.push(!0)}else s[r]=[],t.sortLabel.push(!1);else if(t.isCustomCol.push(!1),!a.options.sortLabel||"select"!=a.options.inputType&&"autoComplete"!=a.options.inputType)s[r]=[],t.sortLabel.push(!1);else{var g;if(a.dataComp)"linkedDataList"==(g=this._grid.modelControl.getDataComp(a.dataComp)).initializeType?s[r]=g._dataList.getAllJSON():s[r]=g.getAllJSON();else s[r]=a.getItemArray();t.sortItemsetIdObj={label:a.itemsetObj.label,value:a.itemsetObj.value},t.sortLabel.push(!0)}}s.length>0&&(t.sortItemArr=s)}}t.internal=!0,this._grid._dataList.setFilter(t),"outfocus"==t.focuseMode&&this._grid.setScrollTop(0)}}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.removeFilter=function(t,e){try{t&&(t.internal=!0),this._grid._linkedDataList?this._grid._linkedDataList.removeFilter(t,e):this._grid._dataList.removeFilter(t,e)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.clearFilter=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.clearFilter(t):this._grid._dataList.clearFilter(t)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.sort=function(t,e){try{this._grid._linkedDataList?this._grid._linkedDataList.sort(t,e):this._grid._dataList.sort(t,e)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.clearSort=function(){try{this._grid._linkedDataList?this._grid._linkedDataList.clearSort():(this._grid._dataList.clearSort(),"outfocus"==this._grid.options.filterFocusMode&&this._grid.setScrollTop(0))}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.multisort=function(t){try{this._grid._linkedDataList?this._grid._linkedDataList.multisort(t):this._grid._dataList.multisort(t)}catch(t){o.w.printStackTrace(t,null,this)}},n.prototype.setMatchIgnoreCase=function(t){try{return this._grid._dataList.setMatchIgnoreCase(t)}catch(t){o.w.printStackTrace(t)}},
n.prototype.mappingCommonAPI=function(){try{this._grid._getData=this._getData,this._grid._getRowData=this._getRowData,this._grid._setCellData=this._setCellData,this._grid._setOriginalCellData=this._setOriginalCellData,this._grid._insertData=this._insertData,this._grid._undoRow=this._undoRow,this._grid._getRowStatusValue=this._getRowStatusValue,this._grid._getRowStatus=this._getRowStatus,this._grid._setRowStatus=this._setRowStatus,this._grid._createRowStatus=this._createRowStatus,this._grid._updateRowStatus=this._updateRowStatus,this._grid._deleteRowStatus=this._deleteRowStatus,this._grid._undeleteRowStatus=this._undeleteRowStatus,this._grid.getRowJSON=this.getRowJSON,this._grid.getRowCount=this.getRowCount,this._grid.getCellData=this.getCellData,this._grid._getCellData=this._getCellData,this._grid.getOriginalCellData=this.getOriginalCellData,this._grid.getColData=this.getColData,this._grid.getRowData=this.getRowData,this._grid.getDataRow=this.getDataRow,this._grid.getMatchedData=this.getMatchedData,this._grid.getUnmatchedData=this.getUnmatchedData,this._grid.getMatchedColumnData=this.getMatchedColumnData,this._grid.getUnmatchedColumnData=this.getUnmatchedColumnData,this._grid.getMatchedIndex=this.getMatchedIndex,this._grid.getUnmatchedIndex=this.getUnmatchedIndex,this._grid.getRangeData=this.getRangeData,this._grid.getAllData=this.getAllData,this._grid.getColumnDistinctDataArray=this.getColumnDistinctDataArray,this._grid.getRangeXML=this.getRangeXML,this._grid.getMatchedXML=this.getMatchedXML,this._grid.getUnmatchedXML=this.getUnmatchedXML,this._grid.getRowXML=this.getRowXML,this._grid.getAllXML=this.getAllXML,this._grid.getRowJSON=this.getRowJSON,this._grid.getAllJSON=this.getAllJSON,this._grid.getRangeJSON=this.getRangeJSON,this._grid.getMatchedJSON=this.getMatchedJSON,this._grid.getUnmatchedJSON=this.getUnmatchedJSON,this._grid.getRowStatusValue=this.getRowStatusValue,this._grid.getRowStatus=this.getRowStatus,this._grid.getRowIndexByStatus=this.getRowIndexByStatus,this._grid.getInsertedIndex=this.getInsertedIndex,this._grid.getUpdatedIndex=this.getUpdatedIndex,this._grid.getDeletedIndex=this.getDeletedIndex,this._grid.getModifiedIndex=this.getModifiedIndex,this._grid.getInsertedData=this.getInsertedData,this._grid.getInsertedXML=this.getInsertedXML,this._grid.getInsertedJSON=this.getInsertedJSON,this._grid.getDeletedData=this.getDeletedData,this._grid.getDeletedXML=this.getDeletedXML,this._grid.getDeletedJSON=this.getDeletedJSON,this._grid.getVoidData=this.getVoidData,this._grid.getVoidXML=this.getVoidXML,this._grid.getVoidJSON=this.getVoidJSON,this._grid.getOnlyDeletedData=this.getOnlyDeletedData,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedXML=this.getOnlyDeletedXML,this._grid.getOnlyDeletedJSON=this.getOnlyDeletedJSON,this._grid.getUpdatedData=this.getUpdatedData,this._grid.getUpdatedXML=this.getUpdatedXML,this._grid.getUpdatedJSON=this.getUpdatedJSON,this._grid.getModifiedData=this.getModifiedData,this._grid.getModifiedXML=this.getModifiedXML,this._grid.getModifiedJSON=this.getModifiedJSON,this._grid.setMatchIgnoreCase=this.setMatchIgnoreCase}catch(t){o.w.printStackTrace(t,null,this)}}}}]);