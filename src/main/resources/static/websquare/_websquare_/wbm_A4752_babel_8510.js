(self.webpackChunkwebpack_test=self.webpackChunkwebpack_test||[]).push([[8510],{8510:function(e,t,i){"use strict";i.r(t),i.d(t,{selectbox:function(){return c},selectbox_native:function(){return p}});var s=i(1974),o=i(5052),l=i(5948),n=i(1454),r=i(8683),a=i(1),h=i(5373),d=i(2117),c=function(e,t,i){a.s.call(this,e,t,i)};s.x.extend(c.prototype,a.s.prototype),s.x.extend(c.prototype,h.E.prototype),s.x.extend(c.prototype,d.z.prototype),c.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"component",mobileRenderType:"",serializable:!0,userEvents:["onchange","onclose","onviewchange","onblur","ontooltipshow","ontooltiphide","onselected"],systemEvents:["onclick","ondblclick","onfocus","onblur","onkeydown","onkeyup"],useOtherComponentId:"",useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",wmode:!1,visibleRowNum:5,displayMode:"0",delimiter:"\t",textAlign:"",defaultStyle:"",activeStyle:"",defaultClass:"w2SelectDefault",activeClass:"w2SelectActive",disabledClass:"w2selectbox_disabled",useLocale:!1,submenuSize:"auto",direction:"auto",tableRender:"",tooltipDisplay:!1,tooltipShowAlways:!1,tooltipClass:"",tooltipTime:1,tooltipDisplayItem:!1,itemTooltipDisplay:!1,itemTooltipFormatter:"",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",title:"",setDataRemoveAll:!0,escape:!0,emptyItem:!1,emptyValue:"",emptyIndex:0,optionOrder:"choose",animation:"",closeonmouseleave:!1,selectedData:!0,dataListAutoRefresh:!1,refreshSelectedIndex:!1,preventWheelEvent:!1,customFormatter:"",customLabelFormatter:"",keyMoveListSync:!1,keyMoveSync:!0,wheelRows:0,visibleColumn:"",visibleColumnFalseValue:"0,false,FALSE,F",findItemFirstKey:!0,enableColumn:"",enableColumnFalseValue:"0,false,FALSE,F",keyBufferResetTime:1e3,customToggleKey:"",preventKeyList:"",valueNotInList:"default"},c.prototype.initialize=function(e){try{if(this._initializeCommon(e&&"$blank"==e.getAttribute("chooseOptionLabel")),this.gridOptions={},this.gridViewOptions={},e){var t="xf"==e.getTagName().split(":")[0]?o.v._XML_NAMESPACE.XFORMS:o.v._XML_NAMESPACE.W2,i=WebSquare.Elem.api.getElementsByTagName(e,"choices",t)[0];if(i){var s=WebSquare.Elem.api.getElementsByTagName(i,"gridItemset",o.v._XML_NAMESPACE.W2)[0];null==s&&(s=WebSquare.Elem.api.getElementsByTagName(i,"gridViewItemset",o.v._XML_NAMESPACE.W2)[0]),s&&"w2:gridItemset"==s.getTagName()?this.itemTableMode="grid":s&&"w2:gridViewItemset"==s.getTagName()&&(this.itemTableMode="gridView")}else"gridViewItemset"==this.options.itemTableType&&(this.itemTableMode="gridView")}"grid"==this.itemTableMode?this.initializeGridItemArr(e):"gridView"==this.itemTableMode?this.initializeGridViewItemArr(e):this.initializeItemArr(e);var n=r.D.isMobile();if("ul"!==this.options.tableRender||"auto"==this.options.renderType&&n||(this.options.renderType="component"),this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),this.myhelper=new WebSquare.korHelper,this._preventKeyObj={},this.options.preventKeyList)if("all"===this.options.preventKeyList)this._preventKeyObj.all=!0;else for(var a=this.options.preventKeyList.split(","),h=0;h<a.length;h++){var d=a[h].wq_trim();d&&(this._preventKeyObj[d]=!0)}this.options.itemTooltipDisplay=this.options.tooltipDisplayItem?this.options.tooltipDisplayItem:this.options.itemTooltipDisplay,this.options.itemTooltipDisplay&&this.options.itemTooltipFormatter&&(this.itemTooltipFormatter=r.D.getGlobalFunction(this.options.itemTooltipFormatter,this.scope_id))}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._initializeCommon=function(e){try{this.itemTable=null,this.isOpen=!1,this.statusSubLayer=!1,this.selectedIndex=-1,this.selectedAllIndex=-1,this.cursorIndex=-1,this.showRowIndex=0,
this.displayCount=0,this.tooltip=null,this.timeShowTooltip=null,this.timeHideTooltip=null,this.defaultAllOptionLabel=WebSquare.language.getMessage("SelectBox_all");var t=o.v.getConfiguration("/WebSquare/"+this.options.pluginName+"/chooseOptionLabel/@value");this.defaultChooseOptionLabel=e||!e&&"$blank"===t?"":WebSquare.language.getMessage("SelectBox_choose"),this._initDisplayMode(),this.options.selectedData="false"!=this.options.selectedData&&!1!==this.options.selectedData,this.refreshStop=!1,this.validator=new WebSquare.validator.validateInvoker(this.id,this.options),this.isFireTooltipEvent=!1,this._keyBuffer="",this.keyCharHash={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",110:".",111:"/",106:"*",107:"+",109:"-",187:"=",189:"-",192:"`","220 ":"\\"},this.korCharHash={65:"ㅁ",67:"ㅊ",68:"ㅇ",69:"ㄷ",70:"ㄹ",71:"ㅎ",81:"ㅂ",82:"ㄱ",83:"ㄴ",84:"ㅅ",86:"ㅍ",87:"ㅈ",88:"ㅌ",90:"ㅋ"},this.korCharHash2={69:"ㄸ",81:"ㅃ",82:"ㄲ",84:"ㅆ",87:"ㅉ"}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.finalize=function(){try{a.s.prototype.finalize.call(this),this.labelRuler&&(this.labelRuler.parentNode.removeChild(this.labelRuler),this.labelRuler=null),this.itemTable&&(this.itemTable.remove(),this.itemTable=null)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.toHTML=function(){try{var e=[],t=""==this.options.style?"":"style='"+this.options.style+"'",i="";i=!0===this.options.disabled?"":""===this.options.tabIndex?"tabIndex='0'":"tabIndex='"+this.options.tabIndex+"'";var s=""==this.options.title?"":"title='"+this.options.title+"'",o=""==this.options.defaultStyle?"":"style='"+this.options.defaultStyle+"'",n=""==this.options.textAlign?o:"style='text-align:"+this.options.textAlign+";"+this.options.defaultStyle+"'";return"ul"===this.options.tableRender?(e.push("<div id='"+this.id+"' "+t+" class='w2selectbox "+this.options.className+"' "+s+" role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='none'>"),e.push("<a id='"+this.id+"_main_tbody' class='w2selectbox_ul_table_main' href='#"+this.id+"_itemTable' onclick='event.returnValue=false; return false;'>"),e.push("<div class='w2selectbox_ul_col_label' "+o+"><span id='"+this.id+"_label' role='document' aria-live='assertive' aria-automatic='true' class='w2selectbox_ul_label' "+n+"></span></div>"),e.push("<span class='w2selectbox_ul_col_arrow'></span>"),e.push("</a>"),e.push("</div>")):(e.push("<div id='"+this.id+"' role='combobox' aria-labelledby='"+this.id+"_itemTable' aria-autocomplete='none' "+t+" class='w2selectbox "+this.options.className+"' "+i+" "+s+">"),e.push("<table class='w2selectbox_table_main'>"),e.push("<tbody id='"+this.id+"_main_tbody'>"),e.push("<tr class='w2selectbox_row w2selectbox_row_main'>"),e.push("<td class='w2selectbox_col_label' "+o+"><div id='"+this.id+"_label' role='document' aria-live='assertive' aria-automatic='true' class='w2selectbox_label' "+n+"></div></td>"),e.push("<td class='w2selectbox_col_button' id='"+this.id+"_button'  aria-labelledby='"+this.id+"_itemTable' aria-controls='"+this.id+"_itemTable'></td>"),e.push("</tr></tbody>"),e.push("</table>"),e.push("</div>")),e.join("")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setPreAction=function(){try{this.dom.button=this.getElementById(this.id+"_button"),this.dom.label=this.getElementById(this.id+"_label"),this.dom.tbody=this.getElementById(this.id+"_main_tbody"),this.options.useOtherComponentId?o.v.setTimer((function(){this.otherComponent=r.D.getComponentById(this.options.useOtherComponentId),WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.options.useOtherComponentId,WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,
fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.otherComponent.render,"onmousedown",this.event.bindAsEventListener(this.otherComponent,(function(e){n.B.stopPropagation(e)}))),this.otherComponent.hide()}),{key:this.options.useOtherComponentId,caller:this,delay:100}):"grid"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):"gridView"==this.itemTableMode?(WebSquare.getBody().getLayerListener().useOtherComponentId[this.id]=this.id+"_gridViewItemTable",WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openOtherLayer,fnHide:this._closeOtherLayer,paramHide:{documentClick:!0},event:{}})):WebSquare.getBody().getLayerListener().addListener({component:this,fnShow:this._openSubLayer,fnHide:this._closeSubLayer,paramHide:{documentClick:!0},event:{}}),this.event.addListener(this.render,"onclick",this.event.bindAsEventListener(this,this.handleClickEvent)),r.D.isMobile()?(this.event.addListener(this.render,"ontouchstart",this.event.bindAsEventListener(this,(function(e){n.B.stopPropagation(e)}))),this.event.addListener(this.render,"ontouchmove",this.event.bindAsEventListener(this,(function(e){this._closeSubLayer()})))):this.event.addListener(this.render,"onmousedown",this.event.bindAsEventListener(this,(function(e){n.B.stopPropagation(e)}))),this.event.addListener(this.render,"onkeydown",this.event.bindAsEventListener(this,this.handleKeydownEvent)),this.event.addListener(this.render,"onkeyup",this.event.bindAsEventListener(this,this.handleKeyupEvent)),this.event.addListener(this.render,"onmousewheel",this.event.bindAsEventListener(this,this.handleMousewheelEvent)),this.event.addListener(this.render,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.render,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent)),this.event.addListener(this.render,"onmouseover",this.event.bindAsEventListener(this,this.handleMouseoverEvent)),this.event.addListener(this.render,"onmouseout",this.event.bindAsEventListener(this,this.handleMouseoutEvent)),1==this.options.closeonmouseleave&&this.event.addListener(this.render,"onmouseleave",this.event.bindAsEventListener(this,this.handleMouseleaveEvent)),this.modelControl.isItemsetBinded()?(this.refreshItemArr(),this.componentRedraw()):!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var e=document.getElementById(this.id).style.cssText,t=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:e,className:t}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex?this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})):this.selectedIndex>0&&this.getItemCount()>0&&(this.modelControl.isBinded()||(this.setSelectedIndexNM(this.selectedIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})))
;this.options.mandatory&&this.onPropertyChange("mandatory",r.D.getBoolean(this.options.mandatory))}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.onComplete=function(){try{this.options.customFormatter&&this.customFormatter(),a.s.prototype.onComplete.call(this)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.customFormatter=function(){try{var e=null;"grid"===this.itemTableMode||"gridView"===this.itemTableMode||("function"==typeof this.options.customFormatter?e=this.options.customFormatter:null!=(e=r.D.getGlobalFunction(this.options.customFormatter,this.scope_id))&&(this.options.customFormatter=e),"function"==typeof e&&(this.modelControl.isBinded()&&!this.modelControl.isDataCollectionItemsetBinded&&this.refreshItemArr(),this.itemArr=e.call(this,this.itemArr),this.componentRedraw()))}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.refreshItemset=function(e,t){try{if(this.refreshStop)return;if(this.modelControl.isItemsetBinded())if(this.refreshItemArr(),this.componentRedraw(!1,e,t),"grid"==this.itemTableMode?(this.refreshGridItemArr(),null!=this.itemTable&&null!=this.itemTable.grid?(this.itemTable.grid.clearFilter(),this.setGridData(),this.options.allOption&&this.gridItemArr.length>0&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))):"gridView"==this.itemTableMode&&(this.refreshGridViewItemArr(),null!=this.itemTable&&null!=this.itemTable.gridView?"dataList"===this.gridViewOptions.dataComp.initializeType&&this.setGridViewData():1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue,orgLabel:this.defaultAllOptionLabel}].concat(this.itemArr))),this.modelControl.isBinded())this.refresh();else{if(this.options.customFormatter&&this.customFormatter(),"auto"==this.options.submenuSize&&this.itemTable&&"grid"!==this.itemTableMode&&"gridView"!==this.itemTableMode&&!0!==this.refreshStopItemTable){var i=this.getMaxLabelSize();this.itemTable.setStyle("width",i+"px")}-1!=this.getSelectedIndex()||null!=this.getValue()&&""!==this.getValue()&&"keepValue"!==this.options.valueNotInList||this.setSelectedIndexNM(0)}this.isOpen&&this.setItemTable(),this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.refresh=function(){try{if(this.refreshStop)return;if(this.modelControl.isBinded()){var e=this.modelControl.getDataComp(),t=this.getItemCount();if(e&&"linkedDataList"===e.initializeType&&(this.options.chooseOption||this.options.allOption)&&(1!=t||this.itemArr[0].label!==this._getChooseOptionLabel()&&this.itemArr[0].label!==this.defaultAllOptionLabel?2==t&&this.itemArr[0].label===this._getChooseOptionLabel()&&this.itemArr[1].label===this.defaultAllOptionLabel&&(t-=2):t--),t>0){this.modelControl.isDataCollectionItemsetBinded&&this.refreshItemArr();var i=this.getValue(),s=this.modelControl.getData();this.options.customFormatter&&this.customFormatter();var o=this.setValueNM(s);1==o?(i!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}),null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()),this.broadcast({linkedDataList:["refresh",["replace"]]})):isNaN(o)?null!=this.getValue()&&s!=this.getValue()&&this.modelControl.setData(this.getValue()):this._setValueNotInList(s,!1)}}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.changeChooseOption=function(e,t){try{var i=-2;if(!0===this.options.chooseOption){i=-1;for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value===this.options.chooseOptionValue){i=o;break}i>-1&&this.itemArr.splice(i,1)}this.options.chooseOption=!0,this.options.chooseOptionValue=e,this.options.chooseOptionLabel=t,this.itemArr=[{label:t,value:e}].concat(this.itemArr),
this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()||this.setSelectedIndex(0)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.showChooseOption=function(e){try{var t=this._getChooseOptionLabel();t=WebSquare.xml.decode(t).replace("&nbsp;"," ");var i=this.options.chooseOptionValue;if(1==e)this.options.chooseOption!=e&&("all"==this.options.optionOrder&&1==this.options.allOption?this.itemArr.splice(1,0,{label:t,value:i}):this.itemArr=[{label:t,value:i}].concat(this.itemArr));else if(this.options.chooseOptions!=e)for(var s=0;s<this.itemArr.length;s++)if(this.itemArr[s].label==t){this.itemArr.splice(s,1);break}this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),-2!==this.getSelectedIndex()&&-1!==this.getSelectedIndex()&&0!==this.getSelectedIndex()||this.setSelectedIndex(0),this.options.chooseOption=e}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.componentRedraw=function(e,t,i){try{if(this.refreshStop)return;if(this.showRowIndex=0,!0===this.options.labelWidthAuto&&this.setLabelWidthByItemLength(),"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&this.setSelectOptions(),this.itemArr.length>0){var s=0;if(t||this.options.refreshSelectedIndex&&"insertRow"===i)return"insertRow"!==i&&"replace"!=t&&this.getSelectedIndex()>-1&&(s=this.getSelectedIndex()),void this.setSelectedIndexNM(s);if(this.options.refreshSelectedIndex&&"setCellData"===i)s=this.getSelectedIndex();else if(this.modelControl.isItemsetBinded()&&!this.modelControl.isBinded()&&-1!==this.selectedIndex)return void(this.options.emptyItem?this.setSelectedIndexNM(-1):this.setSelectedIndexNM(0));if(this._setLabel(s),this.options.refreshSelectedIndex&&"setCellData"===i)return}else this.dom.label&&(this.dom.label.innerHTML="");this.setValueNM("")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setLabelWidthByItemLength=function(){try{var e=this.getMaxLabelSize();this.render&&(this.render.style.width=e+"px")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.getMaxLabelSize=function(){try{this.labelRuler||(this.labelRuler=document.createElement("div"),this.labelRuler.style.position="absolute",this.labelRuler.style.top="-1000px",this.labelRuler.style.left="-1000px",this.labelRuler.style.visibility="hidden",document.body.appendChild(this.labelRuler));for(var e=0,t=0;t<this.itemArr.length;t++)this.labelRuler.innerHTML=this.itemArr[t].label,this.labelRuler.offsetWidth>e&&(e=this.labelRuler.offsetWidth);var i=document.getElementById(this.id+"_button"),s=0;return i&&(s=i.offsetWidth||parseInt(WebSquare.style.getComputedStyle(i,"width"))),e+s+10}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSubLayer=function(){try{var e=this;if(null==this.itemTable)if("grid"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridOptions.width||(this.gridOptions.parentWidth=this.render.offsetWidth),this.gridOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridItemTable(this.id+"_gridItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridOptions:this.gridOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.grid.addEvent("oncellclick",(function(t,i){e.focus(),"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(t)})),this.event.addListener(this.itemTable.grid.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.grid,(function(t){
var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(s)}else 27==i&&(e._closeSubLayer(),e.focus())}))),this.setGridData();else if("gridView"==this.itemTableMode)"auto"==this.options.submenuSize&&(this.gridViewOptions.width||(this.gridViewOptions.parentWidth=this.render.offsetWidth),this.gridViewOptions.autoFit="allColumn"),this.itemTable=new WebSquare.uiplugin.gridViewItemTable(this.id+"_gridViewItemTable",{itemsetObj:this.itemsetObj,className:this.options.className,gridViewOptions:this.gridViewOptions,visibleRowNum:this.options.visibleRowNum,findItemKor:this.options.findItemKor,findItemFirstKey:this.options.findItemFirstKey,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.gridView.addEvent("oncellclick",(function(t,i){e.focus(),"dataList"===e.gridViewOptions.dataComp.initializeType&&(t=this.getRealRowIndex(t)),e.setSelectedIndex1(t)})),this.event.addListener(this.itemTable.gridView.render,"onkeydown",this.event.bindAsEventListener(this.itemTable.gridView,(function(t){var i=t.charCode?t.charCode:t.keyCode;if(13==i){e.focus();var s=this.getFocusedRowIndex();"dataList"===e.gridViewOptions.dataComp.initializeType&&(s=this.getRealRowIndex(s)),e.setSelectedIndex1(s)}else 27==i&&(e._closeSubLayer(),e.focus())}))),this.setGridViewData();else{"ul"===this.options.tableRender?this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_ul_main",w2table_row:"w2table_sb_ul_row",w2table_col:"w2table_sb_ul_col",w2table_col_over:"w2table_sb_ul_col_over",escape:this.options.escape,tableRender:this.options.tableRender,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid}):this.itemTable=new WebSquare.uiplugin.itemTable(this.id+"_itemTable",{row:this.options.visibleRowNum,col:1,submenuSize:this.options.submenuSize,style:"position:absolute;",defaultStyle:"text-align:"+this.options.textAlign+";"+this.options.defaultStyle,className:"w2table "+this.options.className,w2table:"w2table_sb",w2table_main:"w2table_sb_main",w2table_row:"w2table_sb_row",w2table_col:"w2table_sb_col",w2table_col_over:"w2table_sb_col_over",escape:this.options.escape,wheelRows:this.options.wheelRows,chooseOption:this.options.chooseOption,allOption:this.options.allOption,findItemKor:this.options.findItemKor,findItem:this.options.findItem,keyBufferResetTime:this.options.keyBufferResetTime,parent_uuid:this.uuid}),this.itemTable.writeTo(WebSquare.getBody(),null,this.parentFrame),this.itemTable.activate(),this.itemTable.addClickEventListener((function(t,i){var s=t.charCode?t.charCode:t.keyCode,o=e.selectedIndex,l=e.getValue();if(e.focus(),e.setSelectedIndex1(i),e.options.keyMoveSync||0!=e.options.keyMoveSync||13!=s||"keydown"!==t.type){var r={oldValue:l,newValue:e.getValue(),oldSelectedIndex:o,newSelectedIndex:e.selectedIndex};n.B.fireEvent(e,"onselected",r)}})),this.itemTable.addKeyDownEventListener((function(t){var i=t.charCode?t.charCode:t.keyCode;e.options.customToggleKey==i?(e._closeSubLayer(),e.focus()):"ul"==this.options.tableRender&&e.itemTable.endReached?(e.itemTable.endReached=!1,e.closeSubLayer(),e.focus()):27==i&&(e._closeSubLayer(),e.focus())})),this.options.keyMoveSync||this.itemTable.addKeyUpEventListener((function(t,i){if(13==(t.charCode?t.charCode:t.keyCode)){var s=e.selectedIndex,o=e.getValue();e.focus(),e.setSelectedIndex1(i);var l={oldValue:o,newValue:e.getValue(),
oldSelectedIndex:s,newSelectedIndex:e.selectedIndex};n.B.fireEvent(e,"onselected",l)}})),this.options.keyMoveListSync&&this.itemTable.addOnchangeListener((function(t){try{e.setSelectedIndex1(t,{skipClose:!0})}catch(e){l.w.printStackTrace(e,null,this)}}));var t=WebSquare.idCache[this.uuid],i=this.options.closeonmouseleave,s=this.options.itemTooltipDisplay;(i||s)&&this.itemTable.addMouseLeaveEventListener((function(o){if(i){var l=e.render.offsetHeight,n=e.getAbsolutePosition("top");o.clientY>=n&&o.clientY<=n+l||e.closeSubLayer()}s&&t.hideTooltip()})),s&&this.itemTable.addMouseOverEventListener((function(e){var i=e,s=WebSquare.style.getAbsoluteLeft(i)+20,o=WebSquare.style.getAbsoluteTop(i)+i.offsetHeight+3,l="ul"===t.options.tableRender?i.innerText:i.innerHTML;if(t.itemTooltipFormatter&&"function"==typeof t.itemTooltipFormatter){var n=parseInt(i.getAttribute("index"),10);l=t.itemTooltipFormatter(l,n,t.options._rowIndex,t.options._colIndex)}t.showTooltip(s,o,l)})),this.setSelectOptions(),this.setItemTable()}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setGridData=function(){try{if(this.itemTable.grid.setData(this.gridItemArr),this.options.allOption&&this.gridItemArr.length>0){for(var e=[],t=-1,i=0;i<this.itemsetObj.items.length;i++)-1==t&&this.itemsetObj.items[i].ref==this.itemsetObj.label&&(t=i),e.push("");e[-1==t?0:t]=this.defaultAllOptionLabel,this.itemTable.grid.setRowData(0,e,!1)}if(this.itemsetObj.sortIndex&&this.gridItemArr.length>0){var s=[];if(this.options.allOption){var o=this.itemsetObj.sortIndex.split(" ")[0],n=this.itemTable.grid.getCellInfo(o).options.dataType,r=parseInt(this.itemsetObj.sortOrder.split(" ")[0],10);s[0]=function(e,t,i,s){return 0==i?-1:0==s?1:("number"==n?(e=Number(e),t=Number(t)):(e=e||"",t=t||""),e>t?1*r:e<t?-1*r:0)}}this.itemTable.grid.multisort({sortIndex:this.itemsetObj.sortIndex,sortOrder:this.itemsetObj.sortOrder,sortFuncArr:s})}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setGridViewData=function(){try{var e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);e.setData(this.gridViewItemArr.slice());var t=this.gridViewOptions.dataComp.filterManager.filterArr;if(t)for(var i=0;i<t.length;i++)e.setColumnFilter({type:t[i].options.type,colIndex:t[i].options.colIndex,key:t[i].options.key,condition:t[i].options.condition});if(this.options.chooseOption||this.options.allOption){for(var s=e.getAllData(),o=this.itemsetObj.label,n=e.getColumnIndex(o),r=e.getColumnCount(),a=n,h=0,d=[],c=0;c<r;c++)d.push("");if(this.options.chooseOption){var p=WebSquare.language.getMessage("SelectBox_choose")||"-선택-";s[a]!=p&&(d[n]=this._getChooseOptionLabel(),e.setRowData(h,d,!1))}if(this.options.allOption){WebSquare.language.getMessage("SelectBox_all");s[a]!=p&&(a=this.options.chooseOption?n+r:n,h=this.options.chooseOption?1:0,d[n]=this.defaultAllOptionLabel,e.setRowData(h,d,!1))}}var u=this.gridViewItemArr.length>0&&this.itemTable.gridView.delayedDrawObj&&this.itemTable.render&&"none"===this.itemTable.render.style.display;u&&this.itemTable.show(),this.itemTable.gridView.notifyDataChanged({keepTop:!0}),u&&this.itemTable.hide()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSelectOptions=function(){try{null!=this.itemTable&&"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode&&!0!==this.refreshStopItemTable&&this.itemTable.setItemArr(this.itemArr)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setItemTable=function(){try{var e,t=this.render.offsetWidth,i=document.body.offsetWidth,s=WebSquare.style.getAbsoluteLeft(this.render),n=WebSquare.style.getAbsoluteTop(this.render),r=this.itemTable.render.getElementsByTagName("td");if("ul"===this.options.tableRender&&(r=this.itemTable.render.getElementsByTagName("li")),r&&r.length>0){e=0;for(var a=Math.min(this.getVisibleItemCount(),this.options.visibleRowNum),h=0;h<a;h++)e+=r[h].offsetHeight;o.v.browserCheck.moz&&e<34&&1==a&&(e=34),this.itemTable.setStyle("height",e+"px")
}else this.itemTable.setStyle("height","0px");"auto"==this.itemTable.getStyle("overflow-x")&&(e+=20,this.itemTable.setStyle("height",e+"px"));var d=WebSquare.style.getSize(this.itemTable.render,"outerwidth")-WebSquare.style.getSize(this.itemTable.render,"width");if("fixed"==this.options.submenuSize)this.itemTable.setStyle("width",t-d+"px"),this.itemTable.render.offsetHeight>=this.itemTable.render.scrollHeight?this.itemTable.render.firstChild.style.width=t+"px":this.itemTable.render.firstChild.style.width=t-17+"px";else if("auto"==this.options.submenuSize){var c,p=this.render.offsetWidth,u=WebSquare.style.getSize(this.itemTable.render,"innerwidth")-WebSquare.style.getSize(this.itemTable.render,"width"),m=this.itemTable.render.clientWidth-u;if(i>p&&i<m&&(m=i-d),m=p-d,this.itemTable.setStyle("width",m+"px"),this.itemTable.render.clientHeight>=this.itemTable.render.scrollHeight||this.getItemCount()<=this.options.visibleRowNum)this.itemTable.render.firstChild.style.width=m+"px",(c=this.itemTable.render.scrollWidth-d)>m&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+"px"));else this.itemTable.render.firstChild.style.width=m-17+"px",(c=this.itemTable.render.scrollWidth-d)>i&&(c=i-17),c>m-17&&(this.itemTable.render.firstChild.style.width=c+"px",this.itemTable.setStyle("width",c+17+"px"));0===this.getItemCount()&&(this.itemTable.setStyle("width","0px"),this.itemTable.render.firstChild.style.width="0px")}else this.itemTable.render.scrollHeight-this.itemTable.render.offsetHeight>1&&this.itemTable.setStyle("width",this.itemTable.render.firstChild.offsetWidth+17+"px");var b=this.options.direction;if("auto"==b){var f=document.body.scrollTop;f<document.documentElement.scrollTop&&(f=document.documentElement.scrollTop);var y=WebSquare.style.getScale(),g=(n-f)*y,v=document.documentElement.clientHeight-(g+this.render.offsetHeight),T=this.itemTable.render.offsetHeight*y,S=Math.max(v,g);if(S<T&&r&&r.length>0){var I=0;for(h=0;h<r.length&&!(I+r[h].offsetHeight+2>S);h++)I+=r[h].offsetHeight;this.itemTable.rowCount=h,this.itemTable.setStyle("height",I+"px"),S!==v&&(b="up")}else v<T&&g>T&&(b="up")}if("up"==b?n-=this.itemTable.render.offsetHeight:n+=this.render.offsetHeight,document.documentElement.clientWidth<s+this.itemTable.render.offsetWidth)(s=s+this.render.offsetWidth-this.itemTable.render.offsetWidth)<0?(s=WebSquare.style.getAbsoluteLeft(this.render),m=document.body.offsetWidth-17-s,this.itemTable.setStyle("width",m+"px"),"auto"!=this.itemTable.getStyle("overflow-x")&&(e+=20),this.itemTable.setStyle("height",e+"px"),this.itemTable.setStyle("overflow-x","auto")):this.itemTable.setStyle("overflow-x","hidden");else{m=this.itemTable.render.firstChild.offsetWidth;var w=this.itemTable.render.clientWidth;if(s+m<i&&"auto"==this.itemTable.getStyle("overflow-x")){var x=m>w?m:w;e-=20,this.itemTable.setStyle("height",e+"px"),this.itemTable.setStyle("width",x+"px"),this.itemTable.setStyle("overflow-x","hidden")}}this.itemTableDirection=b,this.itemTable.setPosition(s,n),WebSquare.style.adjustZIndex(this.uuid,this.itemTable.uuid,"itemTable")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSelectItemArr=function(){try{if(""!=this.options.sortOption){var e=[],t=null;"label"==this.options.sortOption?t=function(){return this.label}:"value"==this.options.sortOption&&(t=function(){return this.value});for(var i=0;i<this.itemArr.length;i++){var s=this.itemArr[i];s.toString=t,e.push(s)}e.sort(),"descending"==this.options.sortMethod&&e.reverse(),this.itemArr=e}if("0"!=this.options.displayMode)for(i=0;i<this.itemArr.length;i++)this.itemArr[i].orgLabel=this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i);if("all"==this.options.optionOrder){if(1==this.options.chooseOption){var o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,
value:WebSquare.allValue}].concat(this.itemArr))}else if(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption){o=this._getChooseOptionLabel();o=WebSquare.xml.decode(o).replace("&nbsp;"," "),this.itemArr=[{label:o,value:this.options.chooseOptionValue}].concat(this.itemArr)}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.toggle=function(){try{this.isOpen?this.closeSubLayer():this.openSubLayer()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.openSubLayer=function(){try{WebSquare.getBody().getLayerListener().show(this.id)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._openSubLayer=function(){try{if(this.setSubLayer(),!this.isOpen){if(this.itemTable.show(),this.addClass("w2selectbox_open"),this.itemTable.render.setAttribute("aria-expanded","true"),this.setItemTable(),1==this.options.wmode&&WebSquare.getBody().showWModeFrame(this.getPluginName(),this.itemTable.render),r.D.isMobile()||this.itemTable.focus(),"ul"==this.options.tableRender&&(this.itemTable.removeClass(this.itemTable.selectedCell,this.itemTable.options.w2table_col_over),this.itemTable.selectedCell=null),this.options.emptyItem?this.itemTable.setSelectedIndex(this.selectedIndex,{noChangeFunc:!0}):-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex),""!=this.options.animation&&"string"==typeof this.options.animation){var e="down",t=WebSquare.style.getAbsoluteTop(this.render),i=document.body.scrollTop;i<document.documentElement.scrollTop&&(i=document.documentElement.scrollTop);var s=t-i,o=document.documentElement.clientHeight-(s+this.render.offsetHeight),n=this.itemTable.render.offsetHeight;o<n&&s>n&&(e="up"),"show"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().show("fast"):"fadein"==this.options.animation.toLowerCase()?$("#"+this.itemTable.id).hide().fadeIn("slow"):"slidedown"==this.options.animation.toLowerCase()&&"down"==e&&$("#"+this.itemTable.id).hide().slideDown("fast")}this.isOpen=!0,this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex)}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._openOtherLayer=function(){try{var e=this.otherComponent;if("grid"==this.itemTableMode?(this.setSubLayer(),this.setGridData(),""!==this.gridOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.grid.render.style.height),e=this.itemTable):"gridView"==this.itemTableMode&&(this.setSubLayer(),this.setGridViewData(),""!==this.gridViewOptions.visibleRowNum&&(this.itemTable.render.style.height=this.itemTable.gridView.render.style.height),e=this.itemTable),!this.isOpen){e.show(),this.addClass("w2selectbox_open");var t=WebSquare.style.getAbsoluteLeft(this.render),i=WebSquare.style.getAbsoluteTop(this.render),s=this.options.direction;if("auto"==s){var o=document.body.scrollTop;o<document.documentElement.scrollTop&&(o=document.documentElement.scrollTop);var n=i-o,a=document.documentElement.clientHeight-(n+this.render.offsetHeight),h=e.render.offsetHeight;a<h&&n>h&&(s="up")}"up"==s?"gridView"==this.itemTableMode?i-=e.gridView.render.offsetHeight:i-=e.grid.render.offsetHeight:i+=this.render.offsetHeight,"auto"==this.options.submenuSize&&"gridView"==this.itemTableMode&&(t=WebSquare.style.getAbsoluteLeft(this.render),this.gridViewOptions.width||(e.render.style.width=this.render.offsetWidth+"px")),document.documentElement.clientWidth<t+e.render.offsetWidth&&(t=t+this.render.offsetWidth-e.render.offsetWidth),t<0&&(t=0),e.setPosition(t,i),this.isOpen=!0,this.itemTableDirection=s,WebSquare.style.adjustZIndex(this.uuid,e.uuid,"itemTable"),!r.D.isMobile()&&this.options.findItemFirstKey&&("grid"==this.itemTableMode?e.grid.render.focus():"gridView"==this.itemTableMode&&e.gridView.render.focus())}
-1!=this.selectedIndex&&this.itemTable.setSelectedIndex(this.selectedIndex)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.closeSubLayer=function(e){try{var t={documentClick:e};null!=this.itemTable&&("grid"==this.itemTableMode?this.itemTable.grid.applyFocusedCellOut(this.itemTable.grid.focusedCell[0]):"gridView"==this.itemTableMode&&this.itemTable.gridView.applyFocusedCellOut(this.itemTable.gridView.focusedCell[0])),WebSquare.getBody().getLayerListener().hide(this.id,t)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._closeSubLayer=function(e){try{var t=(e=e||{}).documentClick;this.isOpen&&null!=this.itemTable&&(this.itemTable.hide(),this.removeClass("w2selectbox_open"),this.itemTable.render.setAttribute("aria-expanded","true"),1==this.options.wmode&&WebSquare.getBody().hideWModeFrame(this.getPluginName(),this.itemTable.id),this.isOpen=!1,this.options.customLabelFormatter&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter&&this._setLabel(this.selectedIndex),!0===t?n.B.fireEvent(this,"onclose",!0):n.B.fireEvent(this,"onclose",!1))}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._closeOtherLayer=function(e){try{var t=(e=e||{}).documentClick,i=this.otherComponent;"grid"!=this.itemTableMode&&"gridView"!=this.itemTableMode||(i=this.itemTable),this.isOpen&&null!=i&&(i.hide(),this.removeClass("w2selectbox_open"),this.isOpen=!1,!0===t?n.B.fireEvent(this,"onclose",!0):n.B.fireEvent(this,"onclose",!1))}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSelectedIndex=function(e,t){try{if(e=parseInt(e,10),isNaN(e))return;if(e<0||e>=this.getItemCount()){if(this.options.emptyItem)if(this.modelControl.isBinded())(1==this.options.selectedData||0!=t)&&this.modelControl.setData(this.options.emptyValue),this.setSelectedIndexNM(-1);else{var i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(-1),-1!=i&&n.B.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}return}if(this.modelControl.isBinded()){var o=this.modelControl.dataCollectionRefInfo?this.modelControl.dataCollectionRefInfo.dataComp:null;1==this.options.selectedData?(this.modelControl.setData(this.itemArr[e].value),null==o||o.getBroadcast()||this.setSelectedIndexNM(e)):0!=t?this.itemArr[e].value!=WebSquare.allValue?(this.modelControl.setData(this.itemArr[e].value),1==this.options.chooseOption&&0==e?this.setSelectedIndexNM(0):null==o||o.getBroadcast()||this.setSelectedIndexNM(e)):(this.modelControl.setData(""),this.setSelectedIndexNM(e)):this.setSelectedIndexNM(-1)}else{i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(e),i!=this.getSelectedIndex()&&n.B.fireEvent(this,"onchange",{oldValue:s,newValue:this.getValue()})}this.broadcast({linkedDataList:["refresh",["replace"]]})}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSelectedIndexNM=function(e){try{return e=parseInt(e,10),isNaN(e)?!1:e<0||e>=this.getItemCount()?!!this.options.emptyItem&&(this.selectedIndex=-1,this.dom.label.innerHTML="",this.itemTable&&this.itemTable.setSelectedIndex(0),!0):(this.selectedIndex=e,this._setLabel(e),this.itemTable&&this.render.setAttribute("aria-activedescendant",this.itemTable.id+"_"+e),!0)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setAllSelectedIndex=function(e,t){try{if(!this.allItemArr[e])return this.selectedAllIndex=-1,!1;this.selectedIndex=-1,this.selectedAllIndex=e;var i=this.allItemArr[e].label+"";return this.dom.label&&(this.dom.label.innerHTML=this._getLabel(i)),t&&this.modelControl.setData(this.allItemArr[e].value),NaN}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.getSelectedIndex=function(){try{return this.selectedIndex}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.getSelectedRow=function(){try{if("gridView"==this.itemTableMode&&this.itemTable){var e=this.modelControl.getDataComp(this.itemTable.gridView.options.dataList);if(e)return e.getRowArray(this.getSelectedIndex())}
}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setValue=function(e){try{var t=!0;if(r.D.isNull(e))return!1;var i=this.getValue();if(this.modelControl.isBinded())this.modelControl.setData(e);else{i=this.getValue();var s=this.setValueNM(e);1==s?i!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:i,newValue:this.getValue()}):isNaN(s)||(this._setValueNotInList(e),t=!1)}return this.broadcast({linkedDataList:["refresh",["replace"]]}),t}catch(e){return l.w.printStackTrace(e,null,this),!1}},c.prototype.setValueNM=function(e){try{if(r.D.isNull(e))return;e=e.toString();for(var t=this.getItemCount(),i=0;i<t;i++)if(this.itemArr[i].value==e)return this.setSelectedIndexNM(i),!0;return this.setAllValue(e)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setAllValue=function(e,t){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(e){return!1}if(r.D.isNull(e))return!1;e=e.toString();for(var i=this.allItemArr.length,s=0;s<i;s++)if(this.allItemArr[s].value==e)return this.setAllSelectedIndex(s,t);return!1}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype._setValueNotInList=function(e,t){try{switch(this.options.valueNotInList){case"keepValue":if(e)if(this.selectedIndex=-1,null!=this.dom.label.textContent)this.dom.label.textContent=e;else if(null!=this.dom.label.innerText)this.dom.label.innerText=e;else{var i=this._getLabel(e);this.dom.label.innerHTML=i}else this.options.emptyItem?this.setSelectedIndex(-1):this.setSelectedIndex(0);break;case"default":default:this.options.emptyItem?this.setSelectedIndex(-1,t):this.setSelectedIndex(0,t)}}catch(e){return l.w.printStackTrace(e,null,this),!1}},c.prototype.getValue=function(){try{if(this.itemArr[this.selectedIndex])return this.itemArr[this.selectedIndex].value;var e=this.getAllValue();return!1!==e?e:this._getValueNotInList()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.getAllValue=function(e,t){try{try{if(!this.modelControl.isDataCollectionItemsetBinded||this.modelControl.dataCollectionItemsetInfo.dataComp&&!this.modelControl.dataCollectionItemsetInfo.dataComp.options.validateAllItemsetData)return!1}catch(e){return!1}return!!this.allItemArr[this.selectedAllIndex]&&this.allItemArr[this.selectedAllIndex].value}catch(e){return l.w.printStackTrace(e,null,this),!1}},c.prototype._getValueNotInList=function(){try{switch(this.options.valueNotInList){case"keepValue":return(null!=this.dom.label.textContent?this.dom.label.textContent:null!=this.dom.label.innerText?this.dom.label.innerText:this.dom.label.innerHTML)||(this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null);case"default":default:return this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}}catch(e){return l.w.printStackTrace(e,null,this),null}},c.prototype.setText=function(e,t){try{var i=this.getItemCount(),s="";if(t)for(var o=0;o<i;o++)this.itemArr[o].orgLabel==e&&(s=this.itemArr[o].value);else for(o=0;o<i;o++)this.itemArr[o].label==e&&(s=this.itemArr[o].value);this.setValue(s)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.getText=function(e){try{return this.itemArr[this.selectedIndex]?e?this.itemArr[this.selectedIndex].orgLabel:this.itemArr[this.selectedIndex].label:this.options.emptyItem&&-1==this.selectedIndex?"":null}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.addItemArr=function(e,t,i){try{!0===i||!1===i?this.itemArr.push({label:e,value:t,_hidden:i}):this.itemArr.push({label:e,value:t})}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.addItem=function(e,t,i,s){try{if(i=parseInt(i,10),(isNaN(i)||i<0||i>=this.getItemCount())&&(i=this.getItemCount()),null==s&&(s=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&s){var o=this.modelControl.getDataComp();if(o&&WebSquare.idCache[o.uuid]){var n={};n[this.itemsetObj.value]=e,n[this.itemsetObj.label]=t,
this.stopRefresh(!0),o.insertJSON(i,[n]),this.stopRefresh(!1)}}var r={};return r.value=e,r.label=t,this.itemArr.splice(i,0,r),"0"!=this.options.displayMode&&(this.itemArr[i].orgLabel=this.itemArr[i].label,this.itemArr[i].label=this.getItemText(i)),this.options.emptyItem&&-1==this.selectedIndex&&this.setSelectedIndex(0),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),i}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.deleteItem=function(e,t){try{if(e=parseInt(e,10),isNaN(e))return;if(null==t&&(t=this.options.dataListAutoRefresh),this.itemsetObj.nodeset.match("data:")&&t){var i=this.modelControl.getDataComp();if(i&&WebSquare.idCache[i.uuid]){var s=0;this.options.chooseOption&&s++,this.options.allOption&&s++,this.stopRefresh(!0),i.removeRow(e-s),this.stopRefresh(!1)}}var o=null;return e>=0&&e<this.getItemCount()&&(o=this.itemArr.splice(e,1)[0]),this.itemTable?(this.itemTable.setStyle("visibility","hidden"),this.itemTable.setStyle("display","block"),this.setSelectOptions(this.itemArr),this.itemTable.setStyle("display","none")):this.setSelectOptions(this.itemArr),this.options.emptyItem&&(-1!=this.selectedIndex&&e!=this.selectedIndex||this.setSelectedIndex(0)),this.options.emptyItem&&"native"==this.options.renderType?this.selectedIndex>e&&e>=0?this.setSelectedIndex(this.selectedIndex-1):this.setSelectedIndex(this.selectedIndex):this.selectedIndex>e&&e>=0&&this.setSelectedIndex(this.selectedIndex-1),o}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.removeAll=function(e){try{var t=this.getValue();if(this.itemArr=new Array,e&&(1==this.options.allOption&&(this.itemArr=[{label:this.defaultAllOptionLabel,value:WebSquare.allValue}].concat(this.itemArr)),1==this.options.chooseOption)){var i=this._getChooseOptionLabel();i=WebSquare.xml.decode(i).replace("&nbsp;"," "),this.itemArr=[{label:i,value:this.options.chooseOptionValue}].concat(this.itemArr)}if(this.setSelectOptions(this.itemArr),this.dom.label)if(this.itemArr.length>0){i=this.itemArr[0].label+"";r.D.isIE()&&parseInt(o.v.browserVersion(),10)<10?(i.indexOf("&")>-1&&(i=i.wq_replaceAll("&","&amp;")),i=this.options.escape?WebSquare.xml._encode(i):i.wq_replaceAll("&amp;nbsp;","&nbsp;").wq_replaceAll("&amp;nbsp","&nbsp;")):this.options.escape&&(i=WebSquare.xml._encode(i)),this.dom.label.innerHTML=i}else this.dom.label.innerHTML="";if(this.options.setDataRemoveAll&&(e?this.setSelectedIndex(0):(this.selectedIndex=-1,!this.dom.label&&this.dom.select&&(this.dom.select.selectedIndex=-1),this.modelControl.isBinded()&&this.modelControl.setData(""),t!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()}))),"grid"==this.itemTableMode)this.gridItemArr=[],this.itemTable&&this.itemTable.grid.removeAll();else if("gridView"==this.itemTableMode){if(this.gridViewItemArr=[],this.itemTable)this.modelControl.getDataComp(this.itemTable.gridView.options.dataList).removeAll()}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.onPropertyChange=function(e,t){try{switch(e){case"disabled":"component"==this.options.renderType?t?(this.closeSubLayer(),this.getElementById(this.id+"_label").style.color="#848684"):this.getElementById(this.id+"_label").style.color="":t?this.dom.select&&this.dom.select.setAttribute("disabled","disabled"):this.dom.select&&this.dom.select.removeAttribute("disabled");var i=this.dom.button;1==t?(this.addClass(this.render,this.options.disabledClass),null!=i&&this.addClass(i,"w2selectbox_button_disabled")):(this.removeClass(this.render,this.options.disabledClass),null!=i&&this.removeClass(i,"w2selectbox_button_disabled"));break;case"mandatory":1==t?this.addClass(this.render,"w2selectbox_mandatory"):this.removeClass(this.render,"w2selectbox_mandatory")}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setSelectedIndex1=function(e,t){try{void 0!==t&&null!=t||(t={})
;var i=this.selectedIndex,s=this.getValue();if(this.setSelectedIndex(e),i!=this.selectedIndex){var o={oldValue:s,newValue:this.getValue(),oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onviewchange",o)}!0!==t.skipClose&&this.closeSubLayer()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.validate=function(){try{var e=this.validator.validate(this.getValue());return e||this.focus(),e}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.validateObject=function(){try{var e=this.validator.validate(this.getValue()),t={};return e||(this.focus(),this.validator&&this.validator.obfuscator_invalidObject&&(t.callerId=this.validator.obfuscator_invalidObject.callerId,t.type=this.validator.obfuscator_invalidObject.getType(),t.value=this.validator.obfuscator_invalidObject.getValue())),t}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setInitValue=function(e){try{var t=this.getValue();""===this.options.initValue&&this.itemArr&&this.itemArr[0]&&(this.options.initValue=this.itemArr[0].value),this.setValueNM(this.options.initValue),this.modelControl.setData(this.options.initValue),e.fireEvent&&t!=this.getValue()&&n.B.fireEvent(this,"onchange",{oldValue:t,newValue:this.getValue()})}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.hide=function(){try{this.closeSubLayer(),a.s.prototype.hide.call(this)}catch(e){l.w.printStackTrace(e)}},c.prototype.showTooltip=function(e,t,i){try{if(!i)return;null!=this.timeShowTooltip&&(clearTimeout(this.timeShowTooltip),this.timeShowTooltip=null),null!=this.timeHideTooltip&&(clearTimeout(this.timeHideTooltip),this.timeHideTooltip=null);var s="";this.options.itemTooltipDisplay&&(s="position:absolute;z-index:10000;"),this.timeShowTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip||(this.tooltip=new WebSquare.uiplugin.group(this.id+"_tooltip",{className:"w2selectbox_tooltip "+this.options.tooltipClass,style:s}),this.tooltip.writeTo(WebSquare.getBody(),null,this.parentFrame),this.tooltip.activate(),this.tooltip.removeClass("w2group")),this.tooltip.setStyle("display","block"),this.tooltip.setStyle("left",e+"px"),this.tooltip.setStyle("top",t+"px"),WebSquare.style.adjustZIndex(this.uuid,this.tooltip.uuid,"toolTip"),this.options.escape&&(i=WebSquare.xml._encode(i)),this.tooltip.render.innerHTML=i,this.isFireTooltipEvent||(this.isFireTooltipEvent=!0,n.B.fireEvent(this,"ontooltipshow"))})),1e3*this.options.tooltipTime)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.hideTooltip=function(){try{this.timeHideTooltip=setTimeout(this.event.bindAsEventListener(this,(function(){this.tooltip&&(this.tooltip.setStyle("display","none"),n.B.fireEvent(this,"ontooltiphide"),this.isFireTooltipEvent=!1)})),1e3*this.options.tooltipTime)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.focusNextTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID){var e=r.D.getNextTabbableComp(this.id);e&&e.focus()}}catch(e){l.w.printStackTrace(e)}},c.prototype.focusPreTabOrder=function(){try{if(null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID){var e=r.D.getPreTabbableComp(this.id);e&&e.focus()}}catch(e){l.w.printStackTrace(e)}},c.prototype.getNextTabID=function(){try{var e=null;return null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(e=WebSquare.tabOrder[this.id].nextTabID),e}catch(e){l.w.printStackTrace(e)}},c.prototype.setNextTabID=function(e,t){try{null!=e&&r.D.setNextTabID(this.id,e,t)}catch(e){l.w.printStackTrace(e)}},c.prototype.handleClickEvent=function(e){try{if(this.options.disabled)return!1;r.D.isMobile()||this.focus(),this.itemArr.length>0?this.toggle():1==WebSquare.getBody().getLayerListener().existShow&&WebSquare.getBody().getLayerListener().hideAll()}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleKeydownEvent=function(e){try{var t=e.charCode?e.charCode:e.keyCode,i=this.getSelectedIndex()
;if(!0===this._preventKeyObj[t]||!0===this._preventKeyObj.all)return;if(13==t&&this.options.keyMoveSync)return void this.handleClickEvent(e);if(this.options.customToggleKey==t)return void this.toggle();if(this.isOpen)return;if(!this.options.keyMoveSync||38!=t&&40!=t&&33!=t&&34!=t&&35!=t&&36!=t)return 9==t?(this.tabOrderMoveStart=!1,void(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(e)))):(this.findItemStartedWithKeyChar(e,t),void(this.options.findItem&&this._keyBuffer&&(r.D.clearTimeout(this.id+"_selectKeyBuffer"),r.D.setTimeout((function(){this._keyBuffer=""}),{key:this.id+"_selectKeyBuffer",caller:this,delay:this.options.keyBufferResetTime}))));if(this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==t)i>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(i-1),this.targetFocusedIndex=i-1):this.setSelectedIndex1(i-1));else if(40==t)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?i+1<this.getItemCount()&&(this.setSelectedIndex1(i+1),this.targetFocusedIndex=i+1):i+1<this.getItemCount()&&this.setSelectedIndex1(i+1);else if(33==t){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i-this.options.visibleRowNum)<0&&(s=0),this.setSelectedIndex1(s)}else if(34==t){var s;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s),this.targetFocusedIndex=s;else(s=i+this.options.visibleRowNum)>=this.getItemCount()&&(s=this.getItemCount()-1),this.setSelectedIndex1(s)}else 35==t?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndex1(this.getItemCount()-1):36==t&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndex1(0),this.targetFocusedIndex=0):this.setSelectedIndex1(0));if(this._oldIndex!=this.selectedIndex){var o={oldValue:this._oldValue,newValue:this.getValue(),oldSelectedIndex:this._oldIndex,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onselected",o)}n.B.stopEvent(e)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleKeyupEvent=function(e){try{var t,i=e.charCode?e.charCode:e.keyCode;if(!0===this._preventKeyObj[i]||!0===this._preventKeyObj.all)return;if(!this.options.keyMoveSync&&this.modelControl.isBinded()){var s=this.getSelectedIndex();if(13==i){for(var o=this.modelControl.getData(),a=-1,h=0;h<this.itemArr.length;h++)if(this.itemArr[h].value==o){a=h;break}var d={oldValue:o,newValue:this.getValue(),oldSelectedIndex:a,newSelectedIndex:s};this.setSelectedIndex(this.getSelectedIndex()),n.B.fireEvent(this,"onselected",d)}else if(38==i||40==i||33==i||34==i||35==i||36==i)if(this._onSelected=!1,this._oldIndex=this.selectedIndex,this._oldValue=this.getValue(),38==i)s>0&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(s-1),this.targetFocusedIndex=s-1):this.setSelectedIndexNM(s-1));else if(40==i)"grid"==this.itemTableMode||"gridView"==this.itemTableMode?s+1<this.getItemCount()&&(this.setSelectedIndexNM(s+1),this.targetFocusedIndex=s+1):s+1<this.getItemCount()&&this.setSelectedIndexNM(s+1);else if(33==i){if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(c=s-this.options.visibleRowNum)<0&&(c=0),this.setSelectedIndexNM(c),this.targetFocusedIndex=c;else(c=s-this.options.visibleRowNum)<0&&(c=0),this.setSelectedIndexNM(c)}else if(34==i){var c;if("grid"==this.itemTableMode||"gridView"==this.itemTableMode)(c=s+this.options.visibleRowNum)>=this.getItemCount()&&(c=this.getItemCount()-1),this.setSelectedIndexNM(c),
this.targetFocusedIndex=c;else(c=s+this.options.visibleRowNum)>=this.getItemCount()&&(c=this.getItemCount()-1),this.setSelectedIndexNM(c)}else 35==i?"grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(this.getItemCount()-1),this.targetFocusedIndex=this.getItemCount()-1):this.setSelectedIndexNM(this.getItemCount()-1):36==i&&("grid"==this.itemTableMode||"gridView"==this.itemTableMode?(this.setSelectedIndexNM(0),this.targetFocusedIndex=0):this.setSelectedIndexNM(0))}if(9==i||13==i&&this.options.nextTabByEnter)if(null!=WebSquare.tabOrder[this.id])if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(t=r.D.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus())}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(t=r.D.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus())}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleMousewheelEvent=function(e){try{if(this.options.preventWheelEvent)return;n.B.stopEvent(e);for(var t=this.event.getTargetIterator(e,this.render);t.next();)if(t.match("w2selectbox_focus")&&!this.isOpen){var i=this.getSelectedIndex();e.wheelDelta>0||e.detail<0?this.setSelectedIndex1(i-1):this.setSelectedIndex1(i+1)}t=null}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleFocusEvent=function(e){try{n.B.stopEvent(e),this.addClass(this.dom.tbody,"w2selectbox_focus"),this.addClass("w2selectbox_body_focus")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleBlurEvent=function(e){try{n.B.stopEvent(e),this.removeClass(this.dom.tbody,"w2selectbox_focus"),this.removeClass("w2selectbox_body_focus"),this.itemTable&&this.itemTable.itemTableFocus||n.B.fireEvent(this,"onblur",e)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleMouseoverEvent=function(e){try{if(n.B.stopEvent(e),this.addClass(this.dom.tbody,"w2selectbox_over"),this.addClass("w2selectbox_body_over"),!this.isOpen){for(var t=this.event.getTargetIterator(e,this.render);t.next();)if(t.match("w2selectbox")&&(1==this.options.tooltipDisplay||1==this.options.tooltipShowAlways)){var i=t.getElement(),s=i.getElementsByClassName("w2selectbox_label")[0],o=WebSquare.style.getStyle(s,"text-overflow"),r=this.dom.label.innerHTML;if(!0===this.options.tooltipShowAlways){var a=WebSquare.style.getAbsoluteLeft(i)+20,h=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;this.showTooltip(a,h,r)}else if("ellipsis"==o){this.toolTipRuler||(this.toolTipRuler=document.createElement("span"),this.toolTipRuler.style.position="absolute",this.toolTipRuler.style.visibility="hidden",this.toolTipRuler.style.left="0px",this.toolTipRuler.style.top="0px"),document.body.appendChild(this.toolTipRuler),this.toolTipRuler.className=s.className,this.toolTipRuler.innerHTML=s.innerText,this.toolTipRuler.style.fontSize=WebSquare.style.getStyle(s,"font-size"),this.toolTipRuler.style.fontFamily=WebSquare.style.getStyle(s,"font-family"),this.toolTipRuler.style.fontWeight=WebSquare.style.getStyle(s,"font-weight");var d=this.toolTipRuler.offsetWidth,c=s.clientWidth;if(3!=s.nodeType){var p=WebSquare.style.getStyle(this.toolTipRuler,"padding-left"),u=WebSquare.style.getStyle(this.toolTipRuler,"padding-right");d-=parseInt(p||"0",10),d-=parseInt(u||"0",10),c-=parseInt(WebSquare.style.getStyle(s,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(s,"padding-right"),10),c-=parseInt(WebSquare.style.getStyle(i,"padding-left"),10),c-=parseInt(WebSquare.style.getStyle(i,"padding-right"),10)}if(c<d){a=WebSquare.style.getAbsoluteLeft(i)+20,h=WebSquare.style.getAbsoluteTop(i)+this.render.offsetHeight+3;document.body.removeChild(this.toolTipRuler),this.options.tooltipItemLabel&&(r=this.options.tooltipItemLabel),this.showTooltip(a,h,r)}}}t=null}}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleMouseoutEvent=function(e){try{n.B.stopEvent(e),1!=this.options.tooltipDisplay&&1!=this.options.tooltipShowAlways||this.hideTooltip(),
this.removeClass(this.dom.tbody,"w2selectbox_over"),this.removeClass("w2selectbox_body_over")}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.handleMouseleaveEvent=function(e){try{var t=this.render.offsetHeight-1,i=this.render.offsetWidth-1,s=this.getAbsolutePosition("top"),o=this.getAbsolutePosition("left");this.isOpen&&("up"==this.itemTableDirection?(e.clientX<o||e.clientX>o+i||e.clientY>s||e.clinetY>s+t)&&this.closeSubLayer():(e.clientX<o||e.clientX>o+i||e.clientY<s||e.clinetY>s+t)&&this.closeSubLayer())}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.findItemStartedWithKeyChar=function(e,t){try{var i=this.keyCharHash[t],s=-1;if(i){var o=this.korCharHash[t],n=this.korCharHash2[t],a=this.selectedIndex;this.options.findItem?(this._keyBuffer+=i,a=0):(this._keyBuffer=i,a++);for(var h=1;;){a%=this.itemArr.length;var d=this.itemArr[a].label.toLowerCase();if(0!=a||!0!==this.options.chooseOption&&!0!==this.options.allOption)if(0!=a&&1!=a||!0!==this.options.chooseOption||!0!==this.options.allOption){var c=!1;o&&!e.shiftKey?c=this.myhelper.startWith(d,o):n&&e.shiftKey&&(c=this.myhelper.startWith(d,n));var p=this.options.findItem?this._keyBuffer:i;if(d.startsWith(p)||c&&r.D.getBoolean(this.options.findItemKor)){s=a;break}if(d.startsWith(p)){this._keyBuffer="",s=a;break}if(h>this.itemArr.length)break;a++,h++}else{if(this.itemArr.length<=2)break;a++}else{if(this.itemArr.length<=1)break;a++}}if(s>-1)return this.setSelectedIndex1(s),!0}if(-1==s)return this._keyBuffer="",!1}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.setRef=function(e){try{"string"==typeof e&&e.length>0&&(this.modelControl.isBinded()||(this.modelControl.useRef=!0),this.options.ref=e,this.modelControl.setRef(e),this.refresh())}catch(e){l.w.printStackTrace(e)}},c.prototype.unbindRef=function(){try{this.modelControl.isBinded()&&(this.options.ref="",this.modelControl.unbindRef(),this.refresh())}catch(e){l.w.printStackTrace(e)}},c.prototype._setLabel=function(e,t){try{var i=t&&t.skipCustomFormatter;if(this.dom.label){var s=this.itemArr[e].label+"";if(this.options.customLabelFormatter&&!0!==i&&(this.customLabelFormatter=r.D.getGlobalFunction(this.options.customLabelFormatter,this.scope_id)),"function"==typeof this.customLabelFormatter){var o=this.itemArr[e].value+"",n=this.itemArr[e].orgLabel+"";(0!=e||!0!==this.options.chooseOption&&!0!==this.options.allOption)&&(0!=e&&1!=e||!0!==this.options.chooseOption||!0!==this.options.allOption)&&(s=this.customLabelFormatter.call(this,n,o,this.isOpen))}else s=this._getLabel(s);this.dom.label.innerHTML=s}}catch(e){l.w.printStackTrace(e)}},c.prototype._getLabel=function(e){try{var t=e;return r.D.isIE()&&parseInt(o.v.browserVersion(),10)<10?(e.indexOf("&")>-1&&(e=e.wq_replaceAll("&","&amp;")),e=this.options.escape?WebSquare.xml._encode(e):e.wq_replaceAll("&amp;nbsp;","&nbsp;").wq_replaceAll("&amp;nbsp","&nbsp;")):this.options.escape&&(e=WebSquare.xml._encode(e)),t}catch(e){l.w.printStackTrace(e)}},c.prototype._getChooseOptionLabel=function(e){try{var t;if("$blank"===this.options.chooseOptionLabel)t="";else if(t=this.options.chooseOptionLabel||this.defaultChooseOptionLabel,this.options.useLocale&&this.options.chooseOptionLabelLocaleRef){var i=this.getLocaleValue(this.options.chooseOptionLabelLocaleRef);i&&(t=i)}return t}catch(e){l.w.printStackTrace(e)}},c.prototype.stopRefresh=function(e){try{this.refreshStop=r.D.getBoolean(e)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.stopRefreshItemTable=function(e){try{this.refreshStopItemTable=r.D.getBoolean(e)}catch(e){l.w.printStackTrace(e,null,this)}},c.prototype.focus=function(){"ul"==this.options.tableRender?this.dom.tbody.focus():this.render.focus()},c.prototype.setDisabled=function(e){try{e=r.D.getBoolean(e),this.options.disabled=e,this.setProperty("disabled",e),!0===e?this.render.removeAttribute("tabIndex"):this.render.setAttribute("tabIndex",this.options.tabIndex||0)}catch(e){l.w.printStackTrace(e)}return e},c.prototype.serialize=function(){return{
selectedIndex:this.getSelectedIndex()}},c.prototype.restore=function(e){this.setSelectedIndex(e.selectedIndex)};var p=function(e,t,i){a.s.call(this,e,t,i)};s.x.extend(p.prototype,c.prototype),p.prototype.defaultOptions={pluginType:"uiplugin.selectbox",pluginName:"selectbox",renderType:"native",userEvents:["onchange","onclose","onviewchange","onfocus"],useConfig:!0,value:"",chooseOption:!1,chooseOptionLabel:"",chooseOptionValue:"",allOption:!1,sortOption:"",sortMethod:"",displayMode:"0",delimiter:"\t",textAlign:"",useLocale:!1,disabledClass:"w2selectbox_disabled",mandatory:!1,maxlength:-1,minlength:-1,allowChar:"",ignoreChar:"",characterCase:"",maxByteLength:-1,minByteLength:-1,validator:"",invalidMessage:"",invalidMessageFunc:"",displaymessage:!1,labelWidthAuto:!1,initValue:"",title:"",emptyItem:!1,emptyValue:"",emptyIndex:0,findItem:!1,initStyle:!1},p.prototype.initialize=function(e){try{this._initializeCommon(e&&"$blank"==e.getAttribute("chooseOptionLabel")),this.initializeItemArr(e)}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.finalize=function(){a.s.prototype.finalize.call(this)},p.prototype.toHTML=function(){try{var e=[],t=this.options.style?"style='"+this.options.style+"'":"",i=this.options.title?"title='"+this.options.title+"'":"";if("select"==this.options.renderType){e.push("<select id='"+this.id+"' "+t+" class='w2selectbox_select "+this.options.className+"' "+i+">");for(var s=0;s<this.itemArr.length;s++)e.push("<option>"+this.itemArr[s].label+"</option>");e.push("</select>")}else{e.push("<div id='"+this.id+"' "+t+" class='w2selectbox_native "+(r.D.isMobile()?"w2selectbox_native_mobile ":"")+(this.options.labelWidthAuto?"":"fixedWidth ")+this.options.className+"'>"),e.push("<div class='w2selectbox_native_innerDiv'>"),e.push("<select class='w2selectbox_native_select' id='"+this.id+"_input_0' "+i+">");for(s=0;s<this.itemArr.length;s++)e.push("<option>"+this.itemArr[s].label+"</option>");e.push("</select>"),e.push("</div>"),e.push("</div>")}return e.join("")}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.setPreAction=function(){try{if(this.dom.select="select"==this.options.renderType?this.render:this.render.firstChild.firstChild,!(r.D.isIE(6)||r.D.isIE(7))&&"native"==this.options.renderType){var e=this.render.clientHeight-this.dom.select.offsetHeight;e>0&&(this.dom.select.style.marginTop=parseInt(e/2,10)+"px")}!0===this.options.labelWidthAuto&&(this.render.style.width=""),this.modelControl.isItemsetBinded()&&(this.refreshItemArr(),this.componentRedraw())}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.setAction=function(){try{if(this.options.nextTabID&&this.setNextTabID(this.options.nextTabID,this.scope_id),this.options.initStyle){var e=document.getElementById(this.id).style.cssText,t=document.getElementById(this.id).getAttribute("class");WebSquare.initStyle[this.id]={style:e,className:t}}if(this.modelControl.isBinded()){var i=this.modelControl.getData();this.setValueNM(i)}if(-1==this.selectedIndex&&this.getItemCount()>0&&(0==this.options.emptyIndex||!this.options.emptyIndex))if(this.modelControl.isBinded()){i=this.getValue();if(this.options.emptyRef){for(var s=this.getItemCount(),o=0;o<s;o++)if(this.itemArr[o].value==i){this.setSelectedIndexNM(0),this.modelControl.setData(i);break}}else this.setSelectedIndexNM(0),this.modelControl.setData(i)}else this.setSelectedIndexNM(0),this.broadcast({linkedDataList:["refresh",["replace"]]});else if(this.getItemCount()>0&&this.modelControl.isBinded()&&(0==this.options.emptyIndex||!this.options.emptyIndex)){i=this.getValue();this.modelControl.getData()!==i&&this.modelControl.setData(i)}else this.options.emptyIndex&&"number"==typeof this.options.emptyIndex&&(this.modelControl.isBinded()?(this.setSelectedIndexNM(this.options.emptyIndex),this.modelControl.setData(this.getValue())):(this.setSelectedIndexNM(this.options.emptyIndex),this.broadcast({linkedDataList:["refresh",["replace"]]})))
;this.options.mandatory&&this.onPropertyChange("mandatory",r.D.getBoolean(this.options.mandatory)),this.event.addListener2(this.dom.select,"onchange",this.event.bindAsEventListener(this,this.handleOnchange)),this.event.addListener(this.dom.select,"onfocus",this.event.bindAsEventListener(this,this.handleFocusEvent)),this.event.addListener(this.dom.select,"onblur",this.event.bindAsEventListener(this,this.handleBlurEvent))}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.componentRedraw=function(e,t){try{if(this.refreshStop)return;if(this.showRowIndex=0,this.setSelectOptions(),this.itemArr.length>0){if(this.options.refreshSelectedIndex&&"setCellData"===t)return;if(e||"insertRow"===t){var i=0;return"insertRow"!==t&&"replace"!=e&&this.getSelectedIndex()>-1&&(i=this.getSelectedIndex()),this.dom.select.selectedIndex=i,void(this.selectedIndex=i)}this.dom.select.selectedIndex=0,this.selectedIndex=0}this.setValueNM("")}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.refreshVisible=function(){try{for(var e=0;e<this.itemArr.length;e++)!0===this.itemArr[e]._hidden&&this.dom.select?this.dom.select.options[e].style.display="none":this.dom.select.options[e].style.display=""}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.refreshEnable=function(){try{for(var e=0;e<this.itemArr.length;e++)!0===this.itemArr[e]._disabled&&this.dom.select?this.dom.select.options[e].setAttribute("disabled",""):this.dom.select.options[e].removeAttribute("disabled")}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.setSelectOptions=function(){try{for(var e=this.dom.select.options.length;e>=0;e--)this.dom.select.remove(e);for(e=0;e<this.itemArr.length;e++){var t=document.createElement("option");t.text=this.itemArr[e].label,this.dom.select.options[e]=t,!0===this.itemArr[e]._hidden&&(this.dom.select.options[e].style.display="none"),!0===this.itemArr[e]._disabled&&this.dom.select.options[e].setAttribute("disabled","")}}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.setSelectedIndexNM=function(e){try{return e=parseInt(e),!this.options.emptyItem&&(isNaN(e)||e<0||e>=this.getItemCount())?!1:(this.selectedIndex=e,this.dom.select&&(this.dom.select.selectedIndex=e),this.broadcast({linkedDataList:["refresh",["replace"]]}),!0)}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.handleOnchange=function(e){var t=this.dom.select.selectedIndex,i=this.getSelectedIndex(),s=this.getValue();this.setSelectedIndexNM(t),this.options.emptyItem&&-1==t?this.modelControl.setData(this.options.emptyValue):this.modelControl.setData(this.itemArr[t].value);var o=this.getValue();if(this.selectedIndex=t,i!=this.getSelectedIndex()){n.B.fireEvent(this,"onchange",{oldValue:s,newValue:o});var l={oldValue:s,newValue:o,oldSelectedIndex:i,newSelectedIndex:this.selectedIndex};n.B.fireEvent(this,"onviewchange",l)}},p.prototype.handleKeydownEvent=function(e){try{if(9==(e.charCode?e.charCode:e.keyCode))return this.tabOrderMoveStart=!1,void(e.shiftKey?null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].preTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(e)):null!=WebSquare.tabOrder[this.id]&&null!=WebSquare.tabOrder[this.id].nextTabID&&(this.tabOrderMoveStart=!0,n.B.preventDefault(e)))}catch(e){l.w.printStackTrace(e)}},p.prototype.handleKeyupEvent=function(e){try{var t;if(9==(e.charCode?e.charCode:e.keyCode))if(null!=WebSquare.tabOrder[this.id])if(e.shiftKey){if(null!=WebSquare.tabOrder[this.id].preTabID)(t=r.D.getPreTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus())}else if(null!=WebSquare.tabOrder[this.id].nextTabID)(t=r.D.getNextTabbableComp(this.id))&&this.tabOrderMoveStart&&(this.tabOrderMoveStart=!1,t.focus())}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.handleBlurEvent=function(e){try{n.B.fireEvent(this,"onblur")}catch(e){l.w.printStackTrace(e,null,this)}},p.prototype.handleFocusEvent=function(e){n.B.fireEvent(this,"onfocus")},p.prototype.focus=function(){this.dom.select.focus()},
p.prototype.setDisabled=function(e){try{e=r.D.getBoolean(e),this.options.disabled=e,this.onPropertyChange("disabled",e)}catch(e){l.w.printStackTrace(e)}return e},p.prototype._getValueNotInList=function(){try{switch(this.options.valueNotInList){case"keepValue":case"default":default:return this.options.emptyItem&&-1==this.selectedIndex?this.options.emptyValue:null}}catch(e){return l.w.printStackTrace(e,null,this),null}},p.prototype._setValueNotInList=function(e,t){try{switch(this.options.valueNotInList){case"keepValue":case"default":default:this.options.emptyItem?this.setSelectedIndex(-1,t):this.setSelectedIndex(0,t)}}catch(e){return l.w.printStackTrace(e,null,this),!1}}}}]);